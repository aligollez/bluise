function destoryTawkObjects(){if(void 0!==window.Tawk_API&&"function"==typeof window.Tawk_API.hideWidget)for(var e=document.querySelectorAll("iframe"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);for(var n=document.getElementsByTagName("script"),t=0;t<n.length;t++){var a=n[t];"yes"===a.getAttribute("tawk")&&a.parentNode.removeChild(a)}}function getCookie(e){var t="; "+document.cookie,n=t.split("; "+e+"=");if(2===n.length)return n.pop().split(";").shift()}function setUnused(){}function toggleModalMenu(){$("#modal-menu").toggle()}function cacheSuffix(){return"?time"+Math.floor(Date.now()/1e3)}var app=angular.module("app",["ui.router","ui.bootstrap","LocalStorageModule","pascalprecht.translate","naif.base64","oc.lazyLoad","ngSanitize","ngCookies","ui.mask","ui.utils","angular-ladda","angular-cryptography","ui.carousel","vcRecaptcha"]),_translateProvider={},KTAppOptions={colors:{state:{brand:"#5d78ff",dark:"#282a3c",light:"#ffffff",primary:"#5867dd",success:"#34bfa3",info:"#36a3f7",warning:"#ffb822",danger:"#fd3995"},base:{label:["#c5cbe3","#a1a8c3","#3d4465","#3e4466"],shape:["#f0f3ff","#d9dffa","#afb4d4","#646c9a"]}}};app.run(["$rest","$validations","$transitions","$insured","$timeout","$rootScope","$interval","$storage","$window","$location","$anchorScroll",function(e,t,n,a,i,o,r,l,s,u,c){e.onCreate(),t.onCreate(),a.onCreate();try{i(function(){angular.element(document.getElementById("kt_footer")).css("display",""),angular.element(document.getElementById("kt_footer_bottom")).css("display",""),$("#kt_footer").css("display",""),$("#kt_footer_bottom").css("display","")},2e3)}catch(e){i(function(){angular.element(document.getElementById("kt_footer")).css("display",""),angular.element(document.getElementById("kt_footer_bottom")).css("display",""),$("#kt_footer").css("display",""),$("#kt_footer_bottom").css("display","")},2e3)}n.onBefore({},function(){i(function(){destoryTawkObjects()},50)}),n.onSuccess({},function(){r.cancel(o.quotationRefresh),c();try{console.clear()}catch(e){}i(function(){window.scrollTo({top:0})},50),i(function(){angular.element(document.getElementsByClassName("popover")).addClass("invisible"),angular.element(document.getElementsByClassName("popover")).removeClass("popover show")},50)}),n.onStart({},function(e){if(!0===e._targetState._definition.self.isRequireInsured)return null!==a.getActiveInsured()||(a.setReferrer(e._targetState._definition.self.name,e._targetState._params),e.router.stateService.target("insuredLocalSearch"))})}]),app.config(["$translateProvider","$httpProvider","$cryptoProvider",function(e,t,n){t.interceptors.push(["$culture","$timeout",function(e,t){return{response:function(n){return 0===n.config.url.indexOf("/api/languages/")&&t(e.setReady,1),n}}}]),e.useStaticFilesLoader({prefix:"/api/welcome/languages/",suffix:""}),_translateProvider=e,n.setCryptographyKey("UxLPuYFIzdOPKcTW"),n.setCryptographyIV("Bhuywg7tzjks3ZbW"),e.useSanitizeValueStrategy("sce");var a="tr-tr";$.getJSON("../content/language/lang.json",function(e){a=e.language;var t=angular.element(document.body).injector();t.has("$translate")&&t.get("$translate").use(a)})}]),setUnused(),JSON.clone=function(e){var t=null;try{t.assign({},e)}catch(n){try{t=JSON.parse(JSON.stringify(e))}catch(n){t=angular.copy(e)}}return t},Array.prototype.addSelection=function(e){var t=angular.element(document.body).injector().get("$culture");return void 0===e&&(e=null),this.unshift({kod:e,ad:t.translate("SEÇİNİZ")}),this},Array.prototype.addAllSelection=function(e){var t=angular.element(document.body).injector().get("$culture");return void 0===e&&(e=null),this.unshift({kod:e,ad:t.translate("TÜMÜ")}),this},JSON.fixNulls=function(e){angular.forEach(e,function(t,n){void 0!==t&&null!==t&&"string"==typeof t&&0===t.length&&(e[n]=null)})},JSON.fixIntsToNulls=function(e,t){angular.forEach(t,function(t){void 0!==e[t]&&null!==e[t]&&0===e[t]&&(e[t]=null)})},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},app.config(["$stateProvider","$translateProvider","$locationProvider","$urlRouterProvider",function(e,t,n,a){var i=cacheSuffix();e.state("home",{url:"/",templateUrl:"/content/views/welcome.html"+i}).state("welcome",{url:"/",templateUrl:"/content/views/welcome.html"+i}).state("panel",{url:"/panel/index",templateUrl:"/content/views/dashboard.html"+i}).state("dashboard",{url:"/dashboard",templateUrl:"/content/views/dashboard.html"+i,params:{section:null,tabOption:null}}).state("DaskCreate",{url:"/dask/{menuurl}",templateUrl:"/content/views/quotation/dask.html"+i,params:{menu:null,menuurl:null}}).state("PropertyCreate",{url:"/konut/{menuurl}",templateUrl:"/content/views/quotation/property.html"+i,params:{menu:null,menuurl:null}}).state("HealthCreate",{url:"/saglik/{menuurl}",templateUrl:"/content/views/quotation/health.html"+i,params:{menu:null,menuurl:null}}).state("OtherCreate",{url:"/diger/{menuurl}",templateUrl:"/content/views/quotation/other.html"+i,params:{menu:null,menuurl:null}}).state("EngineeringCreate",{url:"/muhendislik/{menuurl}",templateUrl:"/content/views/quotation/engineering.html"+i,params:{menu:null,menuurl:null}}).state("CarCreate",{url:"/oto/{menuurl}",templateUrl:"/content/views/quotation/traffic.html"+i,params:{menu:null,menuurl:null}}).state("OtherCarCreate",{url:"/oto/diger/{menuurl}",templateUrl:"/content/views/quotation/other-car.html"+i,params:{menu:null}}).state("Page",{url:"/page/{url}",templateUrl:"/content/views/pages/index.html"+i,params:{url:null}}).state("PageNotFound",{url:"/page-not-found",templateUrl:"/content/views/pages/404.html"+i}).state("Widget",{url:"/widget/{url}",templateUrl:"/content/views/widgets/index.html"+i,params:{url:null}}),n.html5Mode({enabled:!0,requireBase:!0})}]),app.controller("AnnouncementModalController",["$scope","$uibModalInstance","$sce","$rest",function(e,t,n,a){e.announcementItem=t.data.announcementItem,e.onCreate=function(){a.get("welcome/announcement/"+e.announcementItem.id,{},function(t){e.announcementItem=t},null,null,null,!0)},e.getBoxTrustedHtml=function(e){return n.trustAsHtml(e)},e.cancel=function(){t.dismiss("cancel")},e.onCreate()}]),app.controller("AnnounceModalController",["$scope","$uibModalInstance","$rootScope","$sce","$welcomeInit","$filter","$boxesInit",function(e,t,n,a,i,o,r){e.welcomeInit=i,e.announcedMenuId=t.data.menuId,e.onCreate=function(){e.welcomeInit.isSuccessData?e.initData():n.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){e.onInitPortalBox(e.announcedMenuId)},e.getBoxTrustedHtml=function(e){return a.trustAsHtml(e)},e.cancel=function(){t.dismiss("cancel")},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=o("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onInitPortalBox=function(t){e.boxesInit=r.onCreate(t),-1!=t&&-2!=t||(e.boxesData=r.getBoxes(t),e.getCategories(e.boxesData)),n.$on("$boxesInit.onSuccess",function(){e.boxesData=r.getBoxes(t),e.getCategories(e.boxesData)})},e.onCreate()}]),app.controller("ContactModalController",["$scope","$uibModalInstance","$rest","$alert","$culture","$sce",function(e,t,n,a,i,o){e.form={name:null,phone:null,message:null,mail:null,type:"CONTACT"},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.onCreate=function(){},e.save=function(){var t=angular.copy(e.form);if(null===e.form.name||null===e.form.phone||null===e.form.message||null===e.form.mail)return void a.warning(i.translate("Boş alanlar mevcut..!"));n.post("options/contacts/save",t,function(){a.success(i.translate("Mesajınız Başarıyla iletildi..!")),e.cancel()})},e.cancel=function(){t.dismiss("cancel")},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return o.trustAsHtml(e)},e.onCreate()}]),app.controller("ContactModalInsuredController",["$scope","$uibModalInstance","$rest","$alert","$culture","$sce",function(e,t,n,a,i,o){e.form={name:null,phone:null,message:null,mail:null,type:"CONTACT"},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.data=t.data,e.onCreate=function(){null!==e.data&&void 0!==e.data&&(e.form.name=e.data.data.Unvan,e.form.phone=e.data.data.GSMNo,e.form.mail=e.data.data.EMail)},e.save=function(){var t=angular.copy(e.form);if(null===e.form.name||null===e.form.phone||null===e.form.message||null===e.form.mail)return void a.warning(i.translate("Boş alanlar mevcut..!"));n.post("options/contacts/save",t,function(){a.success(i.translate("Mesajınız Başarıyla iletildi..!")),e.cancel()})},e.cancel=function(){t.dismiss("cancel")},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return o.trustAsHtml(e)},e.onCreate()}]),app.controller("DashboardController",["$scope","$rest","$auth","$modal","$rootScope","$insured","$state","$timeout","$rootSettings","$sce","$culture","$elements","$location","$welcomeInit","$formValidations","$storage","$dateFormatter","$lists","$alert","$http","$tia","$filter","$boxesInit","$handcuff","$window",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S,C,T,D){e._validator=p,e.isNoThemed=null,e.activeView="",e.quotationData=angular.copy(g.get("Quotation")),g.set("Quotation",null),e.restConnector=t,e.isCookiePermission=!1,e.isLoggedIn=!0,e.search={searchQuery:null,search:null},e.tabOptions={options:{quotations:"quotations",policy_requests:"policy_requests"},selectedOption:"quotations"},e.activateView=function(t,n){e.activeView=t,""!=e.insuredData.HesKod&&null!=e.insuredData.HesKod&&void 0!=e.insuredData.HesKod||(h.error(c.translate("Oturumunuz sonlandırıldı! Ana sayfaya yönlendirileceksiniz...")),l(function(){window.location.href="/"},2e3)),"quotationDetail"!==t&&g.set("Quotation",null),m.search("Success",null),"dashboard"==t&&i.$broadcast("@OnUpdateCount",e.insuredData.HesKod),n&&n()},i.$on("@activateView",function(t,n){e.activeView=n,"quotationDetail"!==n&&g.set("Quotation",null)}),e.onChangeTabOptions=function(t){e.tabOptions.selectedOption=t},e.isDefaultBannerActive=!0,e.activeMenuForBanner=null,e.isInsuranceMenuActive=!1,e.policyRequestExists=!1,e.welcomeInit=f,e.bannerImage={isViewDescriptionTitleBanner:null,menuHoverId:0},e.bannerNavigation={next:!1,prev:!1},e.nextSlide=function(){e.bannerNavigation.next=!0},e.prevSlide=function(){e.bannerNavigation.prev=!0},e.onReadyMarquee=function(){e.marqueeReady=!0},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null},e.menuStyles={menuLocation:null,menuStyle:null,menuRadius:null,menuBackgroundColor:null,menuHoverColor:null,menuFontColor:null,menuAlign:null,menuViewLocation:null,isHeader:!1,isFixed:!1,isViewIcon:!0,subMenuEffect:!0,subMenuBackgroundColor:null,subMenuAlign:null,menuFontSize:null,isViewHamburgerMenu:!1,isViewIconMobile:!0},e.headerSettingsStyle=null,e.headerSettings=null,e.topHeaderSettings=null,e.newQuotationBgColor=null,e.newQuotationHoverColor=null,e.newQuotationMenuRadius=null,e.newQuotationMenuFontSize=null,e.newQuotationSubMenuBgColor=null,e.newQuotationIsViewIcon=null,e.newQuotationMenuFontColor=null,e.filter={dateType:0,firstDate:moment(),lastDate:moment(),AnaBrans:null},e.excelParameters={isAllSelected:!1,isUploading:null,productSelection:null,transportProductList:[],teminatList:[],isProductionStarted:!1,isProductionFailed:!1,TotalCount:0,CustomerBalance:0},e.checkCookiePermission=function(){return!0!==g.get("cookie_permission")&&(g.set("cookie_permission",!1),angular.element(document.querySelector("#cookie_permission")).removeClass("kt-display-none"),!0)},e.onCreate=function(a){var i=m.search();null!==i&&""!==i&&void 0!==i?!0!==i.Success&&r.go("dashboard"):r.go("dashboard");var u=m.search();null!==u&&""!==u&&void 0!==u&&null!==u.ref_fw&&""!==u.ref_fw&&void 0!==u.ref_fw&&t.get("reference/definition/"+u.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};g.set("Ref",t)}}),t.get("application/init",{},function(i){null!==i.authenticated&&""!==i.authenticated&&(i.authenticated.HesapKodu=T.remove(i.authenticated.HesapKodu),i.authenticated.AdresNo=T.remove(i.authenticated.AdresNo),i.authenticated.Adres=T.remove(i.authenticated.Adres),i.authenticated.Email=T.remove(i.authenticated.Email),i.authenticated.GSM=T.remove(i.authenticated.GSM),i.authenticated.Unvan=T.remove(i.authenticated.Unvan),i.authenticated.UserName=T.remove(i.authenticated.UserName),i.authenticated.CustomerHesKod=T.remove(i.authenticated.CustomerHesKod),i.authenticated.DaireNo=T.remove(i.authenticated.DaireNo),i.authenticated.Mahalle=T.remove(i.authenticated.Mahalle),i.authenticated.TPSicilNo=T.remove(i.authenticated.TPSicilNo),i.authenticated.PersonelKodu=T.remove(i.authenticated.PersonelKodu),i.authenticated.PersonelAdi=T.remove(i.authenticated.PersonelAdi)),i.companiesInfo.length>0&&angular.forEach(i.companiesInfo,function(e){e.description=T.remove(e.description),e.fileName=T.remove(e.fileName),e.logo=T.remove(e.logo),e.skpsCode=T.remove(e.skpsCode),e.tramerCode=T.remove(e.tramerCode),e.title=T.remove(e.title)}),e.companiesInfo=i.companiesInfo,e.productDetails=i.portalMenuProductDetails,s.set(i.rootSettings),n.set(i);var r={accountId:i.authenticated.HesapKodu};t.post("insured/query",r,function(n){null!==n&&""!==n?(n.Adres=T.remove(n.Adres),n.AdresNo=T.remove(n.AdresNo),n.BinaNo=T.remove(n.BinaNo),n.DaireNo=T.remove(n.DaireNo),n.EMail=T.remove(n.EMail),n.GSMNo=T.remove(n.GSMNo),n.HesKod=T.remove(n.HesKod),n.Mahalle=T.remove(n.Mahalle),n.PasaportNo=T.remove(n.PasaportNo),n.ReferansAdi=T.remove(n.ReferansAdi),n.Sokak=T.remove(n.Sokak),n.TCNo=T.remove(n.TCNo),n.Tali=T.remove(n.Tali),n.TaliAdi=T.remove(n.TaliAdi),n.TelNo1=T.remove(n.TelNo1),n.TelNo2=T.remove(n.TelNo2),n.Temsilci=T.remove(n.Temsilci),n.TemsilciAdi=T.remove(n.TemsilciAdi),n.Unvan=T.remove(n.Unvan),n.VergiNo=T.remove(n.VergiNo),n.Ilce=T.remove(n.Ilce),n.IlKodu=T.remove(n.IlKodu),n.IkametTel1=T.remove(n.IkametTel1),n.IzinliPazarlamaDurum=T.remove(n.IzinliPazarlamaDurum),n.KVKKDurum=T.remove(n.KVKKDurum),n.Sehir=T.remove(n.Sehir),n.Semt=T.remove(n.Semt),n.PKodu=T.remove(n.PKodu),n.Cadde=T.remove(n.Cadde),n.IlceKodu=T.remove(n.IlceKodu),n.DogumTarihi=T.remove(n.DogumTarihi)):(h.error(c.translate("Oturumunuz sonlandırıldı! Ana sayfaya yönlendirileceksiniz...")),l(function(){window.location.href="/"},2e3)),o.setAccountId(i.authenticated.HesapKodu),o.set(n),e.insuredData=n,null!==e.quotationData&&(e.activeView="quotationDetail",e.quotationData.id=e.quotationData.pPoliID,e.quotationData.tip=e.quotationData.pTip,e.viewQuotationDetails(e.quotationData)),e.startInitData(function(){var n={HesapKodu:i.authenticated.HesapKodu,pGrupGetir:e.quotationCriterias.groupAccount,endDatePreviousDay:e.quotationCriterias.endDatePreviousDay,endDateNextDay:e.quotationCriterias.endDateNextDay};t.post("sales/operations/counts",n,function(t){e.counts={TeklifAdet:parseInt(t.return.TeklifAdet),PoliceAdet:parseInt(t.return.PoliceAdet),PoliceTalebiAdet:parseInt(t.return.PoliceTalebiAdet),PoliceDuzenlendiAdet:parseInt(t.return.PoliceDuzenlendiAdet),PoliceTalepToplamAdet:parseInt(t.return.PoliceTalebiAdet)+parseInt(t.return.PoliceDuzenlendiAdet)},e.onInitPortalBox(),e.portalPanelSettings.isUploadTransportFileView?(e.excelParameters.transportProductList=[],angular.forEach(e.menus,function(t){8==t.main_product&&(t.title=t.portalDetailsMenu.title,e.excelParameters.transportProductList.push(t))}),e.excelParameters.transportProductList.length>0&&(e.excelParameters.productSelection=e.excelParameters.transportProductList[0].product),e.onChangeTransportProduct(function(){"function"==typeof a&&a()})):"function"==typeof a&&a()})})},function(){e.startInitData()})},function(e){"HttpStatusCode_Unauthorized"===e.code&&m.path("/")}),e.filter.firstDate=moment().add(-30,"days").format("DD-MM-YYYY"),e.filter.lastDate=moment().add(30,"days").format("DD-MM-YYYY")},e.startInitData=function(t){e.welcomeInit.isSuccessData?e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:-2,viewLocation:"DASHBOARD"},function(){if("/dashboard"===m.path()){var n=e.welcomeInit;e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks()}e.initData(t)})}):i.$on("$welcomeInit.onSuccess",function(){e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:-2,viewLocation:"DASHBOARD"},function(){if("/dashboard"===m.path()){var n=e.welcomeInit;e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks()}e.initData(t)})})})},e.initData=function(t){var n=e.welcomeInit;if(e.styleSettings=n.getStyleSettings(),e.styleSettings.footerColor||(e.styleSettings.footerColor="#1A102B"),e.styleSettings.bottomFooterColor||(e.styleSettings.bottomFooterColor="#1A102B"),null!==e.styleSettings.fontUrl&&""!==e.styleSettings.fontUrl&&"DEFAULT"!==e.styleSettings.font&&(document.getElementById("fontUrl")||(document.getElementsByTagName("body")[0].style=e.styleSettings.fontFamily)),e.headerSettingsStyle=n.getHeaderStyle(),e.headerSettings=n.getHeaderSettings(),e.topHeaderSettings=n.getTopHeaderSettings(),e.headerControl=n.getHeaderControl(),e.topHeaderControl=n.getTopHeaderControl(),e.headerDetails={},angular.forEach(e.headerSettings,function(t){"DESKTOP"===t.resolution?"LOGO"===t.type&&(e.headerDetails.DESKTOP_LOGO=t):"TABLET"===t.resolution?"LOGO"===t.type&&(e.headerDetails.TABLET_LOGO=t):"MOBİLE"===t.resolution&&"LOGO"===t.type&&(e.headerDetails.MOBILE_LOGO=t)}),e.menus=[],angular.forEach(n.getMenus(),function(t){-1!==t.viewLocation&&e.menus.push(t)}),e.setMenuRedirectUrls(),e.menuProducts=n.getMenuProducts(),e.companies=n.getCompanies(),e.companyDetail=n.getCompanyDetail(),e.websiteSettings=n.getWebsiteSettings(),e.languageList=n.getLanguageList(),e.langCode=n.getLangCode(),e.portalPanelSettings=n.getPanelSettings(),e.tawk=n.getTawkSettings(),e.dynamicContent=n.getDynamicContent(),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.menuResponse=n.getMenuStyles(),e.setMenuStyles();try{"CLOSED"!==e.tawk.tawkWidgetOption&&null!==e.tawk.tawkWidgetCode&&""!==e.tawk.tawkWidgetCode&&void 0!==e.tawk.tawkWidgetCode&&e._setupTawk()}catch(e){}l(c.setReady,1),"function"==typeof t&&t()},e.setMenuRedirectUrls=function(){angular.forEach(e.menus,function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return e.displayUrl=e.url,void(e.displayTarget=e.urlType?"_self":e.urlType);if(e.portalPageId>0)return e.displayUrl="/page/"+e.portalMenuPage.url,void(e.displayTarget=e.urlType?"_self":e.urlType);if(null!==e.product&&void 0!==e.product&&""!==e.product){var t=parseInt(e.main_product);if(4==t||5==t)return e.displayUrl="/oto/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(10==t)return e.displayUrl="/dask/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(1==t||2==t||3==t)return e.displayUrl="/konut/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(12==t)return e.displayUrl="/saglik/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(7==t||8==t||11==t)return e.displayUrl="/diger/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(9==t)return e.displayUrl="/muhendislik/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(6==t)return e.displayUrl="/oto/diger/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(13==t)return e.displayUrl="/pota/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);e.displayUrl=""}})},e.injectProductStyles=function(e){var t=angular.copy(e);return angular.forEach(t.authenticated.Menus,function(e){e.iconname=null,e.color=null,e.backgroundColor=null}),angular.forEach(t.productStyles,function(e){angular.forEach(t.authenticated.Menus,function(t){e.productKey==t.arabrans&&(t.iconname=e.icon,t.color=e.color,t.backgroundColor=e.backgroundColor)})}),t.authenticated},e.setMenuStyles=function(){var t=null,n=m.path();angular.forEach(e.menuResponse,function(a){"/dashboard"===n?"DASHBOARD"===a.location&&(t=a):n.indexOf("/page/")>-1?"PAGES"===a.location&&(t=a):"QUATATION"===a.location&&(t=a),"GETNEWQUOTATION"===a.location&&(e.newQuotationBgColor=a.menuBackgroundColor,e.newQuotationHoverColor=a.menuHoverColor,e.newQuotationMenuRadius=a.menuRadius,e.newQuotationMenuFontSize=a.menuFontSize+"px",e.newQuotationSubMenuBgColor=a.subMenuBackgroundColor,e.newQuotationIsViewIcon=a.isViewIcon,e.newQuotationMenuFontColor=a.menuFontColor)}),t?(e.menuStyles.menuLocation=t.location,e.menuStyles.menuStyle=t.menuStyle,e.menuStyles.menuBackgroundColor=t.menuBackgroundColor,e.menuStyles.menuHoverColor=t.menuHoverColor,e.menuStyles.menuFontColor=t.menuFontColor,e.menuStyles.menuFontSize=t.menuFontSize+"px",e.menuStyles.menuAlign=t.menuAlign,e.menuStyles.isFixed=t.isFixed,e.menuStyles.isViewIcon=t.isViewIcon,e.menuStyles.isViewIconMobile=t.isViewIconMobile,e.menuStyles.menuViewLocation=t.menuViewLocation,e.menuStyles.isHeader=t.isHeader,e.menuStyles.isViewHamburgerMenu=t.isViewHamburgerMenu,e.menuStyles.subMenuEffect=t.subMenuEffect,e.menuStyles.subMenuBackgroundColor=t.subMenuBackgroundColor,e.menuStyles.subMenuAlign=t.subMenuAlign,"S01-DEFAULT"!==t.menuStyle&&null!==t.menuStyle||(e.menuStyles.menuRadius=".25rem !important;"),"S01-SQUARE"!==t.menuStyle&&null!==t.menuStyle||(e.menuStyles.menuRadius="0px !important;"),"S01-ROUND"!==t.menuStyle&&null!==t.menuStyle||(e.menuStyles.menuRadius=".35rem !important;"),!0!==t.isHeader&&"transparent"===t.menuBackgroundColor&&(e.menuStyles.menuBackgroundColor="#fff")):e.menuStyles={menuStyle:null,menuRadius:null,menuBackgroundColor:null,menuHoverColor:null,menuFontColor:null,menuLocation:null,isFixed:null,isViewIcon:null,isHeader:null,isViewHamburgerMenu:null,subMenuEffect:null,subMenuBackgroundColor:null,subMenuAlign:null,menuFontSize:null,isViewIconMobile:null}},e.setSeoSettings=function(e){var t=!1,n=!1,a=!1,i=document.getElementsByTagName("meta"),o=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],r=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(e,function(e){if(-2==e.portalMenuId){for(var l=0;l<i.length;l++)"robots"===i[l].getAttribute("name")&&0==e.isRobot&&(i[l].content="noindex, nofollow",n=!0),"description"===i[l].getAttribute("name")&&e.description&&""!==e.description&&(i[l].content=e.description,a=!0),"keywords"===i[l].getAttribute("name")&&e.keywords&&""!==e.keywords&&(i[l].content=e.keywords);angular.forEach(o,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(r,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}-2==e.portalMenuId&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,t=!0)}),t||(document.title=f.getPanelSettings()?f.getPanelSettings().siteName:"Polisoft Ltd");for(var l=0;l<i.length;l++)"robots"!==i[l].getAttribute("name")||n||(i[l].content="index, follow"),"description"!==i[l].getAttribute("name")||a||(i[l].content=f.getPanelSettings()?f.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var t=e.welcomeInit;"/dashboard"===m.path()&&(e.announcements=[],angular.forEach(t.getAnnouncements(),function(t){-2===t.portalMenuId&&e.announcements.push(t)}),e.onReadyMarquee())},i.$on("@SetAnnouncementList",function(t,n){if(n.length>0)e.announcements=n;else{var a=e.welcomeInit;e.announcements=[],angular.forEach(a.getAnnouncements(),function(t){-2===t.portalMenuId&&!0===t.isViewAllPagesDashboard&&e.announcements.push(t)}),e.onReadyMarquee()}}),e.setQuickLinks=function(){var t=e.welcomeInit;e.quickLinks=[],angular.forEach(t.getQuickLinks(),function(t){"DASHBOARD"!==t.viewLocation&&"ALL"!==t.viewLocation||e.quickLinks.push(t)})},i.$on("@SetQuickLinkList",function(t,n){if(n.length>0)e.quickLinks=n;else{var a=e.welcomeInit;e.quickLinks=[],angular.forEach(a.getQuickLinks(),function(t){"DASHBOARD"!==t.viewLocation&&"ALL"!==t.viewLocation||e.quickLinks.push(t)}),e.onReadyMarquee()}}),e.checkIfSuperUser=function(e){var t=!1;return angular.forEach(e,function(e){e.ModuleCode===parseInt(533)&&(t=!0)}),t},e.onArrangeValidations=function(e,t){var n=[];return angular.forEach(e,function(e){angular.forEach(t,function(t){t.id==e.userGroup&&n.push(e)})}),n},e.resetActiveMenu=function(){e.activeMenu=null,$("#modal-menu").hide(),angular.element(document.getElementsByClassName("mobile-sub-menu")).removeClass("show")},e.setActiveMenu=function(t){if(e.activeMenu>0&&e.activeMenu===t.id)return void(e.activeMenu=null);angular.forEach(e.menus,function(n){n.parent===t.id&&(e.activeMenu=t.id)}),t.isSubExists||e.resetActiveMenu()},e.setTopActiveMenu=function(t){if(e.topActiveMenu>0&&e.topActiveMenu===t.id)return void(e.topActiveMenu=null);angular.forEach(e.menus,function(n){n.parent===t.id&&(e.topActiveMenu=t.id)}),t.isSubExists||e.resetActiveMenu()},e.changeRoute=function(t){e.activeMenuForBanner=t,e.resetActiveMenu()},i.$on("$locationChangeSuccess",function(){"/"===m.path()?e.isTopMenuViewerActive=!1:(e.isTopMenuViewerActive=!0,e.closeCookieConsent()),""!==r.params.section&&null!==r.params.section&&void 0!==r.params.section&&(e.activeView=r.params.section,"teklifler"===r.params.section&&e.onCreate(function(){e.listQuotations(),"policy_requests"===r.params.tabOption&&(e.tabOptions.selectedOption=r.params.tabOption)}),"policeler"===r.params.section&&e.onCreate(function(){e.listPolicies()}),"dashboard"===r.params.section&&i.$broadcast("@OnUpdateCount",e.insuredData.HesKod)),e.setAnnouncements(),e.menuResponse&&e.setMenuStyles();e.activeMenuForBanner;m.path();try{"CLOSED"!==e.tawk.tawkWidgetOption&&e._setupTawk()}catch(e){}}),e.setInsuranceMenuActive=function(){e.isInsuranceMenuActive=!e.isInsuranceMenuActive},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return u.trustAsHtml(e)},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.getBoxTrustedHtml=function(e){return u.trustAsHtml(e)},e.getPolicyTrustedHtml=function(e){return u.trustAsHtml(e)},e.onLogoClick=function(){r.go("dashboard",{},{reload:!0}),g.set("Quotation",null),e.activeView=""},e.openContactModal=function(){a.open("/content/views/contact-modal-insured.html","ContactModalInsuredController",function(t){t.data={data:e.insuredData}})},e.openAnnounceModal=function(){if(-1===f.OpenedAnnounceModals.indexOf("DASHBOARD")&&"/dashboard"===m.path()){var t=!1;angular.forEach(e.boxesData.defaultItems,function(e){-2==e.portalMenuId&&!0===e.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(e){e.data={menuId:-2},f.OpenedAnnounceModals.push("DASHBOARD")},"lg")}},e.openAnnouncementModal=function(e){null!==e.description&&""!==e.description&&a.open("/content/views/announcement-header-modal.html","AnnouncementModalController",function(t){t.data={announcementItem:e}},"lg")},e.onSetDropdown=function(t){e.setDropdown=t},e.validate=function(t,n,a,i,o,r){e._validator.validate(t,n,a,i,o,r)},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e._isInvalid=function(t){return e._validator.isInvalid(t)},e.logout=function(){o.set(null),o.setAccountId(null),o.setList(null)},e.getProductIcon=function(t){var n="fa fa-clipboard-check";return angular.forEach(e.menus,function(e){e.product===t.arabrans&&(n=e.icon)}),"0"==t.tip&&angular.forEach(e.menus,function(e){if(e.product!==t.arabrans){parseInt(e.main_product)-1==parseInt(t.anabrans)&&(n=e.icon)}}),n},e.getListDescription=function(t){var n=null;return angular.forEach(e.menus,function(e){if(e.product===t.arabrans)try{n=e.portalDetailsMenu.listDescription}catch(e){}}),n},e.getCardDescription=function(t){var n=null;return angular.forEach(e.menus,function(e){if(e.product===t.arabrans)try{n=e.portalDetailsMenu.cardDescription}catch(e){}}),n},e.getQuotationListColor=function(t){var n="";return angular.forEach(e.menus,function(e){e.product===t.arabrans&&(n=e.quotationListColor?e.quotationListColor:e.color)}),"0"==t.tip&&angular.forEach(e.menus,function(e){if(e.product!==t.arabrans){parseInt(e.main_product)-1==parseInt(t.anabrans)&&(n=e.quotationListColor?e.quotationListColor:e.color)}}),n},e.getProductIconDetail=function(t){var n="fa fa-clipboard-check";return angular.forEach(e.menus,function(e){e.product===t&&(n=e.icon)}),n},e.getQuotationListColorDetail=function(t){var n="";return angular.forEach(e.menus,function(e){e.product===t&&(n=e.quotationListColor?e.quotationListColor:e.color)}),n},e.viewQuotationDetails=function(e){i.pPoliIDForDetail=e.id,i.pTipForDetail=e.tip;var t={pPoliID:e.id,pTip:e.tip};g.set("Quotation",t)},e.viewQuotationDetailsMiniCard=function(e){i.pPoliIDForDetail=e.id,i.pTipForDetail=e.tip;var t={pPoliID:e.id,pTip:e.tip};g.set("Quotation",t),r.reload()},e.onClickPreferences=function(e,t,n){a.open("/content/views/quotation/preferences-modal.html","Preferences.QuotationModalController",function(a){a.data={sirket:t,data:e,activeMenu:n}},"lg")},e._setupTawk=function(t){if(e.tawk){var n={};if("CLOSED"===e.tawk.tawkWidgetOption)return;void 0!==e.tawk.tawkWidgetOption&&null!==e.tawk.tawkWidgetOption&&""!==e.tawk.tawkWidgetOption&&("GENERAL"===e.tawk.tawkWidgetOption?null!==e.tawk.tawkWidgetCode&&void 0!==e.tawk.tawkWidgetCode&&""!==e.tawk.tawkWidgetCode&&(n={default:e.tawk.tawkWidgetCode},e.configTawk(n)):"/dashboard"===m.path()?null!==e.tawk.tawkWidgetCode&&void 0!==e.tawk.tawkWidgetCode&&""!==e.tawk.tawkWidgetCode&&(n={default:e.tawk.tawkWidgetCode},e.configTawk(n)):null!==t&&void 0!==t&&""!==t?(n={default:t},e.configTawk(n)):void 0!==window.Tawk_API&&"function"==typeof window.Tawk_API.hideWidget&&window.Tawk_API.hideWidget())}},e.configTawk=function(e){void 0!==window.Tawk_API&&"function"==typeof window.Tawk_API.hideWidget&&window.Tawk_API.hideWidget();for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var a=t[n];"yes"===a.getAttribute("tawk")&&a.parentNode.removeChild(a)}
for(var i in window)window.hasOwnProperty(i)&&(i.includes("tawk")||i.includes("Tawk"))&&delete window[i];window.Tawk_API={},window.Tawk_LoadStart=new Date,function(){var t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.async=!0,t.src=e.default,t.charset="UTF-8",t.setAttribute("crossorigin","*"),t.setAttribute("tawk","yes"),n.parentNode.insertBefore(t,n)}()},e.listQuotations=function(){var n={HesapKodu:e.insuredData.HesKod,pPoliceTipi:-1,pPozisyon:e.quotationCriterias.position,pSiralama:e.quotationCriterias.order,pGorevlendirmeDurumu:e.quotationCriterias.assignType,pGrupGetir:e.quotationCriterias.groupAccount,endDatePreviousDay:e.quotationCriterias.endDatePreviousDay,endDateNextDay:e.quotationCriterias.endDateNextDay};e.isPageRendering=!0,"CARD"===e.welcomeInit.getPanelSettings().quotationStyle&&(n.pWithWebIzleTeminat=!0),t.post("teklifler/getlist",n,function(n){""!==n&&null!==n&&void 0!==n&&n.dispolice.length>0&&angular.forEach(n.dispolice,function(e){e.gtemsilciad=T.remove(e.gtemsilciad),e.heskod=T.remove(e.heskod),e.id=T.remove(e.id),e.motorno=T.remove(e.motorno),e.plaka=T.remove(e.plaka),e.policeno=T.remove(e.policeno),e.refgrup=T.remove(e.refgrup),e.sasino=T.remove(e.sasino),e.skod=T.remove(e.skod),e.ttkaciklama=T.remove(e.ttkaciklama),e.unvan1=T.remove(e.unvan1),e.yenilemeno=T.remove(e.yenilemeno),e.zeylno=T.remove(e.zeylno),e.anabrans=T.remove(e.anabrans),e.anabransadi=T.remove(e.anabransadi),e.arabrans=T.remove(e.arabrans),e.arabransaciklama=T.remove(e.arabransaciklama),e.aracdurumu=T.remove(e.aracdurumu),e.bitisgun=T.remove(e.bitisgun),e.distalep2=T.remove(e.distalep2),e.ebaslama=T.remove(e.ebaslama),e.ebitis=T.remove(e.ebitis),e.kayittarihi=T.remove(e.kayittarihi),e.pt_sirketad=T.remove(e.pt_sirketad),e.pt_skod=T.remove(e.pt_skod),e.sirketadi=T.remove(e.sirketadi),e.tarih=T.remove(e.tarih),e.tsirket2=T.remove(e.tsirket2),e.vsirket2=T.remove(e.vsirket2),e.subeadi=T.remove(e.subeadi)});var a=n.dispolice,o=n.TIAItems;angular.forEach(a,function(e){if(e.tarih=v.wsServiceToInput(e.tarih),e.isQuotationExpired=!1,e.gecerlilikGun=null,""!==e.gun&&"0"!==e.gun&&null!==e.gun){e.gecerlilikGun=moment(e.tekliftarihi,"DD.MM.YYYY").add(parseInt(e.gun),"days").format("DD.MM.YYYY");var t=moment().format("YYYY-MM-DD"),n=moment(e.tekliftarihi,"DD.MM.YYYY").add(parseInt(e.gun),"days").format("YYYY-MM-DD");parseInt(moment.duration(moment(n).diff(moment(t))).asDays())<0&&(e.isQuotationExpired=!0)}}),angular.forEach(a,function(e){var t=parseInt(e.tsirket2),n=parseInt(e.vsirket2),a=parseInt(e.nsirket);t>0&&n+a<t&&(e.teklifDurum="TEKLIF_CALISIYOR"),t>0&&n+a==t&&(e.teklifDurum="TEKLIF_TAMAMLANDI"),t>0&&a==t&&(e.teklifDurum="TEKLIF_CALISILAMADI")}),angular.forEach(a,function(e){null!==e.pt_skod&&""!==e.pt_skod&&(e.image=e.pt_skod.replace(/ /g,"_"))}),angular.forEach(a,function(t){angular.forEach(e.companiesInfo,function(n){t.tsk==n.tramerCode&&(t.companyLogo=n.logo,angular.forEach(e.productDetails,function(e){n.id==e.companyId&&e.product==t.arabrans&&(t.isHideCompanyInformation=e.isHideCompanyInformation,t.isHideInstallmentOn3D=e.isHideInstallmentOn3D)}))})}),angular.forEach(a,function(t){angular.forEach(e.menuProducts,function(e){if(e.product===t.arabrans){try{t.araBransTitle=e.portalDetailsMenu.title}catch(e){}try{if(""!==t.teklifzaman&&null!==t.teklifzaman&&void 0!==t.teklifzaman){if(0!=e.timeOut&&null!=e.timeOut&&void 0!=e.timeOut||0!=parseInt(e.refreshTime)&&null!=parseInt(e.refreshTime)&&void 0!=parseInt(e.refreshTime)||(t.isTimedOut=!0),e.timeOut>0&&parseInt(e.refreshTime)>0){var n=moment(t.teklifzaman,"YYYY-MM-DD HH:mm:ss"),a=n.add(e.timeOut,"seconds"),i=moment(t.serverzaman,"YYYY-MM-DD HH:mm:ss");""!==n&&null!==n&&void 0!==n&&""!==a&&null!==a&&void 0!==a&&(a.valueOf()>=i.valueOf()?t.isTimedOut=!1:t.isTimedOut=!0)}}else t.isTimedOut=!0}catch(e){}}if("0"==t.tip&&e.product!==t.arabrans){if(parseInt(e.main_product)-1==parseInt(t.anabrans)){try{t.araBransTitle=t.arabransaciklama}catch(e){}try{if(""!==t.teklifzaman&&null!==t.teklifzaman&&void 0!==t.teklifzaman){if(0!=e.timeOut&&null!=e.timeOut&&void 0!=e.timeOut||0!=parseInt(e.refreshTime)&&null!=parseInt(e.refreshTime)&&void 0!=parseInt(e.refreshTime)||(t.isTimedOut=!0),e.timeOut>0&&parseInt(e.refreshTime)>0){var n=moment(t.teklifzaman,"YYYY-MM-DD HH:mm:ss"),a=n.add(e.timeOut,"seconds"),i=moment(t.serverzaman,"YYYY-MM-DD HH:mm:ss");""!==n&&null!==n&&void 0!==n&&""!==a&&null!==a&&void 0!==a&&(a.valueOf()>=i.valueOf()?t.isTimedOut=!1:t.isTimedOut=!0)}}else t.isTimedOut=!0}catch(e){}}}})}),"police-talepleri"===e.activeView&&angular.forEach(a,function(n){18==n.distalep2&&(e.policyRequestExists=!0,angular.forEach(e.menus,function(a){if(a.product===n.anateklif_arabranskodu&&(e.isViewPolicyQuotationPDF=a.isViewPdf,t.get("portalmenus/menustatus/"+a.id,{},function(e){angular.forEach(e,function(e){"POLICE_TALEBI_TELEFON"===e.status&&n.arabrans==e.product&&"18"==n.distalep2&&(n.policyRequestMessage=e.message,n.policyRequestMessageMobile=e.messageMobile,n.policyRequestMessageTablet=e.messageTablet,n.policyRequestIsViewAllResolutions=e.isViewAllResolutions)})},null,null,null,!0)),"0"==n.tip&&a.product!==n.anateklif_arabranskodu){parseInt(a.main_product)-1==n.anabrans&&(e.isViewPolicyQuotationPDF=a.isViewPdf,t.get("portalmenus/menustatus/"+a.id,{},function(e){angular.forEach(e,function(e){"POLICE_TALEBI_TELEFON"===e.status&&n.arabrans==e.product&&"18"==n.distalep2&&(n.policyRequestMessage=e.message,n.policyRequestMessageMobile=e.messageMobile,n.policyRequestMessageTablet=e.messageTablet,n.policyRequestIsViewAllResolutions=e.isViewAllResolutions)})},null,null,null,!0))}})),20==n.distalep2&&(e.isViewPolicyQuotationPDF=!0)}),angular.forEach(a,function(e){e.TeminatList=[],e.AciklamaList=[],e.IndirimList=[],angular.forEach(o,function(t){t.PoliID===parseInt(e.id)&&t.PoliTip===parseInt(e.tip)&&(e.TeminatList=t.Teminat,e.AciklamaList=t.Aciklama,e.IndirimList=t.Indirim)}),angular.forEach(e.TeminatList,function(e){null!==e.NesneDeger&&void 0!==e.NesneDeger&&0!==e.NesneDeger&&e.NesneDeger>0&&angular.forEach(e.ListItems,function(t){t.ID==e.NesneDeger&&(e.DisplayValue=t.Ad)})}),angular.forEach(e.IndirimList,function(e){null!==e.NesneDeger&&void 0!==e.NesneDeger&&0!==e.NesneDeger&&e.NesneDeger>0&&angular.forEach(e.ListItems,function(t){t.ID==e.NesneDeger&&(e.DisplayValue=t.Ad)})}),angular.forEach(e.AciklamaList,function(e){null!==e.NesneDeger&&void 0!==e.NesneDeger&&0!==e.NesneDeger&&e.NesneDeger>0&&angular.forEach(e.ListItems,function(t){t.ID==e.NesneDeger&&(e.DisplayValue=t.Ad)})})}),e.policyCollection=a,e.isPageRendering=!1,e.quotationCount=0,e.policyRequestCount=0,angular.forEach(a,function(t){18!=t.distalep2&&e.quotationCount++,18==t.distalep2&&e.policyRequestCount++}),i.$broadcast("@OnUpdateCount",e.insuredData.HesKod),e.tarihTipiList=k.getPoliceIslemlerTarihTipiList(),e.anaBransList=k.getAnaBranslar(),e.anaBransList.unshift({value:null,title:c.translate("TÜMÜ")}),e.filter.firstDate=moment().add(-30,"days").format("DD-MM-YYYY"),e.filter.lastDate=moment().add(30,"days").format("DD-MM-YYYY")},function(){e.isPageRendering=!1},null,null,!0)},e.listPolicies=function(){e.tarihTipiList=k.getPoliceIslemlerTarihTipiList(),e.anaBransList=k.getAnaBranslar(),e.anaBransList.unshift({value:null,title:c.translate("TÜMÜ")}),e.search={searchQuery:"",search:""};var n=angular.copy(e.filter);n.HesapKodu=e.insuredData.HesKod,n.pPoliceTipi=0,n.pSiralama="tarih",n.pGrupGetir=1,n.firstDate=v.toService("firstDate.ISLS01",e.filter.firstDate),n.lastDate=v.toService("lastDate.ISLS01",e.filter.lastDate),0==n.dateType&&(n.pSiralama="tarih"),2==n.dateType&&(n.pSiralama="ebitis"),t.post("policeler/getlist",n,function(t){angular.forEach(t,function(e){e.GrupAdi=T.remove(e.GrupAdi),e.anabrans=T.remove(e.anabrans),e.anabransadi=T.remove(e.anabransadi),e.arabrans=T.remove(e.arabrans),e.arabransaciklama=T.remove(e.arabransaciklama),e.ebaslama=T.remove(e.ebaslama),e.ebitis=T.remove(e.ebitis),e.gtemsilciad=T.remove(e.gtemsilciad),e.gtemsilcikodu=T.remove(e.gtemsilcikodu),e.heskod=T.remove(e.heskod),e.id=T.remove(e.id),e.ksirket2=T.remove(e.ksirket2),e.nsirket=T.remove(e.nsirket),e.plaka=T.remove(e.plaka),e.policeno=T.remove(e.policeno),e.pt_skod=T.remove(e.pt_skod),e.pt_sirketad=T.remove(e.pt_sirketad),e.refgrup=T.remove(e.refgrup),e.sasino=T.remove(e.sasino),e.sirketadi=T.remove(e.sirketadi),e.skod=T.remove(e.skod),e.subeadi=T.remove(e.subeadi),e.tarih=T.remove(e.tarih),e.tsirket2=T.remove(e.tsirket2),e.ttbn=T.remove(e.ttbn),e.ttk=T.remove(e.ttk),e.ttkaciklama=T.remove(e.ttkaciklama),e.unvan1=T.remove(e.unvan1),e.vsirket2=T.remove(e.vsirket2),e.yenilemeno=T.remove(e.yenilemeno),e.zeylno=T.remove(e.zeylno),e.tarih=v.wsServiceToInput(e.tarih)}),e.policyList=t})},e.activateDetailView=function(e){if(void 0===e.detailView||null===e.detailView?e.detailView=!0:e.detailView=!e.detailView,0!=e.detailView){var n={pPoliID:e.id};t.get("sales/policy/archive/files",n,function(t){e.policeDosyalar=t})}},e.downloadPolicyFile=function(e){h.downloadConfirm(e.orjinalad,function(){e.isDownloading=!0,y({url:"/api/sales/operations/file?pDosyaID="+e.id,method:"GET",responseType:"arraybuffer"}).then(function(t){e.isDownloading=!1;var n=document.createElement("a");n.setAttribute("href",window.URL.createObjectURL(new Blob([t.data],{type:"application/json"}))),n.setAttribute("download",e.orjinalad);var a=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});try{navigator.userAgent.match("CriOS")?h.error(c.translate("Mobil tarayıcı (iOS/Chrome) PDF dosyalarını doğrudan indiremiyor. Lütfen farklı bir tarayıcı ile tekrar deneyin!")):n.dispatchEvent(a)}catch(e){n.dispatchEvent(a)}})})};var A=function(e,t){var n=new FormData;n.append("file",t),n.append("pYerID",e.id),n.append("pTip",0),n.append("pDokumanTuru",1),e.isFileUploading=!0;var a=new XMLHttpRequest;a.open("POST","/api/sales/operations/uploadFile",!0),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var t=JSON.parse(a.responseText);i.$apply(function(){e.policeDosyalar=t,e.isFileUploading=!1})}else h.error(c.translate("ALERT_ERROR")),i.$apply(function(){e.isFileUploading=!1})},a.upload.addEventListener("progress",function(t){if(t.lengthComputable){var n=parseInt(t.loaded/t.total*100);i.$apply(function(){e.fileUploadPercent=n})}},!0),a.send(n)};e.onDropFile=function(e,t){angular.forEach(t,function(t){A(e,t)})},e.openUploadBox=function(e){var t=document.createElement("input");t.type="file",angular.element(t).bind("change",function(){i.$apply(function(){e.isFileUploading=!0,e.fileUploadPercent=0}),angular.forEach(angular.element(t)[0].files,function(t){A(e,t)})}),angular.element(t).click()},e.setSearchQuery=function(t){e.search.searchQuery=t,e.search.search=t},e.removeSearchQuery=function(){e.search={searchQuery:"",search:""}},e.setSearchQueryAsValue=function(t){e.search.searchQuery=t,e.search.search=t},e.onClickPolicyRequestPreferences=function(n){var a={pPoliID:n.id,pTip:n.tip};t.get("sales/operations/detail",a,function(t){t.teklif.sirketler.length>0&&angular.forEach(t.teklif.sirketler,function(e){e.skod=T.remove(e.skod),e.policeno=T.remove(e.policeno),e.abs_aciklama=T.remove(e.abs_aciklama),e.sirketadi=T.remove(e.sirketadi),e.aciklama=T.remove(e.aciklama),e.panatalikom=T.remove(e.panatalikom),e.pkom=T.remove(e.pkom),e.policelestir=T.remove(e.policelestir),e.prod=T.remove(e.prod),e.ptalikom=T.remove(e.ptalikom),e.ptutar=T.remove(e.ptutar),e.tanatalikom=T.remove(e.tanatalikom),e.teklifno=T.remove(e.teklifno),e.teklifno_psn=T.remove(e.teklifno_psn),e.tkom=T.remove(e.tkom),e.tsk=T.remove(e.tsk),e.ttalikom=T.remove(e.ttalikom),e.ttutar=T.remove(e.ttutar),e.tvneden=T.remove(e.tvneden),e.tvnedenid=T.remove(e.tvnedenid)}),t.teklif.teklifler.length>0&&angular.forEach(t.teklif.teklifler,function(e){e.policetalebi=T.remove(e.policetalebi),e.saat=T.remove(e.saat),e.tarih=T.remove(e.tarih),e.teklifislemtipi=T.remove(e.teklifislemtipi)}),t.dosyalar.length>0&&angular.forEach(t.dosyalar,function(e){e.skod=T.remove(e.skod),e.aciklama=T.remove(e.aciklama),e.orjinalad=T.remove(e.orjinalad),e.sistemad=T.remove(e.sistemad)}),t.forms.length>0&&angular.forEach(t.forms,function(e){e.createEmployeeCode=T.remove(e.createEmployeeCode),e.updateEmployeeCode=T.remove(e.updateEmployeeCode),e.databaseCode=T.remove(e.databaseCode),e.skod=T.remove(e.skod),e.product=T.remove(e.product)}),null!==t.satir&&""!==t.satir&&(t.satir.gtemsilciad=T.remove(t.satir.gtemsilciad),t.satir.gtemsilcikodu=T.remove(t.satir.gtemsilcikodu),t.satir.heskod=T.remove(t.satir.heskod),t.satir.motorno=T.remove(t.satir.motorno),t.satir.policeno=T.remove(t.satir.policeno),t.satir.skod=T.remove(t.satir.skod),t.satir.pt_skod=T.remove(t.satir.pt_skod),t.satir.sasino=T.remove(t.satir.sasino),t.satir.unvan1=T.remove(t.satir.unvan1),t.satir.ttbn=T.remove(t.satir.ttbn),t.satir.yenilemeno=T.remove(t.satir.yenilemeno),t.satir.zeylno=T.remove(t.satir.zeylno),t.satir.anabrans=T.remove(t.satir.anabrans),t.satir.anabransadi=T.remove(t.satir.anabransadi),t.satir.arabransaciklama=T.remove(t.satir.arabransaciklama),t.satir.bitisgun=T.remove(t.satir.bitisgun),t.satir.ebaslama=T.remove(t.satir.ebaslama),t.satir.ebitis=T.remove(t.satir.ebitis),t.satir.kayittarihi=T.remove(t.satir.kayittarihi),t.satir.ksirket2=T.remove(t.satir.ksirket2),t.satir.nsirket=T.remove(t.satir.nsirket),t.satir.pt_sirketad=T.remove(t.satir.pt_sirketad),t.satir.refgrup=T.remove(t.satir.refgrup),t.satir.sirketadi=T.remove(t.satir.sirketadi),t.satir.sisaat=T.remove(t.satir.sisaat),t.satir.sitarih=T.remove(t.satir.sitarih),t.satir.subeadi=T.remove(t.satir.subeadi),t.satir.tali=T.remove(t.satir.tali),t.satir.tesciltarihi=T.remove(t.satir.tesciltarihi),t.satir.tsirket2=T.remove(t.satir.tsirket2),t.satir.ttkaciklama=T.remove(t.satir.ttkaciklama),t.satir.vsirket2=T.remove(t.satir.vsirket2)),t||(window.location.href="/"),n.detail=t,angular.forEach(t.teklif.sirketler,function(e){e.image=e.skod.replace(/ /g,"_"),e.floatPtutar=parseFloat(e.ptutar)}),null!==n.detail.teklif.selectedCompany&&(e.policyRequestIsShow=!0,e.detailButtonIsShow=!0),n.detail.documentPath=null,null===n.detail.teklif.selectedCompany&&n.detail.teklif.sirketler.length>0&&(n.detail.teklif.selectedCompany=n.detail.teklif.sirketler[0].skod),angular.forEach(n.detail.teklif.sirketler,function(e){e.isReady=!1,parseFloat(e.ptutar,10)>0||parseFloat(e.ttutar,10)>0?(e.isReady=!0,e.status="QUOT_GIVEN"):e.status="QUOT_PREPARING",e.floatPtutar=parseFloat(e.ptutar)}),angular.forEach(n.detail.teklif.sirketler,function(e){"0"!==e.tvnedenid&&(e.status="QUOT_NOT_GIVEN"),"0"!==e.tvnedenid&&-1===e.aciklama.indexOf("(Bilgi)")&&(e.status="QUOT_ERROR")}),null===n.detail.teklif.subTab&&(n.detail.teklif.subTab="cover"),n.detail.teklif.selected=null,n.detail.teklif.isListOpen=!1,n.detail.teklif.teklifler.length>0&&(n.detail.teklif.teklifler.sort(function(e,t){return parseInt(t.id)-parseInt(e.id)}),n.detail.teklif.teklifler[0].isActive=!0,n.detail.teklif.teklifler[0].isSelfActive=!0,n.detail.teklif.selected=n.detail.teklif.teklifler[0]),n.detail.tia=I.build(null,n.detail.sigortaIcerikleri);var a=[];angular.forEach(n.detail.teklif.sirketler,function(e){(parseFloat(e.ptutar)>0||parseFloat(e.ttutar)>0)&&a.push(e)}),n.detail.teklif.sirketler=a;var i=null;angular.forEach(n.detail.teklif.sirketler,function(e){n.pt_skod===e.skod&&(i=e)}),n.pPoliID=n.id,n.pTip=n.tip;e.onClickPreferences(n,i,null)})},e.onClickPolicyRequestDetail=function(n){if(n.isDetailActive)return void(n.isDetailActive=!1);n.isDetailActive=!0;var a={pPoliID:n.id,pTip:n.tip};n.isDetailLoading=!0,t.get("sales/operations/detail",a,function(t){t.teklif.sirketler.length>0&&angular.forEach(t.teklif.sirketler,function(e){e.skod=T.remove(e.skod),e.policeno=T.remove(e.policeno),e.abs_aciklama=T.remove(e.abs_aciklama),e.sirketadi=T.remove(e.sirketadi),e.aciklama=T.remove(e.aciklama),e.panatalikom=T.remove(e.panatalikom),e.pkom=T.remove(e.pkom),e.policelestir=T.remove(e.policelestir),e.prod=T.remove(e.prod),e.ptalikom=T.remove(e.ptalikom),e.ptutar=T.remove(e.ptutar),e.tanatalikom=T.remove(e.tanatalikom),e.teklifno=T.remove(e.teklifno),e.teklifno_psn=T.remove(e.teklifno_psn),e.tkom=T.remove(e.tkom),e.tsk=T.remove(e.tsk),e.ttalikom=T.remove(e.ttalikom),e.ttutar=T.remove(e.ttutar),e.tvneden=T.remove(e.tvneden),e.tvnedenid=T.remove(e.tvnedenid)}),t.teklif.teklifler.length>0&&angular.forEach(t.teklif.teklifler,function(e){e.policetalebi=T.remove(e.policetalebi),e.saat=T.remove(e.saat),e.tarih=T.remove(e.tarih),e.teklifislemtipi=T.remove(e.teklifislemtipi)}),t.dosyalar.length>0&&angular.forEach(t.dosyalar,function(e){e.skod=T.remove(e.skod),e.aciklama=T.remove(e.aciklama),e.orjinalad=T.remove(e.orjinalad),e.sistemad=T.remove(e.sistemad)}),t.forms.length>0&&angular.forEach(t.forms,function(e){e.createEmployeeCode=T.remove(e.createEmployeeCode),e.updateEmployeeCode=T.remove(e.updateEmployeeCode),e.databaseCode=T.remove(e.databaseCode),e.skod=T.remove(e.skod),e.product=T.remove(e.product)}),null!==t.satir&&""!==t.satir&&(t.satir.gtemsilciad=T.remove(t.satir.gtemsilciad),t.satir.gtemsilcikodu=T.remove(t.satir.gtemsilcikodu),t.satir.heskod=T.remove(t.satir.heskod),t.satir.motorno=T.remove(t.satir.motorno),t.satir.policeno=T.remove(t.satir.policeno),t.satir.skod=T.remove(t.satir.skod),t.satir.pt_skod=T.remove(t.satir.pt_skod),t.satir.sasino=T.remove(t.satir.sasino),t.satir.unvan1=T.remove(t.satir.unvan1),t.satir.ttbn=T.remove(t.satir.ttbn),t.satir.yenilemeno=T.remove(t.satir.yenilemeno),t.satir.zeylno=T.remove(t.satir.zeylno),t.satir.anabrans=T.remove(t.satir.anabrans),t.satir.anabransadi=T.remove(t.satir.anabransadi),t.satir.arabransaciklama=T.remove(t.satir.arabransaciklama),t.satir.bitisgun=T.remove(t.satir.bitisgun),t.satir.ebaslama=T.remove(t.satir.ebaslama),t.satir.ebitis=T.remove(t.satir.ebitis),t.satir.kayittarihi=T.remove(t.satir.kayittarihi),t.satir.ksirket2=T.remove(t.satir.ksirket2),t.satir.nsirket=T.remove(t.satir.nsirket),t.satir.pt_sirketad=T.remove(t.satir.pt_sirketad),t.satir.refgrup=T.remove(t.satir.refgrup),t.satir.sirketadi=T.remove(t.satir.sirketadi),t.satir.sisaat=T.remove(t.satir.sisaat),t.satir.sitarih=T.remove(t.satir.sitarih),t.satir.subeadi=T.remove(t.satir.subeadi),t.satir.tali=T.remove(t.satir.tali),t.satir.tesciltarihi=T.remove(t.satir.tesciltarihi),t.satir.tsirket2=T.remove(t.satir.tsirket2),t.satir.ttkaciklama=T.remove(t.satir.ttkaciklama),t.satir.vsirket2=T.remove(t.satir.vsirket2)),t||(window.location.href="/"),n.detail=t,angular.forEach(t.teklif.sirketler,function(e){e.image=e.skod.replace(/ /g,"_"),e.floatPtutar=parseFloat(e.ptutar)}),null!==n.detail.teklif.selectedCompany&&(e.policyRequestIsShow=!0,e.detailButtonIsShow=!0),n.detail.documentPath=null,null===n.detail.teklif.selectedCompany&&n.detail.teklif.sirketler.length>0&&(n.detail.teklif.selectedCompany=n.detail.teklif.sirketler[0].skod),angular.forEach(n.detail.teklif.sirketler,function(e){e.isReady=!1,parseFloat(e.ptutar,10)>0||parseFloat(e.ttutar,10)>0?(e.isReady=!0,e.status="QUOT_GIVEN"):e.status="QUOT_PREPARING",e.floatPtutar=parseFloat(e.ptutar)}),angular.forEach(n.detail.teklif.sirketler,function(e){"0"!==e.tvnedenid&&(e.status="QUOT_NOT_GIVEN"),"0"!==e.tvnedenid&&-1===e.aciklama.indexOf("(Bilgi)")&&(e.status="QUOT_ERROR")}),null===n.detail.teklif.subTab&&(n.detail.teklif.subTab="cover"),n.detail.teklif.selected=null,n.detail.teklif.isListOpen=!1,n.detail.teklif.teklifler.length>0&&(n.detail.teklif.teklifler.sort(function(e,t){return parseInt(t.id)-parseInt(e.id)}),n.detail.teklif.teklifler[0].isActive=!0,n.detail.teklif.teklifler[0].isSelfActive=!0,n.detail.teklif.selected=n.detail.teklif.teklifler[0]),n.detail.tia=I.build(null,n.detail.sigortaIcerikleri);var a=[];angular.forEach(n.detail.teklif.sirketler,function(e){(parseFloat(e.ptutar)>0||parseFloat(e.ttutar)>0)&&a.push(e)}),n.detail.teklif.sirketler=a;var i=null;angular.forEach(n.detail.teklif.sirketler,function(e){n.pt_skod===e.skod&&(i=e)}),n.pPoliID=n.id,n.pTip=n.tip,n.detail.dosyaCollection=[],angular.forEach(n.detail.dosyalar,function(e){e.skod===i.skod&&n.detail.dosyaCollection.push(e)}),"20"==n.distalep2&&0==n.detail.dosyaCollection.length&&angular.forEach(n.detail.dosyalar,function(e){n.detail.dosyaCollection.push(e)}),angular.forEach(e.menus,function(e){if(e.product===t.satir.arabrans)try{n.detail.isHideInstallation=e.isHideInstallation}catch(e){}if("0"==t.satir.tip&&e.product!==t.satir.arabrans){var a=parseInt(e.main_product)-1;if(t.satir.anabrans==a)try{n.detail.isHideInstallation=e.isHideInstallation}catch(e){}}}),n.isDetailLoading=!1},function(){n.isDetailLoading=!1},null,null,!0)},e.getComparisonDetail=function(n){var a=null;angular.forEach(n.detail.teklif.sirketler,function(e){n.pt_skod===e.skod&&(a=e)});var i={pAnaBrans:n.detail.satir.anabrans,pAraBrans:n.detail.satir.arabrans,pPoliID:n.pPoliID,pTip:n.pTip,pTeklifID:n.pt_teklifid,pSirketler:[a.skod]};n.isComparisonLoading=!0,t.post("sales/operations/comparison",i,function(t){null!==t.sirketler&&""!==t.sirketler&&angular.forEach(t.sirketler,function(e){e.skod=T.remove(e.skod),e.abs_aciklama=T.remove(e.abs_aciklama),e.aciklama=T.remove(e.aciklama),e.id=T.remove(e.id),e.panatalikom=T.remove(e.panatalikom),e.pkom=T.remove(e.pkom),e.policeno=T.remove(e.policeno),e.sirketadi=T.remove(e.sirketadi),e.tanatalikom=T.remove(e.tanatalikom),e.ptalikom=T.remove(e.ptalikom),e.teklifno=T.remove(e.teklifno),e.teklifno_psn=T.remove(e.teklifno_psn),e.ttutar=T.remove(e.ttutar),e.ttalikom=T.remove(e.ttalikom),e.kullanici=T.remove(e.kullanici),e.ptutar=T.remove(e.ptutar),e.tkom=T.remove(e.tkom),e.tsk=T.remove(e.tsk),e.tvneden=T.remove(e.tvneden)}),null!==t.tablo.TeminatTablo&&""!==t.tablo.TeminatTablo&&angular.forEach(t.tablo.TeminatTablo,function(e){e.Aciklama=T.remove(e.Aciklama),e.Deger=T.remove(e.Deger),e.Grup_Adi=T.remove(e.Grup_Adi),e.SirketAdi=T.remove(e.SirketAdi),e.SirketKodu=T.remove(e.SirketKodu),e.TIA_Aciklama=T.remove(e.TIA_Aciklama),e.TIA_Adi=T.remove(e.TIA_Adi),e.WQV=T.remove(e.WQV)}),null!==t.tablo.IndirimTablo&&""!==t.tablo.IndirimTablo&&angular.forEach(t.tablo.IndirimTablo,function(e){e.Aciklama=T.remove(e.Aciklama),e.Deger=T.remove(e.Deger),e.Grup_Adi=T.remove(e.Grup_Adi),e.SirketAdi=T.remove(e.SirketAdi),e.SirketKodu=T.remove(e.SirketKodu),e.TIA_Aciklama=T.remove(e.TIA_Aciklama),e.TIA_Adi=T.remove(e.TIA_Adi),e.WQV=T.remove(e.WQV)}),null!==t.tablo.AciklamaTablo&&""!==t.tablo.AciklamaTablo&&angular.forEach(t.tablo.AciklamaTablo,function(e){e.Aciklama=T.remove(e.Aciklama),e.Deger=T.remove(e.Deger),e.Grup_Adi=T.remove(e.Grup_Adi),e.SirketAdi=T.remove(e.SirketAdi),e.SirketKodu=T.remove(e.SirketKodu),e.TIA_Aciklama=T.remove(e.TIA_Aciklama),e.TIA_Adi=T.remove(e.TIA_Adi),e.WQV=T.remove(e.WQV)}),n.table={length:{column:0},columns:{},groups:{TeminatTablo:[],IndirimTablo:[],AciklamaTablo:[]}};var a=t;e.min1Teklif=!1,angular.forEach(a.sirketler,function(e){e.floatPtutar=parseFloat(e.ptutar)}),a.sirketler=S("orderBy")(a.sirketler,n.selectedOption),angular.forEach(a.sirketler,function(t){(parseFloat(t.ptutar)>0||parseFloat(t.ttutar)>0)&&(n.table.length.column++,t.ptutar=t.ptutar,t.ttutar=t.ttutar,n.table.columns[t.skod]=t),t.completed=!1,(t.aciklama.toString().length>0||parseFloat(t.tvnedenid)>0||parseFloat(t.ptutar)>0||parseFloat(t.ttutar)>0)&&(t.completed=!0),(parseFloat(t.ptutar)>0||parseFloat(t.ttutar)>0)&&(e.min1Teklif=!0),!1===t.completed&&(e.completedAll=!1)}),e.setGroups(a.tablo.TeminatTablo,"TeminatTablo",n),e.setGroups(a.tablo.IndirimTablo,"IndirimTablo",n),e.setGroups(a.tablo.AciklamaTablo,"AciklamaTablo",n),n.isComparisonLoading=!1},function(){n.isComparisonLoading=!1},null,null,!0)},e.closeItemDetail=function(e){e.isDetailActive=!1},e.getOrCreateSection=function(e,t,n){var a=!1;return angular.forEach(n.table.groups[e],function(e){e.Grup_Id===t.Grup_Id&&(a=e)}),!1===a&&(a={Grup_Id:t.Grup_Id,Grup_Adi:t.Grup_Adi,WQV:t.WQV,elements:[]},0===a.Grup_Adi.length&&(a.Grup_Adi="GENEL"),n.table.groups[e].push(a)),a},e.getOrCreateElement=function(e,t){var n=!1;return angular.forEach(e.elements,function(e){e.TIA_Id===t.TIA_Id&&(n=e)}),!1===n&&(n={TIA_Id:t.TIA_Id,TIA_Adi:t.TIA_Adi,WQV:t.WQV,values:{}},e.elements.push(n)),n},e.setGroups=function(t,n,a){angular.forEach(t,function(t){if(void 0!==a.table.columns[t.SirketKodu]){var i=e.getOrCreateSection(n,t,a);e.getOrCreateElement(i,t,a).values[t.SirketKodu]={SirketAdi:t.SirketAdi,TIA_Tip:t.TIA_Tip,Deger:t.Deger,Aciklama:t.Aciklama,Tip:t.Tip,TIA_Aciklama:t.TIA_Aciklama,WQV:t.WQV}}})},e.downloadFile=function(n){y({url:"/api/sales/operations/file?pDosyaID="+n.id,method:"GET",responseType:"arraybuffer"}).then(function(a){var i=document.createElement("a");i.setAttribute("href",window.URL.createObjectURL(new Blob([a.data],{type:"application/octet-stream"}))),i.setAttribute("download",n.orjinalad);var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});i.dispatchEvent(o);var r={pPoliID:e.data.data.pPoliID,skod:e.sirket.skod};t.post("q/d/d/wlg",r,function(){},null,null,null,!0)})},e.cancelPolicyRequest=function(n){h.areYouSureWithMessage(c.translate("Poliçe Talebini iptal etmek istediğiniz emin misiniz?"),function(){var a={pPoliID:n.id,pTip:n.tip};t.get("sales/operations/detail",a,function(a){a.teklif.sirketler.length>0&&angular.forEach(a.teklif.sirketler,function(e){e.skod=T.remove(e.skod),e.policeno=T.remove(e.policeno),e.abs_aciklama=T.remove(e.abs_aciklama),e.sirketadi=T.remove(e.sirketadi),e.aciklama=T.remove(e.aciklama),e.panatalikom=T.remove(e.panatalikom),e.pkom=T.remove(e.pkom),e.policelestir=T.remove(e.policelestir),e.prod=T.remove(e.prod),e.ptalikom=T.remove(e.ptalikom),e.ptutar=T.remove(e.ptutar),e.tanatalikom=T.remove(e.tanatalikom),e.teklifno=T.remove(e.teklifno),e.teklifno_psn=T.remove(e.teklifno_psn),e.tkom=T.remove(e.tkom),e.tsk=T.remove(e.tsk),e.ttalikom=T.remove(e.ttalikom),e.ttutar=T.remove(e.ttutar),e.tvneden=T.remove(e.tvneden),e.tvnedenid=T.remove(e.tvnedenid)}),a.teklif.teklifler.length>0&&angular.forEach(a.teklif.teklifler,function(e){e.policetalebi=T.remove(e.policetalebi),e.saat=T.remove(e.saat),e.tarih=T.remove(e.tarih),e.teklifislemtipi=T.remove(e.teklifislemtipi)}),a.dosyalar.length>0&&angular.forEach(a.dosyalar,function(e){e.skod=T.remove(e.skod),e.aciklama=T.remove(e.aciklama),e.orjinalad=T.remove(e.orjinalad),e.sistemad=T.remove(e.sistemad)}),a.forms.length>0&&angular.forEach(a.forms,function(e){e.createEmployeeCode=T.remove(e.createEmployeeCode),e.updateEmployeeCode=T.remove(e.updateEmployeeCode),e.databaseCode=T.remove(e.databaseCode),e.skod=T.remove(e.skod),e.product=T.remove(e.product)}),null!==a.satir&&""!==a.satir&&(a.satir.gtemsilciad=T.remove(a.satir.gtemsilciad),a.satir.gtemsilcikodu=T.remove(a.satir.gtemsilcikodu),a.satir.heskod=T.remove(a.satir.heskod),a.satir.motorno=T.remove(a.satir.motorno),a.satir.policeno=T.remove(a.satir.policeno),a.satir.skod=T.remove(a.satir.skod),a.satir.pt_skod=T.remove(a.satir.pt_skod),a.satir.sasino=T.remove(a.satir.sasino),a.satir.unvan1=T.remove(a.satir.unvan1),a.satir.ttbn=T.remove(a.satir.ttbn),a.satir.yenilemeno=T.remove(a.satir.yenilemeno),a.satir.zeylno=T.remove(a.satir.zeylno),a.satir.anabrans=T.remove(a.satir.anabrans),a.satir.anabransadi=T.remove(a.satir.anabransadi),a.satir.arabransaciklama=T.remove(a.satir.arabransaciklama),a.satir.bitisgun=T.remove(a.satir.bitisgun),a.satir.ebaslama=T.remove(a.satir.ebaslama),a.satir.ebitis=T.remove(a.satir.ebitis),a.satir.kayittarihi=T.remove(a.satir.kayittarihi),a.satir.ksirket2=T.remove(a.satir.ksirket2),a.satir.nsirket=T.remove(a.satir.nsirket),a.satir.pt_sirketad=T.remove(a.satir.pt_sirketad),a.satir.refgrup=T.remove(a.satir.refgrup),a.satir.sirketadi=T.remove(a.satir.sirketadi),a.satir.sisaat=T.remove(a.satir.sisaat),a.satir.sitarih=T.remove(a.satir.sitarih),a.satir.subeadi=T.remove(a.satir.subeadi),a.satir.tali=T.remove(a.satir.tali),a.satir.tesciltarihi=T.remove(a.satir.tesciltarihi),a.satir.tsirket2=T.remove(a.satir.tsirket2),a.satir.ttkaciklama=T.remove(a.satir.ttkaciklama),a.satir.vsirket2=T.remove(a.satir.vsirket2)),a||(window.location.href="/"),n.detail=a,angular.forEach(a.teklif.sirketler,function(e){e.image=e.skod.replace(/ /g,"_"),e.floatPtutar=parseFloat(e.ptutar)}),null===n.detail.teklif.selectedCompany&&n.detail.teklif.sirketler.length>0&&(n.detail.teklif.selectedCompany=n.detail.teklif.sirketler[0].skod),angular.forEach(n.detail.teklif.sirketler,function(e){e.floatPtutar=parseFloat(e.ptutar)}),n.detail.teklif.selected=null,n.detail.teklif.isListOpen=!1,n.detail.teklif.teklifler.length>0&&(n.detail.teklif.teklifler.sort(function(e,t){return parseInt(t.id)-parseInt(e.id)}),n.detail.teklif.teklifler[0].isActive=!0,n.detail.teklif.teklifler[0].isSelfActive=!0,n.detail.teklif.selected=n.detail.teklif.teklifler[0]);var i=[];angular.forEach(n.detail.teklif.sirketler,function(e){(parseFloat(e.ptutar)>0||parseFloat(e.ttutar)>0)&&i.push(e)}),n.detail.teklif.sirketler=i;var o={pPoliceID:n.id,pPoliceTipi:n.tip,pTeklifID:-1};angular.forEach(n.detail.teklif.teklifler,function(e){1===parseInt(e.policetalebi)&&(o.pTeklifID=e.id)}),t.post("sales/operations/cancel/policy",o,function(){if(null!==e.portalPanelSettings.cancelRequestOperationList&&""!==e.portalPanelSettings.cancelRequestOperationList&&void 0!==e.portalPanelSettings.cancelRequestOperationList){var a=[],i=[];a.push(1),i.push(n.id);var o={pAciklama:null,pIslemTipi:parseInt(e.portalPanelSettings.cancelRequestOperationList),pNotlar:null,pTipDizi:a,pPoliceDizi:i,_totalRecordCount:1,isSingleRequest:!0};t.post("quotation/transactionList",o,function(){h.success(c.translate("Poliçe Talebi iptal edildi..!")),e.activateView("teklifler",e.listQuotations()),e.onChangeTabOptions("quotations")},function(){h.success(c.translate("Poliçe Talebi iptal edildi..!")),e.activateView("teklifler",e.listQuotations()),e.onChangeTabOptions("quotations")})}else h.success(c.translate("Poliçe Talebi iptal edildi..!")),e.activateView("teklifler",e.listQuotations()),e.onChangeTabOptions("quotations")})})})},e.getBannerNavigationTop=function(e){return e?e/2+"px":"175px"},window.onblur=function(){e.prevTitle=document.title,null!==e.portalPanelSettings.dinamicSiteTitle&&""!==e.portalPanelSettings.dinamicSiteTitle&&void 0!==e.portalPanelSettings.dinamicSiteTitle&&(document.title=e.portalPanelSettings.dinamicSiteTitle)},window.onfocus=function(){null!==e.prevTitle&&void 0!==e.prevTitle&&""!==e.prevTitle&&(document.title=e.prevTitle)},e.$watch("restConnector.current",function(t){0===t&&e.welcomeInit.isSuccessData&&l(function(){window.prerenderReady=!0},300)}),i.$on("@SetupTawkForCustomEndpoint",function(t,n){"PRODUCT"===e.tawk.tawkWidgetOption&&e._setupTawk(n)}),i.$on("@OnUpdateCount",function(n,a){var i={HesapKodu:a,pGrupGetir:e.quotationCriterias.groupAccount,endDatePreviousDay:e.quotationCriterias.endDatePreviousDay,endDateNextDay:e.quotationCriterias.endDateNextDay};t.post("sales/operations/counts",i,function(t){e.counts={TeklifAdet:parseInt(t.return.TeklifAdet),PoliceAdet:parseInt(t.return.PoliceAdet),PoliceTalebiAdet:parseInt(t.return.PoliceTalebiAdet),PoliceDuzenlendiAdet:parseInt(t.return.PoliceDuzenlendiAdet),PoliceTalepToplamAdet:parseInt(t.return.PoliceTalebiAdet)+parseInt(t.return.PoliceDuzenlendiAdet)}},null,null,null,!0)}),e.closeCookieConsent=function(){g.set("cookie_permission",!0)},e.openDataPolicyModal=function(){a.open("/content/views/data-policy-modal.html","DataPolicyModalController",function(t){t.data={data:e.dynamicContent,onSuccess:function(){e.closeCookieConsent()}}})},e.openPrivacyPolicyModal=function(){a.open("/content/views/privacy-policy-modal.html","PrivacyPolicyModalController",function(t){t.data={data:e.dynamicContent,onSuccess:function(){e.closeCookieConsent()}}})},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){
angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=S("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.onInitPortalBox=function(){e.boxesInit=C.onCreate(-2),i.$on("$boxesInit.onSuccess",function(){e.boxesData=C.getBoxes(-2),e.getCategories(e.boxesData),e.portalPanelSettings.isViewAnnouncePanel&&e.openAnnounceModal()})},e.redirectHrefUrl=function(e){window.location.href=e},e.redirectToUrl=function(e){null!==e.url&&void 0!==e.url&&""!==e.url&&D.open(e.url)},e.letsScrollToTop=function(){window.scrollTo({top:0,behavior:"smooth"})},e.prepareCounter=function(){e.counterForm={musteriVkn:e.insuredData.HesKod,musteriUnvan:e.insuredData.Unvan},e.isTransportCounterReady=!1,e.transportCounterURL=null},e.callCounterApi=function(){var n={musteriVkn:e.counterForm.musteriVkn,musteriUnvan:e.counterForm.musteriUnvan};t.post("counter/transport",n,function(t){null!==t&&void 0!==t&&""!==t&&(e.isTransportCounterReady=!0,e.transportCounterURL=u.trustAsResourceUrl(t))},function(){e.isTransportCounterReady=!1,e.transportCounterURL=null,h.error(c.translate("Bilgiler doğrulanamadı..! Lütfen daha sonra tekrar deneyin."))})},e.initExcelUpload=function(){try{$("#input-excel").on("change",function(t){e.sheetData=null;var n=new FileReader;n.readAsArrayBuffer(t.target.files[0]),n.onload=function(t){var a=new Uint8Array(n.result),i=XLSX.read(a,{type:"array"}),o={};i.SheetNames.forEach(function(e){o[e]=XLSX.utils.sheet_to_json(i.Sheets[e])}),e.sheetData=o.Nakliyat,angular.forEach(e.sheetData,function(t){angular.forEach(e.excelParameters.teminatList,function(e){"Araç başı Limit"===e.Adi&&(angular.forEach(e.ListItems,function(e){if(!e.Ad.includes("Hediye")){var t=e.Ad.split("TL");try{e.deger=t[0].replace(/\./g,""),e.tutar=t[1].replace("(","")}catch(e){}}}),angular.forEach(e.ListItems,function(e){parseFloat(t.Limit)===parseFloat(e.deger)&&(t.Tutar=e.tutar,t.Durum=c.translate("Beklemede"),t.isValid=!0)}))})}),angular.forEach(e.sheetData,function(t){try{t.SeferBaslangicYer=t.SeferBaslangicYer.trim(),t.SeferBitisYer=t.SeferBitisYer.trim(),t.SeferBaslangicTarih=t.SeferBaslangicTarih.trim(),t.SigortaliAdi=t.SigortaliAdi.trim(),t.SigortaliGSM=t.SigortaliGSM.trim(),t.SigortaliGSM=t.SigortaliGSM.replace(/\s/g,"")}catch(e){}t.Teminatlar=[],angular.forEach(e.excelParameters.teminatList,function(e){e.ListItem=0,"Sefer Başlama Tarihi"===e.Adi&&(e.Aciklama=t.SeferBaslangicTarih),"Nakliyat-Plaka"===e.Adi&&(e.Aciklama=t.Plaka),"Nakliyat-Sefer Başlama Yeri"===e.Adi&&angular.forEach(e.ListItems,function(n){n.Ad.toLocaleUpperCase("tr-TR")==t.SeferBaslangicYer&&(e.ListItem=parseInt(n.ID))}),"Nakliyat-Sefer Bitiş Yeri"===e.Adi&&angular.forEach(e.ListItems,function(n){n.Ad.toLocaleUpperCase("tr-TR")==t.SeferBitisYer&&(e.ListItem=parseInt(n.ID))}),"Araç başı Limit"===e.Adi&&angular.forEach(e.ListItems,function(n){if(!n.Ad.includes("Hediye")){n.Ad.split("TL")[0].replace(/\./g,"")==t.Limit&&(e.ListItem=parseInt(n.ID))}}),e.TeminatID=e.Id,t.Teminatlar.push(e)})});var r=0;angular.forEach(e.sheetData,function(e){if(null!==e.Tutar&&void 0!==e.Tutar&&""!==e.Tutar){var t=e.Tutar.split(".");t[0]=t[0].replace(/\s/g,""),r+=parseInt(t[0])}}),e.excelParameters.TotalCount=r}});var n={musteriVkn:e.insuredData.HesKod};t.post("counter/balance",n,function(t){if(null!==t&&void 0!==t&&""!==t&&t.length>0){var n=t[0].kalanBakiye.split(".");n[0]=n[0].replace(/\s/g,""),e.excelParameters.CustomerBalance=parseInt(n[0])}else e.excelParameters.CustomerBalance=0},function(){e.excelParameters.CustomerBalance=0})}catch(e){h.error(c.translate("Dosya yüklenirken bir hata oluştu..!"))}},e.onChangeTransportProduct=function(n){e.excelParameters.teminatList=[];var a={pAnaBrans:8,pAraBrans:e.excelParameters.productSelection,pTarifeKodu:0};t.get("quotation/tia",a,function(t){e.excelParameters.teminatList=t.Teminat," function"==typeof n&&n()})},e.selectAllExcel=function(){angular.forEach(e.sheetData,function(t){t.isValid&&(t.isSelected=e.excelParameters.isAllSelected)})},e.excelAskProduction=function(){h.warningConfirmation(c.translate("Seçilen kayıtlar için üretim başlatılacak. İşlemi onaylıyor musunuz?"),function(){e.forceKeepGoing=!0,angular.forEach(e.sheetData,function(e){e.isProcessing=!1,e.isFailed=!1}),e.excelStartProduction()})},e.checkIfProductionStarted=function(){var t=!1;return angular.forEach(e.sheetData,function(e){e.isProcessing&&(t=!0)}),t},e.stopExcelProduction=function(){h.warningConfirmation(c.translate("Hazırlanma aşamasında olan işlem hariç diğer tüm işlemler durdurulacak. Onaylıyor musunuz?"),function(){e.forceKeepGoing=!1,angular.forEach(e.sheetData,function(e){e.isProcessing=!1})})},e.excelStartProduction=function(){e.excelParameters.isProductionStarted=!0,e.excelParameters.isProductionFailed=!1,e.keepGoing=!0,angular.forEach(e.sheetData,function(n){if(n.isValid&&n.isSelected&&1!=n.isCompleted&&1!=n.isFailed&&e.keepGoing&&e.forceKeepGoing){e.keepGoing=!1,n.Durum=c.translate("Hazırlanıyor..."),n.isProcessing=!0;var a=[];a.push({TCKN:n.SigortaliTC,Ad:n.SigortaliAdi,GSM:n.SigortaliGSM});var i={AnaBrans:8,AraBrans:e.excelParameters.productSelection,HesapKodu:e.insuredData.HesKod,pTeminatlar:n.Teminatlar,pSigortalilar:a,pReferansPersonelKodu:null},o=g.get("Ref");null!==o&&""!==o&&void 0!==o&&void 0!==o.kod&&null!==o.kod&&""!==o.kod&&(i.pReferansPersonelKodu=o.kod),t.post("quotation/quick",i,function(a){if(!a){n.Durum=c.translate("Hata Oluştu."),n.isCompleted=!1,n.isFailed=!0,n.isProcessing=!1,e.keepGoing=!0;var i={musteriVkn:e.insuredData.HesKod};return void t.post("counter/balance",i,function(t){if(null!==t&&void 0!==t&&""!==t&&t.length>0){var n=t[0].kalanBakiye.split(".");n[0]=n[0].replace(/\s/g,""),e.excelParameters.CustomerBalance=parseInt(n[0]),e.excelStartProduction()}else e.excelParameters.CustomerBalance=0},function(){e.excelParameters.CustomerBalance=0},null,null,!0)}n.Durum=c.translate("Üretim Başarılı."),n.isCompleted=!0,n.isProcessing=!1,n.isFailed=!1;var i={musteriVkn:e.insuredData.HesKod};t.post("counter/balance",i,function(t){if(null!==t&&void 0!==t&&""!==t&&t.length>0){var n=t[0].kalanBakiye.split(".");n[0]=n[0].replace(/\s/g,""),e.excelParameters.CustomerBalance=parseInt(n[0]),e.excelStartProduction()}else e.excelParameters.CustomerBalance=0,e.excelStartProduction()},function(){e.excelParameters.CustomerBalance=0,e.excelStartProduction()},null,null,!0)},function(){n.Durum=c.translate("Hata Oluştu."),n.isCompleted=!1,n.isFailed=!0,n.isProcessing=!1,e.keepGoing=!0;var a={musteriVkn:e.insuredData.HesKod};t.post("counter/balance",a,function(t){if(null!==t&&void 0!==t&&""!==t&&t.length>0){var n=t[0].kalanBakiye.split(".");n[0]=n[0].replace(/\s/g,""),e.excelParameters.CustomerBalance=parseInt(n[0]),e.excelStartProduction()}else e.excelParameters.CustomerBalance=0},function(){e.excelParameters.CustomerBalance=0},null,null,!0)},null,null,!0)}}),e.excelParameters.isProductionStarted=!1},e.clearExcelContent=function(){e.sheetData=[],r.reload()},e.getSelectedTransportAmount=function(){var t=0;return angular.forEach(e.sheetData,function(e){if(e.isSelected&&null!==e.Tutar&&void 0!==e.Tutar&&""!==e.Tutar){var n=e.Tutar.split(".");n[0]=n[0].replace(/\s/g,""),t+=parseInt(n[0])}}),t},e.getDiffTransportAmount=function(){var t=e.getSelectedTransportAmount();return t>0?parseInt(e.excelParameters.CustomerBalance)-parseInt(t):e.excelParameters.CustomerBalance},e.reCalculateQuotation=function(n){var a={pPoliID:n.id,pTip:n.tip};t.post("sales/quotation/recalculate",a,function(t){i.pPoliIDForDetail=n.id,i.pTipForDetail=n.tip;var a={pPoliID:n.id,pTip:n.tip};g.set("Quotation",a),e.activateView("quotationDetail")},function(){g.set("Quotation",a),e.activateView("quotationDetail")})},e.getRefName=function(){var e=null,t=g.get("Ref");return null!==t&&""!==t&&void 0!==t&&void 0!==t.ad&&null!==t.ad&&""!==t.ad&&(e=t.ad),e},e.removeRefUser=function(){g.set("Ref",null),e.onLogoClick()},e.onCreate()}]),app.controller("DataPolicyModalController",["$scope","$uibModalInstance","$sce","$rest",function(e,t,n,a){e.data=t.data,e.onCreate=function(){},e.accept=function(){e.data.onSuccess(),a.post("d/p/a/wlg",{},function(){},null,null,null,!0),e.cancel()},e.cancel=function(){t.dismiss("cancel")},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return n.trustAsHtml(e)},e.onCreate()}]),app.controller("LoginModalController",["$scope","$sce","$uibModalInstance","$http","$rest","$alert","$culture","$formValidations","$welcomeInit","$rootScope","vcRecaptchaService","$handcuff","$dateFormatter",function(e,t,n,a,i,o,r,l,s,u,c,d,m){e._validator=l,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isLoginButtonDisabled=!1,e.flex=null,e.data={languageList:null,langCode:null},e.form={username:null,password:null,HesapKodu:null,Unvan:null,GSM:null,securecode:null,pSessionID:null,FlexPassword:null,DogumTarihi:null},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.signing=!1,e.referenceCode=null,e.welcomeInit=s,e.onCreate=function(){i.get("welcome/login/content",{},function(t){e.loginContent=t.loginContent,e.loginBackgroundColor=t.loginBackgroundColor,e.isVerifyRCPT=t.isVerifyRCPT,null!==t.RCK.PK&&""!==t.RCK.PK&&void 0!==t.RCK.PK&&(t.RCK.PK=d.remove(t.RCK.PK)),e.isVerifyRCPT&&(e.captchaKeys=t.RCK,e.captchaKeys.PK?(e.PK=e.captchaKeys.PK,e.isViewReCaptcha=!0,e.isLoginButtonDisabled=!0):(e.isLoginButtonDisabled=!1,e.isViewReCaptcha=!1)),e.welcomeInit.isSuccessData?e.initData():u.$on("$welcomeInit.onSuccess",function(){e.initData()})})},e.initData=function(){var t=e.welcomeInit;e.data.languageList=t.getLanguageList(),e.data.langCode=t.getLangCode()},e.login=function(){e.signing=!0;var t=angular.copy(e.form);i.post("attempt/login",t,function(t){0===t.ResultCode&&(t.isSmsSend?(e.signing=!1,e.verifying=!1,e.isSmsSend=!0,e.form.pSessionID=t.JSONData,e.referenceCode=t.OtherData,i.post("open/sms",{},function(){},null,null,null,!0)):(e.signing=!1,window.location.href="/panel/")),112233===t.ResultCode&&(e.signing=!1,e.verifying=!1,e.isRegisterRequired=!0,o.warning(r.translate("Üye kaydınız bulunamadı. Üye olmak için ihtiyacınız olan sigortayı seçin ve teklif alın."))),t.ResultCode>0&&112233!==t.ResultCode&&404!==t.ResultCode&&(e.signing=!1,o.warning(r.translate(t.Message))),404==t.ResultCode&&0==t.isGSMValid&&(e.isViewEditGSMForm=!0,11==e.form.HesapKodu.length&&(e.form.Tip="personal"),9!=e.form.HesapKodu.length&&10!=e.form.HesapKodu.length||(e.form.Tip="company")),404==t.ResultCode&&0!==t.isGSMValid&&(e.signing=!1,e.verifying=!1,o.warning(r.translate("Üye olurken belirttiğiniz telefon numarasını girmelisiniz, lütfen tekrar deneyin. Telefon numaranızı değiştirdiyseniz lütfen bizimle iletişime geçin.")))},null,function(t){(t.data.code="USER_ALREADY_BLOCKED")&&(o.warning(r.translate("USER_ALREADY_BLOCKED")),e.signing=!1)},null,null,!0)},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSM,pDogumTarihi:m.dateInputToService(e.form.DogumTarihi)};i.post("login/insured/update",n,function(n){0==n.return.HataKodu?(e.login(),e.isViewEditGSMForm=!1):(e.isViewEditGSMForm=!1,e.signing=!1,e.verifying=!1),"function"==typeof t&&t()},function(){e.isViewEditGSMForm=!0,e.signing=!1,e.verifying=!1})},e.verify=function(){e.verifying=!0;var t=angular.copy(e.form);i.post("check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?window.location.href="/panel/":6==t.ResultCode?o.error(r.translate("ALERT_VERIFY_ERROR")):o.error(r.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.register=function(){e.signing=!0;var t=angular.copy(e.form);i.post("attempt/register",t,function(t){0===t.ResultCode?t.isSmsSend?(e.signing=!1,e.verifying=!1,e.isSmsSend=!0):(e.signing=!1,window.location.href="/panel/"):o.error(r.translate("Hata Oluştu: ")+r.translate(t.Message))})},e.changeLanguage=function(){a.get("/auth/changeLanguage/"+e.data.langCode).then(function(){})},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.submitLogin=function(t,n,a,i,o,r,l,s,u){e.isRegisterRequired?e.isSmsSend?e._validator.validateMultiForms(t,e.verify,n,a,i,o,r,l,s,u):e._validator.validateMultiForms(t,e.register,n,a,i,o,r,l,s,u):e.isSmsSend?e._validator.validateMultiForms(t,e.verify,n,a,i,o,r,l,s,u):e._validator.validateMultiForms(t,e.login,n,a,i,o,r,l,s,u)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return e=e.replace("<img",'<img class="img-responsive"'),t.trustAsHtml(e)},e.cancel=function(){n.dismiss("cancel")},e.cbExpiration=function(){c.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(c.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isLoginButtonDisabled=!1:(e.isLoginButtonDisabled=!0,o.error(r.translate("reCAPTCHA doğrulanamadı..!")),c.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.validateFlexPassword=function(){if(null!==e.form.FlexPassword&&void 0!==e.form.FlexPassword&&""!==e.form.FlexPassword&&e.form.FlexPassword.length>3){var t={password:e.form.FlexPassword};e.isFlexPasswordInProgress=!0,i.post("flex/check",t,function(t){if(e.isFlexPasswordInProgress=!1,!0!==t.Success)return o.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir."),e.form.FlexPassword=null,e.isInsuredInfoRunning=!1,void(e.flex=null);e.flex=t},function(t){e.isFlexPasswordInProgress=!1,e.form.FlexPassword=null,e.flex=null,o.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir.")})}},e.onCreate()}]),app.controller("PagesController",["$scope","$rootScope","$state","$modal","$rest","$http","$filter","$sce","$welcomeInit","$boxesInit","$storage","$location",function(e,t,n,a,i,o,r,l,s,u,c,d){e.isCustomerExists=null,e.isLoggedIn=!1,e.page=null,e.welcomeInit=s,e.isDefaultBannerActive=!0,e.portalPagesKeywords=null,e.portalMenusKeywords=null,e.isShowOnePage=!0,e.bannerImage={isViewDescriptionTitleBanner:null,menuHoverId:0},e.onCreate=function(){e.getPageInfo(function(){e.welcomeInit.isSuccessData?e.welcomeInit.onCreateFilter({portalPageId:e.page.id,viewLocation:"PAGES"},function(){var t=e.welcomeInit;e.banners=t.getBanners(),e.bannerSettings=t.getBannersSettings(),e.setSeoSettings(t.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks(),e.initData()}):t.$on("$welcomeInit.onSuccess",function(){e.welcomeInit.onCreateFilter({portalPageId:e.page.id,viewLocation:"PAGES"},function(){var t=e.welcomeInit;e.banners=t.getBanners(),e.bannerSettings=t.getBannersSettings(),e.setSeoSettings(t.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks(),e.initData()})})})},e.getPageInfo=function(t){""!==n.params.url&&null!==n.params.url||n.go("PageNotFound",{},{reload:!0});var a=d.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};c.set("Ref",t)}});var l={url:n.params.url};i.post("pages/get",l,function(a){if(0==a.PortalPage.id||null==a.PortalPage.url||""==a.PortalPage.url||void 0==a.PortalPage.url)return void n.go("PageNotFound",{},{reload:!0});a.PortalPage.language_code!==a.SelectedLanguage?o.get("/auth/changeLanguage/"+a.PortalPage.language_code).then(function(){c.set("isChangeLanguage",!0),window.location.reload()}):(e.page=a.PortalPage,i.get("pages/pagecategories/"+e.page.id,{},function(n){e.searchPageCategories=n,e.searchPageCategories.length>0&&(e.searchPageCategories=r("orderBy")(e.searchPageCategories,"order"),e.activeKategoriID=e.searchPageCategories[0].id,angular.forEach(e.searchPageCategories,function(t,n){0===n?(t.activeClass="active",e.onChangeActiveKategori(t.id)):t.activeClass=""})),i.get("pages/pagekeywords/"+e.page.id,{},function(t){e.portalPagesKeywords=t,e.portalPagesKeywords.length=t.length}),"function"==typeof t&&t()}))})},e.initData=function(){var t=s;e.menus=t.getMenus();var n=angular.copy(e.menus);e.menus=[],angular.forEach(n,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onInitPortalBox()},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.page.id,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],u=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalPageId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(u,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalPageId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=s.getPanelSettings()?s.getPanelSettings().siteName:"Polisoft Ltd");for(var c=0;c<r.length;c++)"robots"!==r[c].getAttribute("name")||i||(r[c].content="index, follow"),"description"!==r[c].getAttribute("name")||o||(r[c].content=s.getPanelSettings()?s.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=s;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalPageId===e.page.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.reload=function(){n.reload()},e.trustAsHtml=function(e){return l.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return l.trustAsHtml(e)},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.onChangeActiveKategori=function(t){e.activeKategoriID=t,angular.forEach(e.searchPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses.length>0&&(e.portalPageFaqContentResponses=r("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""}))):e.activeClass=""})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onInitPortalBox=function(){e.boxesInit=u.onCreate(-3),t.$on("$boxesInit.onSuccess",function(){e.boxesData=u.getBoxes(-3),e.getCategories(e.boxesData)})},e.onCreate()}]),app.controller("Payment.ModalController",["$scope","$culture","$sce","$uibModalInstance","$modal","$formValidations","$rest","$alert","$timeout","$state","$filter","$interval","$location","$insured","$welcomeInit",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p){e.quotationContent=a.data.quotationContent,e.sirket=a.data.sirket,e.boxesData=a.data.boxesData,e.documents=a.data.documents,e.forms=a.data.forms,e.insuredData=a.data.insuredData,e.current=1,e.isCustomerExists=null,e.menuData={},e.isLoggedIn=!1,e.odemeSekilleriList=[],e.isProdCheckActive=!1,e.isFormProcessing=!1,e.activeMenu=a.data.activeMenu,e.selects={manuelOdemeSekilleriList:[],onlineOdemeSekilleriList:[]},e._validator=o,e.form={status:a.data.isMenuPresentationDesc,TaksitSayisi:1,PoliceTipi:1,Aciklama:null,Banka:null,Cvc:null,KartNo:null,KartSahibi:null,KartTipi:null,SonKulTar:null,GSM:null,ReferansKodu:null,KartSahibiTC:null,sonKulYil:null,sonKulAy:null,OdemeTipi:"1",SalesAgreement:"0",CreditCardAgreement:"0",PaymentSelection:null,InformationText:!1,KartSahibiTC:null},e.pdfDocuments={isInformationTextDocumentExist:!1,isDefaultInformationTextDocumentExist:!1,informationDocument:null,defaultInformationDocument:null},e.data={yearList:[],months:[{kod:null,number:t.translate("Ay"),ad:t.translate("Ay")},{kod:"01",number:"01",ad:t.translate("Ocak")},{kod:"02",number:"02",ad:t.translate("Şubat")},{kod:"03",number:"03",ad:t.translate("Mart")},{kod:"04",number:"04",ad:t.translate("Nisan")},{kod:"05",number:"05",ad:t.translate("Mayıs")},{kod:"06",number:"06",ad:t.translate("Haziran")},{kod:"07",number:"07",ad:t.translate("Temmuz")},{kod:"08",number:"08",ad:t.translate("Ağustos")},{kod:"09",number:"09",ad:t.translate("Eylül")},{kod:"10",number:"10",ad:t.translate("Ekim")},{kod:"11",number:"11",ad:t.translate("Kasım")},{kod:"12",number:"12",ad:t.translate("Aralık")}]},e.getValidYears=function(){for(var e=[],t=moment().year(),n=0;n<11;n++)e.push({kod:t.toString(),ad:t}),t++;return e},e.getBoxTrustedHtml=function(e){return n.trustAsHtml(e)},e.onCreate=function(){e.dynamicContent=p.getDynamicContent(),e.websiteSettings=p.getWebsiteSettings(),null!==e.activeMenu.isHideInstallation&&void 0!==e.activeMenu.isHideInstallation&&!0===e.activeMenu.isHideInstallation&&e.setOdemeTipi(0),0==e.sirket.ttutar&&e.setOdemeTipi(0),e.getCategories(e.boxesData),e.data.yearList=e.getValidYears(),e.data.yearList.unshift({kod:null,ad:t.translate("Yıl")}),angular.forEach(e.sirket.tablo.OdemeTipleri.odeme_tipleri,function(t){t.skod==e.sirket.skod&&(t.sira=parseInt(t.sira),e.selects.manuelOdemeSekilleriList.push(t))}),e.selects.manuelOdemeSekilleriList.push({skod:"",sira:-1,taksit_adedi:0,id:null,aciklama:t.translate("SEÇİNİZ")}),e.selects.manuelOdemeSekilleriList=c("orderBy")(e.selects.manuelOdemeSekilleriList,"sira"),e.selectedInstallation=e.selects.manuelOdemeSekilleriList[0].id,e.form.TaksitSayisi=e.selects.manuelOdemeSekilleriList[0].taksit_adedi,e.onTaksitChange();var a=!1;if(angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){a||parseInt(t.taksit_adedi)>1&&(e.selectedInstallation=t.id,e.form.TaksitSayisi=t.taksit_adedi,a=!0)}),e.setOnlineOdemeYontemi(function(){e.setFirstItemOnChangePayment();var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/wlg",t,function(){},null,null,null,!0)}),null!==e.documents&&angular.forEach(e.documents,function(t){e.sirket.skod==t.skod&&"3"==t.doctip&&(e.pdfDocuments.informationDocument=t,e.pdfDocuments.isInformationTextDocumentExist=!0,e.pdfDocuments.isDefaultInformationTextDocumentExist=!1)}),!0!==e.pdfDocuments.isInformationTextDocumentExist&&null!==e.forms&&angular.forEach(e.forms,function(t){null!==t.siteUrl&&""!==t.siteUrl&&null!==t.pdfLocation&&""!==t.pdfLocation&&e.quotationContent.detail.satir.arabrans==t.product&&e.sirket.skod==t.skod&&(e.pdfDocuments.defaultInformationDocument=t,e.pdfDocuments.isDefaultInformationTextDocumentExist=!0)}),null!==e.pdfDocuments.informationDocument){var i={pDosyaID:e.pdfDocuments.informationDocument.id};r.post("sales/operations/file/base",i,function(){var t=e.generateFileURL();e.pdfDocuments.informationDocument=n.trustAsResourceUrl(t)})}var i={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/wlg",i,function(){},null,null,null,!0)},e.generateFileURL=function(){var t=null,t=location.host,n=m.protocol()+"://"+t,a=n+"/content/uploads/temp-"+f.getActiveInsured().HesKod;return e.getFileURL(a)},e.getFileURL=function(e){return e+"-Pdf.pdf?time="+Number(new Date)},e.openConfirmationModal=function(t){i.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"SalesAgreement"==t&&e.onChangeSaleAgreement()}}},"lg")},e.openInformationTextModal=function(t){i.open("/content/views/modals/information-text-document.html","Modals.InformationTextController",function(n){n.data={document:e.pdfDocuments,onSuccess:function(n){e.form[t]=n,1==n&&e.onChangeInformationText()}}},"lg")},e.trustAsHtml=function(e){return n.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return n.trustAsHtml(e)},e.cancel=function(){a.dismiss("cancel")},e.onSave=function(){if(e.isFormProcessing=!0,e.isProdCheckActive=!1,e.isFieldsValid()){var t=angular.copy(e.form);t.pAnaBrans=e.quotationContent.detail.satir.anabrans,t.pAraBrans=e.sirket.arabrans,t.pTeklifID=e.sirket.teklif_id,t.pPTutar=e.sirket.ptutar,t.pPoliID=e.quotationContent.pPoliID,t.pSKOD=e.sirket.skod,t.pTTutar=e.sirket.ttutar,t.pTVNedeni=e.sirket.tvneden,t.pTeklifNo=e.sirket.teklifno,t.pTeklifnoPSN=e.sirket.teklifno_psn,t.pTip=e.quotationContent.pTip,t.pPKomisyon=e.sirket.pkom,t.pTKomisyon=e.sirket.tkom,t.pAciklama=e.sirket.aciklama,t.pOdemeTipi=parseInt(e.form.OdemeTipi),t.pPhone=e.insuredData.TelNo1,t.OdemeSekli=parseInt(e.selectedInstallation),t.KartTipi=-1,t.Banka=-1,t.KartSahibi=e.form.KartSahibi,t.KartSahibiTC=e.form.KartSahibiTC,t.Telefon=e.insuredData.TelNo1,t.Aciklama="",t.CekimSekli=parseInt(e.form.OdemeTipi),t.TaksitSayisi=null,t.pOdemeSecenekID=parseInt(e.form.OdemeSecenekID),t.OdemeSecenekID=parseInt(e.form.OdemeSecenekID),t.TC=e.insuredData.TCNo,t.pSatisSekli="-1",t.pGSM=e.insuredData.TelNo1,t.pEposta=e.insuredData.EMail,t.OdemeSecenekKodu=e.form.OdemeSecenekKodu,t.isOnline=!0,null==e.selectedInstallation&&(t.pOdemeSecenekID=-1,t.OdemeSekli=-1),null!==t.TaksitSayisi&&void 0!==t.TaksitSayisi||(t.TaksitSayisi=0),null==t.OdemeSecenekID&&(t.OdemeSecenekID=0),null==t.pOdemeSecenekID&&(t.pOdemeSecenekID=0),0==e.isOnlinePaymentAvailable&&(t.TaksitSayisi=e.form.TaksitSayisi),null!==t.KartNo&&""!==t.KartNo&&void 0!==t.KartNo&&(t.KartNo=e.spliteCardNumber(t.KartNo)),t.SonKulTar=t.sonKulAy+"-"+t.sonKulYil,t.OdemeSecenekID=t.pOdemeSecenekID,null==t.OdemeSecenekID&&(t.OdemeSecenekID=-1),(null==t.OdemeSecenekID||void 0==t.OdemeSecenekID||isNaN(t.OdemeSecenekID))&&(t.OdemeSecenekID=-1),r.post("sales/policyrequestonline",t,function(t){e.isFormProcessing=!1,e.isProdCheckActive=!0;var n=d(function(){"Success"!==e.result&&e.checkPolicyProdStatus(n)},1e4);e.interval=n,s(function(){d.cancel(n)},18e4)},function(){e.isFormProcessing=!1},null,null,!0)}else e.isFormProcessing=!1},e.cancelProdStatus=function(){null!==e.interval&&void 0!==e.interval&&d.cancel(e.interval),a.dismiss("cancel")},e.checkPolicyProdStatus=function(n){var a={pTeklifHareketID:parseInt(e.sirket.teklif_id),pSkod:e.sirket.skod};r.post("sales/check/policystatus",a,function(a){if(2==a.HataKodu&&(e.result="Success",d.cancel(n),e.cancel(),l.success(t.translate("Satın Alma işlemi başarıyla gerçekleştirildi..!")),$rootScope.$broadcast("@activateView","police-talepleri")),1==a.HataKodu){e.result="Success",d.cancel(n),l.error(a.HataMesaji);var i={pPoliceID:e.quotationContent.pPoliID,pPoliceTipi:e.quotationContent.pTip,pTeklifID:parseInt(e.sirket.teklif_id)};r.post("sales/operations/cancel/policy",i,function(){e.cancel()},null,null,null,!0)}},null,null,null,!0)},e.isFieldsValid=function(){return!0===angular.copy(e.form).SalesAgreement||(l.error(t.translate("İşleme devam edebilmek için lütfen Mesafeli Satış Sözleşmesine İlişkin Aydınlatma Metnini okuyup, onaylayın.")),!1)},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.onChangeSaleAgreement=function(){s(function(){if(e.form.SalesAgreement){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/s/wlg",t,function(){},null,null,null,!0)}},50)},e.onChangeInformationText=function(){s(function(){if(e.form.InformationText){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/cd/wlg",t,function(){},null,null,null,!0)}},50)},e.onChangeCreditCardAgreement=function(){s(function(){if(e.form.CreditCardAgreement){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/c/wlg",t,function(){},null,null,null,!0)}},250)},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=c("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.getInstallmentCount=function(e,t,n){var a={taksitAdet:0,taksitText:"",taksitTutar:0},i=0,o=parseFloat(n),r=0;return void 0!==n&&null!==n&&""!==n&&(angular.forEach(e,function(e){e.skod==t&&parseInt(e.taksit_adedi)>1&&(i=e.taksit_adedi)}),r=o/i),r=c("serviceCurrency")(r),a.taksitAdet=parseInt(i),a.taksitTutar=parseInt(r),a.taksitText=r+" x "+i,a},e.spliteCardNumber=function(e){for(var t="",n=e.toString(),a=4,i=0;i<n.length;i++)i===a?(t+="-"+n.charAt(i),a+=4):t+=n.charAt(i);return t},e.onTaksitChange=function(){e.isCounterPaymentActive=!1,angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){t.id==e.form.PaymentSelection&&(e.form.TaksitSayisi=t.taksit_adedi,e.form.OdemeSecenekID=parseInt(t.id))})},e.onOnlineTaksitChange=function(){if(e.isCounterPaymentActive=!1,e.customerCounterBalance=null,"K01"==e.form.OdemeSecenekKodu){e.isCounterPaymentActive=!0;var n={musteriVkn:e.quotationContent.detail.satir.heskod};r.post("counter/balance",n,function(t){null!==t&&void 0!==t&&""!==t&&t.length>0?e.customerCounterBalance=t[0].kalanBakiye:e.customerCounterBalance=0},function(){l.error(t.translate("Bakiye Bilgisi Alınmadı..! Lütfen daha sonra tekrar deneyin."))})}},e.setOdemeTipi=function(t){if(e.form.OdemeTipi=t,0==t)angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){"0"!=t.taksit_adedi&&"1"!=t.taksit_adedi||(e.selectedInstallation=t.id,e.form.TaksitSayisi=t.taksit_adedi)});else{var n=!1;angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){
n||parseInt(t.taksit_adedi)>1&&(e.selectedInstallation=t.id,e.form.TaksitSayisi=t.taksit_adedi,n=!0)})}e.setFirstItemOnChangePayment()},e.isFieldsValid=function(){return!0===angular.copy(e.form).SalesAgreement||(l.error(t.translate("İşleme devam edebilmek için lütfen Mesafeli Satış Sözleşmesine İlişkin Aydınlatma Metnini okuyup, onaylayın.")),!1)},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.onChangeWizard=function(t){e.current=t},e.odemeTipiFilter=function(t){return t.ot==e.form.OdemeTipi?t:!1===e.onlineTaksitMevcut&&1==e.form.OdemeTipi?t:void 0},e.setFirstItemOnChangePayment=function(){var t=!1;angular.forEach(e.selects.onlineOdemeSekilleriList,function(n){n.ot==e.form.OdemeTipi&&!1===t&&(e.form.OdemeSecenekKodu=n.kod,t=!0)})},e.setOnlineOdemeYontemi=function(t){e.isOnlinePaymentAvailable=!1;var n={pTeklifHareketID:parseInt(parseInt(e.sirket.teklif_id)),pSirketKodu:e.sirket.skod};r.post("sales/onlinepayment/types",n,function(n){e.selects.onlineOdemeSekilleriList=n,n.length>0&&(e.isOnlinePaymentAvailable=!0),n.length>0&&(e.form.OdemeSecenekKodu=n[0].kod),e.onlineTaksitMevcut=!1,angular.forEach(e.selects.onlineOdemeSekilleriList,function(t){1==t.ot&&(e.onlineTaksitMevcut=!0)}),"function"==typeof t&&t()})},e.onCreate()}]),app.controller("PaymentRequest.ModalController",["$scope","$culture","$sce","$uibModalInstance","$modal","$formValidations","$rest","$alert","$timeout","$state","$filter","$location","$insured","$welcomeInit","$rootScope",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p){e.quotationContent=a.data.quotationContent,e.sirket=a.data.sirket,e.boxesData=a.data.boxesData,e.documents=a.data.documents,e.forms=a.data.forms,e.activeMenu=a.data.activeMenu,e.current=1,e.isCustomerExists=null,e.menuData={},e.isLoggedIn=!1,e.odemeSekilleriList=[],e._validator=o,e.form={status:a.data.isMenuPresentationDesc,TaksitSayisi:1,PoliceTipi:1,Aciklama:null,Banka:null,Cvc:null,KartNo:"",KartSahibi:"",KartTipi:"",SonKulTar:"",GSM:null,ReferansKodu:null,KartSahibiTC:"",sonKulYil:"",sonKulAy:"",OdemeTipi:"1",SalesAgreement:"0",CreditCardAgreement:"0",PaymentSelection:"",InformationText:!1},e.pdfDocuments={isInformationTextDocumentExist:!1,isDefaultInformationTextDocumentExist:!1,informationDocument:null,defaultInformationDocument:null},e.getBoxTrustedHtml=function(e){return n.trustAsHtml(e)},e.onCreate=function(){if(e.getCategories(e.boxesData),e.dynamicContent=f.getDynamicContent(),e.websiteSettings=f.getWebsiteSettings(),e.odemeSekilleriList.push({skod:"",sira:0,taksit_adedi:0,id:null,aciklama:t.translate("SEÇİNİZ")}),angular.forEach(e.sirket.tablo.OdemeTipleri.odeme_tipleri,function(t){t.skod==e.sirket.skod&&(t.sira=parseInt(t.sira),e.odemeSekilleriList.push(t))}),e.odemeSekilleriList=c("orderBy")(e.odemeSekilleriList,"sira"),null!==e.documents&&angular.forEach(e.documents,function(t){e.sirket.skod==t.skod&&"3"==t.doctip&&(e.pdfDocuments.informationDocument=t,e.pdfDocuments.isInformationTextDocumentExist=!0,e.pdfDocuments.isDefaultInformationTextDocumentExist=!1)}),!0!==e.pdfDocuments.isInformationTextDocumentExist&&null!==e.forms&&angular.forEach(e.forms,function(t){null!==t.siteUrl&&""!==t.siteUrl&&null!==t.pdfLocation&&""!==t.pdfLocation&&e.quotationContent.detail.satir.arabrans==t.product&&e.sirket.skod==t.skod&&(e.pdfDocuments.defaultInformationDocument=t,e.pdfDocuments.isDefaultInformationTextDocumentExist=!0)}),null!==e.pdfDocuments.informationDocument){var a={pDosyaID:e.pdfDocuments.informationDocument.id};r.post("sales/operations/file/base",a,function(){var t=e.generateFileURL();e.pdfDocuments.informationDocument=n.trustAsResourceUrl(t)})}e.onTaksitChange();var a={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/wlg",a,function(){},null,null,null,!0)},e.generateFileURL=function(){var t=null,t=location.host,n=d.protocol()+"://"+t,a=n+"/content/uploads/temp-"+m.getActiveInsured().HesKod;return e.getFileURL(a)},e.getFileURL=function(e){return e+"-Pdf.pdf?time="+Number(new Date)},e.openConfirmationModal=function(t){i.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"SalesAgreement"==t&&e.onChangeSaleAgreement()}}},"lg")},e.openInformationTextModal=function(t){i.open("/content/views/modals/information-text-document.html","Modals.InformationTextController",function(n){n.data={document:e.pdfDocuments,onSuccess:function(n){e.form[t]=n,1==n&&e.onChangeInformationText()}}},"lg")},e.trustAsHtml=function(e){return n.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return n.trustAsHtml(e)},e.cancel=function(){a.dismiss("cancel")},e.onSave=function(){if(e.isFieldsValid()){e.form.OdemeTipi=0,e.form.TaksitSayisi>1&&(e.form.OdemeTipi=1),e.form.skod=e.sirket.skod,e.form.PID=e.quotationContent.pPoliID,e.form.PIDKSK=e.quotationContent.pPoliID;var t=angular.copy(e.form);"0"==e.sirket.prod?t.isOnline=!1:t.isOnline=!0,t.OdemeSecenekID=-1,r.post("sales/satinal",t,function(t){0==t.ResultCode?(l.success("Talebiniz oluşturuldu..!"),e.cancel(),p.$broadcast("@activateView","police-talepleri")):404==t.ResultCode?l.info("Hata Oluştu."):l.info(t.Title)})}},e.isFieldsValid=function(){return!0===angular.copy(e.form).SalesAgreement||(l.error(t.translate("İşleme devam edebilmek için lütfen Mesafeli Satış Sözleşmesine İlişkin Aydınlatma Metnini okuyup, onaylayın.")),!1)},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.onChangeSaleAgreement=function(){s(function(){if(e.form.SalesAgreement){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/s/wlg",t,function(){},null,null,null,!0)}},50)},e.onChangeInformationText=function(){s(function(){if(e.form.InformationText){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/cd/wlg",t,function(){},null,null,null,!0)}},50)},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=c("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.getInstallmentCount=function(e,t,n){var a={taksitAdet:0,taksitText:"",taksitTutar:0},i=0,o=parseFloat(n),r=0;return void 0!==n&&null!==n&&""!==n&&(angular.forEach(e,function(e){e.skod==t&&parseInt(e.taksit_adedi)>1&&(i=e.taksit_adedi)}),r=o/i),r=c("serviceCurrency")(r),a.taksitAdet=parseInt(i),a.taksitTutar=parseInt(r),a.taksitText=r+" x "+i,a},e.onTaksitChange=function(){angular.forEach(e.odemeSekilleriList,function(t){t.id==e.form.PaymentSelection&&(e.form.TaksitSayisi=t.taksit_adedi,e.form.OdemeSecenekID=parseInt(t.id))})},e.onCreate()}]),app.controller("PrivacyPolicyModalController",["$scope","$uibModalInstance","$sce","$rest",function(e,t,n,a){e.data=t.data,e.onCreate=function(){},e.accept=function(){e.data.onSuccess(),a.post("p/cn/wlg",{},function(){},null,null,null,!0),e.cancel()},e.cancel=function(){t.dismiss("cancel")},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return n.trustAsHtml(e)},e.onCreate()}]),app.controller("QuickLinkModalController",["$scope","$uibModalInstance","$sce",function(e,t,n){e.quickLinkItem=t.data.quickLinkItem,e.getTrustedHtml=function(e){return n.trustAsHtml(e)},e.cancel=function(){t.dismiss("cancel")}}]),app.controller("RefLoginController",["$scope","$rest","$modal","$alert","$culture","vcRecaptchaService","$handcuff",function(e,t,n,a,i,o,r){e.restConnector=t,e.widgetId=null,e.reCaptchaResponse="",e.isViewRefReCaptcha=!1,e.isRefLoginButtonDisabled=!1,e.PK=null,e.SK=null,e.loginForm={username:null,password:null,databaseSelection:null,isContinue:!1},e.loginResponse={errorCode:null,loginType:null,isRedirectToUrl:!1,url:null},e.onCreate=function(){e.isRCKLoading=!0,t.get("welcome/login/content",{},function(t){e.isVerifyRefRCPT=t.isVerifyRCPT,null!==t.RCK.PK&&""!==t.RCK.PK&&void 0!==t.RCK.PK&&(t.RCK.PK=r.remove(t.RCK.PK)),e.isVerifyRefRCPT&&(e.captchaKeys=t.RCK,e.captchaKeys.PK?(e.PK=e.captchaKeys.PK,e.isViewRefReCaptcha=!0,e.isRefLoginButtonDisabled=!0):(e.isRefLoginButtonDisabled=!1,e.isViewRefReCaptcha=!1)),e.isRCKLoading=!1},function(){e.isRCKLoading=!1})},e.refLogin=function(){if(!(e.isRefLoginButtonDisabled&&e.isViewRefReCaptcha||e.isRCKLoading)){var n=JSON.clone(e.loginForm);t.post("reference/login",n,function(t){t.isRedirectToUrl?window.location.href=t.url:e.loginResponse=t},null,function(t){var n=t.data;if("155"===n.realCode){var o={username:e.loginForm.username,databaseCode:e.loginForm.databaseSelection};e.changePasswordModal(o)}else if("1"===n.realCode&&"IsSupportSMSPasswordReset"===n.defaultMessage){var r={username:e.loginForm.username,databaseCode:e.loginForm.databaseSelection};e.sendSms(r)}else a.error(i.translate(n.defaultMessage))})}},e.changePasswordModal=function(e){var t=i.translate("Kullanıcı hesabınıza ait parolanın yenilenmesi gerekiyor, lütfen yeni bir parola tanımlayarak sisteme tekrar giriş yapın.");a.areYouSureWithMessage(t,function(){n.open("/content/views/auth/change-password-modal.html","LoginChangePasswordModalController",function(t){t.data={username:e.username,databaseCode:e.databaseCode}},"cmd")})},e.sendSms=function(o){var r=i.translate("Girilen parola hatalı. Sistemde kayıtlı telefon numaranızı kullanarak parolanızı sıfırlayabilirsiniz. İşlemi onaylıyor musunuz?");a.areYouSureWithMessage(r,function(){t.post("auth/sendpasswordsms",o,function(t){n.open("/content/views/auth/set-password-via-sms-modal.html","LoginSetPasswordViaSmsModalController",function(n){n.data={username:e.loginForm.username,databaseCode:null,refCode:t.message}},"cmd")})},function(){window.location.reload()})},e.continueLogin=function(t){"SS"===t&&(e.loginForm.isContinue=!0,e.refLogin())},e.cbExpiration=function(){o.reload(e.widgetId),e.reCaptchaResponse=null,e.isRefLoginButtonDisabled=!0},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(o.reload(e.widgetId),e.reCaptchaResponse=null,e.isRefLoginButtonDisabled=!0)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var n={reCaptchaResponse:e.reCaptchaResponse,SK:e.SK};t.post("widget/recaptcha/check",n,function(t){t?e.isRefLoginButtonDisabled=!1:(e.isRefLoginButtonDisabled=!0,a.error(i.translate("reCPTCHA doğrulanamadı..!")),o.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.returnBackToHome=function(){window.location.href="/"},e.onCreate()}]),app.controller("SecurePayment.ModalController",["$scope","$culture","$sce","$uibModalInstance","$modal","$formValidations","$rest","$alert","$timeout","$state","$filter","$interval","$location","$insured","$welcomeInit",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p){e.quotationContent=a.data.quotationContent,e.sirket=a.data.sirket,e.boxesData=a.data.boxesData,e.documents=a.data.documents,e.forms=a.data.forms,e.insuredData=a.data.insuredData,e.isPaymentContentExist=a.data.isPaymentContentExist,e.current=1,e.isCustomerExists=null,e.isProdCheckActive=!1,e.menuData={},e.activeMenu=a.data.activeMenu,e.isLoggedIn=!1,e.selects={manuelOdemeSekilleriList:[],onlineOdemeSekilleriList:[]},e.isSecureFrameForbidden=!1,e.isSelfPostRequired=!1,e._validator=o,e.form={OdemeTipi:1,status:a.data.isMenuPresentationDesc,TaksitSayisi:1,PoliceTipi:1,Aciklama:null,Banka:null,Cvc:null,KartNo:null,KartSahibi:null,KartSahibiTC:null,KartTipi:null,SonKulTar:null,GSM:null,ReferansKodu:null,KartSahibiTC:null,sonKulYil:null,sonKulAy:null,SalesAgreement:"0",CreditCardAgreement:"0",PaymentSelection:null,InformationText:!1},e.pdfDocuments={isInformationTextDocumentExist:!1,isDefaultInformationTextDocumentExist:!1,informationDocument:null,defaultInformationDocument:null},e.data={yearList:[],months:[{kod:null,number:t.translate("Ay"),ad:t.translate("Ay")},{kod:"01",number:"01",ad:t.translate("Ocak")},{kod:"02",number:"02",ad:t.translate("Şubat")},{kod:"03",number:"03",ad:t.translate("Mart")},{kod:"04",number:"04",ad:t.translate("Nisan")},{kod:"05",number:"05",ad:t.translate("Mayıs")},{kod:"06",number:"06",ad:t.translate("Haziran")},{kod:"07",number:"07",ad:t.translate("Temmuz")},{kod:"08",number:"08",ad:t.translate("Ağustos")},{kod:"09",number:"09",ad:t.translate("Eylül")},{kod:"10",number:"10",ad:t.translate("Ekim")},{kod:"11",number:"11",ad:t.translate("Kasım")},{kod:"12",number:"12",ad:t.translate("Aralık")}]},e.getValidYears=function(){for(var e=[],t=moment().year(),n=0;n<11;n++)e.push({kod:t.toString(),ad:t}),t++;return e},e.getBoxTrustedHtml=function(e){return n.trustAsHtml(e)},e.getTaksitCount=function(){var t=parseInt(e.form.TaksitSayisi),n=parseFloat(e.sirket.ttutar);return parseFloat(n/t)},e.selectInstallation=function(t){e.selectedInstallation=t.id,e.form.TaksitSayisi=t.taksit_adedi},e.setOdemeTipi=function(t){if(e.form.OdemeTipi=t,0==t)angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){"0"!=t.taksit_adedi&&"1"!=t.taksit_adedi||(e.selectedInstallation=t.id,e.form.TaksitSayisi=t.taksit_adedi)});else{var n=!1;angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){n||parseInt(t.taksit_adedi)>1&&(e.selectedInstallation=t.id,e.form.TaksitSayisi=t.taksit_adedi,n=!0)})}e.setFirstItemOnChangePayment()},e.onCreate=function(){e.dynamicContent=p.getDynamicContent(),e.websiteSettings=p.getWebsiteSettings(),null!==e.activeMenu.isHideInstallation&&void 0!==e.activeMenu.isHideInstallation&&!0===e.activeMenu.isHideInstallation&&e.setOdemeTipi(0),e.getCategories(e.boxesData),e.data.yearList=e.getValidYears(),e.data.yearList.unshift({kod:null,ad:t.translate("Yıl")}),angular.forEach(e.sirket.tablo.OdemeTipleri.odeme_tipleri,function(t){t.skod==e.sirket.skod&&(t.sira=parseInt(t.sira),e.selects.manuelOdemeSekilleriList.push(t))}),e.selects.manuelOdemeSekilleriList.push({skod:"",sira:-1,taksit_adedi:0,id:null,aciklama:t.translate("SEÇİNİZ")}),e.selects.manuelOdemeSekilleriList=c("orderBy")(e.selects.manuelOdemeSekilleriList,"sira"),e.selectedInstallation=e.selects.manuelOdemeSekilleriList[0].id,e.form.TaksitSayisi=e.selects.manuelOdemeSekilleriList[0].taksit_adedi,e.onTaksitChange();var a=!1;if(angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){a||parseInt(t.taksit_adedi)>1&&(e.selectedInstallation=t.id,e.form.TaksitSayisi=t.taksit_adedi,a=!0)}),null!==e.documents&&angular.forEach(e.documents,function(t){e.sirket.skod==t.skod&&"3"==t.doctip&&(e.pdfDocuments.informationDocument=t,e.pdfDocuments.isInformationTextDocumentExist=!0,e.pdfDocuments.isDefaultInformationTextDocumentExist=!1)}),!0!==e.pdfDocuments.isInformationTextDocumentExist&&null!==e.forms&&angular.forEach(e.forms,function(t){null!==t.siteUrl&&""!==t.siteUrl&&null!==t.pdfLocation&&""!==t.pdfLocation&&e.quotationContent.detail.satir.arabrans==t.product&&e.sirket.skod==t.skod&&(e.pdfDocuments.defaultInformationDocument=t,e.pdfDocuments.isDefaultInformationTextDocumentExist=!0)}),null!==e.pdfDocuments.informationDocument){var i={pDosyaID:e.pdfDocuments.informationDocument.id};r.post("sales/operations/file/base",i,function(){var t=e.generateFileURL();e.pdfDocuments.informationDocument=n.trustAsResourceUrl(t)})}e.setOnlineOdemeYontemi(function(){e.setFirstItemOnChangePayment();var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/wlg",t,function(){},null,null,null,!0)})},e.generateFileURL=function(){var t=null,t=location.host,n=m.protocol()+"://"+t,a=n+"/content/uploads/temp-"+f.getActiveInsured().HesKod;return e.getFileURL(a)},e.getFileURL=function(e){return e+"-Pdf.pdf?time="+Number(new Date)},e.openConfirmationModal=function(t){i.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"SalesAgreement"==t&&e.onChangeSaleAgreement()}}},"lg")},e.openInformationTextModal=function(t){i.open("/content/views/modals/information-text-document.html","Modals.InformationTextController",function(n){n.data={document:e.pdfDocuments,onSuccess:function(n){e.form[t]=n,1==n&&e.onChangeInformationText()}}},"lg")},e.onChangeSaleAgreement=function(){s(function(){if(e.form.SalesAgreement){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/s/wlg",t,function(){},null,null,null,!0)}},50)},e.onChangeInformationText=function(){s(function(){if(e.form.InformationText){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/cd/wlg",t,function(){},null,null,null,!0)}},50)},e.onChangeCreditCardAgreement=function(){s(function(){if(e.form.CreditCardAgreement){var t={pPoliID:e.quotationContent.pPoliID,skod:e.sirket.skod};r.post("p/c/wlg",t,function(){},null,null,null,!0)}},250)},e.cancel=function(){null!==e.interval&&void 0!==e.interval&&d.cancel(e.interval),a.dismiss("cancel")},e.trustAsHtml=function(e){return n.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return n.trustAsHtml(e)},e.onChangeQuotationWizard=function(t){e.current=2,t&&(e.current=1)},e.onChangeQuotationWizardToSecure=function(t){t?e.current=1:e.get3DSecureAddress()},e.onChangeCCWizard=function(t){t?e.current=1:e.get3DSecureAddress()},e.onSave=function(){if(e.isProdCheckActive=!1,e.isFieldsValid()){e.form.OdemeTipi=0,e.form.TaksitSayisi>1&&(e.form.OdemeTipi=1),e.form.skod=e.sirket.skod,e.form.PID=e.quotationContent.pPoliID,e.form.PIDKSK=e.quotationContent.pPoliID;var t=angular.copy(e.form);"0"==e.sirket.prod?t.isOnline=!1:t.isOnline=!0,t.KartNo=e.spliteCardNumber(t.KartNo),t.SonKulTar=t.sonKulAy+"-"+t.sonKulYil,r.post("sales/satinal",t,function(t){0==t.ResultCode?(l.success("Satın Alma İşlemi Başarılı."),e.cancel(),$rootScope.$broadcast("@activateView","police-talepleri")):404==t.ResultCode?l.info("Hata Oluştu."):l.info(t.Title)})}},e.isFieldsValid=function(){var n=angular.copy(e.form);return!0!==n.SalesAgreement?(l.error(t.translate("İşleme devam edebilmek için lütfen Mesafeli Satış Sözleşmesine İlişkin Aydınlatma Metnini okuyup, onaylayın.")),!1):!0===n.CreditCardAgreement||(l.error(t.translate("İşleme devam edebilmek için lütfen Kredi Kartı Kullanım İznine İlişkin Aydınlatma Metnini okuyup, onaylayın.")),!1)},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=c("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.getInstallmentCount=function(e,t,n){var a={taksitAdet:0,taksitText:"",taksitTutar:0},i=0,o=parseFloat(n),r=0;return void 0!==n&&null!==n&&""!==n&&(angular.forEach(e,function(e){e.skod==t&&parseInt(e.taksit_adedi)>1&&(i=e.taksit_adedi)}),r=o/i),r=c("serviceCurrency")(r),a.taksitAdet=parseInt(i),a.taksitTutar=parseInt(r),a.taksitText=r+" x "+i,a},e.spliteCardNumber=function(e){for(var t="",n=e.toString(),a=4,i=0;i<n.length;i++)i===a?(t+="-"+n.charAt(i),a+=4):t+=n.charAt(i);return t},e.onTaksitChange=function(){angular.forEach(e.selects.manuelOdemeSekilleriList,function(t){t.id==e.form.PaymentSelection&&(e.form.TaksitSayisi=t.taksit_adedi,e.form.OdemeSecenekID=parseInt(t.id))})},e.getAxaQuery=function(){return"?pTeklifID="+parseInt(e.form.pTeklifID)+"&pOdemeTipi="+parseInt(e.form._pOdemeBilgisi.CekimSekli)+"&pOdemeSecenekID="+parseInt(e.form.OdemeSecenekID)+"&pSirketKodu="+e.form.pSKOD};var g=function(e){try{JSON.parse(e)}catch(e){return!1}return!0};e.get3DSecureAddress=function(){var t={pTeklifID:parseInt(e.sirket.teklif_id),pOdemeTipi:parseInt(e.form.OdemeTipi),pOdemeSecenekID:parseInt(e.selectedInstallation),pSirketKodu:e.sirket.skod,KartSahibi:e.form.KartSahibi,KartNo:e.form.KartNo,CVV:e.form.Cvc,SonKulTar:e.form.sonKulAy+"-"+e.form.sonKulYil};null==t.CVV&&(t.CVV=""),null==t.KartNo&&(t.KartNo=""),null==t.KartSahibi&&(t.KartSahibi=""),null!=t.SonKulTar&&"null-null"!=t.SonKulTar||(t.SonKulTar=""),null!==t.pOdemeSecenekID&&t.pOdemeSecenekID>0&&(t.pOdemeSecenekKodu=t.pOdemeSecenekID),null!==e.form.OdemeSecenekKodu&&""!==e.form.OdemeSecenekKodu&&void 0!==e.form.OdemeSecenekKodu&&(t.pOdemeSecenekKodu=e.form.OdemeSecenekKodu),r.post("sales/order/3d",t,function(t){e.current=3,e.secure={Url:t.Url,TransactionId:t.TransactionID},g(t.Url)&&"042"==e.sirket.tsk&&(e.rayData=JSON.parse(t.Url),e.isFormActionRequired=!0,e.isSecureFrameForbidden=null,e.current=3,s(function(){document.getElementById("payment").submit()},1e3)),"051"==e.sirket.tsk&&(e.rayData=e.getTrustedHtml(t.Url),e.isFormActionRequired=!0,e.isSecureFrameForbidden=null,e.isSelfPostRequired=!0,s(function(){document.forms.form.target="_blank"},100)),""!==e.secureUrl&&null!==e.secure.Url&&void 0!==e.secure.Url&&!0!==e.isFormActionRequired&&(e.current=3,"040"==e.sirket.tsk&&(e.isSecureFrameForbidden=!0),"061"==e.sirket.tsk&&(e.isSecureFrameForbidden=!0));var n=d(function(){"Success"!==e.secureResult&&e.getSecuredPaymentResult(n)},1e4);e.interval=n,s(function(){d.cancel(n)},9e5)})},e.onClickTNippon3DButton=function(){document.forms.form.submit()},e.getTrustedSecureUrl=function(e){return n.trustAsResourceUrl(e)},e.validateSecuredUrl=function(e){return n.trustAsResourceUrl(e)},e.getSecuredPaymentResult=function(t){var n={TransactionId:e.secure.TransactionId};r.post("sales/order/3dresult",n,function(n){"Success"!==n.result&&"success"!==n.result&&"SUCCESS"!==n.result&&"Y"!==n.result&&"y"!==n.result||(e.secureResult="Success",d.cancel(t),""!==n.policeNo&&null!==n.policeNo&&void 0!==n.policeNo?e.doSecurePoliceTalep(n.policeNo):e.doSecurePoliceTalep()),"Failed"!==n.result&&"FAILED"!==n.result&&"failed"!==n.result&&"N"!==n.result&&"n"!==n.result||(e.secureResult="Failed",e.doSecureFail(t),d.cancel(t))},null,null,null,!0)},e.doSecureFail=function(n){var a={pTeklifID:parseInt(e.sirket.teklif_id),pSirketKodu:e.sirket.skod};r.post("sales/order/fail",a,function(){d.cancel(n),l.error(t.translate("3D Bilgileri doğrulanamadı..! Lütfen tekrar deneyin. Ödeme Ekranı kapatılıyor...")),e.cancel()})},e.doSecurePoliceTalep=function(t){var n={pAnaBrans:e.quotationContent.detail.satir.anabrans,pAraBrans:e.sirket.arabrans,pTeklifID:e.sirket.teklif_id,pPTutar:e.sirket.ptutar,pPoliID:e.quotationContent.pPoliID,pSKOD:e.sirket.skod,pTTutar:e.sirket.ttutar,pTVNedeni:e.sirket.tvneden,pTeklifNo:e.sirket.teklifno,pTeklifnoPSN:e.sirket.teklifno_psn,pTip:e.quotationContent.pTip,pPKomisyon:e.sirket.pkom,pTKomisyon:e.sirket.tkom,pAciklama:e.sirket.aciklama,SatisSekli:e.form.SatisSekli,pOdemeTipi:parseInt(e.form.OdemeTipi),pPhone:e.insuredData.TelNo1,OdemeSekli:parseInt(e.selectedInstallation),KartTipi:-1,Banka:-1,KartSahibi:e.form.KartSahibi,KartSahibiTC:e.form.KartSahibiTC,Telefon:e.insuredData.TelNo1,Aciklama:"",CekimSekli:parseInt(e.form.OdemeTipi),TaksitSayisi:null,pOdemeSecenekID:parseInt(e.form.OdemeSecenekID),OdemeSecenekID:parseInt(e.form.OdemeSecenekID),TC:e.insuredData.TCNo,pSatisSekli:-1,pGSM:e.insuredData.TelNo1,pEposta:e.insuredData.EMail,OdemeSecenekKodu:e.form.OdemeSecenekKodu,OnlineOdemeSecenekKodu:e.form.OdemeSecenekKodu};null==parseInt(e.selectedInstallation)&&(n.pOdemeSecenekID=-1,n.OdemeSekli=-1),null!==n.TaksitSayisi&&void 0!==n.TaksitSayisi||(n.TaksitSayisi=0),"042"==e.sirket.tsk&&(n.pPoliID=e.rayData.RAY.PolicyNo),angular.forEach(e.selects.manuelOdemeSekilleriList,function(e){n.pOdemeSecenekID==e.Id&&(n.TaksitSayisi=e.TaksitSayisi)}),(null==n.OdemeSekli||void 0==n.OdemeSekli||isNaN(n.OdemeSekli))&&(n.OdemeSekli=-1),null!==t&&void 0!==t&&""!==t&&(n.p3DPoliceNo=t),n.OdemeSecenekID=n.pOdemeSecenekID,(null==n.OdemeSecenekID||void 0==n.OdemeSecenekID||isNaN(n.OdemeSecenekID))&&(n.OdemeSecenekID=-1),r.post("sales/securepolicyprod",n,function(){e.isProdCheckActive=!0;var t=d(function(){"Success"!==e.result&&e.checkPolicyProdStatus(t)},1e4);e.interval=t,s(function(){d.cancel(t)},6e5)})},e.checkPolicyProdStatus=function(n){var a={pTeklifHareketID:parseInt(e.sirket.teklif_id),pSkod:e.sirket.skod};r.post("sales/check/policystatus",a,function(a){if(2==a.HataKodu&&(e.result="Success",d.cancel(n),l.success(t.translate("Poliçe Üretiminiz Başarıyla Tamamlandı..!")),e.cancel(),$rootScope.$broadcast("@activateView","police-talepleri")),1==a.HataKodu){e.result="Success",d.cancel(n),l.error(a.HataMesaji);var i={pPoliceID:e.quotationContent.pPoliID,pPoliceTipi:e.quotationContent.pTip,pTeklifID:parseInt(e.sirket.teklif_id)};r.post("sales/operations/cancel/policy",i,function(){e.cancel()},null,null,null,!0)}},null,null,null,!0)},e.odemeTipiFilter=function(t){return t.ot==e.form.OdemeTipi?t:!1===e.onlineTaksitMevcut&&1==e.form.OdemeTipi?t:void 0},e.setFirstItemOnChangePayment=function(){var t=!1;angular.forEach(e.selects.onlineOdemeSekilleriList,function(n){n.ot==e.form.OdemeTipi&&!1===t&&(e.form.OdemeSecenekKodu=n.kod,t=!0)})},e.setOnlineOdemeYontemi=function(t){e.isOnlinePaymentAvailable=!1;var n={pTeklifHareketID:parseInt(parseInt(e.sirket.teklif_id)),pSirketKodu:e.sirket.skod};r.post("sales/onlinepayment/types",n,function(n){e.selects.onlineOdemeSekilleriList=n,n.length>0&&(e.isOnlinePaymentAvailable=!0),n.length>0&&(e.form.OdemeSecenekKodu=n[0].kod),e.onlineTaksitMevcut=!1,angular.forEach(e.selects.onlineOdemeSekilleriList,function(t){1==t.ot&&(e.onlineTaksitMevcut=!0)}),"function"==typeof t&&t()})},e.onCreate()}]),app.controller("SecurePolisoftModalController",["$scope","$uibModalInstance","$timeout","$sce","$interval","$rest",function(e,t,n,a,i,o){e.data=t.data,e.form=t.data.form,e.transactionId=e.data.data.return.TransactionID,e.transactionUrl=e.data.data.return.Url,e.requestedPaymentCompany=e.data.sirket,e.quotationContent=t.data.quotationContent,e.websiteSettings=t.data.websiteSettings,e.activeMenu=t.data.activeMenu,e.securePaymentResult="Failed",e.onCreate=function(){n(function(){document.getElementById("payment").submit()},1e3);var t=i(function(){"Success"!==e.securePaymentResult&&e.getSecuredPaymentResult(t)},5e3);e.interval=t,n(function(){i.cancel(t)},18e4)},e.getTrustedSecureUrl=function(e){return a.trustAsResourceUrl(e)},e.cancel=function(){null!==e.interval&&void 0!==e.interval&&i.cancel(e.interval),t.dismiss("cancel"),"Success"!==e.secureResult&&e.data.onFailed(e.transactionId)},e.getSecuredPaymentResult=function(t){e.secureResult="";var a={TransactionId:e.transactionId};o.post("sales/polisoft/3dresult",a,function(a){"Success"===a.result&&(e.secureResult="Success",i.cancel(t),e.data.onSuccess(a),e.cancel()),"Fail"===a.result&&(e.secureResult="Failed",e.doSecureFail(t),i.cancel(t),n(function(){e.cancel()},1e3))},null,null,null,!0)},e.doSecureFail=function(t){var a={pTeklifID:parseInt(e.requestedPaymentCompany.teklif_id),pSirketKodu:e.requestedPaymentCompany.skod};o.post("sales/order/fail",a,function(){i.cancel(t),$alert.error($culture.translate("3D Bilgileri doğrulanamadı..! Lütfen tekrar deneyin. Ödeme Ekranı kapatılıyor...")),n(function(){e.cancel()},1e3)})},e.onCreate()}]),app.controller("SMSVerifyInsuredModalController",["$scope","$uibModalInstance","$rest","$culture","$formValidations","$alert","$timeout","$sce","$state","$handcuff",function(e,t,n,a,i,o,r,l,s,u){e._validator=i,e.data=t.data,e.smsActivationLocation=t.smsActivationLocation,e.smsActivateDescription=t.smsActivateDescription,e.isUpdatePhoneActive=!1,e.referenceCode=null,e.isNumberValidated=!1,e.isValidating=!1,e.form={HesapKodu:e.data.data.HesapKodu,GSM:e.data.data.GSMNo,securecode:null,pSessionID:null},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,pGSM:e.data.data.GSMNo,pVKN:null,pUnvan:e.data.data.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.data.sID};null!==e.data.data.GSMNo&&""!==e.data.data.GSMNo&&void 0!==e.data.data.GSMNo||(t.GSMNo=e.data.data.pGenel.GSMNo),null!==e.data.data.HesapKodu&&""!==e.data.data.HesapKodu&&void 0!==e.data.data.HesapKodu||(e.data.data.HesapKodu=e.data.data.pGenel.HesapKodu),"company"==e.data.data.Tip?t.pVKN=e.data.data.HesapKodu:t.pTCKN=e.data.data.HesapKodu,t.HesapKodu=e.data.data.HesapKodu,n.post("prepare/activation",t,function(t){e.form.pSessionID=u.remove(t.return.JSONData),e.referenceCode=u.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,n.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verify=function(){e.verifying=!0;var i=angular.copy(e.form);n.post("insured/check/sms",i,function(n){e.verifying=!1,!0===n.isSmsValid?(e.data.onSuccess(e.form.pSessionID,!0),r(function(){t.dismiss("cancel")},100)):6==n.ResultCode?o.error(a.translate("ALERT_VERIFY_ERROR")):o.error(a.translate(n.Message))},function(){e.verifying=!1},null,null,!0)},e.changePhoneNumber=function(){e.changing=!0;var t=angular.copy(e.form);n.post("change/phone",t,function(t){0==t.ResultCode?(e.changing=!1,e.isUpdatePhoneActive=!1,e.data.GSMNo=e.form.GSM):(e.changing=!1,o.error(t.Message))})},e.activateChangePhone=function(){e.form.GSM=null,e.isUpdatePhoneActive=!0},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.cancel=function(){t.dismiss("cancel"),e.data.onModalCancel(),n.post("o/sc/wlg",{},function(){},null,null,null,!0)},e.closeModal=function(){t.dismiss("cancel"),n.post("o/sc/wlg",{},function(){},null,null,null,!0),s.go("welcome")},e.cancelChangePhoneNumber=function(){e.isUpdatePhoneActive=!1},e.trustAsHtml=function(e){return l.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return l.trustAsHtml(e)}}]),app.controller("SMSVerifyModalController",["$scope","$uibModalInstance","$rest","$culture","$formValidations","$alert","$timeout","$sce","$state","$handcuff",function(e,t,n,a,i,o,r,l,s,u){e._validator=i,e.data=t.data,e.smsActivationLocation=t.data.smsActivationLocation,e.smsActivateDescription=t.data.smsActivateDescription,e.isUpdatePhoneActive=!1,e.referenceCode=null,e.isNumberValidated=!1,e.isValidating=!1,e.form={HesapKodu:e.data.data.pGenel.HesapKodu,GSM:e.data.data.pGenel.GSMNo,securecode:null,pSessionID:null},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,pGSM:e.data.data.GSMNo,pVKN:null,pUnvan:e.data.data.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.data.data.sID};null!==e.data.data.GSMNo&&""!==e.data.data.GSMNo&&void 0!==e.data.data.GSMNo||(t.GSMNo=e.data.data.pGenel.GSMNo),null!==e.data.data.HesapKodu&&""!==e.data.data.HesapKodu&&void 0!==e.data.data.HesapKodu||(e.data.data.HesapKodu=e.data.data.pGenel.HesapKodu),"company"==e.data.data.pGenel.Tip?t.pVKN=e.data.data.HesapKodu:t.pTCKN=e.data.data.HesapKodu,t.HesapKodu=e.data.data.HesapKodu,n.post("prepare/activation",t,function(t){e.form.pSessionID=u.remove(t.return.JSONData),e.referenceCode=u.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,n.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verify=function(){e.verifying=!0;var i=angular.copy(e.form);n.post("check/sms",i,function(n){e.verifying=!1,!0===n.isSmsValid?(e.data.onSuccess(e.form.pSessionID),r(function(){t.dismiss("cancel")},100)):6==n.ResultCode?o.error(a.translate("ALERT_VERIFY_ERROR")):o.error(a.translate(n.Message))},function(){e.verifying=!1},null,null,!0)},
e.changePhoneNumber=function(){e.changing=!0;var t=angular.copy(e.form);n.post("change/phone",t,function(t){0==t.ResultCode?(e.changing=!1,e.isUpdatePhoneActive=!1,e.data.data.pGenel.GSMNo=e.form.GSM):(e.changing=!1,o.error(t.Message))})},e.activateChangePhone=function(){e.form.GSM=null,e.isUpdatePhoneActive=!0},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.cancel=function(){t.dismiss("cancel"),n.post("o/sc/wlg",{},function(){},null,null,null,!0)},e.closeModal=function(){t.dismiss("cancel"),n.post("o/sc/wlg",{},function(){},null,null,null,!0),s.go("welcome")},e.cancelChangePhoneNumber=function(){e.isUpdatePhoneActive=!1},e.trustAsHtml=function(e){return l.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return l.trustAsHtml(e)}}]),app.controller("SMSVerifyQuickFormModalController",["$scope","$uibModalInstance","$rest","$culture","$formValidations","$alert","$timeout","$handcuff",function(e,t,n,a,i,o,r,l){e._validator=i,e.data=t.data,e.isUpdatePhoneActive=!1,e.referenceCode=null,e.isNumberValidated=!1,e.isValidating=!1,e.form={HesapKodu:e.data.data.HesapKodu,GSM:e.data.data.GSMNo,securecode:null,pSessionID:null},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,pGSM:e.data.data.GSMNo,pVKN:null,pUnvan:e.data.data.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.data.data.sID};1==(11==e.data.data.HesapKodu.Length?0:1)?t.pVKN=e.data.data.HesapKodu:t.pTCKN=e.data.data.HesapKodu,t.HesapKodu=e.data.data.HesapKodu,n.post("prepare/activation",t,function(t){e.form.pSessionID=l.remove(t.return.JSONData),e.referenceCode=l.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,n.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verify=function(){e.verifying=!0;var i=angular.copy(e.form);n.post("check/sms",i,function(n){e.verifying=!1,!0===n.isSmsValid?(e.data.onSuccess(e.form.pSessionID),r(function(){t.dismiss("cancel")},100)):6==n.ResultCode?o.error(a.translate("ALERT_VERIFY_ERROR")):o.error(a.translate(n.Message))},function(){e.verifying=!1},null,null,!0)},e.changePhoneNumber=function(){e.changing=!0;var t=angular.copy(e.form);n.post("change/phone",t,function(t){0==t.ResultCode?(e.changing=!1,e.isUpdatePhoneActive=!1,e.data.data.pGenel.GSMNo=e.form.GSM):(e.changing=!1,o.error(t.Message))})},e.activateChangePhone=function(){e.form.GSM=null,e.isUpdatePhoneActive=!0},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.cancel=function(){t.dismiss("cancel"),n.post("o/sc/wlg",{},function(){},null,null,null,!0)},e.cancelChangePhoneNumber=function(){e.isUpdatePhoneActive=!1}}]),app.controller("SSLoginController",["$scope","$sce","$http","$rest","$state","$alert","$culture","$formValidations","$handcuff","$welcomeInit","$rootScope","vcRecaptchaService","$dateFormatter",function(e,t,n,a,i,o,r,l,s,u,c,d,m){e._validator=l,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isLoginButtonDisabled=!1,e.flex=null,e.data={languageList:null,langCode:null},e.phoneMaskOptions={maskDefinitions:{0:/[0]/,5:/[5]/}},e.form={username:null,password:null,HesapKodu:null,Unvan:null,GSM:null,securecode:null,pSessionID:null,FlexPassword:null,DogumTarihi:null},e.signing=!1,e.registerData=null,e.loginError=null,e.referenceCode=null,e.welcomeInit=u,e.onCreate=function(){a.get("welcome/login/content",{},function(t){e.loginContent=t.loginContent,e.isVerifyRCPT=t.isVerifyRCPT,null!==t.RCK.PK&&""!==t.RCK.PK&&void 0!==t.RCK.PK&&(t.RCK.PK=s.remove(t.RCK.PK)),e.isVerifyRCPT&&(e.captchaKeys=t.RCK,e.captchaKeys.PK?(e.PK=e.captchaKeys.PK,e.isViewReCaptcha=!0,e.isLoginButtonDisabled=!0):(e.isLoginButtonDisabled=!1,e.isViewReCaptcha=!1)),n.get("/auth/language",{}).then(function(t){e.data.languageList=t.data.languageList,e.data.langCode=t.data.langCode,e.welcomeInit.isSuccessData?e.initData():c.$on("$welcomeInit.onSuccess",function(){e.initData()})})})},e.initData=function(){var t=e.welcomeInit;e.data.languageList=t.getLanguageList(),e.data.langCode=t.getLangCode()},e.login=function(){e.signing=!0,e.loginError=null;var t=angular.copy(e.form);a.post("attempt/login",t,function(t){0===t.ResultCode&&(t.isSmsSend?(e.signing=!1,e.verifying=!1,e.isSmsSend=!0,e.form.pSessionID=t.JSONData,e.referenceCode=t.OtherData):(e.signing=!1,window.location.href="/panel/")),112233===t.ResultCode&&(e.signing=!1,e.verifying=!1,e.isRegisterRequired=!0,o.warning(r.translate("Üye kaydınız bulunamadı. Üye olmak için ihtiyacınız olan sigortayı seçin ve teklif alın."))),t.ResultCode>0&&112233!==t.ResultCode&&404!==t.ResultCode&&(e.loginError=t.Message,o.warning(r.translate(t.Message))),404==t.ResultCode&&0==t.isGSMValid&&(e.isViewEditGSMForm=!0,11==e.form.HesapKodu.length&&(e.form.Tip="personal"),9!=e.form.HesapKodu.length&&10!=e.form.HesapKodu.length||(e.form.Tip="company")),404==t.ResultCode&&0!==t.isGSMValid&&(e.signing=!1,e.verifying=!1,e.loginError="Üye olurken belirttiğiniz telefon numarasını girmelisiniz, lütfen tekrar deneyin. Telefon numaranızı değiştirdiyseniz lütfen bizimle iletişime geçin.",o.warning(r.translate("Üye olurken belirttiğiniz telefon numarasını girmelisiniz, lütfen tekrar deneyin. Telefon numaranızı değiştirdiyseniz lütfen bizimle iletişime geçin.")))},null,function(t){(t.data.code="USER_ALREADY_BLOCKED")&&(e.loginError=r.translate("USER_ALREADY_BLOCKED"),o.warning(r.translate("USER_ALREADY_BLOCKED")),e.signing=!1)})},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSM,pDogumTarihi:m.dateInputToService(e.form.DogumTarihi)};a.post("login/insured/update",n,function(n){0==n.return.HataKodu?(e.login(),e.isViewEditGSMForm=!1):(e.isViewEditGSMForm=!1,e.signing=!1,e.verifying=!1),"function"==typeof t&&t()},function(){e.isViewEditGSMForm=!0,e.signing=!1,e.verifying=!1})},e.register=function(){e.signing=!0;var t=angular.copy(e.form);a.post("attempt/register",t,function(t){0===t.ResultCode?t.isSmsSend?(e.signing=!1,e.verifying=!1,e.isSmsSend=!0):(e.signing=!1,window.location.href="/panel/"):o.error(r.translate("Hata Oluştu: ")+t.Message)})},e.verify=function(){e.verifying=!0;var t=angular.copy(e.form);a.post("check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?window.location.href="/panel/":6==t.ResultCode?o.error(r.translate("ALERT_VERIFY_ERROR")):o.error(r.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.changeLanguage=function(){n.get("/auth/changeLanguage/"+e.data.langCode).then(function(){})},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.submitLogin=function(t,n,a,i,o,r,l,s,u){e.isRegisterRequired?e.isSmsSend?e._validator.validateMultiForms(t,e.verify,n,a,i,o,r,l,s,u):e._validator.validateMultiForms(t,e.register,n,a,i,o,r,l,s,u):e.isSmsSend?e._validator.validateMultiForms(t,e.verify,n,a,i,o,r,l,s,u):e._validator.validateMultiForms(t,e.login,n,a,i,o,r,l,s,u)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return t.trustAsHtml(e)},e.cancel=function(){window.location.href="/insurer"},e.cbExpiration=function(){d.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(d.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};a.post("widget/recaptcha/check",t,function(t){t?e.isLoginButtonDisabled=!1:(e.isLoginButtonDisabled=!0,o.error(r.translate("reCAPTCHA doğrulanamadı..!")),d.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.validateFlexPassword=function(){if(null!==e.form.FlexPassword&&void 0!==e.form.FlexPassword&&""!==e.form.FlexPassword&&e.form.FlexPassword.length>3){var t={password:e.form.FlexPassword};e.isFlexPasswordInProgress=!0,a.post("flex/check",t,function(t){if(e.isFlexPasswordInProgress=!1,!0!==t.Success)return o.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir."),e.form.FlexPassword=null,e.isInsuredInfoRunning=!1,void(e.flex=null);e.flex=t},function(t){e.isFlexPasswordInProgress=!1,e.form.FlexPassword=null,e.flex=null,o.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir.")})}},e.onCreate()}]),app.controller("TopBarWelcomeController",["$scope","$modal","$http","$window","$languageService","$rootScope","$welcomeInit","$sce","$storage",function(e,t,n,a,i,o,r,l,s){e.isNoThemed=null,e.data={languageList:null,langCode:null},e.contact={name:null,surname:null,phone:null,message:null},e.onCreate=function(){e.welcomeInit.isSuccessData?e.initData():o.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){var t=r;e.data.languageList=t.getLanguageList(),e.data.langCode=t.getLangCode(),i.set(t.getLangCode()),angular.forEach(e.data.languageList,function(e){"tr-tr"===e.Value&&(e.Text="Türkçe")}),e.portalPanelSettings=t.getPanelSettings(),angular.forEach(e.menus,function(t){angular.forEach(e.menus,function(e){e.parent===t.id&&(t.isSubExists=!0)})}),e.menusTapBar=t.getMenus()},e.openLoginModal=function(){t.open("/content/views/login-modal.html","LoginModalController",function(e){e.data={}},"lg")},e.openContactModal=function(){t.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openQuickLinkModal=function(e){var n=e.modalSize?e.modalSize:"lg";null!==e.content&&""!==e.content&&t.open("/content/views/quick-link-modal.html","QuickLinkModalController",function(t){t.data={quickLinkItem:e}},n)},e.changeLanguage=function(t){e.data.langCode=t,n.get("/auth/changeLanguage/"+t).then(function(){i.set(t),s.set("isChangeLanguage",!0),a.location.reload(!0)})},e.redirectToUrl=function(e){null!==e.url&&void 0!==e.url&&""!==e.url&&a.open(e.url)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return l.trustAsHtml(e)},e.onCreate()}]),app.controller("WelcomeController",["$scope","$state","$rest","$welcomeInit","$rootScope","$location","$timeout","$culture","$sce","$window","$formValidations","$rootSettings","$insured","$storage","$auth","$modal","$dateFormatter","$lists","$filter","$boxesInit","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I){e._validator=c,t.go("welcome",{},{reload:!0}),f.set("Quotation",null),e.restConnector=n,e.isCookiePermission=!1,e.activeMenu=null,e.topActiveMenu=null,e.isTopMenuViewerActive=!1,e.isInsuranceMenuActive=!1,e.isDefaultBannerActive=!0,e.activeMenuForBanner=null,e.welcomeInit=a,e.bannerImage={isViewDescriptionTitleBanner:null,menuHoverId:0},e.bannerNavigation={next:!1,prev:!1},e.nextSlide=function(){e.bannerNavigation.next=!0},e.prevSlide=function(){e.bannerNavigation.prev=!0},e.onReadyMarquee=function(){e.marqueeReady=!0},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null},e.menuStyles={menuLocation:null,menuStyle:null,mobileMenuStyle:null,menuRadius:null,menuBackgroundColor:null,menuHoverColor:null,menuFontColor:null,menuAlign:null,menuViewLocation:null,isHeader:!1,isFixed:!1,isViewIcon:!0,subMenuEffect:null,subMenuBackgroundColor:null,subMenuAlign:null,isViewHamburgerMenu:!1,isViewIconMobile:!0},e.headerSettingsStyle=null,e.headerSettings=null,e.topHeaderSettings=null,e.filter={dateType:2,firstDate:moment(),lastDate:moment(),AnaBrans:null},e.activateView=function(t,n){e.activeView=t,"quotationDetail"!==t&&f.set("Quotation",null),n&&n()},e.checkCookiePermission=function(){return!0!==f.get("cookie_permission")&&(f.set("cookie_permission",!1),angular.element(document.querySelector("#cookie_permission")).removeClass("kt-display-none"),!0)},e.onCreate=function(){var t=o.search();null!==t&&""!==t&&void 0!==t&&null!==t.ref_fw&&""!==t.ref_fw&&void 0!==t.ref_fw&&n.get("reference/definition/"+t.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};f.set("Ref",t)}}),e.isLoggedIn=!1,m.set(null),m.setAccountId(null),m.setList(null),e.startInitData(function(){e.onInitPortalBox(function(){r(function(){n.post("wl/open",{},function(){},null,null,null,!0)})})})},e.onClickPreferences=function(e,t,n){g.open("/content/views/quotation/preferences-modal.html","Preferences.QuotationModalController",function(a){a.data={sirket:t,data:e,activeMenu:n}},"lg")},e.startInitData=function(t){e.welcomeInit.isSuccessData?e.welcomeInit.onCreateFilter({portalMenuId:-1,viewLocation:"WELCOME"},function(){if("/welcome"===o.path()||"/"===o.path()){var n=e.welcomeInit;e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks()}e.initData(t)}):i.$on("$welcomeInit.onSuccess",function(){e.welcomeInit.onCreateFilter({portalMenuId:-1,viewLocation:"WELCOME"},function(){if("/welcome"===o.path()||"/"===o.path()){var n=e.welcomeInit;e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.setSeoSettings(n.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks()}e.initData(t)})})},e.initData=function(t){var n=e.welcomeInit;e.styleSettings=n.getStyleSettings(),e.styleSettings.footerColor||(e.styleSettings.footerColor="#1A102B"),e.styleSettings.bottomFooterColor||(e.styleSettings.bottomFooterColor="#1A102B"),null!==e.styleSettings.fontUrl&&""!==e.styleSettings.fontUrl&&"DEFAULT"!==e.styleSettings.font&&(document.getElementById("fontUrl")||(document.getElementsByTagName("body")[0].style=e.styleSettings.fontFamily)),e.headerSettingsStyle=n.getHeaderStyle(),e.headerSettings=n.getHeaderSettings(),e.topHeaderSettings=n.getTopHeaderSettings(),e.headerControl=n.getHeaderControl(),e.topHeaderControl=n.getTopHeaderControl(),e.headerDetails={},angular.forEach(e.headerSettings,function(t){"DESKTOP"===t.resolution?"LOGO"===t.type&&(e.headerDetails.DESKTOP_LOGO=t):"TABLET"===t.resolution?"LOGO"===t.type&&(e.headerDetails.TABLET_LOGO=t):"MOBİLE"===t.resolution&&"LOGO"===t.type&&(e.headerDetails.MOBILE_LOGO=t)}),e.menus=[],angular.forEach(n.getMenus(),function(t){0===t.viewLocation?e.menus.push(t):(1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t))}),e.setMenuRedirectUrls(),e.menuProducts=n.getMenuProducts(),e.companies=n.getCompanies(),e.companyDetail=n.getCompanyDetail(),e.websiteSettings=n.getWebsiteSettings(),e.languageList=n.getLanguageList(),e.langCode=n.getLangCode(),e.portalPanelSettings=n.getPanelSettings(),e.tawk=n.getTawkSettings(),e.dynamicContent=n.getDynamicContent(),e.menuResponse=n.getMenuStyles(),e.setMenuStyles();try{"CLOSED"!==e.tawk.tawkWidgetOption&&null!==e.tawk.tawkWidgetCode&&""!==e.tawk.tawkWidgetCode&&void 0!==e.tawk.tawkWidgetCode&&e._setupTawk()}catch(e){}d.set(n.getRootSettings()),r(l.setReady,1),"function"==typeof t&&t()},e.setMenuRedirectUrls=function(){angular.forEach(e.menus,function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return e.displayUrl=e.url,void(e.displayTarget=e.urlType?"_self":e.urlType);if(e.portalPageId>0)return e.displayUrl="/page/"+e.portalMenuPage.url,void(e.displayTarget=e.urlType?"_self":e.urlType);if(null!==e.product&&void 0!==e.product&&""!==e.product){var t=parseInt(e.main_product);if(4==t||5==t)return e.displayUrl="/oto/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(10==t)return e.displayUrl="/dask/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(1==t||2==t||3==t)return e.displayUrl="/konut/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(12==t)return e.displayUrl="/saglik/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(7==t||8==t||11==t)return e.displayUrl="/diger/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(9==t)return e.displayUrl="/muhendislik/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);if(6==t)return e.displayUrl="/oto/diger/"+e.menuURL,void(e.displayTarget=e.urlType?"_self":e.urlType);e.displayUrl=""}})},e.setMenuStyles=function(){var t=null,n=o.path();angular.forEach(e.menuResponse,function(a){if("/welcome"===n||"/"===n){if("WELCOME"===a.location){t=a;var i=!0;angular.forEach(e.banners,function(e){-1===e.portalMenuId&&(i=!1)}),!1!==e.bannerSettings.WELCOME.isViewBannerDesktop&&!0!==i||(t.menuViewLocation="TOP-BANNER")}}else n.indexOf("/page/")>-1?"PAGES"===a.location&&(t=a):"QUATATION"===a.location&&(t=a)}),t&&(e.menuStyles.menuLocation=t.location,e.menuStyles.menuStyle=t.menuStyle,e.menuStyles.mobileMenuStyle=t.mobileMenuStyle,e.menuStyles.menuBackgroundColor=t.menuBackgroundColor,e.menuStyles.menuHoverColor=t.menuHoverColor,e.menuStyles.menuFontColor=t.menuFontColor,e.menuStyles.menuFontSize=t.menuFontSize+"px",e.menuStyles.isFixed=t.isFixed,e.menuStyles.isViewIcon=t.isViewIcon,e.menuStyles.isViewIconMobile=t.isViewIconMobile,e.menuStyles.menuAlign=t.menuAlign,e.menuStyles.menuViewLocation=t.menuViewLocation,e.menuStyles.isHeader=t.isHeader,e.menuStyles.isViewHamburgerMenu=t.isViewHamburgerMenu,e.menuStyles.subMenuEffect=t.subMenuEffect,e.menuStyles.subMenuBackgroundColor=t.subMenuBackgroundColor,e.menuStyles.subMenuAlign=t.subMenuAlign,"S01-DEFAULT"!==t.menuStyle&&null!==t.menuStyle||(e.menuStyles.menuRadius=".25rem !important;"),"S01-SQUARE"!==t.menuStyle&&null!==t.menuStyle||(e.menuStyles.menuRadius="0px !important;"),"S01-ROUND"!==t.menuStyle&&null!==t.menuStyle||(e.menuStyles.menuRadius=".35rem !important;"),!0!==t.isHeader&&"transparent"===t.menuBackgroundColor&&(e.menuStyles.menuBackgroundColor="#fff"))},e.setSeoSettings=function(e){var t=!1,n=!1,i=!1,o=document.getElementsByTagName("meta"),r=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],l=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(e,function(e){if(-1==e.portalMenuId){for(var a=0;a<o.length;a++)"robots"===o[a].getAttribute("name")&&0==e.isRobot&&(o[a].content="noindex, nofollow",n=!0),"description"===o[a].getAttribute("name")&&e.description&&""!==e.description&&(o[a].content=e.description,i=!0),"keywords"===o[a].getAttribute("name")&&e.keywords&&""!==e.keywords&&(o[a].content=e.keywords);angular.forEach(r,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}-1==e.portalMenuId&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,t=!0)}),t||(document.title=a.getPanelSettings()?a.getPanelSettings().siteName:"Polisoft Ltd");for(var s=0;s<o.length;s++)"robots"!==o[s].getAttribute("name")||n||(o[s].content="index, follow"),"description"!==o[s].getAttribute("name")||i||(o[s].content=a.getPanelSettings()?a.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var t=e.welcomeInit;"/welcome"!==o.path()&&"/"!==o.path()||(e.announcements=[],angular.forEach(t.getAnnouncements(),function(t){-1===t.portalMenuId&&e.announcements.push(t)}),e.onReadyMarquee())},i.$on("@SetAnnouncementList",function(t,n){if(n.length>0)e.announcements=n;else{var a=e.welcomeInit;e.announcements=[],angular.forEach(a.getAnnouncements(),function(t){-1===t.portalMenuId&&!0===t.isViewAllPages&&e.announcements.push(t)}),e.onReadyMarquee()}}),e.setQuickLinks=function(){var t=e.welcomeInit;"/welcome"!==o.path()&&"/"!==o.path()||(e.quickLinks=[],angular.forEach(t.getQuickLinks(),function(t){"WELCOME"!==t.viewLocation&&"ALL"!==t.viewLocation||e.quickLinks.push(t)}))},i.$on("@SetQuickLinkList",function(t,n){if(n.length>0)e.quickLinks=n;else{var a=e.welcomeInit;e.quickLinks=[],angular.forEach(a.getQuickLinks(),function(t){"WELCOME"!==t.viewLocation&&"ALL"!==t.viewLocation||e.quickLinks.push(t)}),e.onReadyMarquee()}}),e.onSetDropdown=function(t){e.setDropdown=t},e.resetActiveMenu=function(){e.activeMenu=null,$("#modal-menu").hide(),angular.element(document.getElementsByClassName("mobile-sub-menu")).removeClass("show")},e.setActiveMenu=function(t){if(e.activeMenu>0&&e.activeMenu===t.id)return void(e.activeMenu=null);angular.forEach(e.menus,function(n){n.parent===t.id&&(e.activeMenu=t.id)}),t.isSubExists||e.resetActiveMenu()},e.setTopActiveMenu=function(t){if(e.topActiveMenu>0&&e.topActiveMenu===t.id)return void(e.topActiveMenu=null);angular.forEach(e.menus,function(n){n.parent===t.id&&(e.topActiveMenu=t.id)}),t.isSubExists||e.resetActiveMenu()},e.changeRoute=function(t){e.activeMenuForBanner=t,e.resetActiveMenu()},e.redirectToUrl=function(e){null!==e.url&&void 0!==e.url&&""!==e.url&&u.open(e.url)},e.setInsuranceMenuActive=function(){e.isInsuranceMenuActive=!e.isInsuranceMenuActive},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return s.trustAsHtml(e)},e.getBoxTrustedHtml=function(e){return s.trustAsHtml(e)},e.onLogoClick=function(){t.go("welcome",{},{reload:!0})},e.validate=function(t,n,a,i,o,r){e._validator.validate(t,n,a,i,o,r)},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e._isInvalid=function(t){return e._validator.isInvalid(t)},e.logout=function(){m.set(null),m.setAccountId(null),m.setList(null)},e._setupTawk=function(t){if(e.tawk){var n={};if("CLOSED"===e.tawk.tawkWidgetOption)return;null!==e.tawk.tawkWidgetOption&&void 0!==e.tawk.tawkWidgetOption&&""!==e.tawk.tawkWidgetOption&&("GENERAL"===e.tawk.tawkWidgetOption?null!==e.tawk.tawkWidgetCode&&void 0!==e.tawk.tawkWidgetCode&&""!==e.tawk.tawkWidgetCode&&(n={default:e.tawk.tawkWidgetCode},e.configTawk(n)):"/welcome"===o.path()||"/"===o.path()?null!==e.tawk.tawkWidgetCode&&void 0!==e.tawk.tawkWidgetCode&&""!==e.tawk.tawkWidgetCode&&(n={default:e.tawk.tawkWidgetCode},e.configTawk(n)):null!==t&&void 0!==t&&""!==t?(n={default:t},e.configTawk(n)):void 0!==window.Tawk_API&&"function"==typeof window.Tawk_API.hideWidget&&window.Tawk_API.hideWidget())}},e.configTawk=function(e){void 0!==window.Tawk_API&&"function"==typeof window.Tawk_API.hideWidget&&window.Tawk_API.hideWidget();for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var a=t[n];"yes"===a.getAttribute("tawk")&&a.parentNode.removeChild(a)}for(var i in window)window.hasOwnProperty(i)&&(i.includes("tawk")||i.includes("Tawk"))&&delete window[i];delete window.$_Tawk,delete window.$_Tawk_AccountKey,delete window.$_Tawk_Unstable,delete window.$_Tawk_WidgetId,delete window.$__TawkEngine,delete window.$__TawkSocket,delete window.TawkClass,delete window.Tawk_API,r(function(){window.Tawk_API={},window.Tawk_LoadStart=new Date,function(){var t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.async=!0,t.src=e.default,t.charset="UTF-8",t.setAttribute("crossorigin","*"),t.setAttribute("tawk","yes"),n.parentNode.insertBefore(t,n)}()},50)},e.openContactModal=function(){g.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===a.OpenedAnnounceModals.indexOf("WELCOME")&&("/"===o.path()||"/welcome"===o.path())){var t=!1;angular.forEach(e.boxesData.defaultItems,function(e){-1==e.portalMenuId&&!0===e.isViewAnnounceModal&&(t=!0)}),t&&g.open("/content/views/announce-modal.html","AnnounceModalController",function(e){e.data={menuId:-1},a.OpenedAnnounceModals.push("WELCOME")},"lg")}},e.openAnnouncementModal=function(e){null!==e.description&&""!==e.description&&g.open("/content/views/announcement-header-modal.html","AnnouncementModalController",function(t){t.data={announcementItem:e}},"lg")},e.getBannerNavigationTop=function(e){return e?e/2+"px":"175px"},e.closeCookieConsent=function(){f.set("cookie_permission",!0)},e.openDataPolicyModal=function(){g.open("/content/views/data-policy-modal.html","DataPolicyModalController",function(t){t.data={data:e.dynamicContent,onSuccess:function(){e.closeCookieConsent()}}})},e.openPrivacyPolicyModal=function(){g.open("/content/views/privacy-policy-modal.html","PrivacyPolicyModalController",function(t){t.data={data:e.dynamicContent,onSuccess:function(){e.closeCookieConsent()}}})},window.onblur=function(){e.prevTitle=document.title,null!==e.portalPanelSettings.dinamicSiteTitle&&""!==e.portalPanelSettings.dinamicSiteTitle&&void 0!==e.portalPanelSettings.dinamicSiteTitle&&(document.title=e.portalPanelSettings.dinamicSiteTitle)},window.onfocus=function(){null!==e.prevTitle&&void 0!==e.prevTitle&&""!==e.prevTitle&&(document.title=e.prevTitle)},e.$watch("restConnector.current",function(t){0===t&&e.welcomeInit.isSuccessData&&r(function(){window.prerenderReady=!0},300)}),i.$on("@SetupTawkForCustomEndpoint",function(t,n){r(function(){"PRODUCT"===e.tawk.tawkWidgetOption&&e._setupTawk(n)},500)}),i.$on("@OnUpdateCount",function(t,a){var i={HesapKodu:a,pGrupGetir:e.quotationCriterias.groupAccount,endDatePreviousDay:e.quotationCriterias.endDatePreviousDay,endDateNextDay:e.quotationCriterias.endDateNextDay};n.post("sales/operations/counts",i,function(t){e.counts={TeklifAdet:parseInt(t.return.TeklifAdet),PoliceAdet:parseInt(t.return.PoliceAdet),PoliceTalebiAdet:parseInt(t.return.PoliceTalebiAdet),PoliceDuzenlendiAdet:parseInt(t.return.PoliceDuzenlendiAdet),PoliceTalepToplamAdet:parseInt(t.return.PoliceTalebiAdet)+parseInt(t.return.PoliceDuzenlendiAdet)}},null,null,null,!0)}),i.$on("$locationChangeSuccess",function(){e.activeMenuForBanner;"/welcome"===o.path()||"/"===o.path()?e.isTopMenuViewerActive=!1:(e.isTopMenuViewerActive=!0,e.closeCookieConsent()),e.onCreate()}),e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=h("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})};var S=function(t){var n=!1;return angular.forEach(e.boxRows,function(e){e.number===t&&(n=!0)}),n};e.onInitPortalBox=function(t){e.boxesInit=y.onCreate(-1),i.$on("$boxesInit.onSuccess",function(){e.boxesData=y.getBoxes(-1),e.boxRows=[],angular.forEach(e.boxesData.defaultItems,function(t){-1===t.portalMenuId&&t.rowNumber>0&&!1===S(t.rowNumber)&&e.boxRows.push({number:t.rowNumber,isFullwidth:t.isFullwidth})}),e.boxRows=h("orderBy")(e.boxRows,"number"),e.getCategories(e.boxesData),e.portalPanelSettings.isViewAnnouncePanel&&e.openAnnounceModal(),"function"==typeof t&&t()})},e.redirectHrefUrl=function(e){window.location.href=e},e.letsScrollToTop=function(){window.scrollTo({top:0,behavior:"smooth"})},e.getRefName=function(){var e=null,t=f.get("Ref");return null!==t&&""!==t&&void 0!==t&&void 0!==t.ad&&null!==t.ad&&""!==t.ad&&(e=t.ad),e},e.removeRefUser=function(){f.set("Ref",null),window.location.href="/"}}]),app.controller("WidgetsController",["$scope","$rootScope","$state","$modal","$rest","$form","$filter","$sce","$welcomeInit","$boxesInit","$timeout","$alert","$culture","$storage","$lists","$tia","$insured","vcRecaptchaService","$dateFormatter","$handcuff","$location",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I){e.isCustomerExists=null,e.isLoggedIn=!1,e.page=null,e.welcomeInit=s,e.isDefaultBannerActive=!0,e.portalPagesKeywords=null,e.portalMenusKeywords=null,e.isShowOnePage=!0,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isSendButtonDisabled=!1,e.isSelectBackwardDateTia=!1,e.serviceConnectionStatus=!0,e.bannerImage={isViewDescriptionTitleBanner:null,menuHoverId:0},e._tia={data:null},e.PK,e.data={aracMarkaList:[],aracModelList:[],modelYillariList:[],tarifeList:[],altTarifeList:[]},e.renewalBgList=[],e.handoverBgList=[],e.formParameters={isViewDateOfBirth:!1},e.onCreate=function(){e.getWidgetInfo(function(){e.welcomeInit.isSuccessData?e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalWidgetId:e.page.id,viewLocation:"WIDGET"},function(){var t=e.welcomeInit;e.banners=t.getBanners(),e.bannerSettings=t.getBannersSettings(),e.setSeoSettings(t.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks(),e.initData()})}):t.$on("$welcomeInit.onSuccess",function(){e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalWidgetId:e.page.id,viewLocation:"WIDGET"},function(){var t=e.welcomeInit;e.banners=t.getBanners(),e.bannerSettings=t.getBannersSettings(),e.setSeoSettings(t.getSeoSettings()),e.setAnnouncements(),e.setQuickLinks(),e.initData()})})})})},e.getWidgetInfo=function(a){""!==n.params.url&&null!==n.params.url||n.go("PageNotFound",{},{reload:!0});var o=I.search();null!==o&&""!==o&&void 0!==o&&null!==o.ref_fw&&""!==o.ref_fw&&void 0!==o.ref_fw&&i.get("reference/definition/"+o.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};f.set("Ref",t)}});var r={url:n.params.url};i.post("widgets/get",r,function(i){!i.PortalWidget.length>0&&n.go("PageNotFound",{},{reload:!0}),e.page=i.PortalWidget[0],null!==e.page.potaSuccessMessage&&""!==e.page.potaSuccessMessage&&void 0!==e.page.potaSuccessMessage||(e.page.potaSuccessMessage="Form kaydı başarılı."),null!==i.RCK.PK&&""!==i.RCK.PK&&void 0!==i.RCK.PK&&(i.RCK.PK=y.remove(i.RCK.PK)),e.captchaKeys=i.RCK,e.captchaKeys.PK?(e.PK=e.captchaKeys.PK,e.isViewReCaptcha=!0,e.isSendButtonDisabled=!0):(e.isSendButtonDisabled=!1,e.isViewReCaptcha=!1),e.renewalBgList.push({siteUrl:i.PortalWidget[0].siteUrl,logoLocation:i.PortalWidget[0].renewalBackground,scale:i.PortalWidget[0].renewalScale}),e.handoverBgList.push({siteUrl:i.PortalWidget[0].siteUrl,logoLocation:i.PortalWidget[0].handoverBackground,scale:i.PortalWidget[0].handoverScale}),null!=e.page.renewalBgHoverColor&&""!=e.page.renewalBgHoverColor&&void 0!=e.page.renewalBgHoverColor||(e.page.renewalBgHoverColor="rgba(0,96,255,0.70)"),null!=e.page.handoverBgHoverColor&&""!=e.page.handoverBgHoverColor&&void 0!=e.page.handoverBgHoverColor||(e.page.handoverBgHoverColor="rgba(0,96,255,0.70)");var o=I.search();o.notheme&&"true"==o.notheme&&(t.isNoThemed=!0),e.checkServiceConnection(),"function"==typeof a&&a()})},e.initData=function(){var t=s;if(t.getFormParameters()&&(e.formParameters=t.getFormParameters()),e.quotationCriterias=t.getQuotationCriterias(),e.quotationFormStyles=t.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var n=0
;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(n=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=n}e.menus=t.getMenus(),"contactUsPOTA"==e.page.widgetType&&(angular.forEach(e.menus,function(t){t.id==e.page.potaMenuId&&(e.ab=parseInt(t.main_product),e.arabrans=t.product,e.isSelectBackwardDateTia=t.isSelectBackwardDateTia)}),e.setWarrants());var a=angular.copy(e.menus);e.menus=[],angular.forEach(a,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onInitPortalBox(),e.onVehicleCreate()},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.page.id,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],u=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalPageId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(u,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalPageId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=s.getPanelSettings()?s.getPanelSettings().siteName:"Polisoft Ltd");for(var c=0;c<r.length;c++)"robots"!==r[c].getAttribute("name")||i||(r[c].content="index, follow"),"description"!==r[c].getAttribute("name")||o||(r[c].content=s.getPanelSettings()?s.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=s;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalPageId===e.page.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.reload=function(){n.reload()},e.trustAsHtml=function(e){return l.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return l.trustAsHtml(e)},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.onInitPortalBox=function(){e.boxesInit=u.onCreate(-3),t.$on("$boxesInit.onSuccess",function(){e.boxesData=u.getBoxes(-3),c(function(){e.getCategories(e.boxesData)},50)})},e.getCategories=function(t){angular.forEach(t.widgetBoxItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.widgetBoxItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=r("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.quickForm={modeSelection:null,HesapKodu:null,Plaka:null,RuhsatNo:null,GSMNo:null,EMail:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,Marka:null,ModelYili:null,Model:null,AracDetayTipi:null,KullanimTarzi:null,KullanimDetayi:null,MarkaTipi:null,AracKodu:null,DogumTarihi:null},e.form={Unvan:null,GSMNo:null,EMail:null,KVKK:!1,Agreement:!1,PrivacyPolicy:!1,_tia:{teminat:{},indirim:{},aciklama:{}}},e.isFirstActive=null,e.isViewDetailContent=!1,e.isSecondActive=null,e.activateQuickFormRenewal=function(){var t=s;e.isFirstActive=!0,e.isViewDetailContent=!0,e.isSecondActive=!1,e.quickForm={modeSelection:"MANUEL",HesapKodu:null,Plaka:null,RuhsatNo:null,GSMNo:null,EMail:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,Marka:null,ModelYili:null,Model:null,AracDetayTipi:null,KullanimTarzi:null,KullanimDetayi:null,MarkaTipi:null,AracKodu:null,DogumTarihi:null},null!==t.getDynamicContent()&&(e.dynamicContent=t.getDynamicContent(),e.dynamicContent.GCR&&(e.quickForm.KVKK=!1),e.dynamicContent.PCR&&(e.quickForm.PrivacyPolicy=!1),e.dynamicContent.CCR&&(e.quickForm.Agreement=!1))},e.activateQuickFormHandover=function(){var t=s;e.isFirstActive=!1,e.isViewDetailContent=!0,e.isSecondActive=!0,e.quickForm={modeSelection:"MANUEL",HesapKodu:null,Plaka:null,RuhsatNo:null,GSMNo:null,EMail:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,Marka:null,ModelYili:null,Model:null,AracDetayTipi:null,KullanimTarzi:null,KullanimDetayi:null,MarkaTipi:null,AracKodu:null,DogumTarihi:null},null!==t.getDynamicContent()&&(e.dynamicContent=t.getDynamicContent(),e.dynamicContent.GCR&&(e.quickForm.KVKK=!1),e.dynamicContent.PCR&&(e.quickForm.PrivacyPolicy=!1),e.dynamicContent.CCR&&(e.quickForm.Agreement=!1))},e.activateRenewalStatus=function(t){e.quickForm.modeSelection=t,null!==v.getActiveInsured()&&void 0!==v.getActiveInsured()&&(e.quickForm.GSMNo=v.getActiveInsured().GSMNo,e.quickForm.EMail=v.getActiveInsured().EMail,e.quickForm.HesapKodu=v.getActiveInsured().HesKod)},e.activateHandoverStatus=function(t){e.quickForm.modeSelection=t,null!==v.getActiveInsured()&&void 0!==v.getActiveInsured()&&(e.quickForm.GSMNo=v.getActiveInsured().GSMNo,e.quickForm.EMail=v.getActiveInsured().EMail,e.quickForm.HesapKodu=v.getActiveInsured().HesKod)},e.resetQuickFormView=function(){e.isFirstActive=null,e.isViewDetailContent=!1,e.isSecondActive=null},e.openConfirmationModal=function(t,n){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(a){a.data={contentType:t,onSuccess:function(a){"POTA"==n?e.form[t]=a:e.quickForm[t]=a,1==a&&"KVKK"==t&&"POTA"!==n&&e.onChangeGdpr()}}},"lg")},e.onChangeMarketing=function(t){c(function(){if(e.quickForm.Agreement){var n={Unvan:e.quickForm.Unvan,HesapKodu:e.quickForm.HesapKodu,GSMNo:e.quickForm.GSMNo,EMail:e.quickForm.EMail,IlKodu:e.quickForm.IlKodu,IlceKodu:e.quickForm.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeGdpr=function(t){c(function(){if(e.quickForm.KVKK){var n={Unvan:e.quickForm.Unvan,HesapKodu:e.quickForm.HesapKodu,GSMNo:e.quickForm.GSMNo,EMail:e.quickForm.EMail,IlKodu:e.quickForm.IlKodu,IlceKodu:e.quickForm.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangePotaGdpr=function(t){c(function(){if(e.quickForm.KVKK){var n={Unvan:e.form.Unvan,GSMNo:e.form.GSMNo,EMail:e.form.EMail,sID:e.sID};i.post("f/gd/wlg",n,function(){"function"==typeof t&&t()},null,null,null,!0)}},50)};var S=function(n){var a=new FormData;a.append("file",n);var i=new XMLHttpRequest;i.open("POST","/api/widgets/upload",!0),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){if(null!==i.responseText&&""!==i.responseText){var n=i.responseText.split("-");t.$apply(function(){e.quickForm.RuhsatNo=n[0],e.quickForm.Plaka=n[1],e.quickForm.HesapKodu=n[2],e.quickForm.detailsRequired=!0,null!==v.getActiveInsured()&&void 0!==v.getActiveInsured()&&(e.quickForm.GSMNo=v.getActiveInsured().GSMNo,e.quickForm.EMail=v.getActiveInsured().EMail)})}}else t.$apply(function(){e.quickForm={modeSelection:"MANUEL",HesapKodu:null,Plaka:null,RuhsatNo:null,GSMNo:null,EMail:null,KVKK:!0,Agreement:!0,Marka:null,ModelYili:null,Model:null,AracDetayTipi:null,KullanimTarzi:null,KullanimDetayi:null,MarkaTipi:null,AracKodu:null,DogumTarihi:null},null!==v.getActiveInsured()&&void 0!==v.getActiveInsured()&&(e.quickForm.GSMNo=v.getActiveInsured().GSMNo,e.quickForm.EMail=v.getActiveInsured().EMail,e.quickForm.HesapKodu=v.getActiveInsured().HesKod)}),d.error(m.translate("Ruhsat bilgileri okunamadı. Bilgileri lütfen elle girin."))},i.send(a)},C=document.getElementById("mobileUploader");angular.element(C).on("drop",function(){angular.forEach(angular.element(C)[0].files,function(e){S(e)})}),e.uploadQuickFormFile=function(){e.quickForm={modeSelection:"PHOTO",HesapKodu:null,Plaka:null,RuhsatNo:null,GSMNo:null,EMail:null,detailsRequired:!1,DogumTarihi:null};var t=document.getElementById("mobileUploader");angular.element(t).bind("change",function(){angular.forEach(angular.element(t)[0].files,function(e){S(e)})})},e.onDropFile=function(e,t){angular.forEach(t,function(e){S(e)})},e.openUploadBox=function(){var e=document.createElement("input");e.type="file",angular.element(e).bind("change",function(){angular.forEach(angular.element(e)[0].files,function(e){S(e)})}),angular.element(e).click()},e.createQuotation=function(){d.confirmHtmlContent(m.translate("Onayınızla sizin için en uygun fiyatları araştıracağız."),function(){e.isFirstActive&&(islemTipi="yenileme"),e.isSecondActive&&(islemTipi="devir");var t={identityNumber:e.quickForm.HesapKodu,pPlaka:e.quickForm.Plaka,pRuhsatAsbisNo:e.quickForm.RuhsatNo,islemTipi:islemTipi};if(null===e.quickForm.Plaka||""===e.quickForm.Plaka||void 0===e.quickForm.Plaka||void 0===e.quickForm.RuhsatNo||""===e.quickForm.RuhsatNo||null===e.quickForm.RuhsatNo)return void d.error(m.translate("Boş alanları doldurunuz..!"));i.post("webservice/kasko/trafik",t,function(t){if(e.quotationArray=[],e.isFirstActive){var n=moment().format("YYYY-MM-DD"),i=moment().add(30,"days").format("YYYY-MM-DD"),o=moment(t.kasko.ksktresult.return.Belgeler[0].BitisTarihi,"DD-MM-YYYY").format("YYYY-MM-DD"),r=moment(o).isBetween(n,i,"days",!0),l=moment(t.trafik.trftresult.return.Belgeler[0].BitisTarihi,"DD-MM-YYYY").format("YYYY-MM-DD");moment(l).isBetween(n,i,"days",!0)&&e.quotationArray.push({type:"trafik",arabrans:e.page.trafficMenuDetails.product,isProcessed:!1}),r&&e.quotationArray.push({type:"kasko",arabrans:e.page.cascoMenuDetails.product,isProcessed:!1}),0===e.quotationArray.length&&d.error(m.translate("Girilen Ruhsat ve Plaka KASKO ve TRAFİK Yenilemek için uygun değil..!")),1==e.isLoggedIn&&(e.isSmsSend=!0);var s={};s.pKN=e.quickForm.HesapKodu,s.HesapKodu=e.quickForm.HesapKodu,s.pPlaka=e.quickForm.Plaka,s.pRuhsatNo=e.quickForm.RuhsatNo,s.GSMNo=e.quickForm.GSMNo,s.EMail=e.quickForm.EMail,s.pDogumTarihi=h.dateInputToService(e.quickForm.DogumTarihi),s.AracDurumu=0,s.AnaBrans=null,s.AraBrans=null,s.pTeklifPDF=0,s.pBilgiFormuPDF=0,s.pAciklamalar=[],s.pIndirimler=[],s.pTeminatlar=[],s.sID=null;var u=f.get("Ref");null!==u&&""!==u&&void 0!==u&&void 0!==u.kod&&null!==u.kod&&""!==u.kod&&(s.pReferansPersonelKodu=u.kod),a.open("/content/views/sms-insured-modal.html","SMSVerifyQuickFormModalController",function(t){t.data={data:s,onSuccess:function(t){s.pSMSToken=t,e.finalizeQuotation(s)}}})}})})},e.finalizeQuotation=function(t){var n=e.quotationArray.length;angular.forEach(e.quotationArray,function(a,o){"trafik"===a.type&&(t.AnaBrans=5,t.AraBrans=a.arabrans,e.quotationArray.splice(o,1)),"kasko"===a.type&&(t.AnaBrans=4,t.AraBrans=a.arabrans,e.quotationArray.splice(o,1));var r={AnaBrans:t.AnaBrans,AraBrans:t.AraBrans};i.post("quotation/pre",r,function(o){t.sID=o.SID,e.sID=o.SID,i.post("quotation/kaydet",t,function(o){if(e.quotationArray.length>0)t.AnaBrans=null,t.AraBrans=null,null!=t.AnaBrans&&void 0!=t.AnaBrans||(t.AnaBrans=13),t.kvkkStatus=!0,t.privacyStatus=!0,e.finalizeQuotation(t);else if("kasko"===a.type||"trafik"===a.type&&1===n){f.set("Quotation",null);var r={pPoliID:o.href,pTip:1};0==o.ResultCode?0!==o.href&&"0"!==o.href&&null!==o.href&&""!==o.href?i.post("l/a/wlg",{},function(){f.set("Quotation",r),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):d.error(m.translate("Teklif Kaydedilemedi!")):null!==o.ResultMessage&&""!==o.ResultMessage?d.info(o.ResultMessage):d.info(m.translate("Ruhsat Numarası Hatalı..!")),e.isSaving=!1}},function(){e.isSaving=!1})})})},e.createHandoverQuotation=function(){d.confirmHtmlContent(m.translate("Onayınızla sizin için en uygun fiyatları araştıracağız."),function(){e.isFirstActive&&(islemTipi="yenileme"),e.isSecondActive&&(islemTipi="devir");var t={identityNumber:e.quickForm.HesapKodu,pPlaka:e.quickForm.Plaka,pRuhsatAsbisNo:e.quickForm.RuhsatNo,islemTipi:islemTipi};if(null===e.quickForm.Plaka||""===e.quickForm.Plaka||void 0===e.quickForm.Plaka||void 0===e.quickForm.RuhsatNo||""===e.quickForm.RuhsatNo||null===e.quickForm.RuhsatNo)return void d.error(m.translate("Boş alanları doldurunuz..!"));i.post("webservice/kasko/trafik",t,function(t){if(e.quotationArray=[],e.isSecondActive){0==t.trafik.eresult.return.HataKodu&&e.quotationArray.push({type:"trafik",arabrans:e.page.trafficMenuDetails.product,isProcessed:!1}),0==t.kasko.eresult.return.HataKodu&&e.quotationArray.push({type:"kasko",arabrans:e.page.cascoMenuDetails.product,isProcessed:!1}),0===e.quotationArray.length&&d.error(m.translate("Girilen Ruhsat ve Plaka Devir işlemi için uygun değil..!")),1==e.isLoggedIn&&(e.isSmsSend=!0);var n={};n.pKN=e.quickForm.HesapKodu,n.HesapKodu=e.quickForm.HesapKodu,n.pPlaka=e.quickForm.Plaka,n.pRuhsatNo=e.quickForm.RuhsatNo,n.GSMNo=e.quickForm.GSMNo,n.EMail=e.quickForm.EMail,n.pDogumTarihi=h.dateInputToService(e.quickForm.DogumTarihi),n.AracDurumu=1,n.AnaBrans=null,n.AraBrans=null,n.pTeklifPDF=0,n.pBilgiFormuPDF=0,n.pAciklamalar=[],n.pIndirimler=[],n.pTeminatlar=[],n.sID=null;var i=f.get("Ref");null!==i&&""!==i&&void 0!==i&&void 0!==i.kod&&null!==i.kod&&""!==i.kod&&(n.pReferansPersonelKodu=i.kod),n.pMotorNo=t.trafik.eresult.return.MotorNo,n.pSasiNo=t.trafik.eresult.return.SasiNo,n.Model=parseInt(t.trafik.eresult.return.ModelYili),e.quickForm.Model=parseInt(t.trafik.eresult.return.ModelYili),n.pTramerTarifeKodu=e.quickForm.KullanimTarzi,angular.forEach(e.data.aracMarkaList,function(n){n.marka==t.trafik.eresult.return.Marka&&(e.quickForm.Marka=n.markakodu,e.onChangeMarka(function(){e.onChangeModel()}))}),n.pAracKodu=e.quickForm.Marka+e.quickForm.Model,e.onChangeTramerTarifeKodu(function(){n.pAracKullanimDetayKodu=e.quickForm.KullanimDetayi,a.open("/content/views/sms-insured-modal.html","SMSVerifyQuickFormModalController",function(t){t.data={data:n,onSuccess:function(t){n.pSMSToken=t,e.finalizeHandoverQuotation(n)}}})})}})})},e.finalizeHandoverQuotation=function(t){var n=e.quotationArray.length;angular.forEach(e.quotationArray,function(a,o){"trafik"===a.type&&(t.AnaBrans=5,t.AraBrans=a.arabrans,e.quotationArray.splice(o,1)),"kasko"===a.type&&(t.AnaBrans=4,t.AraBrans=a.arabrans,e.quotationArray.splice(o,1));var r={AnaBrans:t.AnaBrans,AraBrans:t.AraBrans};i.post("quotation/pre",r,function(o){t.sID=o.SID,e.sID=o.SID,i.post("quotation/kaydet",t,function(o){if(e.quotationArray.length>0)t.AnaBrans=null,t.AraBrans=null,e.finalizeQuotation(t);else if("kasko"===a.type||"trafik"===a.type&&1===n){f.set("Quotation",null);var r={pPoliID:o.href,pTip:1};0==o.ResultCode?0!==o.href&&"0"!==o.href&&null!==o.href&&""!==o.href?i.post("l/a/wlg",{},function(){f.set("Quotation",r),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):d.error(m.translate("Teklif Kaydedilemedi!")):null!==o.ResultMessage&&""!==o.ResultMessage?d.info(o.ResultMessage):d.info(m.translate("Ruhsat Numarası Hatalı..!")),e.isSaving=!1}},function(){e.isSaving=!1})})})},e.createPOTAContact=function(){d.areYouSureWithMessage(m.translate("Kaydetme işlemini onaylıyor musunuz?"),function(){var t=o.build(e);t.pUnvan=e.form.Unvan,t.GSMNo=e.form.GSMNo,t.EMail=e.form.EMail,t.AnaBrans=e.ab,t.AraBrans=e.arabrans,e.isPotaSaving=!0,!0!==e.page.isViewKVKKConfirm&&(e.form.KVKK=!0),!0!==e.page.isViewPrivacyPolicyConfirm&&(e.form.PrivacyPolicy=!0);var a={AnaBrans:t.AnaBrans,AraBrans:t.AraBrans,kvkkStatus:e.form.KVKK,privacyStatus:e.form.PrivacyPolicy,pTC:"",Unvan:t.pUnvan,GSMNo:t.GSMNo,EMail:t.EMail,IlAdi:"",IlceAdi:"",pDogumTarihi:""};(null==a.AnaBrans||void 0==a.AnaBrans||isNaN(a.AnaBrans))&&(a.AnaBrans=13);var r=f.get("Ref");null!==r&&""!==r&&void 0!==r&&void 0!==r.kod&&null!==r.kod&&""!==r.kod&&(t.pReferansPersonelKodu=r.kod),i.post("quotation/pre",a,function(a){t.sID=a.SID,e.sID=a.SID,e.form.KVKK&&e.onChangePotaGdpr(),angular.forEach(e._tia.data,function(e){angular.forEach(e.elements,function(e){angular.forEach(t.pTeminatlar,function(t){t.TeminatID===e.Id&&(t.TeminatAdi=e.Adi,t.ListItem>0&&angular.forEach(e.ListItems,function(e){t.ListItem==e.ID&&(t.TeminatSecimi=e.Ad)}))})})}),(null==t.AnaBrans||void 0==t.AnaBrans||isNaN(t.AnaBrans))&&(t.AnaBrans=13),i.post("widget/pota/kaydet",t,function(a){if(f.set("Quotation",null),0==a.ResultCode){var o={pUnvan:e.form.Unvan,GSMNo:e.form.GSMNo,EMail:e.form.EMail,WidgetName:e.page.widgetName,pTeminatlar:t.pTeminatlar,potaWidgetId:e.page.id};i.post("widget/send/pota/mail",o,function(t){t?(e.isPotaSaving=!1,d.showHtmlContent(e.page.potaSuccessMessage,"success"),e.clearForm(),n.reload()):(d.showHtmlContent(e.page.potaSuccessMessage,"success"),e.clearForm(),n.reload())})}else d.info(a.ResultMessage),e.isPotaSaving=!1},function(){e.isPotaSaving=!1})})})},e.cbExpiration=function(){k.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(k.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isSendButtonDisabled=!1:(e.isSendButtonDisabled=!0,d.error(m.translate("reCAPTCHA doğrulanamadı..!")),k.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.clearForm=function(){e.form={Unvan:null,GSMNo:null,EMail:null,_tia:{teminat:{},indirim:{},aciklama:{}}}},e.onVehicleCreate=function(){i.get("vehicle/brands",{},function(t){e.data.aracMarkaList=t,e.data.modelYillariList=[{kod:null,ad:m.translate("SEÇİNİZ")}],e.data.aracMarkaList.unshift({markakodu:null,marka:m.translate("SEÇİNİZ")}),e.data.aracModelList.unshift({arackodu:null,tip:m.translate("SEÇİNİZ"),tipkodu:null}),e.data.tarifeList=p.getTarifeler().addSelection(),e.data.altTarifeList.unshift({kod:null,ad:m.translate("SEÇİNİZ")});for(var n=parseInt(moment().format("YYYY"));n>1970;n--)e.data.modelYillariList.push({kod:n,ad:n})})},e.onChangeMarka=function(t){var n={pMarkaKodu:e.quickForm.Marka,pModelYili:e.quickForm.ModelYili};i.get("vehicle/models",n,function(n){e.data.aracModelList=n,e.data.aracModelList.unshift({arackodu:null,tip:m.translate("SEÇİNİZ"),tipkodu:null}),"function"==typeof t&&t()},null,null,null,!0)},e.onChangeModelYili=function(){if(null!==e.quickForm.Marka){var t={pMarkaKodu:e.quickForm.Marka,pModelYili:e.quickForm.ModelYili};e.quickForm.Model=null,i.get("vehicle/models",t,function(t){e.data.aracModelList=t,e.data.aracModelList.unshift({arackodu:null,tip:m.translate("SEÇİNİZ"),tipkodu:null})},null,null,null,!0)}},e.onChangeTramerTarifeKodu=function(t){e.quickForm.AracDetayTipi=null,p.getSilent("ALT_TARIFE",e.quickForm.KullanimTarzi,null,function(n){e.data.altTarifeList=n.addSelection(),e.data.altTarifeList.length>0&&(e.quickForm.KullanimDetayi=e.data.altTarifeList[1].kod),"function"==typeof t&&t()},!0)},e.onChangeModel=function(){c(function(){angular.forEach(e.data.aracModelList,function(t){t.tipkodu===e.quickForm.MarkaTipi&&(e.quickForm.AracKodu=t.arackodu)}),e.quickForm.AracKodu},50)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),o.fetchTIA(e,{pAnaBrans:e.ab,pAraBrans:e.arabrans,pTarifeKodu:null},function(){"function"==typeof t&&t()}),o.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=$currency.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),g.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return l.trustAsHtml(e)},e.getBoxTrustedHtml=function(e){return l.trustAsHtml(e)},e.checkServiceConnection=function(t){i.get("check/connection",{},function(n){e.serviceConnectionStatus=n,"function"==typeof t&&t()})},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&d.info(e)},e.onCreate()}]),app.directive("actions",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/dashboard/actions.html"}}),app.directive("appSlider",["$bannerAnimate","$rest","$timeout",function(e,t,n){return{restrict:"A",link:function(a,i,o){var r=null,l=o.bannerid,s=o.menuid,u=o.bannerscale,c=o.bannerkategori,d=null,m={pushTransition:["push_left","push_right"]};a.bannerImageValues=[],a.isViewDefaultBanner=!1,a._init=function(o){var d={portalBannerId:parseInt(l),resolution:o};t.get("welcome/portalbanners/images",d,function(t){a.bannerImageValues=[],r=t;var o=[],l=!0;0==r.length&&(a.isViewDefaultBanner=!0,o=[{url:a.bannerSettings[c].defaultBackground,alt:""}],u="fill",a.bannerSettings[c].transition="fade",l=!1),angular.forEach(r,function(e,t){e.transition=null===e.transition?a.bannerSettings[c].transition:e.transition,e.duration=0===e.duration?a.bannerSettings[c].duration:e.duration,o.push({url:e.siteUrl+e.location,alt:e.title,transition:e.transition,duration:e.duration}),a.bannerImageValues.push({id:e.id,activeClass:0===t?"dot-banner-active":""})}),n(function(){"undefined"!=a.bannerSettings[c]&&($(i).backstretch(o,{transition:a.bannerSettings[c].transition,transitionDuration:a.bannerSettings[c].transitionDuration,duration:a.bannerSettings[c].duration,animateFirst:l,scale:u||"cover",paused:a.bannerSettings[c].isStopLoop}),-1!=s&&$(i).css({"z-index":"-1"}),-1==s&&$(i).css({"z-index":"1"}),r.length>0?n(function(){e.configureAnimate(r[0],a),e.configureBannerImageValue(r[0],a)},a.bannerSettings[c].transitionDuration):a.bannerImageDetailList=[])},50)})},$(i).on("backstretch.before",function(t,i,o){d&&(n.cancel(d),d=null),a.$$phase||r.length>0&&a.$apply(function(){"fade"!==r[o].transition?a.bannerImageDetailList=[]:(e.configureAnimate(r[o],a),e.configureBannerImageValue(r[o],a))})}),$(i).on("backstretch.after",function(t,o,l){d&&(n.cancel(d),d=null),a.$$phase||r.length>0&&a.$apply(function(){"fade"!==r[l].transition&&l===$(i).backstretch("current")&&(e.configureAnimate(r[l],a),e.configureBannerImageValue(r[l],a))})}),a.$watch("bannerNavigation.next",function(t){if(t){d&&(n.cancel(d),d=null);var o=$(i).backstretch("current");$(i).backstretch("next",{transition:f(o)}),o=$(i).backstretch("current"),a.bannerImageDetailList=[],"fade"!==r[o].transition?d=n(function(){e.configureAnimate(r[o],a),e.configureBannerImageValue(r[o],a)},a.bannerSettings[c].transitionDuration):(e.configureAnimate(r[o],a),e.configureBannerImageValue(r[o],a)),a.bannerNavigation.next=!1,angular.forEach(a.bannerImageValues,function(e,t){e.activeClass=o==t?"dot-banner-active":""})}}),a.$watch("bannerNavigation.prev",function(t){if(t){d&&(n.cancel(d),d=null);var o=$(i).backstretch("current");$(i).backstretch("prev",{transition:p(o)}),o=$(i).backstretch("current"),a.bannerImageDetailList=[],"fade"!==r[o].transition?d=n(function(){e.configureAnimate(r[o],a),e.configureBannerImageValue(r[o],a)},a.bannerSettings[c].transitionDuration):(e.configureAnimate(r[o],a),e.configureBannerImageValue(r[o],a)),a.bannerNavigation.prev=!1,angular.forEach(a.bannerImageValues,function(e,t){e.activeClass=o==t?"dot-banner-active":""})}}),a.currentSlide=function(t){d&&(n.cancel(d),d=null),$(i).backstretch("show",t,{transition:f(t)}),a.bannerImageDetailList=[],"fade"!==r[t].transition?d=n(function(){e.configureAnimate(r[t],a),e.configureBannerImageValue(r[t],a)},a.bannerSettings[c].transitionDuration):(e.configureAnimate(r[t],a),e.configureBannerImageValue(r[t],a)),angular.forEach(a.bannerImageValues,function(e,n){e.activeClass=t==n?"dot-banner-active":""})};var f=function(e){return-1!==m.pushTransition.indexOf(r[e].transition)?"push_left":r[e].transition},p=function(e){return-1!==m.pushTransition.indexOf(r[e].transition)?"push_right":r[e].transition};a.$watch("generalResolution",function(){a._init(a.generalResolution)})}}}]),app.directive("appSliderBasic",function(){return{restrict:"A",link:function(e,t,n){var a=n.logolocation,i=n.siteurl,o=n.bannerscale;e._init=function(){var e=i+a;e&&$(t).backstretch(e,{scale:o||"cover"})},e._init()}}}),app.directive("boxAboveBanner",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/box-above-banner.html"}}),app.directive("boxDashboard",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/box-dashboard.html"}}),app.directive("boxSlider",["$rest","$timeout","$welcomeInit",function(e,t,n){return{restrict:"A",link:function(a,i,o){var r=o.boxid,l=o.boxtitle,s=o.bannerkategori;a._init=function(){a.boxesBannerSettings=n.getBoxesBannersSettings(),t(function(){e.get("welcome/portalboxesbanners/images/"+r,{},function(e){var t=null;e.length>0&&(t=[],angular.forEach(e,function(e){t.push({url:e.siteUrl+e.location,alt:l,transition:null===e.transition?a.boxesBannerSettings[s].transition:e.transition})}),$(i).backstretch(t,{transition:a.boxesBannerSettings[s].transition,transitionDuration:a.boxesBannerSettings[s].transitionDuration,duration:a.boxesBannerSettings[s].duration,animateFirst:1!==e.length,paused:a.boxesBannerSettings[s].isStopLoop}))},null,null,null,!0)},20)},a._init()}}}]),app.directive("card",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/dashboard/card.html"}}),app.directive("clickOutside",["$document","$parse","$timeout",function(e,t,n){return{restrict:"A",link:function(a,i,o){n(function(){function n(e){if(!angular.element(i).hasClass("ng-hide")){var n,r=0;if(e&&e.target){for(n=e.target;n;n=n.parentNode){var u=n.id,c=n.className,d=s.length;for(c&&void 0!==c.baseVal&&(c=c.baseVal),r=0;r<d;r++)if(void 0!==u&&u===s[r]||c&&c===s[r])return}a.$apply(function(){(l=t(o.clickOutside))(a)})}}}function r(){return"ontouchstart"in window||navigator.maxTouchPoints}var l,s=void 0!==o.outsideIfNot?o.outsideIfNot.replace(", ",",").split(","):[];void 0!==o.id&&s.push(o.id),r()&&e.on("touchstart",n),e.on("click",n),a.$on("$destroy",function(){r()&&e.off("touchstart",n),e.off("click",n)})})}}}]),app.directive("closeTooltip",function(){return{restrict:"A",link:function(e,t){t.on("click",function(){angular.element(document.getElementsByClassName("tooltip")).addClass("invisible")}),t.on("mouseenter",function(){angular.element(document.getElementsByClassName("tooltip")).removeClass("invisible")})}}}),app.directive("companyBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/company-box.html"}}),app.directive("contents",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/dashboard/contents.html"}}),app.directive("dashboardBanner",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/dashboard/banner.html"}}),app.directive("dashboardBoxes",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/dashboard/boxes.html"}}),app.directive("defaultBanner",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/default-banner.html"}}),app.directive("dynamicController",["$compile",function(e){return{restrict:"A",link:function(t,n,a){var i=a.dynamicController.split("."),o=i[0],r=a.dynamicController.replace(o+".","");angular.element(document).find(o).attr("ng-controller")!==r&&(n.removeAttr("dynamic-controller"),n.attr("ng-controller",r),e(n)(t))}}}]),app.directive("fileDropArea",["$compile",function(e){return{restrict:"A",scope:{onDrop:"=",onClick:"=",data:"="},link:function(t,n){n.html('<div class="file-drop-box" ng-class="{\'on-it\': onIt }" ng-click="onClick(data);"> <h3 cursor-pointer class="dropzone-msg-title text-center mt-2">{{ \'Dosyalarınızı yüklemek için buraya sürükleyip bırakın veya tıklayın.\' | translate }} </h3></div > '),n.removeAttr("file-drop-area"),t.onIt=!1,n.bind("dragover",function(e){t.$apply(function(){t.onIt=!0}),e.preventDefault()}),n.bind("dragleave",function(){t.$apply(function(){t.onIt=!1})}),n.bind("drop",function(e){t.$apply(function(){t.onIt=!1}),t.onDrop(t.data,e.originalEvent.dataTransfer.files),e.preventDefault(),e.stopPropagation()}),e(n)(t)}}}]),app.directive("formBottomBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-bottom-box.html"}}),app.directive("formCompareBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-compare-box.html"}}),app.directive("formContactBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-contact-box.html"}}),app.directive("formContactBoxS1",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-contact-box-s1.html"}}),app.directive("formCrossTableBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-cross-table-box.html"}}),app.directive("formDescriptions",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-descriptions.html"}}),app.directive("formFinalbottomBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-finalbottom-box.html"}}),app.directive("formFinaltopBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-finaltop-box.html"}}),app.directive("formInsideBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-inside-box.html"}}),app.directive("formPageBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-page-box.html"}}),app.directive("formPageCategories",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-page-categories.html"}}),app.directive("formPaymentBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-payment-box.html"}}),app.factory("$handcuff",["$crypto",function(e){var t={};return t.remove=function(t){return null!==t&&""!==t&&void 0!==t&&(t=e.decrypt(t)),t},t.fasten=function(t){return null!==t&&""!==t&&void 0!==t&&(t=e.encrypt(t)),t},t}]),
app.directive("insuredCardSection",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/dashboard/insured-card-section.html"}}),app.directive("miniCard",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/quotation/mini-card.html"}}),app.directive("navigationArrowRemover",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/navigation-arrow-remover.html"}}),app.directive("ngEnter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(n.ngEnter)}),t.preventDefault())})}}),app.directive("poliMarquee",function(){return{restrict:"A",link:function(e,t){e._init=function(){$(document).ready(function(){$(t).liMarquee({direction:"left",loop:-1,scrolldelay:500,scrollamount:90,circular:!1,hoverstop:!0,drag:!1})})},e.$watch("marqueeReady",function(){e.marqueeReady&&e._init()})}}}),app.directive("poliRadio",["$timeout","$rootScope",function(e,t){return{restrict:"A",require:"ngModel",link:function(n,a,i,o){return e(function(){var e;e=i.value,n.$watch(i.ngModel,function(){$(a).iCheck("update")});var r="i"+i.type+"_flat-blue";return void 0!==i.color&&(r="i"+i.type+"_flat-"+i.color),$(a).iCheck({checkboxClass:r,radioClass:r}).on("ifChanged",function(r){var l={itemType:i.itemType,param1:i.param1,value:r.target.checked};if(t.$broadcast("icheck.onClick",l),"checkbox"===$(a).attr("type")&&i.ngModel&&n.$apply(function(){return o.$setViewValue(r.target.checked)}),"radio"===$(a).attr("type")&&i.ngModel)return n.$apply(function(){return o.$setViewValue(e)})})})}}}]),app.directive("poliSelector",["$timeout",function(e){return{restrict:"AC",require:"ngModel",link:function(t,n,a){var i=a.styleid;"form-control-sm"===i&&(i="form-control-custom-sm input-sm"),e(function(){n.select2({width:"100%",containerCssClass:i,selectionCssClass:i}),n.select2Initialized=!0}),$(document).on("select2:open",function(){e(function(){document.querySelector(".select2-search__field").focus()})}),$(document).on("select2:close",function(){});var o=function(){n.select2Initialized&&e(function(){n.trigger("change.select2")})},r=function(){n.select2Initialized&&e(function(){n.select2("destroy"),n.select2({width:"100%",containerCssClass:i,selectionCssClass:i}),"form-control-lg"===i&&($(n),$(".select2-selection__rendered").addClass("p-0"))})};if(t.$watch(a.ngModel,o),a.ngOptions){var l=a.ngOptions.match(/ in ([^ ]*)/)[1];t.$watch(l,r)}a.ngDisabled&&t.$watch(a.ngDisabled,o),t.$watch(function(){return n.attr("class")},function(t){n.select2Initialized&&e(-1!==t.indexOf("form-error")?function(){n.select2({width:"100%",containerCssClass:"form-error shake",selectionCssClass:"form-error shake"}),n.select2Initialized=!0,"form-control-lg"===i&&($(n),$(".select2-selection").addClass("form-control-lg input-lg"),$(n),$(".select2-selection__rendered").addClass("p-0")),"form-control-custom-sm"===i&&($(n),$(".select2-selection").addClass("form-control-custom-sm input-sm"))}:function(){n.select2({width:"100%",containerCssClass:i,selectionCssClass:i}),n.select2Initialized=!0,"form-control-lg"===i&&($(n),$(".select2-selection__rendered").addClass("p-0"))})})}}}]),app.directive("poliTicker",["$timeout",function(e){return{restrict:"A",link:function(t,n,a){t._init=function(){e(function(){$(document).ready(function(){$(n).ticker({speed:100,pauseOnHover:!0,item:"."+a.poliTicker,displayType:"fade"}).data("ticker")})},50)},t.$watch("companies",function(){t._init()})}}}]),app.directive("quotationActions",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/quotation/actions.html"}}),app.directive("quotationCard",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/quotation/card.html"}}),app.directive("quotationDetail",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/quotation/detail.html"}}),app.directive("resolutionControl",["$window",function(e){return{restrict:"A",link:function(t){function n(e){var t="DESKTOP";return e<768&&(t="MOBILE"),e>767&&e<1024&&(t="TABLET"),t}t.generalResolution=n(e.innerWidth),angular.element(e).bind("resize",function(){t.generalResolution=n(e.innerWidth),t.$digest()})}}}]),app.directive("specificBanner",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/specific-banner.html"}}),app.directive("specificPageBanner",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/specific-page-banner.html"}}),app.directive("specificTopbar",function(){return{restrict:"E",templateUrl:"/content/views/directives/specific-topbar.html"}}),app.directive("specificWidgetBanner",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/specific-widget-banner.html"}}),app.directive("textToCanvas",["$compile","$timeout","$window",function(e,t,n){return{restrict:"E",link:function(n,a,i){n._init=function(){var t=i.font;n.drawCanvas=function(){var o=document.createElement("canvas"),r=o.getContext("2d");r.font=t+"px  Raleway, sans-serif",r.textAlign="left",r.fillText(i.data,0,parseInt(t)-1),o.width=r.measureText(i.data).width,o.height=parseInt(t)+2,r.font=t+"px  Raleway, sans-serif",r.textAlign="left",r.fillText(i.data,0,parseInt(t)-1),a.append(e(o)(n))},n.drawCanvas()},t(function(){n._init()},1e3)}}}]),app.directive("widgetHandoverBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/widget-handover-box.html"}}),app.directive("widgetRenewalBox",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/widget-renewal-box.html"}}),app.filter("countDown",[function(){return function(e){return new Date(1970,0,1).setSeconds(e)}}]),app.filter("firstWord",function(){return function(e){return e?(e=e.split(" "),e[0]):e}}),app.filter("islemListesi",["$auth",function(e){return function(t){var n="";return angular.forEach(e.get("IslemListesiDoList"),function(e){parseInt(e.kod)===t&&(n=e.ad)}),n}}]),app.filter("serviceCurrency",["$filter",function(e){return function(t){return e("currency")(t,"",2)}}]),app.filter("smartLimitTo",function(){return function(e,t){var n="";return e.length>t&&(n="..."),e.substr(0,t)+n}}),app.filter("tarifeKodu",["$lists",function(e){return function(t){var n=t;return angular.forEach(e.getTarifeler(),function(e){e.kod===parseInt(t)&&(n=e.ad)}),n}}]),app.filter("tiaDate",function(){return function(e){var t=moment(e,"DDMMYYYY");return t._isValid?t.format("DD.MM.YYYY"):null}}),app.filter("trustHtml",["$sce",function(e){return function(t){if(null!==t&&void 0!==t&&""!==t)return e.trustAsHtml(t)}}]),app.factory("$alert",["$culture","$rootScope",function(e,t){var n={};return n.error=function(t,n){e.whenReady(function(){swal({title:e.translate("Hata"),text:t,type:"error",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){e.value&&"function"==typeof n&&n()})})},n.success=function(t){e.whenReady(function(){var n=e.translate("ALERT_SUCCESS"),a=null;t&&(a=t),swal({title:e.translate(n),text:a,type:"success",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")})})},n.flexError=function(t){e.whenReady(function(){var n=e.translate("Opet Üyeliğiniz Bulunamadı..!"),a=null;t&&(a=t),swal({title:e.translate(n),html:a,type:"error",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")})})},n.successConfirmation=function(t,n){e.whenReady(function(){var a=e.translate("ALERT_SUCCESS"),i=null;t&&(i=t),swal({title:e.translate(a),text:i,type:"success",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){e.value&&"function"==typeof n&&n()})})},n.info=function(t){e.whenReady(function(){swal({title:e.translate("Bilgi"),text:t,type:"info",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")})})},n.warning=function(t){e.whenReady(function(){swal({title:e.translate("Uyarı"),text:t,type:"warning",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")})})},n.deleteConfirmation=function(t){e.whenReady(function(){swal({html:'<font size="3"><b>'+e.translate("ALERT_CONFIRM_DELETE")+"</b></font>",type:"warning",showCancelButton:!0,confirmButtonColor:"#c75757",cancelButtonColor:"#e0e6eb",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){e.value&&t()})})},n.warningConfirmation=function(t,n){e.whenReady(function(){swal({html:'<font size="3"><b>'+t+"</b></font>",type:"warning",showCancelButton:!0,confirmButtonColor:"#18a689",cancelButtonColor:"#e0e6eb",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){e.value&&n()})})},n.areYouSureWithMessage=function(n,a,i){e.whenReady(function(){swal({html:'<font size="3"><b>'+n+"</b></font>",type:"warning",showCancelButton:!0,confirmButtonColor:"#18a689",cancelButtonColor:"#e0e6eb",confirmButtonText:e.translate("ALERT_YES"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){if(e.value)return void t.$apply(function(){a()});"function"==typeof i&&t.$apply(function(){i()})})})},n.areYouSureWithMessageOk=function(n,a,i){e.whenReady(function(){swal({html:'<font size="3"><b>'+n+"</b></font>",type:"warning",showCancelButton:!0,confirmButtonColor:"#18a689",cancelButtonColor:"#e0e6eb",confirmButtonText:e.translate("Devam Et"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){if(e.value)return void t.$apply(function(){a()});"function"==typeof i&&t.$apply(function(){i()})})})},n.confirm=function(n,a,i){e.whenReady(function(){swal({html:'<font size="3"><b>'+n+"</b></font>",type:"success",showCancelButton:!0,confirmButtonColor:"#18a689",cancelButtonColor:"#e0e6eb",confirmButtonText:e.translate("ALERT_CONFIRMATION"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){if(e.value)return void t.$apply(function(){a()});"function"==typeof i&&t.$apply(function(){i()})})})},n.confirmHtmlContent=function(n,a,i){e.whenReady(function(){swal({html:n,type:"success",showCancelButton:!0,confirmButtonColor:"#18a689",cancelButtonColor:"#e0e6eb",confirmButtonText:e.translate("ALERT_CONFIRMATION"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){if(e.value)return void t.$apply(function(){a()});"function"==typeof i&&t.$apply(function(){i()})})})},n.showHtmlContent=function(t,n){e.whenReady(function(){swal({html:t,type:n,confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")})})},n.downloadConfirm=function(n,a,i){e.whenReady(function(){swal({html:'<font size="3"><b>'+n+"</b></font>",type:"success",showCancelButton:!0,confirmButtonColor:"#18a689",cancelButtonColor:"#e0e6eb",confirmButtonText:e.translate("DOSYAYI İNDİR"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){if(e.value)return void t.$apply(function(){a()});"function"==typeof i&&t.$apply(function(){i()})})})},n.areYouSure=function(t,a){n.areYouSureWithMessage(e.translate("ALERT_CONFIRM"),t,a)},n.saveConfirmation=function(t){e.whenReady(function(){swal({html:'<font size="3"><b>'+e.translate("ALERT_CONFIRM_SAVE")+"</b></font>",type:"warning",showCancelButton:!0,confirmButtonColor:"#18a689",cancelButtonColor:"#d33",confirmButtonText:e.translate("ALERT_OK"),cancelButtonText:e.translate("ALERT_CANCEL")}).then(function(e){e.value&&t()})})},n.deleted=function(){e.whenReady(function(){swal(e.translate("ALERT_DELETED")+"!",e.translate("ALERT_RECORD_DELETED"),"success")})},n}]),app.factory("$auth",function(){var e={callbacks:[]},t=null;return e.set=function(n){t=n,angular.forEach(n.SigortaliTipiList,function(e){e.kod=parseInt(e.kod)}),angular.forEach(e.callbacks,function(e){e()})},e.setMenus=function(n){t.Menus=n,angular.forEach(e.callbacks,function(e){e()})},e.isReady=function(){return null!==t},e.whenReady=function(n){if(null!==t)return n();e.callbacks.push(n)},e.get=function(e){if(null===t||void 0===t[e])throw"$auth.whenReady() metodunu kullanılmamış: "+e;return angular.copy(t[e])},e.getAdresTipiList=function(){return e.get("AdresTipiList")},e.getCredentials=function(){return e.get("Credentials")},e.getDokumanTuruList=function(){return e.get("DokumanTuruList")},e.getDuzenlemeNedeniList=function(){return e.get("DuzenlemeNedeniList")},e.getGrupList=function(){return e.get("GrupList")},e.getGrupReferansList=function(){return e.get("GrupReferansList")},e.getIslemListesiDoList=function(){return e.get("IslemListesiDoList")},e.getIslemListesiList=function(){return e.get("IslemListesiList")},e.getJobUsers=function(){return e.get("JobUsers")},e.getKullaniciList=function(){return e.get("KullaniciList")},e.getListeGrupList=function(){return e.get("ListeGrupList")},e.getMenus=function(){return e.get("Menus")},e.getMeslekList=function(){return e.get("MeslekList")},e.getNotGruplari=function(){return e.get("NotGruplari")},e.getOzelKodList=function(){return e.get("OzelKodList")},e.getPbsTeknikPersonelList=function(){return e.get("PbsTeknikPersonelList")},e.getPoliceDuzenlendiList=function(){return e.get("PoliceDuzenlendiList")},e.getReferansList=function(){return e.get("ReferansList")},e.getSatisSekliList=function(){return e.get("SatisSekliList")},e.getSehirList=function(){return e.get("SehirList")},e.getSektorList=function(){return e.get("SektorList")},e.getSigortaliYakinlikList=function(){return e.get("SigortaliYakinlikList")},e.getSirketList=function(){return e.get("SirketList")},e.getSmsSablon=function(){return e.get("SmsSablon")},e.getSmsTip=function(){return e.get("SmsTip")},e.getSonDurumList=function(){return e.get("SonDurumList")},e.getSubeList=function(){return e.get("SubeList")},e.getTahsilatSekliList=function(){return e.get("TahsilatSekliList")},e.getTalepTurleri=function(){return e.get("TalepTurleri")},e.getTaliList=function(){return e.get("TaliList")},e.getAnaTaliList=function(){return e.get("AnaTaliList")},e.getTaliYetkiList=function(){return e.get("TaliYetkiList")},e.getTelefonTipiList=function(){return e.get("TelefonTipiList")},e.getTemsilciList=function(){return e.get("TemsilciList")},e.getTeslimatSekliList=function(){return e.get("TeslimatSekliList")},e.getTvNedenList=function(){return e.get("TvNedenList")},e.getAraBransFullList=function(){return e.get("AraBransFullList")},e.getTaliGruplari=function(){return e.get("TaliGruplari")},e.getBorcKapamaTipi=function(){return e.get("BorcKapamaTipi")},e}),app.factory("$bannerAnimate",["$timeout",function(e){var t={promise:null};return t.configureBannerImageValue=function(e,t){t.bannerImage.menuHoverId=e.menuHoverId,t.bannerImage.isViewDescriptionTitleBanner=e.isViewDescriptionTitleBanner},t.configureAnimate=function(n,a){t.promise&&(e.cancel(t.promise),t.promise=null),a.bannerImageDetailList=[],angular.forEach(n.ImageDetails,function(t){if(t.animateDelay=t.delay/1e3,a.bannerImageDetailList.push(t),e(function(){var e="#banner-image-detail-"+t.uniqueCode;$(e).css({opacity:"1"}),$(e).css({display:"block"});try{document.getElementById(e)[0].play()}catch(e){}},t.delay),t.isActiveDisappearTime){var i=0!==t.disappearTime?t.disappearTime:n.duration;e(function(){var e="#banner-image-detail-"+t.uniqueCode;$(e).css({display:"none"});try{document.getElementById(e)[0].pause()}catch(e){}},i)}})},t}]),app.factory("$culture",["$translate",function(e){var t={},n=!1,a=[];return t.setReady=function(){n||(n=!0,angular.forEach(a,function(e){e()}))},t.whenReady=function(e){if(n)return e();a.push(e)},t.translate=function(n){var a=e.use();if(void 0===t[a]){var i=_translateProvider.translations();void 0!==i&&null!==i&&void 0!==i[a]&&(t[a]=i[a])}return void 0!==t[a]&&void 0!==t[a][n]?t[a][n]:n},t.translateWithArgument=function(e,n){e=t.translate(e);var a=0;return angular.forEach(n,function(t){e=e.replace("{"+a+++"}",t)}),e},t.getActiveLanguage=function(){return e.use()},t}]),app.factory("$currency",["$rootSettings",function(e){var t={};return e.whenReady(function(){t.format=e.getByPath("forms.inputs.currency")}),t.inputToFloat=function(e){var n=parseFloat(t.toService(e));return isNaN(n)?0:n},t.toService=function(e){return void 0===e||null===e?e:e.toString().replace(t.format.groupSeparator,"").replace(t.format.groupSeparator,"").replace(t.format.groupSeparator,"").replace(t.format.groupSeparator,"").replace(t.format.radixPoint,".")},t.toInput=function(e){return void 0===e||null===e?e:(e=parseFloat(e.toString().replace(",",".")),e.toString().replace(".",t.format.radixPoint))},t}]),app.factory("$dateFormatter",["$validations",function(e){var t={};return t.serviceToService=function(e){var t=moment(e,"D-M-YYYY");return t._isValid?t.format("DDMMYYYY"):null},t.vehicleServiceToInput=function(e){var t=moment(e,"D-M-YYYY");return t._isValid?t.format("DD-MM-YYYY"):null},t.toInput=function(t,n){var a="DD-MM-YYYY",i=e.getByKey(t);null!==i.dateDisplay&&void 0!==i.dateDisplay&&i.dateDisplay.toString().length>0&&(a=i.dateDisplay);var o=moment(n,"D-M-YYYY");return o._isValid?o.format(a):null},t.toDateInput=function(e){var t=moment(e,"DD.MM.YYYY");return t._isValid?t.format("DD.MM.YYYY"):null},t.identityServiceToInput=function(e){var t=moment(e,"DD.MM.YYYY");return t._isValid?t.format("DD-MM-YYYY"):null},t.wsServiceToInput=function(e){var t=moment(e,"D.M.YYYY");return t._isValid?t.format("DD.MM.YYYY"):null},t.inputToMoment=function(t,n){var a="DD-MM-YYYY",i=e.getByKey(t);return null!==i.dateDisplay&&void 0!==i.dateDisplay&&i.dateDisplay.toString().length>0&&(a=i.dateDisplay),moment(n,a)},t.momentToInput=function(t,n){var a="DD-MM-YYYY",i=e.getByKey(n);return null!==i.dateDisplay&&void 0!==i.dateDisplay&&i.dateDisplay.toString().length>0&&(a=i.dateDisplay),t.format(a)},t.momentToService=function(e){return e._isValid?e.format("DDMMYYYY"):null},t.now=function(t){var n="DD-MM-YYYY",a=e.getByKey(t);return null!==a.dateDisplay&&void 0!==a.dateDisplay&&a.dateDisplay.toString().length>0&&(n=a.dateDisplay),moment().format(n)},t.toMoment=function(t,n){var a="DD-MM-YYYY",i=e.getByKey(t);return null!==i.dateDisplay&&void 0!==i.dateDisplay&&i.dateDisplay.toString().length>0&&(a=i.dateDisplay),moment(n,a)},t.toService=function(t,n){var a="DD-MM-YYYY",i=e.getByKey(t);null!==i.dateDisplay&&void 0!==i.dateDisplay&&i.dateDisplay.toString().length>0&&(a=i.dateDisplay);var o=moment(n,a);return o._isValid?o.format("DDMMYYYY"):null},t.dateInputToService=function(e){var t=moment(e,"DD-MM-YYYY");return t._isValid?t.format("DDMMYYYY"):null},t}]),app.factory("$elements",function(){var e={isSearchParameterExist:!0},t={isVisible:!0,isRequired:!1,isQuery:!1,isDisabled:!1,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null};return e.checkIfSearchParameterExist=function(e){var t=!1;return angular.forEach(e,function(e){"MAINMENU_Insured_CreateOrFind"===e.parentCode&&(t=!0)}),t},e.checkIfInsuredQuickUpdateRequired=function(t){var n=!1;return 0==t.HesapTipi?angular.forEach(e,function(e,a){"personTitle"===a&&!0===e.SIGQ09.isRequired&&(""!==t.Unvan&&null!==t.Unvan&&void 0!==t.Unvan||(n=!0)),"addressCode"===a&&!0===e.SIGQ09.isRequired&&(""!==t.AdresNo&&null!==t.AdresNo&&void 0!==t.AdresNo||(n=!0)),"address"===a&&!0===e.SIGQ09.isRequired&&(""!==t.Adres&&null!==t.Adres&&void 0!==t.Adres||(n=!0)),"province"===a&&!0===e.SIGQ09.isRequired&&(""!==t.IlKodu&&null!==t.IlKodu&&void 0!==t.IlKodu||(n=!0)),"district"===a&&!0===e.SIGQ09.isRequired&&(""!==t.IlceKodu&&null!==t.IlceKodu&&void 0!==t.IlceKodu||(n=!0)),"mobilePhone"===a&&!0===e.SIGQ09.isRequired&&(""!==t.GSMNo&&null!==t.GSMNo&&void 0!==t.GSMNo||(n=!0)),"email"===a&&!0===e.SIGQ09.isRequired&&(""!==t.EMail&&null!==t.EMail&&void 0!==t.EMail||(n=!0)),"citizenID"===a&&!0===e.SIGQ09.isRequired&&(""!==t.TCNo&&null!==t.TCNo&&void 0!==t.TCNo||(n=!0))}):1==t.HesapTipi&&angular.forEach(e,function(e,a){"companyTitle"===a&&!0===e.SIGQ10.isRequired&&(""!==t.Unvan&&null!==t.Unvan&&void 0!==t.Unvan||(n=!0)),"addressCode"===a&&!0===e.SIGQ10.isRequired&&(""!==t.AdresNo&&null!==t.AdresNo&&void 0!==t.AdresNo||(n=!0)),"address"===a&&!0===e.SIGQ10.isRequired&&(""!==t.Adres&&null!==t.Adres&&void 0!==t.Adres||(n=!0)),"province"===a&&!0===e.SIGQ10.isRequired&&(""!==t.IlKodu&&null!==t.IlKodu&&void 0!==t.IlKodu||(n=!0)),"district"===a&&!0===e.SIGQ10.isRequired&&(""!==t.IlceKodu&&null!==t.IlceKodu&&void 0!==t.IlceKodu||(n=!0)),"mobilePhone"===a&&!0===e.SIGQ10.isRequired&&(""!==t.GSMNo&&null!==t.GSMNo&&void 0!==t.GSMNo||(n=!0)),"email"===a&&!0===e.SIGQ10.isRequired&&(""!==t.EMail&&null!==t.EMail&&void 0!==t.EMail||(n=!0)),"companyId"===a&&!0===e.SIGQ10.isRequired&&(""!==t.VergiNo&&null!==t.VergiNo&&void 0!==t.VergiNo||(n=!0))}),n},e.checkIfInsuredUpdateRequired=function(t){var n=!1;return 0==t.HesapTipi?angular.forEach(e,function(e,a){"accountId"===a&&!0===e.SIG09.isRequired&&(""!==t.HesKod&&null!==t.HesKod&&void 0!==t.HesKod||(n=!0)),"personTitle"===a&&!0===e.SIG09.isRequired&&(""!==t.Unvan&&null!==t.Unvan&&void 0!==t.Unvan||(n=!0)),"addressCode"===a&&!0===e.SIG09.isRequired&&(""!==t.AdresNo&&null!==t.AdresNo&&void 0!==t.AdresNo||(n=!0)),"alias"===a&&!0===e.SIG09.isRequired&&(""!==t.Rumuz&&null!==t.Rumuz&&void 0!==t.Rumuz||(n=!0)),"postCode"===a&&!0===e.SIG09.isRequired&&(""!==t.PKodu&&null!==t.PKodu&&void 0!==t.PKodu||(n=!0)),"address"===a&&!0===e.SIG09.isRequired&&(""!==t.Adres&&null!==t.Adres&&void 0!==t.Adres||(n=!0)),"province"===a&&!0===e.SIG09.isRequired&&(""!==t.IlKodu&&null!==t.IlKodu&&void 0!==t.IlKodu||(n=!0)),"district"===a&&!0===e.SIG09.isRequired&&(""!==t.IlceKodu&&null!==t.IlceKodu&&void 0!==t.IlceKodu||(n=!0)),"mobilePhone"===a&&!0===e.SIG09.isRequired&&(""!==t.GSMNo&&null!==t.GSMNo&&void 0!==t.GSMNo||(n=!0)),"landPhone"===a&&!0===e.SIG09.isRequired&&(""!==t.IkametTel1&&null!==t.IkametTel1&&void 0!==t.IkametTel1||(n=!0)),"email"===a&&!0===e.SIG09.isRequired&&(""!==t.EMail&&null!==t.EMail&&void 0!==t.EMail||(n=!0)),"insuredType"===a&&!0===e.SIG09.isRequired&&(""!==t.Unvan&&null!==t.Unvan&&void 0!==t.Unvan||(n=!0)),"citizenID"===a&&!0===e.SIG09.isRequired&&(""!==t.TCNo&&null!==t.TCNo&&void 0!==t.TCNo||(n=!0)),"passportId"===a&&!0===e.SIG11.isRequired&&(""!==t.PasaportNo&&null!==t.PasaportNo&&void 0!==t.PasaportNo||(n=!0)),"socialSecurityId"===a&&!0===e.SIG11.isRequired&&(""!==t.SGKId&&null!==t.SGKId&&void 0!==t.SGKId||(n=!0)),"drivingLicenseId"===a&&!0===e.SIG11.isRequired&&(""!==t.EhliyetID&&null!==t.EhliyetID&&void 0!==t.EhliyetID||(n=!0)),"gender"===a&&!0===e.SIG11.isRequired&&(""!==t.Cinsiyet&&null!==t.Cinsiyet&&void 0!==t.Cinsiyet||(n=!0)),"dateOfBirth"===a&&!0===e.SIG11.isRequired&&(""!==t.DogumTarihi&&null!==t.DogumTarihi&&void 0!==t.DogumTarihi||(n=!0)),"birthPlace"===a&&!0===e.SIG11.isRequired&&(""!==t.DogumYeri&&null!==t.DogumYeri&&void 0!==t.DogumYeri||(n=!0)),"fatherName"===a&&!0===e.SIG11.isRequired&&(""!==t.BabaAdi&&null!==t.BabaAdi&&void 0!==t.BabaAdi||(n=!0)),"sector"===a&&!0===e.SIG11.isRequired&&(""!==t.Sektor&&null!==t.Sektor&&void 0!==t.Sektor||(n=!0)),"job"===a&&!0===e.SIG11.isRequired&&(""!==t.Meslek&&null!==t.Meslek&&void 0!==t.Meslek||(n=!0)),"maritalStatus"===a&&!0===e.SIG11.isRequired&&(""!==t.MedeniDurum&&null!==t.MedeniDurum&&void 0!==t.MedeniDurum||(n=!0)),"branch"===a&&!0===e.SIG13.isRequired&&(""!==t.Sube&&null!==t.Sube&&void 0!==t.Sube||(n=!0)),"mainCustomerRepresentative"===a&&!0===e.SIG13.isRequired&&(""!==t.Temsilci&&null!==t.Temsilci&&void 0!==t.Temsilci||(n=!0)),"producer"===a&&!0===e.SIG13.isRequired&&(""!==t.Tali&&null!==t.Tali&&void 0!==t.Tali||(n=!0)),"customerGroup"===a&&!0===e.SIG13.isRequired&&(""!==t.Grup&&null!==t.Grup&&void 0!==t.Grup||(n=!0)),"listGroup"===a&&!0===e.SIG13.isRequired&&(""!==t.ListeGrubu&&null!==t.ListeGrubu&&void 0!==t.ListeGrubu||(n=!0)),"referenceGroup"===a&&!0===e.SIG13.isRequired&&(""!==t.ReferansAdi&&null!==t.ReferansAdi&&void 0!==t.ReferansAdi||(n=!0))}):1==t.HesapTipi&&angular.forEach(e,function(e,a){"accountId"===a&&!0===e.SIG10.isRequired&&(""!==t.HesKod&&null!==t.HesKod&&void 0!==t.HesKod||(n=!0)),"addressCode"===a&&!0===e.SIG10.isRequired&&(""!==t.AdresNo&&null!==t.AdresNo&&void 0!==t.AdresNo||(n=!0)),"companyId"===a&&!0===e.SIG10.isRequired&&(""!==t.VergiNo&&null!==t.VergiNo&&void 0!==t.VergiNo||(n=!0)),"companyTitle"===a&&!0===e.SIG10.isRequired&&(""!==t.Unvan&&null!==t.Unvan&&void 0!==t.Unvan||(n=!0)),"alias"===a&&!0===e.SIG10.isRequired&&(""!==t.Rumuz&&null!==t.Rumuz&&void 0!==t.Rumuz||(n=!0)),"postCode"===a&&!0===e.SIG10.isRequired&&(""!==t.PKodu&&null!==t.PKodu&&void 0!==t.PKodu||(n=!0)),"address"===a&&!0===e.SIG10.isRequired&&(""!==t.Adres&&null!==t.Adres&&void 0!==t.Adres||(n=!0)),"province"===a&&!0===e.SIG10.isRequired&&(""!==t.IlKodu&&null!==t.IlKodu&&void 0!==t.IlKodu||(n=!0)),"district"===a&&!0===e.SIG10.isRequired&&(""!==t.IlceKodu&&null!==t.IlceKodu&&void 0!==t.IlceKodu||(n=!0)),"mobilePhone"===a&&!0===e.SIG10.isRequired&&(""!==t.GSMNo&&null!==t.GSMNo&&void 0!==t.GSMNo||(n=!0)),"landPhone"===a&&!0===e.SIG10.isRequired&&(""!==t.IkametTel1&&null!==t.IkametTel1&&void 0!==t.IkametTel1||(n=!0)),"email"===a&&!0===e.SIG10.isRequired&&(""!==t.EMail&&null!==t.EMail&&void 0!==t.EMail||(n=!0)),"sector"===a&&!0===e.SIG12.isRequired&&(""!==t.Sektor&&null!==t.Sektor&&void 0!==t.Sektor||(n=!0)),"job"===a&&!0===e.SIG12.isRequired&&(""!==t.Meslek&&null!==t.Meslek&&void 0!==t.Meslek||(n=!0)),"authorizedTitle"===a&&!0===e.SIG12.isRequired&&(""!==t.YetkiliAdi&&null!==t.YetkiliAdi&&void 0!==t.YetkiliAdi||(n=!0)),"branch"===a&&!0===e.SIG14.isRequired&&(""!==t.Sube&&null!==t.Sube&&void 0!==t.Sube||(n=!0)),"mainCustomerRepresentative"===a&&!0===e.SIG14.isRequired&&(""!==t.TemsilciAdi&&null!==t.TemsilciAdi&&void 0!==t.TemsilciAdi||(n=!0)),"producer"===a&&!0===e.SIG14.isRequired&&(""!==t.Tali&&null!==t.Tali&&void 0!==t.Tali||(n=!0)),"customerGroup"===a&&!0===e.SIG14.isRequired&&(""!==t.Grup&&null!==t.Grup&&void 0!==t.Grup||(n=!0)),"listGroup"===a&&!0===e.SIG14.isRequired&&(""!==t.ListeGrubu&&null!==t.ListeGrubu&&void 0!==t.ListeGrubu||(n=!0)),"referenceGroup"===a&&!0===e.SIG14.isRequired&&(""!==t.ReferansAdi&&null!==t.ReferansAdi&&void 0!==t.ReferansAdi||(n=!0))}),n},e.init=function(n,a){angular.forEach(n,function(n,a){e[a]={},angular.forEach(n,function(n){e[a][n]=angular.copy(t)})});var i=["isVisible","isRequired","isQuery","isDisabled","pattern","maxLength","minLength","maxValue","minValue"],o=a.filter(function(e){return null===e.fieldCode});angular.forEach(o,function(t){angular.forEach(e[t.parentCode],function(n,a){angular.forEach(i,function(n){null!==t[n]&&t[n].toString().length>0&&void 0!==e[t.parentCode][a]&&(e[t.parentCode][a][n]=t[n])})})});var r=a.filter(function(e){return null!==e.fieldCode});angular.forEach(r,function(t){angular.forEach(i,function(n){void 0!==e[t.parentCode]&&null!==e[t.parentCode]&&void 0!==t[n]&&null!==t[n]&&t[n].toString().length>0&&void 0!==e[t.parentCode][t.fieldCode]&&null!==e[t.parentCode][t.fieldCode]&&(e[t.parentCode][t.fieldCode][n]=t[n])})}),e.checkIfSearchParameterExist(a)&&angular.forEach(a,function(t){"MAINMENU_Insured_CreateOrFind"===t.parentCode&&(!0===t.isVisible||null===t.isVisible||void 0===t.isVisible?e.isSearchParameterExist=!0:!1===t.isVisible&&(e.isSearchParameterExist=!1))})},e.getSearchVisibility=function(){return e.isSearchParameterExist},e}),app.factory("$form",["$rootSettings","$currency","$dateFormatter","$helpers","$auth","$rest","$tia",function(e,t,n,a,i,o,r){var l={};return l.toTIAArray=function(n,a){a=angular.copy(a);var i=[],o=e.getByPath("forms.inputs.date");return angular.forEach(a,function(e){var a={Aciklama:e.Aciklama,Deger:e.Deger,ListItem:e.ListItem,Varmi:e.Varmi};if(20!==e.Tip&&21!==e.Tip||void 0!==a.Deger&&null!==a.Deger&&(a.Deger=t.toService(a.Deger)),60===e.Tip&&void 0!==a.Aciklama&&null!==a.Aciklama&&a.Aciklama.toString().length>0){var r=moment(a.Aciklama,o.display);r._isValid&&(a.Aciklama=r.format("DDMMYYYY"))}a[n]=e.TeminatID,i.push(a)}),i},l.toCompanies=function(e){var t=[];return angular.forEach(e.data.companies,function(e){t.push({Sec:e.isSelected,SKod:e.skod})}),t},l.fetchTIA=function(e,t,n,a){e.isTiaLoading=!0,o.get("quotation/tia",t,function(t){e._tia.data=r.build(e.form,t),e._tia.current=0,e.isTiaLoading=!1,n()},a,null,null,!0)},l.fetchChatBiTIA=function(e,t,n,a){e.isTiaLoading=!0,o.get("quotation/tia",t,function(t){e._tia.data=r.build(e.form,t),e._tia.current=0,e.isTiaLoading=!1,n()},a,null,null,!1)},l.isTIAActive=function(e){return void 0!==e&&null!==e&&void 0!==e.data&&null!==e.data&&e.data.length>0},l.fetchCompanyList=function(e,t,n,a,i){if(null!==n.companies)return a();o.get("quotation/companies",{pAnaBrans:e,pAraBrans:t},function(e){n.companies=e,angular.forEach(n.companies,function(e){e.isSelected=1}),a()},i)},l.isCompanySelectionIsActive=function(e,t){var n=!0;return i.whenReady(function(){angular.forEach(i.get("Menus"),function(a){a.ab===e&&a.arabrans===t&&0===parseInt(a.lw_sirketlistele)&&(n=!1)})}),n},l.filterAracList=function(e,t,n){if(null===n.tarifekodu||"0"===n.tarifekodu||0===n.tarifekodu.length)return!0;if(null!==e)return e===parseInt(n.tarifekodu);var a=parseInt(n.tarifekodu),i=!1;return angular.forEach(t,function(e){e.kod===a&&(i=!0)}),i},l.setFamilyMemberDefaults=function(e,t,i){if(e.$index=null,e.Tip=0,e.HesKod=i.HesKod,e.Cinsiyet=null,e.MedeniDurum=null,e.EgitimDurum=null,e.SigortaliTuru=null,e.VatandaslikID=null,e.PasaportID=null,e.Id=null,e.DogumTarihi=null,void 0!==t&&null!==t){void 0!==t.find(function(e){return 0===e.Tip})&&(e.Tip=null)}0===e.Tip&&(e.Unvan=i.Unvan,e.DogumTarihi=n.toInput(a.ab("dateOfBirth.YAB__2"),i.DogumTarihi),"Erkek"!==i.Cinsiyet&&(e.Cinsiyet=1),"Evli"!==i.MedeniDurum&&(e.MedeniDurum=1))},l.build=function(e){var t=angular.copy({pGenel:e.form,pTeminatlar:l.toTIAArray("TeminatID",e.form._tia.teminat),pIndirimler:l.toTIAArray("IndirimID",e.form._tia.indirim),pAciklamalar:l.toTIAArray("AciklamaID",e.form._tia.aciklama),pSurucuBilgisi:e.form.pSurucuBilgisi,pKonutBireyler:e.form.pKonutBireyler,pMulkiyet:e.form.pMulkiyet,pSirketler:l.toCompanies(e),pYeniTeklif:1});return 0===t.pGenel.DisPoliceTipi?t.pGenel.DisPoliceYenilemeSirketKodu=null:1===t.pGenel.DisPoliceTipi&&(t.pGenel.DisPoliceYenilemeSirketKodu=t.pGenel.ESirketKodu,t.pGenel.ESirketKodu=null),void 0!==t.pSurucuBilgisi&&null!==t.pSurucuBilgisi||(t.pSurucuBilgisi=[]),void 0!==t.pKonutBireyler&&null!==t.pKonutBireyler||(t.pKonutBireyler=[]),delete t.pGenel._tia,delete t.pGenel.pSurucuBilgsi,t},l}]),app.factory("$formValidations",["$timeout",function(e){var t={},n={Unvan:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:/(\w.+\s).+/,maxLength:255,minLength:6,maxValue:null,minValue:null,inputMask:null},HesapKoduTC:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:"99999999999"},HesapKoduVERGI:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:10,minLength:10,maxValue:null,minValue:null,inputMask:"9999999999"},GSMNo:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:"(999) 999-9999"},EMail:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},Plaka:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:"20",minLength:null,maxValue:null,minValue:null,inputMask:null},RuhsatNo:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:"10",minLength:null,maxValue:null,minValue:null,inputMask:null},SasiNo:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:17,minLength:17,maxValue:null,minValue:null,inputMask:null},YngAdresKodu:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:10,minLength:null,maxValue:null,minValue:null,inputMask:null},DaskPoliceNo:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:8,minLength:null,maxValue:null,minValue:null,inputMask:null},
YngCadde:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},YngMahalle:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},YngSokak:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},YngBinaNo:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},YngDaireNo:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},YngBrut:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},YngRizikoKat:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},YngYil:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},MotorNo:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:200,minLength:null,maxValue:null,minValue:null,inputMask:null},YolcuSayisi:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null},DogumTarihi:{isVisible:!0,isRequired:!0,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null,inputMask:null}};return t.validateMultiForms=function(n,a,i,o,r,l,s,u,c,d){angular.forEach(n,function(e){angular.forEach(e,function(e,t){"string"==typeof t&&"$"!==t.charAt(0)&&(e.$setDirty(),e.$invalid&&("checkbox"===e.$$attr.type?$("#switch-shake-"+t).addClass("is-not-valid"):e.$$element.addClass("is-not-valid")))})}),t.checkValid(n)?a(i,o,r,l,s,u,c,d):e(function(){$(".is-not-valid").addClass("shake"),e(function(){$(".is-not-valid").removeClass("shake").removeClass("is-not-valid")},400)})},t.checkValid=function(e){var t=!0;return angular.forEach(e,function(e){0==e.$valid&&(t=!1)}),t},t.isInvalid=function(e){return e.$dirty&&e.$invalid},t.onCreate=function(){t.formElements=n},t.onCreate(),t}]),app.factory("$helpers",["$state",function(e){var t={};return t.filterVendorItem=function(e){return angular.copy(e).filter(function(e){return"WITHOUT_MERKEZ"!==e.kod&&null!==e.kod})},t.ab=function(t){if(void 0===e.params.ab||null===e.params.ab)return t;var n=e.params.ab.toString();return 1===n.length&&(n="0"+n),t.replace("__",n)},t.slugify=function(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},t.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},t}]),app.factory("$inputElement",["$timeout","$formValidations",function(e,t){var n={},a=t.formElements;return n.removeMark=function(e,t){e.removeAttr(t)},n.setDirty=function(e,t,n){var a=e.split(".");n.on("keydown",function(){void 0!==t[a[1]]&&void 0!==t[a[1]][a[0]]&&(t[a[1]][a[0]].$dirty=!0)})},n.setPlateRegex=function(e,t){"Plaka"===e.split(".")[0]&&(t.setPlateRegex=function(){var e=/^(0[1-9]|[1-7][0-9]|8[01])(([A-Z])(\d{4,5})|([A-Z]{2})(\d{3,4})|([A-Z]{3})(\d{2}))$/;return{test:function(t){var n=t.replace(/\s+/g,"").toUpperCase();return e.test(n)}}}())},n.setFundamentals=function(e,t,n,i){var o=e.split("."),r=o[0],l=o[1]+"."+o[0];n.attr("name",r);var s={class:"form-control","ng-required":a[r].isRequired,"ng-maxLength":a[r].maxLength,"ng-minLength":a[r].minLength,"ng-max":a[r].maxValue,"ng-min":a[r].minValue,"ng-pattern":a[r].pattern,maxlength:a[r].maxLength,"ng-class":"{ 'form-error': "+l+".$dirty && "+l+".$invalid }","ng-model-options":"{ allowInvalid: true }"};i.ngRequired&&(s["ng-required"]=i.ngRequired),angular.forEach(s,function(e,t){n.attr(t,e)})},n}]),app.factory("$inputter",["$validations","$rootSettings",function(e,t){var n={};return n.setCurrencyMask=function(e,n){var a=t.getByPath("forms.inputs.currency");void 0!==n&&null!==n&&(a.digits=n),new Inputmask(a).mask(e)},n.setPhoneMask=function(e){var t={clearIncomplete:!0,clearMaskOnLostFocus:!0,autoUnmask:!0,greedy:!1,autoGroup:!0,placeholder:"0(5--)--- ----",mask:"#(###)### ####"};new Inputmask(t).mask(e)},n.setIdentityMask=function(e,t){var n={clearIncomplete:!0,clearMaskOnLostFocus:!0,autoUnmask:!0,greedy:!1,autoGroup:!0};"tc"===t?(n.placeholder="-----------",n.mask="###########"):"vergi"===t&&(n.placeholder="----------",n.mask="##########"),new Inputmask(n).mask(e)},n.setNumericMask=function(e){var n=t.getByPath("forms.inputs.numeric");new Inputmask(n).mask(e)},n.setFloatMask=function(e){var n=t.getByPath("forms.inputs.floatSettings");new Inputmask(n).mask(e)},n.setInputMask=function(t,n,a){e.get(t,function(e){void 0!==e.inputMask&&null!==e.inputMask&&e.inputMask.toString().length>0&&new Inputmask(e.inputMask,{clearIncomplete:!0,clearMaskOnLostFocus:!0,autoUnmask:!0,greedy:!1,onincomplete:function(){for(var e=a.attr("ng-model"),t=e.split("."),i=n,o=0;o<t.length-1;o++)i=n[t[o]];void 0!==i&&null!==i&&(i[t[t.length-1]]=null)}}).mask(a)})},n.removeMark=function(e,t){e.removeAttr(t)},n.setDirty=function(e,t,n){var a=e.split(".");n.on("keydown",function(){void 0!==t[a[1]]&&void 0!==t[a[1]][a[0]]&&(t[a[1]][a[0]].$dirty=!0)})},n.setFundamentals=function(e,t,n){var a={class:"form-control","ng-required":"elements.{KEY}.isRequired","ng-maxLength":"elements.{KEY}.maxLength","ng-minLength":"elements.{KEY}.minLength","ng-max":"elements.{KEY}.maxValue","ng-min":"elements.{KEY}.minValue","ng-pattern":"elements.{KEY}.pattern",maxlength:"{{ elements.{KEY}.maxLength }}","ng-class":"{ 'form-error': {VALIDATION_ACCESSOR}.$dirty && {VALIDATION_ACCESSOR}.$invalid }","ng-model-options":"{ allowInvalid: true }"},i=e.split("."),o=i[0],r=i[1]+"."+i[0];n.attr("name",o),angular.forEach(a,function(t,a){n.attr(a,t.replace("{KEY}",e).replace(new RegExp("{VALIDATION_ACCESSOR}","g"),r))})},n}]),app.factory("$insured",["$storage","$state","$rootScope",function(e,t,n){var a={},i={},o={},r={},l=null;return a.onCreate=function(){i=e.get("selectedInsured"),o=e.get("insuredList")},a.goToReferrer=function(){var e=a.getReferrer();null===e?t.go("insuredInformation"):(t.go(e.name,e.params),a.clearReferrer())},a.set=function(t){e.set("selectedInsured",t),i=t,n.$broadcast("$insured@onChanged"),null===t||t.HesKod},a.get=function(){return null===i&&t.go("insuredLocalSearch"),angular.copy(i)},a.getWithoutRedirect=function(){return angular.copy(i)},a.setReferrer=function(e,t){l={name:e,params:t}},a.getReferrer=function(){return l},a.clearReferrer=function(){l=null},a.getActiveInsured=function(){return i=e.get("selectedInsured"),JSON.parse(JSON.stringify(i))},a.getAccountId=function(){return e.get("selectedAccountId")},a.setAccountId=function(t){e.set("selectedAccountId",t)},a.setList=function(t){e.set("insuredList",t),o=t},a.getList=function(){return o},a.setSearchQuery=function(t){e.set("insuredSearchTemp",t),r=t},a.getSearchQuery=function(){return r=e.get("insuredSearchTemp")},a.setLastTenInsured=function(t){var n=a.getLastTenInsured();angular.forEach(n,function(e){e.HesapID===t.HesKod&&(e.Unvan=t.Unvan)}),e.set("lastTenInsureds",JSON.stringify(n))},a.getLastTenInsured=function(){return JSON.parse(e.get("lastTenInsureds"))},a.checkInsuredInLocalStrage=function(e,t){var n=!1;return void 0===e||null===e||null===t?n:(e.find(function(e){e.HesapID===t&&(n=!0)}),n)},a.addToLastTenInsured=function(t,n){var a={HesapID:n.HesKod,HesapTuru:0===n.HesapTipi?"Şahıs":"Şirket",Unvan:n.Unvan,VatandaslikID:n.TCNo,VergiKimlikID:n.VergiNo};if(null!==t)t.push(a),e.set("lastTenInsureds",JSON.stringify(t));else{var i=[];i.push(a),e.set("lastTenInsureds",JSON.stringify(i))}},a.setUserSuInfo=function(e){a.UpdatedSuUserInfo=e},a.getUserSuInfo=function(){return a.UpdatedSuUserInfo},a}]),app.factory("$languageService",function(){var e={},t={};return e.set=function(e){t=e},e.get=function(){return angular.copy(t)},e}),app.factory("$lists",["$rest","$culture",function(e,t){var n={};return n.setNull=function(e,t,n){angular.forEach(t,function(t){e[t]===n&&(e[t]=null)})},n.setNulls=function(e,t,a){angular.forEach(e,function(e){n.setNull(e,t,a)})},n.get=function(t,n,a,i){e.get("portal/lists/"+t+"/"+n+"/"+a,{},i)},n.getSilent=function(t,n,a,i,o){e.get("portal/lists/"+t+"/"+n+"/"+a,{},i,null,null,null,o)},n.getCreditCardTypes=function(){return angular.copy([{kod:"Visa",ad:"Visa"},{kod:"Master",ad:"Master Card"},{kod:"Amex",ad:"Amex"}])},n.getTeslimatDurumList=function(){return angular.copy([{kod:0,ad:t.translate("Bekliyor")},{kod:1,ad:t.translate("Teslim Edildi")}])},n.getOdemeSekliList=function(){return angular.copy([{kod:0,ad:t.translate("Peşin")},{kod:1,ad:t.translate("Taksit")}])},n.getDisPoliceTipiList=function(){return angular.copy([{kod:1,ad:t.translate("Firmamızın Poliçesi (Yenileme)")},{kod:0,ad:t.translate("Diğer Firmanın Poliçesi (Yeni Satış)")}])},n.getYeniTeklifSecenekleri=function(){return angular.copy([{kod:0,ad:t.translate("Teklifi Güncelle")},{kod:1,ad:t.translate("Yeni Teklif Oluştur")}])},n.getSurecDurumList=function(){return angular.copy([{kod:0,ad:t.translate("Satış Bekliyor")},{kod:1,ad:t.translate("Satış Yapıldı")}])},n.getSurecHareketList=function(){return angular.copy([{kod:0,ad:t.translate("Görevlendirme")},{kod:1,ad:t.translate("Çağrı")},{kod:2,ad:t.translate("Faks")},{kod:3,ad:t.translate("E-Posta")},{kod:4,ad:t.translate("SMS")},{kod:5,ad:t.translate("Teklif")},{kod:6,ad:t.translate("Randevu-Ziyaret")},{kod:8,ad:t.translate("Son Durum")},{kod:9,ad:t.translate("Görevlendirme İptal")},{kod:10,ad:t.translate("Yönlendirme")},{kod:11,ad:t.translate("Aktif Konumuna Alındı")},{kod:12,ad:t.translate("Bekleyen Konumuna Alındı")},{kod:13,ad:t.translate("Dönem Takip Durumu Açıldı")},{kod:14,ad:t.translate("Dönem Takip Durumu Kapatıldı")},{kod:15,ad:t.translate("Ek Bilgi")},{kod:16,ad:t.translate("Tramer Sorgu")},{kod:17,ad:t.translate("Tramer Sorgu İptal")},{kod:18,ad:t.translate("Poliçe Talebi")},{kod:19,ad:t.translate("Poliçe Talebi İptal")},{kod:20,ad:t.translate("Poliçe Düzenlendi")},{kod:21,ad:t.translate("Poliçe Düzenlenemedi")},{kod:100,ad:t.translate("İşlem Yok")},{kod:22,ad:t.translate("PBS Kaydı Yapıldı")},{kod:23,ad:t.translate("Hatırlatma")},{kod:24,ad:t.translate("Son Durum İptali")},{kod:25,ad:t.translate("Alternatif Trafik Sorgusu")},{kod:26,ad:t.translate("Alternatif Kasko Sorgusu")},{kod:27,ad:t.translate("İşlem Listesi")},{kod:28,ad:t.translate("Gruba Ekleme")},{kod:29,ad:t.translate("Gruptan Çıkarma")},{kod:30,ad:t.translate("Potansiyele Dönüştürme")},{kod:31,ad:t.translate("Genel Teklif")},{kod:32,ad:t.translate("Yeniden Takip Oluşturma")},{kod:33,ad:t.translate("Tekniğin Özet Teslimi")},{kod:34,ad:t.translate("Satışın Revize Özet Teslimi")},{kod:35,ad:t.translate("Tekniğin Konsolide Teklif Teslimi")},{kod:36,ad:t.translate("Satışın Müşteri Onayına İletimi")},{kod:37,ad:t.translate("Tekniğin Poliçe Teslimi")},{kod:38,ad:t.translate("Satışın Poliçe Kontrolü")},{kod:39,ad:t.translate("Finansın Poliçe Kontrolü")},{kod:40,ad:t.translate("Satışın Müşteriye Poliçe Teslimi")},{kod:41,ad:t.translate("Ara Branş Değişimi")}])},n.getPoliceUretimTipiList=function(){return angular.copy([{policeKayitTipi:0,kod:0,ad:t.translate("0101- Üretim")},{policeKayitTipi:0,kod:1,ad:t.translate("0102- Üretim Eki")},{policeKayitTipi:1,kod:1,ad:t.translate("0201- Tam İptal")},{policeKayitTipi:1,kod:3,ad:t.translate("0202- Kısmi İptal")},{policeKayitTipi:1,kod:4,ad:t.translate("0203- Satıştan İptal")},{policeKayitTipi:1,kod:5,ad:t.translate("0204- Hasardan İptal")},{policeKayitTipi:1,kod:6,ad:t.translate("0205- Ödeme Sorunundan İptal")},{policeKayitTipi:1,kod:7,ad:t.translate("0206- Diğer Nedenlerden İptal")},{policeKayitTipi:1,kod:8,ad:t.translate("0207- Değer Eksiltme İptali")},{policeKayitTipi:2,kod:0,ad:t.translate("0301- Primsiz Ekler")}])},n.getSigortaDetayiList=function(){return angular.copy([{kod:1,ad:t.translate("Yeni bir sigorta başlatıldı")},{kod:0,ad:t.translate("Mevcut sigortası yenilendi")}])},n.getPoliceKayitTipiList=function(){return angular.copy([{kod:0,varsayilanUretimTipi:1,ad:t.translate("01- Üretim / Üretim Ekleri")},{kod:1,varsayilanUretimTipi:1,ad:t.translate("02- İptal / İptal Ekleri")},{kod:2,varsayilanUretimTipi:0,ad:t.translate("03- Primsiz Ekler")}])},n.getGorevlendirmeFiltreList=function(){return angular.copy([{value:1,title:t.translate("Sadece Görevlendirilmişler")},{value:2,title:t.translate("Sadece Görevlendirilmemişler")},{value:0,title:t.translate("TÜMÜ")}])},n.getAnaBranslar=function(){return angular.copy([{value:1,title:t.translate("Yangın (KONUT)")},{value:2,title:t.translate("Yangın (İŞYERİ)")},{value:3,title:t.translate("Yangın (DİĞER)")},{value:4,title:t.translate("Otokaza (KASKO)")},{value:5,title:t.translate("Otokaza (TRAFİK)")},{value:6,title:t.translate("Otokaza (DİĞER)")},{value:7,title:t.translate("Otodışı Kaza")},{value:8,title:t.translate("Nakliyat")},{value:9,title:t.translate("Mühendislik")},{value:10,title:t.translate("Dask")},{value:11,title:t.translate("Tarım")},{value:12,title:t.translate("Sağlık")},{value:13,title:t.translate("PO-TA")}])},n.getPozisyonlar=function(){return angular.copy([{value:-1,title:t.translate("Süreçte Değil")},{value:2,title:t.translate("Bekleyen")},{value:3,title:t.translate("Sonuçlanan")},{value:5,title:t.translate("Olumlu Sonuçlanan")},{value:6,title:t.translate("Olumsuz Sonuçlanan")},{value:4,title:t.translate("TÜMÜ")}])},n.getSonucList=function(){return angular.copy([{kod:0,ad:t.translate("Satış Yapıldı")},{kod:1,ad:t.translate("Satış Yapılamadı")}])},n.getEgitimDurumlari=function(){return angular.copy([{kod:7,ad:t.translate("Okul Öncesi")},{kod:0,ad:t.translate("İlkokul")},{kod:1,ad:t.translate("Ortaokul")},{kod:2,ad:t.translate("Lise")},{kod:3,ad:t.translate("Ön Lisans")},{kod:4,ad:t.translate("Lisans")},{kod:5,ad:t.translate("Yüksek Lisans")},{kod:6,ad:t.translate("Doktora")}])},n.getSurucuDeneyimleri=function(){return angular.copy([{kod:0,ad:t.translate("1 yıldan az")},{kod:1,ad:t.translate("1-2 yıl arası")},{kod:2,ad:t.translate("2-3 yıl arası")},{kod:3,ad:t.translate("3-4 yıl arası")},{kod:4,ad:t.translate("4-5 yıl arası")},{kod:5,ad:t.translate("5-6 yıl arası")},{kod:6,ad:t.translate("6-7 yıl arası")},{kod:7,ad:t.translate("7-8 yıl arası")},{kod:8,ad:t.translate("8-9 yıl arası")},{kod:9,ad:t.translate("9-10 yıl arası")},{kod:10,ad:t.translate("10-20 yıl arası")},{kod:11,ad:t.translate("20 yıldan fazla")}])},n.getSurucuMedenDurum=function(){return angular.copy([{kod:0,ad:t.translate("Evli")},{kod:1,ad:t.translate("Bekar")},{kod:2,ad:t.translate("Diğer")}])},n.getSurucuCinsiyetler=function(){return angular.copy([{kod:0,ad:t.translate("Erkek")},{kod:1,ad:t.translate("Kadın")},{kod:2,ad:t.translate("Diğer")}])},n.getSurucuTipleri=function(){return angular.copy([{kod:0,ad:t.translate("Ana Sürücü")},{kod:1,ad:t.translate("Ek Sürücü")}])},n.getSigortaliYakinlikTurleri=function(){return angular.copy([{kod:0,ad:t.translate("Sigortalı")},{kod:1,ad:t.translate("Sigortalının Eşi")},{kod:2,ad:t.translate("Sigortalının Çocuğu")},{kod:3,ad:t.translate("Sigortalının Yakını")},{kod:4,ad:t.translate("Sigortalının Çalışanı")},{kod:5,ad:t.translate("Diğer")}])},n.getSurucuTurleri=function(){return angular.copy([{kod:0,ad:t.translate("Sigortalı")},{kod:1,ad:t.translate("Sigortalının Eşi")},{kod:2,ad:t.translate("Sigortalının Çocuğu")},{kod:3,ad:t.translate("Sigortalının Yakını")},{kod:4,ad:t.translate("Sigortalının Çalışanı")},{kod:5,ad:t.translate("Diğer")}])},n.getFlags=function(){return angular.copy([{kod:0,ad:"fa fa-flag-o"},{kod:1,ad:"fa fa-flag c-red"},{kod:2,ad:"fa fa-flag c-yellow"},{kod:3,ad:"fa fa-flag c-green"},{kod:4,ad:"fa fa-flag c-blue"},{kod:5,ad:"fa fa-flag c-purple"},{kod:6,ad:"fa fa-flag c-orange"}])},n.getTarifeler=function(){return angular.copy([{kod:1,ad:t.translate("Otomobil")},{kod:2,ad:t.translate("Taksi")},{kod:3,ad:t.translate("Minibüs(10-17 koltuk)")},{kod:4,ad:t.translate("Otobüs (18-30 koltuk)")},{kod:5,ad:t.translate("Otobüs")},{kod:6,ad:t.translate("Kamyonet")},{kod:7,ad:t.translate("Kamyon")},{kod:8,ad:t.translate("İş Makinesi")},{kod:9,ad:t.translate("Traktör")},{kod:10,ad:t.translate("Romörk")},{kod:11,ad:t.translate("Motosiklet ve Yük Motosikleti")},{kod:12,ad:t.translate("Tanker")},{kod:13,ad:t.translate("Çekici")},{kod:14,ad:t.translate("Özel Amaçlı Taşıt")},{kod:16,ad:t.translate("Dolmuş (Sürücü dahil 5-9 koltuk)")},{kod:17,ad:t.translate("Minibüs Dolmuş (Sürücü dahil 10-17 koltuk)")},{kod:18,ad:t.translate("Otobüs Dolmuş (Sürücü dahil 18-30 koltuk)")},{kod:19,ad:t.translate("Otobüs Dolmuş (Sürücü dahil 31 ve üstü koltuk)")},{kod:20,ad:t.translate("Diğer Araçlar")}])},n.getMulkiyetDurumu=function(){return angular.copy([{kod:0,ad:t.translate("Sahibi, Kendisi Oturuyor")},{kod:1,ad:t.translate("Sahibi, Kiraya Verilmiş")},{kod:2,ad:t.translate("Kiracı")}])},n.getIpotekDurumu=function(){return angular.copy([{kod:0,ad:t.translate("İpotek Yok")},{kod:1,ad:t.translate("İpotek Var")}])},n.getManuelPoliceDurum=function(){return angular.copy([{kod:0,ad:t.translate("Geçerli")},{kod:1,ad:t.translate("İptal")}])},n.getManuelPoliceYenilemeSekli=function(){return angular.copy([{kod:0,ad:t.translate("Yenilenir")},{kod:1,ad:t.translate("Yenilenmez")}])},n.getManuelPoliceYenilemeDurumu=function(){return angular.copy([{kod:0,ad:t.translate("Yenileme Bekliyor")},{kod:1,ad:t.translate("Yenileme Yapıldı")},{kod:2,ad:t.translate("Yenileme Yapılmayacak")},{kod:3,ad:t.translate("Yenileme Yapılamadı")},{kod:4,ad:t.translate("Yenileme Yapılamaz")},{kod:5,ad:t.translate("İptal Poliçe")}])},n.getManuelPoliceKayitTipi=function(){return angular.copy([{kod:0,varsayilanUretimTipi:1,ad:t.translate("01- Üretim / Üretim Ekleri")},{kod:1,varsayilanUretimTipi:1,ad:t.translate("02- İptal / İptal Ekleri")},{kod:2,varsayilanUretimTipi:0,ad:t.translate("03- Primsiz Ekler")}])},n.getManuelPoliceUretimTipi=function(){return angular.copy([{policeKayitTipi:0,kod:1,ad:t.translate("0101- Üretim")},{policeKayitTipi:0,kod:2,ad:t.translate("0102- Üretim Eki")},{policeKayitTipi:1,kod:1,ad:t.translate("0201- Tam İptal")},{policeKayitTipi:1,kod:3,ad:t.translate("0202- Kısmi İptal")},{policeKayitTipi:1,kod:4,ad:t.translate("0203- Satıştan İptal")},{policeKayitTipi:1,kod:5,ad:t.translate("0204- Hasardan İptal")},{policeKayitTipi:1,kod:6,ad:t.translate("0205- Ödeme Sorunundan İptal")},{policeKayitTipi:1,kod:7,ad:t.translate("0206- Diğer Nedenlerden İptal")},{policeKayitTipi:1,kod:8,ad:t.translate("0207- Değer Eksiltme İptali")},{policeKayitTipi:2,kod:0,ad:t.translate("0301- Primsiz Ekler")}])},n.getSatisTipleriList=function(){return angular.copy([{kod:2,ad:t.translate("TÜMÜ")},{kod:0,ad:t.translate("Yeni Satış")},{kod:1,ad:t.translate("Yenileme")}])},n.getOdemeSekilleriList=function(){return angular.copy([{kod:0,ad:t.translate("Peşin")},{kod:1,ad:t.translate("Taksit")}])},n.getTahsilatMetotlariList=function(){return angular.copy([{kod:0,ad:t.translate("01- Nakit")},{kod:1,ad:t.translate("02- Banka")}])},n.getKrediKartiTahsilatMetotlariList=function(){return angular.copy([{kod:2,ad:t.translate("03- Kredi Kartı")},{kod:3,ad:t.translate("04- Çek")}])},n.getTumTahsilatMetotlariList=function(){return angular.copy([{kod:4,ad:t.translate("TÜMÜ")},{kod:0,ad:t.translate("01- Kasa")},{kod:1,ad:t.translate("02- Banka")},{kod:2,ad:t.translate("03- Çek")},{kod:3,ad:t.translate("04- Kredi Kartı")}])},n.getHesapListeSekliList=function(){return angular.copy([{kod:!1,ad:t.translate("Sadece Sigortalı")},{kod:!0,ad:t.translate("Tüm Grup")}])},n.getTaksitListeSirasiList=function(){return angular.copy([{kod:0,ad:t.translate("Vade Tarihi Sıralı")},{kod:1,ad:t.translate("Grup Sıralı")},{kod:2,ad:t.translate("Branş Sıralı")}])},n.getHesapTipiList=function(){return angular.copy([{kod:"",ad:t.translate("TÜMÜ")},{kod:"Müşteri",ad:t.translate("Müşteri")},{kod:"Satıcı",ad:t.translate("Satıcı")},{kod:"Kasa",ad:t.translate("Kasa")},{kod:"Banka",ad:t.translate("Banka")},{kod:"Personel",ad:t.translate("Personel")},{kod:"Sigorta Şirketi",ad:t.translate("Sigorta Şirketi")},{kod:"Prodüktör/Tali",ad:t.translate("Prodüktör/Tali")},{kod:"Gider",ad:t.translate("Gider")},{kod:"Diğer",ad:t.translate("Diğer")}])},n.getHesapRaporGrubuList=function(){return angular.copy([{kod:0,ad:t.translate("Borç Alacak")},{kod:2,ad:t.translate("Cari Hareket")}])},n.getPoliceRaporGrubuList=function(){return angular.copy([{kod:1,ad:t.translate("Poliçe Üretim")},{kod:3,ad:t.translate("Poliçe Bakiye")}])},n.getTaksitRaporGrubuList=function(){return angular.copy([{kod:4,ad:t.translate("Müşteri Taksit Listesi")},{kod:5,ad:t.translate("Tahsilat Detaylı Müşteri Taksit Listesi")}])},n.getCiktiSekliList=function(){return angular.copy([{kod:1,ad:t.translate("Liste")},{kod:0,ad:t.translate("PDF")},{kod:2,ad:t.translate("Excel")},{kod:4,ad:t.translate("Excel (Yalnızca Veri)")},{kod:3,ad:t.translate("Word")}])},n.getBakiyeSekliList=function(){return angular.copy([{kod:0,ad:t.translate("TÜMÜ")},{kod:1,ad:t.translate("Bakiyeli")},{kod:2,ad:t.translate("Bakiyesiz")},{kod:3,ad:t.translate("Borç Bakiyeli")},{kod:4,ad:t.translate("Alacak Bakiyeli")}])},n.getHesapTarihTipiList=function(){return angular.copy([{kod:0,ad:t.translate("İşlem Tarihi")},{kod:1,ad:t.translate("Vade Tarihi")}])},n.getTaksitTarihTipiList=function(){return angular.copy([{kod:0,ad:t.translate("İşlem Tarihi")},{kod:1,ad:t.translate("Vade Tarihi")}])},n.getPoliceTarihTipiList=function(){return angular.copy([{kod:0,ad:t.translate("Düzenleme Tarihi")},{kod:1,ad:t.translate("Kayıt Tarihi")},{kod:2,ad:t.translate("Başlama Tarihi")},{kod:3,ad:t.translate("Bitiş Tarihi")}])},n.getSiralamaList=function(){return angular.copy([{value:0,title:t.translate("Hesap IDye Göre")},{value:1,title:t.translate("Unvana Göre")},{value:2,title:t.translate("Kayıt Tarihine Göre")},{value:3,title:t.translate("Kayıt Tarihine Göre (Ters Sıralı)")}])},n.getMedeniDurumList=function(){return angular.copy([{kod:null,ad:t.translate("TÜMÜ")},{kod:"Evli",ad:t.translate("EVLİ")},{kod:"Bekâr",ad:t.translate("BEKAR")},{kod:"Diğer",ad:t.translate("DİĞER")}])},n.getCinsiyetList=function(){return angular.copy([{value:null,title:t.translate("TÜMÜ")},{value:"Erkek",title:t.translate("ERKEK")},{value:"Kadın",title:t.translate("KADIN")},{value:"Diger",title:t.translate("DİĞER")}])},n.getHesapTuruList=function(){return angular.copy([{value:-1,title:t.translate("TÜMÜ")},{value:0,title:t.translate("Şahıs")},{value:1,title:t.translate("Şirket")}])},n.getParaBirimiYerelKarsiligiList=function(){return angular.copy([{value:!1,title:t.translate("Listelenmesin")},{value:!0,title:t.translate("Listelensin")}])},n.getPoliceAnalizKayitTipiList=function(){return angular.copy([{kod:0,ad:t.translate("TÜMÜ")},{kod:1,ad:t.translate("01- Üretim / Üretim Ekleri")},{kod:2,ad:t.translate("02- İptal / İptal Ekleri")},{kod:3,ad:t.translate("03- Primsiz Ekler")}])},n.getBorcKapamaSekliList=function(){return angular.copy([{value:0,title:t.translate("Vade Tarihi Sıralı Otomatik")},{value:1,title:t.translate("Seçilen Taksitler")},{value:2,title:t.translate("Borç Kapama Yapma")}])},n.getHesapTahsilatListeSekliList=function(){return angular.copy([{value:0,title:t.translate("Seçilen Sigortalı")},{value:1,title:t.translate("Tümü")}])},n.getMusteriGrubuListelemeDurumu=function(){return angular.copy([{value:!0,title:t.translate("Listelensin")},{value:!1,title:t.translate("Listelenmesin")}])},n.getKrediKartiIslemSekliList=function(){return angular.copy([{kod:0,ad:t.translate("Tek Çekim - Portföye")},{kod:1,ad:t.translate("Taksitli Çekim - Portföye")},{kod:2,ad:t.translate("Tek Çekim - Şirkete")},{kod:3,ad:t.translate("Taksitli Çekim - Şirkete")}])},n.getKrediKartiIslemTipiList=function(){return angular.copy([{kod:0,ad:t.translate("Blokeli")},{kod:1,ad:t.translate("Mail Order")}])},n.getAylarList=function(){return angular.copy([{kod:"01",ad:t.translate("Ocak")},{kod:"02",ad:t.translate("Şubat")},{kod:"03",ad:t.translate("Mart")},{kod:"04",ad:t.translate("Nisan")},{kod:"05",ad:t.translate("Mayıs")},{kod:"06",ad:t.translate("Haziran")},{kod:"07",ad:t.translate("Temmuz")},{kod:"08",ad:t.translate("Ağustos")},{kod:"09",ad:t.translate("Eylül")},{kod:"10",ad:t.translate("Ekim")},{kod:"11",ad:t.translate("Kasım")},{kod:"12",ad:t.translate("Aralık")}])},n.getTahsilatTuruList=function(){return angular.copy([{kod:0,ad:t.translate("Tümü")},{kod:1,ad:t.translate("Nakit")},{kod:2,ad:t.translate("Banka")},{kod:3,ad:t.translate("Kredi Kartı")},{kod:4,ad:t.translate("Çek")},{kod:5,ad:t.translate("İptal Poliçe")},{kod:6,ad:t.translate("Exchange")},{kod:7,ad:t.translate("Mahsup")}])},n.getTahsilatSiralamaList=function(){return angular.copy([{kod:0,ad:t.translate("Kayıt Tarihi")},{kod:1,ad:t.translate("Tahsilat Şekli")}])},n.getBorcKapamaTarihTipiList=function(){return angular.copy([{kod:0,ad:t.translate("Kayıt Tarihi")},{kod:1,ad:t.translate("Tahsilat Şekli")}])},n.getTaksitSiralamaList=function(){return angular.copy([{kod:0,ad:t.translate("Vade Tarihi")},{kod:1,ad:t.translate("Kayıt Tarihi")},{kod:2,ad:t.translate("Poliçe No")},{kod:3,ad:t.translate("Sigortalı")},{kod:4,ad:t.translate("Prodüktör")}])},n.getKapamaIptaliTarihTipiList=function(){return angular.copy([{kod:0,ad:t.translate("Vade Tarihi")},{kod:1,ad:t.translate("Kayıt Tarihi")}])},n.getKapamaIptaliParaBirimiYerelKarsiligiList=function(){return angular.copy([{kod:0,ad:t.translate("Vade Tarihi")},{kod:1,ad:t.translate("Kayıt Tarihi")},{kod:2,ad:t.translate("Poliçe No")},{kod:3,ad:t.translate("Sigortalı")},{kod:4,ad:t.translate("Prodüktör")}])},n.getPoliceIslemlerTarihTipiList=function(){return angular.copy([{value:0,title:t.translate("Kayıt Tarihi")},{value:2,title:t.translate("Bitiş Tarihi")}])},n.getPoliceIslemlerIslemSirasiList=function(){return angular.copy([{value:0,title:t.translate("Kayıt Tarihi")},{value:1,title:t.translate("Düzenleme Tarihi")},{value:2,title:t.translate("Bitiş Tarihi")}])},n.getPoliceIslemlerListTypesList=function(){return angular.copy([{value:"basic",title:t.translate("Genel Listeleme")},{value:"bulk",title:t.translate("Toplu Seçim")}])},n.getPageTypesList=function(){return angular.copy([{value:10,title:10},{value:25,title:25},{value:50,title:50},{value:100,title:100}])},n.getPoliceIslemlerBakiyeDurumList=function(){return angular.copy([{value:0,title:t.translate("TÜMÜ")},{value:1,title:t.translate("Bakiyeli")},{value:2,title:t.translate("Bakiyesiz")},{value:3,title:t.translate("Hiç ödeme alınmamış")}])},n.getSigortaliHesapTuruList=function(){return angular.copy([{value:0,title:t.translate("Şahıs")},{value:1,title:t.translate("Şirket")}])},n.getSirketlerList=function(){return angular.copy([{value:"",title:t.translate("SEÇİNİZ")},{value:"065",title:"ACE EUROPEAN"},{value:"005",title:"AIG SİGORTA"},{value:"024",title:"AKDENİZ SİGORTA"},{value:"004",title:"AKSİGORTA"},{value:"045",title:"ALLIANZ SİGORTA"},{value:"007",title:"ANADOLU SİGORTA"},{value:"009",title:"ANKARA SİGORTA"},{value:"108",title:"ATLAS SİGORTA"},{value:"040",title:"AXA SİGORTA"},{value:"012",title:"BATI SİGORTA "},{value:"064",title:"BNP CARDIF ELMNT"},{value:"107",title:"COFACE"},{value:"019",title:"DEMİR SİGORTA"},{value:"104",title:"DOĞA SİGORTA"},{value:"063",title:"DUBAİ STARR SİGORTA"},{value:"056",title:"EGE SİGORTA"},{value:"055",title:"EGS"},{value:"022",title:"EMEKSIGORTA"},{value:"035",title:"ERGO SİGORTA"},{value:"109",title:"ETHICA SIGORTA"},{value:"097",title:"EULER"},{value:"002",title:"EUREKO SİGORTA"},{value:"013",title:"G.I.C. DÜNYA SİGORTA"},{value:"025",title:"GENERALİ SİGORTA"},{value:"011",title:"GROUPAMA SİGORTA"},{value:"026",title:"GÜNEŞ SİGORTA"},{value:"028",title:"GÜVEN SİGORTA"},{value:"015",title:"HALK SİGORTA"},{value:"054",title:"HDI SİGORTA"},{value:"031",title:"HÜR SİGORTA"},{value:"044",title:"INTER"},{value:"057",title:"IŞIK SİGORTA"},{value:"058",title:"KAPİTAL SİGORTA"},{value:"096",title:"KORU SİGORTA"},{value:"047",title:"LIBERTY SİGORTA"},{value:"050",title:"MAPFRE GENEL SİGORTA"},{value:"037",title:"MERKEZ SİGORTA"},{value:"093",title:"NEOVA SİGORTA"},{value:"106",title:"ORIENT SİGORTA"},{value:"103",title:"PANDI SİGORTA"},{value:"110",title:"QUICK SİGORTA"},{value:"042",title:"RAY SİGORTA"},{value:"043",title:"RUMELİ SİGORTA"},{value:"059",title:"SANKO"},{value:"049",title:"SBN SİGORTA"},{value:"061",title:"SOMPO JAPAN SİGORTA"},{value:"102",title:"TURİNS SİGORTA"},{value:"051",title:"TÜRK NİPPON SİGORTA"},{value:"017",title:"UNICO SİGORTA"},{value:"052",title:"UNIVARSAL"},{value:"021",title:"XEGESIGORTA"},{value:"029",title:"YAPI KREDİ SİGORTA"},{value:"018",title:"ZURICH SİGORTA"},{value:"092",title:"ZİRAAT SİGORTA"}])},n.getKullanimSekliList=function(){return angular.copy([{value:1,title:t.translate("Mesken")},{value:2,title:t.translate("İşyeri")},{value:4,title:t.translate("Depo")}])},n.getYapiTarziList=function(){return angular.copy([{value:null,title:t.translate("SEÇİNİZ")},{value:1,title:t.translate("Çelik, Betonarme")},{value:2,title:t.translate("Yığma Kagir")},{value:3,title:t.translate("Diğer")}])},n.getIkametSekliList=function(){return angular.copy([{value:null,title:t.translate("SEÇİNİZ")},{value:"Mal Sahibi",title:t.translate("Mal Sahibi")},{value:"Kiracı",title:t.translate("Kiracı")}])},n.getBinaKatiList=function(){return angular.copy([{value:null,title:t.translate("SEÇİNİZ"),rangeLeft:200,rangeRight:-1},{value:5,title:t.translate("01-03 Arası Kat"),rangeLeft:1,rangeRight:3},{value:6,title:t.translate("04-07 Arası Kat"),rangeLeft:4,rangeRight:7},{value:7,title:t.translate("08-18 Arası Kat"),rangeLeft:8,rangeRight:18},{value:8,title:t.translate("19 ve Üzeri Katlar"),rangeLeft:19,rangeRight:200}])},n.getInsaaYiliList=function(){return angular.copy([{value:null,title:t.translate("SEÇİNİZ"),rangeLeft:1900,rangeRight:2100},{value:1,title:t.translate("1975 ve Öncesi"),rangeLeft:1900,rangeRight:1975},{value:2,title:"1976-1999",rangeLeft:1976,rangeRight:1999},{value:3,title:"2000-2006",rangeLeft:2e3,rangeRight:2006},{value:4,title:"2007-2018",rangeLeft:2007,rangeRight:2018},{value:5,title:t.translate("2019 ve Sonrası"),rangeLeft:2019,rangeRight:2100}])},n.getIptalSebebiList=function(){return angular.copy([{value:null,title:"SEÇİNİZ"},{value:"1",title:"Tam İptal"},{value:"2",title:"Tam İptal (Vergisiz)"},{value:"3",title:"Kısmi İptal"},{value:"4",title:"Satıştan İptal"},{value:"5",title:"Hasardan İptal"},{value:"6",title:"Ödeme Sonundan İptal"},{value:"7",title:"Diğer Nedenlerden İptal"},{value:"8",title:"Değer Eksiltme Zeyli"}])},n}]),app.factory("$modal",["$uibModal",function(e){var t={};return t.open=function(t,n,a,i,o){i=i||"";var r={templateUrl:t+cacheSuffix(),controller:n,backdrop:"static",size:i,windowClass:"modal-dialog-scrollable mt-4"};angular.forEach(o,function(e,t){r[t]=e});var l=e.open(r);l.data={},"function"==typeof a&&a(l)},t}]),app.factory("$rest",["$http","$rootScope","$location","$translate","$alert","$culture","$timeout",function(e,t,n,a,i,o,r){var l={endpoint:"/api/",current:0,headers:{"X-Requested-With":"XMLHttpRequest",BaseUrl:n.absUrl()},httpCallbacks:{400:[],401:[],404:[],406:[],422:[],500:[]}};return l.addHTTPCallback=function(e,t){l.httpCallbacks[e].push(t)},l.setHeader=function(e,t){if(void 0===t)return void(l.headers[e]=null);l.headers[e]=t},l.post=function(e,t,a,i,o,r,s){l.headers.BaseUrl=n.absUrl(),l.send("POST",e,t,a,i,o,r,s)},l.get=function(e,t,a,i,o,r,s){l.headers.BaseUrl=n.absUrl(),l.send("GET",e,t,a,i,o,r,s)},l.put=function(e,t,a,i,o,r,s){l.headers.BaseUrl=n.absUrl(),l.send("PUT",e,t,a,i,o,r,s)},l.delete=function(e,t,a,i,o,r,s){l.headers.BaseUrl=n.absUrl(),l.send("DELETE",e,t,a,i,o,r,s)},l.onUnauthoritized=function(){i.error(o.translate("Oturumunuz sonlandırıldı! Ana sayfaya yönlendirileceksiniz...")),r(function(){window.location.href="/"},2e3)
},l.onBadRequest=function(){},l.onNotFound=function(){},l.onNotAcceptable=function(){},l.onUnprocessableEntity=function(e){"SERVICE_CONNECTION_ERROR"===e.code?i.error(o.translateWithArgument(e.code,e.arguments),function(){window.location.href="/"}):i.warning(o.translateWithArgument(e.code,e.arguments))},l.onInternalError=function(){},l.getHeadersAll=function(){return l.headers.Language=a.use(),l.headers},l.send=function(n,a,i,o,r,s,u,c){!0!==c&&null!==c&&l.current++,t.$broadcast("$rest.onStart");var d={method:n,url:l.endpoint+a,headers:l.getHeadersAll(),params:null,data:JSON.stringify(i)};"GET"!==n&&"DELETE"!==n||(d.params=i),null!=u&&1==u&&(d.url=a),e(d).then(function(e){t.$broadcast("$rest.onGetCalculate",{data:JSON.stringify(e.data)}),t.$broadcast("$rest.onDone"),t.$broadcast("$rest.onSuccess"),!0!==c&&null!==c&&l.current--,"function"==typeof o&&o(e.data)},function(e){if(t.$broadcast("$rest.onDone"),t.$broadcast("$rest.onError"),!0!==c&&null!==c&&l.current--,"function"==typeof s)return s(e);void 0!==l.httpCallbacks[e.status]&&angular.forEach(l.httpCallbacks[e.status],function(t){t(e.data)}),"function"==typeof r&&r(e.data)})},l.onCreate=function(){l.addHTTPCallback(400,l.onBadRequest),l.addHTTPCallback(401,l.onUnauthoritized),l.addHTTPCallback(404,l.onNotFound),l.addHTTPCallback(406,l.onNotAcceptable),l.addHTTPCallback(422,l.onUnprocessableEntity),l.addHTTPCallback(500,l.onInternalError),t.$broadcast("rest.onReady")},l}]),app.factory("$rootSettings",function(){var e={values:null,callbacks:[]};return e.whenReady=function(t){if(null===e.values)return e.callbacks.push(t);t()},e.set=function(t){e.values=t,angular.forEach(e.callbacks,function(e){e()})},e.get=function(){if(null===e.values)throw"$rootSettings.whenReady() is required!";return angular.copy(e.values)},e.getByPath=function(t){for(var n=e.get(),a=t.split("."),i=0;i<a.length;i++)n=n[a[i]];return n},e}),app.factory("$storage",["localStorageService",function(e){var t={};return t.set=function(t,n){e.set(t,n)},t.get=function(t){return e.get(t)},t}]),app.factory("$validations",["$auth","$timeout","$currency","$elements",function(e,t,n,a){var i={callbacks:[]},o=null,r={isVisible:null,isRequired:null,isQuery:null,isDisabled:null,pattern:null,maxLength:null,minLength:null,maxValue:null,minValue:null},l=function(e){return!1===e.isVisible&&(e.isRequired=!1),e},s=function(e){var t=null;if(-1===e.indexOf("."))return t=o.find(function(t){return t.parentCode===e}),l(t);var n=e.split(".");t=o.find(function(e){return e.parentCode===n[0]&&null===e.fieldCode}),void 0===t&&(t=r),t=angular.copy(t);var a=o.find(function(e){return e.parentCode===n[0]&&e.fieldCode===n[1]});return void 0===a?l(t):(null!==a.isVisible&&(t.isVisible=a.isVisible),null!==a.isRequired&&(t.isRequired=a.isRequired),null!==a.isQuery&&(t.isQuery=a.isQuery),null!==a.isDisabled&&(t.isDisabled=a.isDisabled),void 0!==a.pattern&&null!==a.pattern&&a.pattern.toString().length>0&&(t.pattern=a.pattern),void 0!==a.minLength&&null!==a.minLength&&a.minLength.toString().length>0&&(t.minLength=a.minLength),void 0!==a.maxLength&&null!==a.maxLength&&a.maxLength.toString().length>0&&(t.maxLength=a.maxLength),void 0!==a.minValue&&null!==a.minValue&&a.minValue.toString().length>0&&(t.minValue=a.minValue),void 0!==a.maxValue&&null!==a.maxValue&&a.maxValue.toString().length>0&&(t.maxValue=a.maxValue),void 0!==a.inputMask&&null!==a.inputMask&&a.inputMask.toString().length>0&&(t.inputMask=a.inputMask),void 0!==a.dateDisplay&&null!==a.dateDisplay&&a.dateDisplay.toString().length>0&&(t.dateDisplay=a.dateDisplay),void 0!==a.dateFirstDayOfWeek&&null!==a.dateFirstDayOfWeek&&a.dateFirstDayOfWeek.toString().length>0&&(t.dateFirstDayOfWeek=a.dateFirstDayOfWeek),l(t))};i.isInvalid=function(e){return e.$dirty&&e.$invalid};var u=function(e,t){if(void 0!==t.$$attr.formCurrency){var i=parseFloat(n.toService(t.$viewValue));if(!isNaN(i)){var o=t.$$attr.formCurrency.split(".");if(void 0!==a[o[0]]&&void 0!==a[o[0]][o[1]]){var r=a[o[0]][o[1]];(null!==r.minValue&&i<=r.minValue||null!==r.maxValue&&i>=r.maxValue)&&(t.$valid=!1,t.$invalid=!0,e.$valid=!1)}}}};return i.validate=function(e,n,a,i,o,r){angular.forEach(e,function(t,n){"string"==typeof n&&"$"!==n.charAt(0)&&(t.$setDirty(),u(e,t),t.$invalid&&t.$$element.addClass("is-not-valid"))}),e.$valid?n(a,i,o,r):t(function(){$(".is-not-valid").addClass("shake"),t(function(){$(".is-not-valid").removeClass("shake").removeClass("is-not-valid")},400)})},i.checkValid=function(e){var t=!0;return angular.forEach(e,function(e){0==e.$valid&&(t=!1)}),t},i.onCreate=function(){e.whenReady(function(){o=e.get("validations"),angular.forEach(i.callbacks,function(e){e.callback(s(e.key))})})},i.getByKey=function(e){return s(e)},i.get=function(e,t){return void 0===e?t(r):null===o?i.callbacks.push({key:e,callback:t}):void t(s(e))},i.getValue=function(e,t){if(null===o)return null;var n=s(e);return void 0===n||null===n?null:n[t]},i.isVisible=function(e){return i.getValue(e,"isVisible")},i.isRequired=function(e){return i.getValue(e,"isRequired")},i.isQuery=function(e){return i.getValue(e,"isQuery")},i.isDisabled=function(e){return i.getValue(e,"isDisabled")},i.getPattern=function(e){return i.getValue(e,"pattern")},i.getMaxLength=function(e){return i.getValue(e,"maxLength")},i.getMinLength=function(e){return i.getValue(e,"minLength")},i.getMax=function(e){return i.getValue(e,"maxValue")},i.getMin=function(e){return i.getValue(e,"minValue")},i}]),app.factory("$viewFactory",["$http",function(e){var t={},n={};return t.get=function(t,a){if(void 0!==n[t])return a(n[t]);e.get("/content/views/"+t).then(function(e){n[t]=e.data,a(e.data)})},t}]),app.controller("Modals.ConfirmationTextController",["$scope","$uibModalInstance","$sce","$rest",function(e,t,n,a){e.form=t.data,e.init=function(){var t={contentType:e.form.contentType};a.get("welcome/confirmationtext",t,function(t){e.form.content=t.content})},e.getAsTrustedHtml=function(){return n.trustAsHtml(e.form.content)},e.agree=function(){e.form.onSuccess(!0),e.close()},e.cancel=function(){t.dismiss("cancel"),e.form.onSuccess(!1)},e.close=function(){t.dismiss("cancel")},e.init()}]),app.controller("Modals.EditPhoneNumberController",["$scope","$uibModalInstance","$alert","$culture","$validations","$elements",function(e,t,n,a,i,o){e.data=t.data,e._validator=i,e.elements=o,e.data.newGSMNo=e.data.GSMNo,e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.save=function(){null!==e.data.newGSMNo&&""!==e.data.newGSMNo?(e.data.onSuccess(e.data),e.cancel()):n.error(a.translate("Yeni numara alanı boş bırakılamaz!"))},e.cancel=function(){e.data.onCancel(),t.dismiss("cancel")},e.validate=function(t,n,a,i,o,r){e._validator.validate(t,n,a,i,o,r)}}]),app.controller("Modals.InformationTextController",["$scope","$uibModalInstance","$sce",function(e,t,n){e.form=t.data,e.init=function(){e.form.document.isInformationTextDocumentExist&&!e.form.document.isDefaultInformationTextDocumentExist&&(e.result=e.form.document.informationDocument),!e.form.document.isInformationTextDocumentExist&&e.form.document.isDefaultInformationTextDocumentExist&&(e.result=n.trustAsResourceUrl(e.form.document.defaultInformationDocument.siteUrl+e.form.document.defaultInformationDocument.pdfLocation))},e.agree=function(){e.form.onSuccess(!0),e.close()},e.cancel=function(){t.dismiss("cancel"),e.form.onSuccess(!1)},e.close=function(){t.dismiss("cancel")},e.init()}]),app.controller("Car.QuotationController",["$scope","$rootScope","$state","$modal","$rest","$lists","$culture","$form","$tia","$sce","$alert","$rootSettings","$insured","$currency","$storage","$welcomeInit","$timeout","$boxesInit","$filter","$handcuff","$location","vcRecaptchaService","$dateFormatter",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S,C){e.params={ab:null,arabrans:null,menu:null,menuurl:null},e.current=0,e.currentWizard=1,e.activeWizard=1,e.isCustomerExists=null,e.isLoggedIn=!1,e.menuData={},e.welcomeInit=g,e.isQuotationPreparing=!1,e.isDefaultBannerActive=!0,e.portalMenusKeywords=null,e.isBack=!1,e.isInsuredInfoRunning=!1,e.sID=null,e.isSmsSend=!1,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isNextButtonDisabled=!1,e.isSendGDPRLog=!1,e.isSendMarketingLog=!1,e.isVehicleInfoRequired=!1,e.isViewTiaForm=!1,e.isChatBiNumberValidated=!1,e.isArchiveSaved=!1,e._tia={data:null,onPrev:null,onNext:null,current:null},e.isEmailRegex=!0,e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null,devirAracMotorSasi:null,devirAracYolcuSayisi:null,smsActivationLocation:"getQuotation",smsActivateDescription:null,isVerifyRCPT:!1,isViewDateOfBirth:!1,egmTescilGun:0,yenilemeTrafikGun:0,devirTrafikGun:0,yenilemeKaskoGun:0,devirKaskoGun:0,isReplaceLetterByStar:!0},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.form={Tip:"personal",MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,Unvan2:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,AracDurumu:"0",IlKodu:null,IlceKodu:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,Plaka:null,RuhsatNo:null,ModelYili:null,Marka:null,Model:null,KullanimTarzi:null,KullanimDetayi:null,MotorNo:null,SasiNo:null,YolcuSayisi:null,DogumTarihi:null,PlakaYK:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,Permissions:!0},e.contact={name:null,surname:null,phone:null,message:null},e.data={sehirList:[],ilceList:[],modelYillariList:[],aracMarkaList:[],tarifeList:[],aracModelList:[{tip:r.translate("SEÇİNİZ"),tipkodu:null}],altTarifeList:[{ad:r.translate("SEÇİNİZ"),kod:null}],sigortaliAracList:[]},e.PSBSStatus={AP:0,KP:0,DP:0,UP:0,TP:0,KsP:0,EP:0},e.onCreate=function(){e.welcomeInit.isSuccessData?e.initData():t.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){""!==n.params.menuurl&&null!==n.params.menuurl||n.go("PageNotFound",{},{reload:!0});var a=I.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};p.set("Ref",t)}});var o=g;if(e.menus=o.getMenus(),angular.forEach(o.getMenus(),function(a){n.params.menuurl==a.menuURL&&(e.params.ab=parseInt(a.main_product),e.params.arabrans=a.product,e.params.menuurl=a.menuURL,e.params.menu=a.id,e.form.AnaBrans=e.params.ab,e.form.AraBrans=e.params.arabrans,e.menuData=a,e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:e.menuData.id,viewLocation:"QUOTATION"},function(){var n=e.welcomeInit;if(e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.setSeoSettings(n.getSeoSettings()),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.PK=n.getReCaptchaKeys(),null!==e.PK&&void 0!==e.PK&&""!==e.PK&&e.formParameters.isVerifyRCPT&&!0!==e.isLoggedIn?(e.isViewReCaptcha=!0,e.isNextButtonDisabled=!0):(e.isNextButtonDisabled=!1,e.isViewReCaptcha=!1),e.setAnnouncements(),e.setQuickLinks(),e.boxesInit=k.onCreate(e.menuData.id),t.$on("$boxesInit.onSuccess",function(){e.boxesData=k.getBoxes(e.menuData.id),e.getCategories(e.boxesData),e.openAnnounceModal()}),(null!=e.menuData.quotationFormStyle&&""!=e.menuData.quotationFormStyle&&void 0!=e.menuData.quotationFormStyle||"STYLE-3"!=e.quotationFormStyles.formStyle)&&"STYLE-3"!=e.menuData.quotationFormStyle||(e.onVehicleCreate(),e.isLoggedIn&&e.doCollectVehicleInfo()),i.get("status",{},function(t){e.PSBSStatus=t,i.get("welcome/menus/menuskeywords/"+e.menuData.id,{},function(t){e.portalMenusKeywords=t})})})}))}),d.set(o.getRootSettings()),!0!==e.isLoggedIn&&null!==o.getDynamicContent()&&(e.dynamicContent=o.getDynamicContent(),e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.PCR&&(e.form.PrivacyPolicy=!1),(e.dynamicContent.GCR||e.dynamicContent.PCR)&&(e.form.Permissions=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)),null!==o.getDynamicContent()){var l=o.getDynamicContent();l.quotationConfirmContent?e.quotationConfirmContent=l.quotationConfirmContent:e.quotationConfirmContent='<font size="3"><b>'+r.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>"}else e.quotationConfirmContent='<font size="3"><b>'+r.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>";if(null!==e.menuData.tawkCode&&void 0!==e.menuData.tawkCode&&""!==e.menuData.tawkCode){var s=e.menuData.tawkCode;e.setCustomTawk(s)}e.getCityList(function(){var t=angular.copy(e.menus);e.menus=[],angular.forEach(t,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onChangeProvince(function(){e.form.IlceKodu=o.IlceKodu}),e.isLoggedIn&&"CHATBI-STYLE-1"==e.menuData.quotationFormStyle&&e.getInsuredVehicleList()});var u=I.search();u&&(void 0!==u.id&&""!==u.id&&void 0==u.cid&&(e.form.Tip="personal",e.form.MusteriTipi=1,e.form.HesapKodu=u.id),void 0!==u.cid&&""!==u.cid&&void 0==u.id&&(e.form.Tip="company",e.form.MusteriTipi=2,e.form.HesapKodu=u.cid),void 0!==u.eml&&""!==u.eml&&(e.form.EMail=u.eml),void 0!==u.gs&&""!==u.gs&&(e.form.GSMNo=u.gs),void 0!==u.uv&&""!==u.uv&&(e.form.Unvan=u.uv),void 0!==u.tt&&""!==u.tt&&(e.form.AracDurumu=u.tt))},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.params.menu,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],s=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalMenuId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(s,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalMenuId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=g.getPanelSettings()?g.getPanelSettings().siteName:"Polisoft Ltd");for(var u=0;u<r.length;u++)"robots"!==r[u].getAttribute("name")||i||(r[u].content="index, follow"),"description"!==r[u].getAttribute("name")||o||(r[u].content=g.getPanelSettings()?g.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=g;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalMenuId===e.menuData.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.isNavigationActive=function(e){return e?"current":"pending"},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===g.OpenedAnnounceModals.indexOf(e.menuData.menuURL)&&!0===e.menuData.isViewAnnounce){var t=!1;angular.forEach(e.boxesData.defaultItems,function(n){n.portalMenuId==e.menuData.id&&!0===n.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(t){t.data={menuId:e.menuData.id},g.OpenedAnnounceModals.push(e.menuData.menuURL)},"lg")}},e.setNavigation=function(t){e.form.AracDurumu=t},e.setVehicleStatus=function(t){e.form.AracDurumu=t,e.isLoggedIn&&e.doCollectVehicleInfo()},e.onNextStep=function(){e.current++,e.currentWizard=null,1==e.current&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),1!==e.current&&document.getElementById("form-start").scrollIntoView()},e.onBackStep=function(){2==e.current&&(e.isCustomerExists=null),1==e.current&&e.clearForm(),e.current--,e.currentWizard=null,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.clearForm=function(){e.form.Plaka=null,e.form.RuhsatNo=null,e.form.ModelYili=null,e.form.Marka=null,e.form.Model=null,e.form.KullanimTarzi=null,e.form.KullanimDetayi=null,e.form.MotorNo=null,e.form.SasiNo=null,e.form.YolcuSayisi=null,e.form.PlakaYK=null},e.reload=function(){n.reload()},e.getCityList=function(t){null!==m.getActiveInsured()&&(e.isLoggedIn=!0,e.form.HesapKodu=m.getActiveInsured().HesKod,e.form.Unvan=m.getActiveInsured().Unvan,e.form.IlKodu=m.getActiveInsured().IlKodu,e.form.IlceKodu=m.getActiveInsured().IlceKodu,e.form.EMail=m.getActiveInsured().EMail,e.form.DogumTarihi=C.identityServiceToInput(m.getActiveInsured().DogumTarihi),!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=m.getActiveInsured().GSMNo,null!==e.form.IlKodu&&void 0!==e.form.IlKodu&&""!==e.form.IlKodu||(e.form.IlKodu="001"),null!==e.form.IlceKodu&&void 0!==e.form.IlceKodu&&""!==e.form.IlceKodu||(e.form.IlceKodu="001"),0===m.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==m.getActiveInsured().VergiNo&&""!==m.getActiveInsured().VergiNo&&void 0!==m.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2),"Bilgilendirme Yapıldı"===m.getActiveInsured().KVKKDurum&&(e.form.KVKK=!0),!0===e.isLoggedIn&&(e.form.KVKK=!0,e.form.Agreement=!0,e.form.Permissions=!0,e.form.PrivacyPolicy=!0),"Bilgilendirme Yapıldı"!==m.getActiveInsured().KVKKDurum&&!0!==e.isLoggedIn&&null!==e.dynamicContent&&(e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)));var n={AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans};i.post("quotation/pre",n,function(n){e.serviceConnectionStatus=n.WSCS,e.sID=n.SID,!1===n.isLogged&&(m.set(null),m.setAccountId(null),m.setList(null),e.isLoggedIn=!1),i.get("portal/lists/cities",null,function(n){e.data.sehirList=n,e.data.sehirList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.sehirList.unshift({kod:null,ad:r.translate("SEÇİNİZ")}),"function"==typeof t&&t()})}),e.insuredInfo=m.getActiveInsured()},e.onChangeProvince=function(){i.get("portal/lists/districts",{cityCode:e.form.IlKodu},function(t){e.data.ilceList=t,e.data.ilceList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.ilceList.unshift({kod:null,ad:r.translate("SEÇİNİZ")})},null,null,null,!0)},e.getIdentityDetails=function(t){if(auto=!!t,e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.KVKK&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.KVKK,privacyStatus:e.form.Agreement,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi),password:null};e.isInsuredInfoRunning=!0,n.sID=e.sID,null!==e.form.FlexPassword&&void 0!==e.form.FlexPassword&&""!==e.form.FlexPassword&&e.form.FlexPassword.length>3&&(n.password=e.form.FlexPassword),i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,c.error(r.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.current=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}if(n.isFlexActive)try{if(null==n.flex)return c.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir."),e.form.FlexPassword=null,void(e.isInsuredInfoRunning=!1);e.flex=n.flex}catch(t){if(null==n.flex)return c.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir."),e.form.FlexPassword=null,void(e.isInsuredInfoRunning=!1);e.flex=n.flex}if(0==n.isGSMValid&&"personal"==e.form.Tip)a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){if(!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation)e.doSendSMS(function(){e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView())});else if(e.isLoggedIn)e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.doCollectVehicleInfo();else{e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView());var a="";"0"===e.form.AracDurumu&&(a="RENEWAL_CAR"),"1"===e.form.AracDurumu&&(a="USED_CAR"),"2"===e.form.AracDurumu&&(a="NEW_CAR"),i.post("f/nx/wlg",{wizardTitle:a,sID:e.sID},function(){e.onVehicleCreate(),"function"==typeof t&&t()},null,null,null,!0)}})},onCancel:function(){e.isInsuredInfoRunning=!1}}});else if(!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation)e.doSendSMS(function(){e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView())});else if(e.isLoggedIn)e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.doCollectVehicleInfo();else{e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView());var o="";"0"===e.form.AracDurumu&&(o="RENEWAL_CAR"),"1"===e.form.AracDurumu&&(o="USED_CAR"),"2"===e.form.AracDurumu&&(o="NEW_CAR"),i.post("f/nx/wlg",{wizardTitle:o,sID:e.sID},function(){e.onVehicleCreate(),"function"==typeof t&&t()},null,null,null,!0)}},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSMNo,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi),sID:e.sID};i.post("insured/update",n,function(e){"function"==typeof t&&t()},function(){e.isInsuredInfoRunning=!1})},e.doCollectVehicleInfo=function(){var t={pHesapKodu:e.form.HesapKodu};i.post("insured/vehicles",t,function(t){t.length>0&&angular.forEach(t,function(e){e.asbisno=y.remove(e.asbisno),e.id=y.remove(e.id),e.plaka=y.remove(e.plaka),e.ruhsat=y.remove(e.ruhsat),e.ruhsatno=y.remove(e.ruhsatno)}),e.data.sigortaliAracList=t,e.data.sigortaliAracList.unshift({value:null,plaka:r.translate("SEÇİNİZ")}),e.form.AracSecimi=e.data.sigortaliAracList[0];var n="";"0"===e.form.AracDurumu&&(n="RENEWAL_CAR"),"1"===e.form.AracDurumu&&(n="USED_CAR"),"2"===e.form.AracDurumu&&(n="NEW_CAR"),i.post("f/nx/wlg",{wizardTitle:n,sID:e.sID},function(){e.onVehicleCreate(),"function"==typeof callback&&callback()},null,null,null,!0)},null,null,null,!0)},e.doSendSMS=function(t){a.open("/content/views/sms-insured-modal.html","SMSVerifyInsuredModalController",function(n){n.data={data:e.form,sID:e.sID,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n,a){e.pSMSToken=n,e.isSmsSend=a,"function"==typeof t&&t()},onModalCancel:function(){e.isInsuredInfoRunning=!1}}})},e.checkCustomerAddressData=function(){if(!(e.form.IlKodu&&e.form.IlceKodu&&e.form.Unvan))return void(e.isNewInsuredInfosRequired=!0);e.isNewInsuredInfosRequired=!1,e.current=2,e.currentWizard=3,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate()},e.getCarDetails=function(){if(e.isFieldsValid())if("0"===e.form.AracDurumu)if(5==e.form.AnaBrans&&1==e.PSBSStatus.TP||4==e.form.AnaBrans&&1==e.PSBSStatus.KsP){var t={pPlaka:e.form.Plaka,pKN:e.form.HesapKodu,sID:e.sID};i.post("quotation/arackontrol",t,function(t){if(0===t.ResultCode)return null!==t.secure.KullanimTarzi&&""!==t.secure.KullanimTarzi&&void 0!==t.secure.KullanimTarzi&&(e.form.KullanimTarzi=t.secure.KullanimTarzi),e.current=3,document.getElementById("form-start").scrollIntoView(),void e.setWarrants();215==t.ResultCode?c.info(r.translate("Poliçe yenileme bilgileriniz tespit edilemedi..!")):c.info(t.ResultMessage)},null,null,null,!0)}else c.error(r.translate("Poliçe yenileme bilgileriniz tespit edilemedi. Hata Kodu: TA-0001"));else e.current=3,document.getElementById("form-start").scrollIntoView(),e.setWarrants()},e.getCarDetailsStyleThree=function(){if(e.isFieldsValid())if("0"===e.form.AracDurumu)if(5==e.form.AnaBrans&&1==e.PSBSStatus.TP||4==e.form.AnaBrans&&1==e.PSBSStatus.KsP){var t={pPlaka:e.form.Plaka,pKN:e.form.HesapKodu,sID:e.sID};i.post("quotation/arackontrol",t,function(t){if(0===t.ResultCode)return null!==t.secure.KullanimTarzi&&""!==t.secure.KullanimTarzi&&void 0!==t.secure.KullanimTarzi&&(e.form.KullanimTarzi=t.secure.KullanimTarzi),document.getElementById("form-start").scrollIntoView(),e.setWarrants(),void(e.currentWizard=4);e.isCustomerExists=null,215==t.ResultCode?c.info(r.translate("Poliçe yenileme bilgileriniz tespit edilemedi..!")):c.info(t.ResultMessage)},null,null,null,!0)}else e.isCustomerExists=null,c.error(r.translate("Poliçe yenileme bilgileriniz tespit edilemedi. Hata Kodu: TA-0001"));else e.currentWizard=3,document.getElementById("form-start").scrollIntoView()},e.checkVehicle=function(){if(1==e.PSBSStatus.EP)if("1"===e.form.AracDurumu||"0"===e.form.AracDurumu){var t={pPlaka:e.form.Plaka,pRuhsatAsbisNo:e.form.RuhsatNo};e.isChecking=!0,i.post("webservice/earackontrol",t,function(t){0===t.eresult.return.HataKodu&&(t.eresult.return.PlakaNo=y.remove(t.eresult.return.PlakaNo),t.eresult.return.MotorNo=y.remove(t.eresult.return.MotorNo),t.eresult.return.SasiNo=y.remove(t.eresult.return.SasiNo),t.eresult.return.Unvan=y.remove(t.eresult.return.Unvan),t.eresult.return.Soyad=y.remove(t.eresult.return.Soyad),t.eresult.return.TescilSeriNo=y.remove(t.eresult.return.TescilSeriNo)),0===t.eresult.return.HataKodu?(e.form.ModelYili=parseInt(t.eresult.return.ModelYili),angular.forEach(e.data.aracMarkaList,function(n){n.marka==t.eresult.return.Marka&&(e.form.Marka=n.markakodu,e.onChangeMarka(function(){e.onChangeModel()}))}),e.onNextWizard(),document.getElementById("form-start").scrollIntoView()):2===t.eresult.return.HataKodu?c.warning(r.translate("Girdiğiniz bilgiler geçersiz..! Plaka ya da Ruhsat Seri Numarasını yanlış girmiş olabilirsiniz.")):c.warning(r.translate(t.eresult.return.HataMesaji)),e.isChecking=!1},function(){e.isChecking=!1},null,null,!0)}else e.onNextWizard();else c.warning(r.translate("Araç sorgusu yapılamadı. İşleme devam edilemiyor..!"))},e.isFieldsValid=function(){var t=angular.copy(e.form);if(1===e.current||2==e.currentWizard)return 1==t.KVKK&&(!(null===t.Unvan&&e.formParameters.sigortaliAdSoyad||null===t.HesapKodu||null===t.GSMNo||null==t.DogumTarihi&&e.formParameters.isViewDateOfBirth&&"personal"==e.form.Tip)||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1));if(2===e.current||3==e.currentWizard){if("0"===e.form.AracDurumu)return null!==t.Plaka||null!==t.RuhsatNo||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1)
;if("1"===e.form.AracDurumu)return null!==t.Plaka||null!==t.RuhsatNo||null!==t.ModelYili||null!==t.Marka||null!==t.Model||null!==t.KullanimTarzi||null!==t.KullanimDetayi||null!==t.MotorNo||null!==t.SasiNo||null!==t.YolcuSayisi||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1);if("2"===e.form.AracDurumu)return null!==t.PlakaYK||null!==t.ModelYili||null!==t.Marka||null!==t.Model||null!==t.KullanimTarzi||null!==t.KullanimDetayi||null!==t.MotorNo||null!==t.SasiNo||null!==t.YolcuSayisi||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1)}},e.onVehicleCreate=function(){i.get("vehicle/brands",{},function(t){e.data.aracMarkaList=t,e.data.modelYillariList=[{kod:null,ad:r.translate("SEÇİNİZ")}],e.data.aracMarkaList.unshift({markakodu:null,marka:r.translate("SEÇİNİZ")}),e.data.tarifeList=o.getTarifeler().addSelection();for(var n=parseInt(moment().format("YYYY"));n>1970;n--)e.data.modelYillariList.push({kod:n,ad:n})},null,null,null,!0)},e.onChangeMarka=function(t){var n={pMarkaKodu:e.form.Marka,pModelYili:e.form.ModelYili};i.get("vehicle/models",n,function(n){e.data.aracModelList=n,e.data.aracModelList.unshift({arackodu:null,tip:r.translate("SEÇİNİZ"),tipkodu:null}),"function"==typeof t&&t()},null,null,null,!0)},e.onChangeModelYili=function(){if(null!==e.form.Marka){var t={pMarkaKodu:e.form.Marka,pModelYili:e.form.ModelYili};e.form.Model=null,i.get("vehicle/models",t,function(t){e.data.aracModelList=t,e.data.aracModelList.unshift({arackodu:null,tip:r.translate("SEÇİNİZ"),tipkodu:null})},null,null,null,!0)}},e.onChangeTramerTarifeKodu=function(){e.form.AracDetayTipi=null,o.getSilent("ALT_TARIFE",e.form.KullanimTarzi,null,function(t){e.data.altTarifeList=t.addSelection(),e.data.altTarifeList.length>1&&(e.form.KullanimDetayi=e.data.altTarifeList[1].kod)},!0)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),l.fetchTIA(e,{pAnaBrans:e.params.ab,pAraBrans:e.params.arabrans,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),l.isTIAActive(e._tia)},e.setWarrantsChatBid=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0");var n=null,a=null;4==e.form.AnaBrans&&(n=e.params.ab,a=e.params.arabrans),5==e.form.AnaBrans&&(n=4,a=e.menuData.chatbiCascoProduct),l.fetchChatBiTIA(e,{pAnaBrans:n,pAraBrans:a,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),l.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=f.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),s.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.trustAsHtml=function(e){return u.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return u.trustAsHtml(e)},e.doSubmitViaSMS=function(){1==e.isLoggedIn&&(e.isSmsSend=!0);var t=l.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.pDogumTarihi=C.dateInputToService(e.form.DogumTarihi),2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}t.sID=e.sID,angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!1,"insuredInformationForm"==e.formParameters.smsActivationLocation&&(t.isSmsVerified=!0),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var i=p.get("Ref");null!==i&&""!==i&&void 0!==i&&void 0!==i.kod&&null!==i.kod&&""!==i.kod&&(t.pReferansPersonelKodu=i.kod),c.confirmHtmlContent(e.quotationConfirmContent,function(){e.isSmsSend?e.doSubmit(t):a.open("/content/views/sms-modal.html","SMSVerifyModalController",function(n){n.data={data:t,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n){t.pSMSToken=n,e.doSubmit(t)}}})})},e.doSubmit=function(t){e.isQuotationPreparing=!0;try{null!==e.flex&&void 0!==e.flex&&(t.TeklifAciklama="("+e.flex.Points[0].PolicyType+" "+e.flex.Points[0].Point+") ("+e.flex.Points[1].PolicyType+" "+e.flex.Points[1].Point+")")}catch(e){}i.post("quotation/kaydet",t,function(t){p.set("Quotation",null);var n={pPoliID:t.href,pTip:1};0==t.ResultCode?0!==t.href&&"0"!==t.href&&null!==t.href&&""!==t.href?i.post("l/a/wlg",{},function(){p.set("Quotation",n),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):c.error(r.translate("Teklif Kaydedilemedi!")):(e.isQuotationPreparing=!1,null!==t.ResultMessage&&""!==t.ResultMessage?215==t.ResultCode?c.info(r.translate("Poliçe yenileme bilgileriniz tespit edilemedi..!")):c.info(t.ResultMessage):c.info(r.translate("Ruhsat Numarası Hatalı..!"))),e.isSaving=!1},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)},e.selectVehicle=function(){var t=e.form.AracSecimi;if(void 0!==t.id&&null!==t.id){var n={pAracID:t.id,pHesKod:e.form.HesapKodu};i.get("insured/vehicles",n,function(t){null!==t&&""!==t&&(t.arackodu=y.remove(t.arackodu),t.asbisno=y.remove(t.asbisno),t.id=y.remove(t.id),t.plaka=y.remove(t.plaka),t.ruhsat=y.remove(t.ruhsat),t.ruhsatno=y.remove(t.ruhsatno),t.motorno=y.remove(t.motorno),t.sasino=y.remove(t.sasino)),e.form.Plaka=t.plaka,e.form.ModelYili=parseInt(t.yil),e.form.AracKodu=t.arackodu,e.form.KullanimTarzi=parseInt(t.tarifekodu),e.form.MotorNo=t.motorno,e.form.SasiNo=t.sasino,e.form.YolcuSayisi=parseInt(t.yeradet),e.form.RuhsatNo=t.ruhsatno,e.form.KullanimDetayi=t.aracdetaykodu,angular.forEach(e.data.sehirList,function(n){parseInt(n.kod)===parseInt(t.plaka)&&(e.form.PlakaYK=n.kod)}),0===e.form.KullanimTarzi&&(e.form.KullanimTarzi=null),e.searchByVehicleCode(),e.onChangeTramerTarifeKodu(function(){e.form.AracDetayTipi=t.aracdetaykodu,""===e.form.AracDetayTipi&&(e.form.AracDetayTipi=null)})},null,null,null,!0)}},e.searchByVehicleCode=function(){e.form.Marka=e.form.AracKodu.substr(0,3).toString(),e.onChangeMarka(function(){v(function(){e.form.Model=e.form.AracKodu.substr(3),e.onChangeModel()},10)})},e.onChangeModel=function(){angular.forEach(e.data.aracModelList,function(t){t.tipkodu===e.form.Model&&(e.form.AracKodu=t.arackodu)}),e.form.AracKodu},e.getModel=function(t){var n=null;return angular.forEach(e.data.aracModelList,function(e){parseInt(t)===parseInt(e.tipkodu)&&(n=e.tip)}),n},e.getMarka=function(t){var n=null;return angular.forEach(e.data.aracMarkaList,function(e){t==e.markakodu&&(n=e.marka)}),n},e.openConfirmationModal=function(t){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"KVKK"==t&&e.onChangeGdpr()}}},"lg")},e.openChatBidConfirmationModal=function(e){a.open("/content/views/modals/chatbid-confirmation-text-modal.html","Modals.ConfirmationTextController",function(t){t.data={contentType:e,onSuccess:function(e){}}},"lg")},e.setCustomTawk=function(e){t.$broadcast("@SetupTawkForCustomEndpoint",e)},e.onChangeGdpr=function(t){v(function(){if(e.form.KVKK){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){e.isSendGDPRLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangeMarketing=function(t){v(function(){if(e.form.Agreement){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){e.isSendMarketingLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeGdprAndMarketing=function(t){e.form.KVKK=t,e.form.PrivacyPolicy=t,e.onChangeGdpr(function(){})},e.onChangeMusteriTipi=function(t){e.form.MusteriTipi="personal"==t?1:2},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=h("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.cbExpiration=function(){S.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(S.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isNextButtonDisabled=!1:(e.isNextButtonDisabled=!0,c.error(r.translate("reCAPTCHA doğrulanamadı..!")),S.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&c.info(e)},e.validateFlexPassword=function(){if(null!==e.form.FlexPassword&&void 0!==e.form.FlexPassword&&""!==e.form.FlexPassword&&e.form.FlexPassword.length>3){var t={password:e.form.FlexPassword};e.isFlexPasswordInProgress=!0,i.post("flex/check",t,function(t){if(e.isFlexPasswordInProgress=!1,!0!==t.Success)return c.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir."),e.form.FlexPassword=null,void(e.isInsuredInfoRunning=!1);e.flex=t},function(t){e.isFlexPasswordInProgress=!1,e.form.FlexPassword=null,c.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir.")})}},e.clearChatBidForm=function(){e.activeWizard=1,e.isArchiveSaved=!1,e.form={Tip:"personal",MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,AracDurumu:"0",IlKodu:null,IlceKodu:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,Plaka:null,RuhsatNo:null,ModelYili:null,Marka:null,Model:null,KullanimTarzi:null,KullanimDetayi:null,MotorNo:null,SasiNo:null,YolcuSayisi:null,DogumTarihi:null,PlakaYK:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,Permissions:!1},e.isLoggedIn&&(e.form.HesapKodu=m.getActiveInsured().HesKod,e.form.Unvan=m.getActiveInsured().Unvan,e.form.IlKodu=m.getActiveInsured().IlKodu,e.form.IlceKodu=m.getActiveInsured().IlceKodu,e.form.EMail=m.getActiveInsured().EMail,e.form.DogumTarihi=C.identityServiceToInput(m.getActiveInsured().DogumTarihi),e.form.Permissions=!0,!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=m.getActiveInsured().GSMNo,null!==e.form.IlKodu&&void 0!==e.form.IlKodu&&""!==e.form.IlKodu||(e.form.IlKodu="001"),null!==e.form.IlceKodu&&void 0!==e.form.IlceKodu&&""!==e.form.IlceKodu||(e.form.IlceKodu="001"),0===m.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==m.getActiveInsured().VergiNo&&""!==m.getActiveInsured().VergiNo&&void 0!==m.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2))},e.activateWizard=function(t){e.activeWizard=t,1==e.activeWizard&&(e.isCustomerExists=null,e.encryptedName=null,e.isVehicleInfoRequired=!1,e.isViewTiaForm=!1,e.form.ModelYili=null,e.form.AracKodu=null,e.form.Marka=null,e.form.Model=null,e.form.KullanimTarzi=null,e.form.KullanimDetayi=null,e.form.MotorNo=null,e.form.SasiNo=null,e.form.YolcuSayisi=null,e.form.PlakaYK=null,e.form.TescilTarihi=null,e.form.TrafigeCikisTarihi=null,e.form.Tonaj=null,e.form.Basamak=null,e.form.HasarAdet=null,e.form.SirketKodu=null,e.form.AcenteKodu=null,e.form.BitisTarihi=null,e.form.PoliceNo=null,e.form.YenilemeNo=null,e.form.Unvan=null,e.form.DogumTarihi=null,e.form.EMail=null,e.form.GSMNo=null,e.form._tia={teminat:{},indirim:{},aciklama:{}},e.isArchiveSaved=!1),2==e.activeWizard&&i.post("f/nx/wlg",{wizardTitle:"CHATBI",sID:e.sID},function(){},null,null,null,!0),4==e.activeWizard&&(e.isChatBiNumberValidated=!1,e.form.pSessionID=null,e.form.securecode=null,e.referenceCode=null)},e.checkInformations=function(){e.isVehicleInfoRequired=!1,e.chatBiPreCheck(function(){var t={identityNumber:e.form.HesapKodu,pPlaka:e.form.Plaka,pRuhsatAsbisNo:e.form.RuhsatNo,islemTipi:"yenileme",cascoPSBSType:e.formParameters.cascoPsbsType};e.getTrafikAndKaskoService(t,function(t){e.getCommentParameters(function(){1==t?e.activateWizard(2):null!==e.comment.casco&&0!==e.comment.casco.potentialRecordType&&3!==e.comment.casco.potentialRecordType?e.setWarrantsChatBid(function(){1==e.checkIfMasterTiaExists()?(e.isViewTiaForm=!0,e.activateWizard(3)):e.menuData.portalDetailsMenu.isViewTiaContentAllResolutions&&null!==e.menuData.portalDetailsMenu.tiaContent||!e.menuData.portalDetailsMenu.isViewTiaContentAllResolutions&&(null!==e.menuData.portalDetailsMenu.tiaContentTablet||null!==e.menuData.portalDetailsMenu.tiaContentMobile)?(e.isViewTiaForm=!0,e.activateWizard(3)):(e.activateWizard(4),e.isViewTiaForm=!1)}):(e.isViewTiaForm=!1,e.activateWizard(4)),"function"==typeof callback&&callback()})})})},e.isTiaBoxesExist=function(){var t=!1,n=[];return n=e.boxesData.defaultItems.filter(function(t){return t.portalMenus.product===e.form.AraBrans&&(!0===t.isViewFormFinalTop||!0===t.isViewFormFinalBottom)}),n.length>0&&(t=!0),t},e.getTrafikAndKaskoService=function(t,n){e.serviceResult={kskTramer:{},trfTramer:{},egm:{}},i.post("webservice/trafikkaskoarackontrol",t,function(t){var a=moment().format("YYYY-MM-DD");if(void 0!==t.eresult&&null!==t.eresult)if(t.eresult.return.Unvan=y.remove(t.eresult.return.Unvan),t.eresult.return.MotorNo=y.remove(t.eresult.return.MotorNo),t.eresult.return.PlakaNo=y.remove(t.eresult.return.PlakaNo),t.eresult.return.TescilSeriNo=y.remove(t.eresult.return.TescilSeriNo),t.eresult.return.SasiNo=y.remove(t.eresult.return.SasiNo),t.eresult.return.Soyad=y.remove(t.eresult.return.Soyad),t.eresult.return.Cinsi=y.remove(t.eresult.return.Cinsi),t.eresult.return.HurdaArac=y.remove(t.eresult.return.HurdaArac),t.eresult.return.KoltukSayisi=y.remove(t.eresult.return.KoltukSayisi),t.eresult.return.KullanimSekli=y.remove(t.eresult.return.KullanimSekli),t.eresult.return.Marka=y.remove(t.eresult.return.Marka),t.eresult.return.ModelYili=y.remove(t.eresult.return.ModelYili),t.eresult.return.PlakaIlKodu=y.remove(t.eresult.return.PlakaIlKodu),t.eresult.return.TescilTarihi=y.remove(t.eresult.return.TescilTarihi),t.eresult.return.Tip=y.remove(t.eresult.return.Tip),e.serviceResult.egm=t.eresult.return,0==t.eresult.return.HataKodu){e.isEgmExist=!0;var i=moment().year(),o=moment(t.eresult.return.TescilTarihi,"DD-MM-YYYY").format("YYYY-MM-DD"),r=moment(o).diff(moment(a));if(e.serviceResult.egm.dayDifference=parseInt(Math.abs(moment.duration(r).asDays())),e.serviceResult.egm.modelYear=Math.abs(i-parseInt(t.eresult.return.ModelYili)),"company"==e.form.Tip?e.form.Unvan=e.serviceResult.egm.Unvan:e.form.Unvan=e.serviceResult.egm.Unvan+" "+e.serviceResult.egm.Soyad,e.encryptedName=null,e.formParameters.isReplaceLetterByStar){var l="company"==e.form.Tip?e.form.Unvan.split(" ").slice(0,3):e.form.Unvan.split(" ");angular.forEach(l,function(t){var n=null;n=l[0]==t?t.length<4?t.substring(0,1)+"*".repeat(t.length):t.substring(0,2)+"*".repeat(t.length-3)+t.slice(-1):t[0]+"*".repeat(t.length-2)+t.slice(-1),null==e.encryptedName?e.encryptedName=n:e.encryptedName=e.encryptedName+" "+n})}}else e.isEgmExist=!1;if(void 0!==t.ksktresult&&null!==t.ksktresult&&(t.ksktresult.return.Belgeler.length>0&&angular.forEach(t.ksktresult.return.Belgeler,function(e){e.AdUnvan=y.remove(e.AdUnvan),e.MotorNo=y.remove(e.MotorNo),e.PlakaNo=y.remove(e.PlakaNo),e.PoliceNo=y.remove(e.PoliceNo),e.SasiNo=y.remove(e.SasiNo),e.Soyad=y.remove(e.Soyad),e.BaslangicTarihi=y.remove(e.BaslangicTarihi),e.BitisTarihi=y.remove(e.BitisTarihi),e.AracTipKodu=y.remove(e.AracTipKodu),e.AcenteKodu=y.remove(e.AcenteKodu),e.ModelYili=y.remove(e.ModelYili),e.SirketKodu=y.remove(e.SirketKodu),e.TarifeKodu=y.remove(e.TarifeKodu),e.YolcuKapasitesi=y.remove(e.YolcuKapasitesi)}),e.serviceResult.kskTramer=t.ksktresult.return),0==t.ksktresult.return.HataKodu){var s=moment(t.ksktresult.return.Belgeler[0].BitisTarihi,"DD-MM-YYYY").format("YYYY-MM-DD"),r=moment(s).diff(moment(a));e.serviceResult.kskTramer.dayDifference=parseInt(moment.duration(r).asDays())}if(void 0!==t.trftresult&&null!==t.trftresult&&(t.trftresult.return.Belgeler.length>0&&angular.forEach(t.trftresult.return.Belgeler,function(e){e.AdUnvan=y.remove(e.AdUnvan),e.MotorNo=y.remove(e.MotorNo),e.PlakaNo=y.remove(e.PlakaNo),e.PoliceNo=y.remove(e.PoliceNo),e.SasiNo=y.remove(e.SasiNo),e.Soyad=y.remove(e.Soyad),e.BaslangicTarihi=y.remove(e.BaslangicTarihi),e.BitisTarihi=y.remove(e.BitisTarihi),e.AcenteKodu=y.remove(e.AcenteKodu),e.ModelYili=y.remove(e.ModelYili),e.Marka=y.remove(e.Marka),e.Model=y.remove(e.Model),e.SirketKodu=y.remove(e.SirketKodu),e.TarifeKodu=y.remove(e.TarifeKodu),e.YolcuKapasitesi=y.remove(e.YolcuKapasitesi),e.TescilTarihi=y.remove(e.TescilTarihi)}),e.serviceResult.trfTramer=t.trftresult.return),0==t.trftresult.return.HataKodu){var u=moment(t.trftresult.return.Belgeler[0].BitisTarihi,"DD-MM-YYYY").format("YYYY-MM-DD"),r=moment(u).diff(moment(a));e.serviceResult.trfTramer.dayDifference=parseInt(moment.duration(r).asDays())}0===t.eresult.return.HataKodu&&T(t.eresult.return.ModelYili)&&(e.form.ModelYili=parseInt(t.eresult.return.ModelYili));var c=t.trftresult.return.Belgeler[0];null!==t.trftresult&&0===t.trftresult.return.HataKodu&&(T(c.Model)&&(e.form.Model=parseInt(c.Model)),T(c.Marka+c.Model)&&(e.form.AracKodu=c.Marka+c.Model),T(c.Marka)&&(e.form.Marka=c.Marka),T(c.TarifeKodu)&&(e.form.KullanimTarzi=parseInt(c.TarifeKodu)),T(c.TescilTarihi)&&(e.form.TescilTarihi=c.TescilTarihi),T(c.TrafigeCikisTarihi)&&(e.form.TrafigeCikisTarihi=c.TrafigeCikisTarihi),T(c.MotorNo)&&(e.form.MotorNo=c.MotorNo),T(c.SasiNo)&&(e.form.SasiNo=c.SasiNo),T(c.YukKapasitesi)&&(e.form.Tonaj=parseInt(c.YukKapasitesi)),T(c.Basamak)&&(e.form.Basamak=parseInt(c.Basamak)),T(c.HasarAdet)&&(e.form.HasarAdet=parseFloat(c.HasarAdet)),T(c.SirketKodu)&&(e.form.SirketKodu=c.SirketKodu),T(c.AcenteKodu)&&(e.form.AcenteKodu=c.AcenteKodu),T(c.BitisTarihi)&&(e.form.BitisTarihi=c.BitisTarihi),T(c.PoliceNo)&&(e.form.PoliceNo=c.PoliceNo),T(c.YenilemeNo)&&(e.form.YenilemeNo=c.YenilemeNo),e.searchByVehicleCode(),e.onChangeTramerTarifeKodu());var d=t.eresult.return;0===t.eresult.return.HataKodu&&t.trftresult.return.HataKodu>0&&(T(d.TescilTarihi)&&(e.form.TescilTarihi=d.TescilTarihi),T(d.MotorNo)&&(e.form.MotorNo=d.MotorNo),T(d.SasiNo)&&(e.form.SasiNo=d.SasiNo),T(d.KoltukSayisi)&&(e.form.YolcuSayisi=parseInt(d.KoltukSayisi)),T(d.Marka)&&angular.forEach(e.data.aracMarkaList,function(t){t.marka==d.Marka&&(e.form.Marka=t.markakodu,e.onChangeMarka(function(){e.onChangeModel()}))}),e.onChangeTramerTarifeKodu()),0===t.eresult.return.HataKodu&&(T(d.TescilTarihi)&&(e.form.TescilTarihi=d.TescilTarihi),T(d.MotorNo)&&(e.form.MotorNo=d.MotorNo),T(d.SasiNo)&&(e.form.SasiNo=d.SasiNo),T(d.KoltukSayisi)&&(e.form.YolcuSayisi=parseInt(d.KoltukSayisi))),0===t.trftresult.return.HataKodu||e.isVehicleSelected?e.isVehicleInfoRequired=!1:e.isVehicleInfoRequired=!0,"function"==typeof n&&n(e.isVehicleInfoRequired)},function(){c.error(r.translate("Bir Hata Oluştu! Lütfen daha sonra tekrar deneyin."))})};var T=function(e){return""!==e&&null!==e&&void 0!==e&&"01.01.1900"!==e&&"1.1.1900"!==e};e.chatBiPreCheck=function(t){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi),Plaka:e.form.Plaka,RuhsatNo:e.form.RuhsatNo};n.sID=e.sID,i.post("identity/chatbi/precheck",n,function(n){e.isCustomerExists=n.isCustomerExists,e.onChangeProvince(),e.onVehicleCreate();i.post("f/nx/wlg",{wizardTitle:"CHATBI_COMMENT",sID:e.sID},function(){"function"==typeof t&&t()},null,null,null,!0)})},e.checkCustomerType=function(t){null!==t&&""!==t&&void 0!==t&&(9!=t.length&&10!=t.length||(e.form.Tip="company",e.form.MusteriTipi=2),11==t.length&&(e.form.Tip="personal",e.form.MusteriTipi=1))},e.getCommentParameters=function(t){var n=[];e.commentList={egm:[],traffic:[],casco:[]},e.comment={egm:null,traffic:null,casco:null},0==e.serviceResult.trfTramer.HataKodu?n.push("trafficExist"):n.push("trafficNotExist"),0==e.serviceResult.kskTramer.HataKodu?n.push("cascoExist"):n.push("cascoNotExist"),0==e.serviceResult.egm.HataKodu?n.push("egmExist"):1==e.serviceResult.egm.HataKodu?n.push("egmServiceNotExist"):n.push("egmNotExist");var a={portalMenuId:e.menuData.id,productParameterList:n};i.post("menus/chatbidcomments",a,function(n){angular.forEach(n,function(t){t.productParameter=y.remove(t.productParameter),t.compareParameter=y.remove(t.compareParameter),t.modelYearCompareParameter=y.remove(t.modelYearCompareParameter),t.egmParameter=y.remove(t.egmParameter),t.modelYearParameter=y.remove(t.modelYearParameter),"trafficExist"!=t.productParameter&&"trafficNotExist"!=t.productParameter||e.commentList.traffic.push(t),"cascoExist"!=t.productParameter&&"cascoNotExist"!=t.productParameter||e.commentList.casco.push(t),"egmExist"!=t.productParameter&&"egmNotExist"!=t.productParameter&&"egmServiceNotExist"!=t.productParameter||e.commentList.egm.push(t)}),angular.forEach(e.commentList.egm,function(t){0!==e.serviceResult.egm.HataKodu?"egmServiceNotExist"==t.productParameter&&1==e.serviceResult.egm.HataKodu?e.comment.egm=t:"egmNotExist"==t.productParameter&&(e.comment.egm=t):"egmExist"==t.productParameter&&0==e.serviceResult.egm.HataKodu&&(t.chatbiComment&&(t.chatbiComment.includes("[gun]")&&(t.chatbiComment=t.chatbiComment.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiComment.includes("[yas]")&&(t.chatbiComment=t.chatbiComment.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiComment.includes("[plaka]")&&(t.chatbiComment=t.chatbiComment.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentTablet&&(t.chatbiCommentTablet.includes("[gun]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentTablet.includes("[yas]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentTablet.includes("[plaka]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentMobile&&(t.chatbiCommentMobile.includes("[gun]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentMobile.includes("[yas]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentMobile.includes("[plaka]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[plaka]",e.form.Plaka.toString()))),"between"==t.compareParameter&&D(e.serviceResult.egm.dayDifference,t.firstDay,t.lastDay)&&(e.comment.egm=t),"lessThan"==t.compareParameter&&e.serviceResult.egm.dayDifference<t.remainDay&&(e.comment.egm=t),"greaterThan"==t.compareParameter&&e.serviceResult.egm.dayDifference>t.remainDay&&(e.comment.egm=t))}),angular.forEach(e.commentList.traffic,function(t){0!==e.serviceResult.trfTramer.HataKodu?("trafficNotExist"!=t.productParameter||t.egmParameter||(e.comment.traffic=t),"trafficNotExist"==t.productParameter&&"egmExist"==t.egmParameter&&0==e.serviceResult.egm.HataKodu&&(t.chatbiComment&&(t.chatbiComment.includes("[gun]")&&(t.chatbiComment=t.chatbiComment.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiComment.includes("[yas]")&&(t.chatbiComment=t.chatbiComment.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiComment.includes("[plaka]")&&(t.chatbiComment=t.chatbiComment.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentTablet&&(t.chatbiCommentTablet.includes("[gun]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentTablet.includes("[yas]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentTablet.includes("[plaka]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentMobile&&(t.chatbiCommentMobile.includes("[gun]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentMobile.includes("[yas]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentMobile.includes("[plaka]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[plaka]",e.form.Plaka.toString()))),"between"==t.compareParameter&&D(e.serviceResult.egm.dayDifference,t.firstDay,t.lastDay)&&(e.comment.traffic=t),"lessThan"==t.compareParameter&&e.serviceResult.egm.dayDifference<t.remainDay&&(e.comment.traffic=t),"greaterThan"==t.compareParameter&&e.serviceResult.egm.dayDifference>t.remainDay&&(e.comment.traffic=t))):"trafficExist"==t.productParameter&&0==e.serviceResult.trfTramer.HataKodu&&(t.chatbiComment&&(t.chatbiComment.includes("[gun]")&&(t.chatbiComment=t.chatbiComment.replace("[gun]",e.serviceResult.trfTramer.dayDifference.toString())),t.chatbiComment.includes("[yas]")&&(t.chatbiComment=t.chatbiComment.replace("[yas]",e.serviceResult.egm.modelYear.toString()?e.serviceResult.egm.modelYear.toString():"")),t.chatbiComment.includes("[plaka]")&&(t.chatbiComment=t.chatbiComment.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentTablet&&(t.chatbiCommentTablet.includes("[gun]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[gun]",e.serviceResult.trfTramer.dayDifference.toString())),t.chatbiCommentTablet.includes("[yas]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[yas]",e.serviceResult.egm.modelYear.toString()?e.serviceResult.egm.modelYear.toString():"")),t.chatbiCommentTablet.includes("[plaka]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentMobile&&(t.chatbiCommentMobile.includes("[gun]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[gun]",e.serviceResult.trfTramer.dayDifference.toString())),t.chatbiCommentMobile.includes("[yas]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[yas]",e.serviceResult.egm.modelYear.toString()?e.serviceResult.egm.modelYear.toString():"")),t.chatbiCommentMobile.includes("[plaka]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[plaka]",e.form.Plaka.toString()))),"between"==t.compareParameter&&D(e.serviceResult.trfTramer.dayDifference,t.firstDay,t.lastDay)&&(e.comment.traffic=t),"lessThan"==t.compareParameter&&e.serviceResult.trfTramer.dayDifference<t.remainDay&&(e.comment.traffic=t),"greaterThan"==t.compareParameter&&e.serviceResult.trfTramer.dayDifference>t.remainDay&&(e.comment.traffic=t))}),angular.forEach(e.commentList.casco,function(t){0!==e.serviceResult.kskTramer.HataKodu?("cascoNotExist"!=t.productParameter||t.modelYearParameter||t.egmParameter||(e.comment.casco=t),"cascoNotExist"!=t.productParameter||"modelYearExist"!=t.modelYearParameter||t.egmParameter||0!=e.serviceResult.egm.HataKodu||(t.chatbiComment&&(t.chatbiComment.includes("[gun]")&&(t.chatbiComment=t.chatbiComment.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiComment.includes("[yas]")&&(t.chatbiComment=t.chatbiComment.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiComment.includes("[plaka]")&&(t.chatbiComment=t.chatbiComment.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentTablet&&(t.chatbiCommentTablet.includes("[gun]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentTablet.includes("[yas]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentTablet.includes("[plaka]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentMobile&&(t.chatbiCommentMobile.includes("[gun]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentMobile.includes("[yas]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentMobile.includes("[plaka]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[plaka]",e.form.Plaka.toString()))),"between"==t.modelYearCompareParameter&&D(e.serviceResult.egm.modelYear,t.firstYear,t.lastYear)&&(e.comment.casco=t),"lessThan"==t.modelYearCompareParameter&&e.serviceResult.egm.modelYear<t.remainYear&&(e.comment.casco=t),"greaterThan"==t.modelYearCompareParameter&&e.serviceResult.egm.modelYear>t.remainYear&&(e.comment.casco=t)),"cascoNotExist"!=t.productParameter||t.modelYearParameter||"egmExist"!=t.egmParameter||0!=e.serviceResult.egm.HataKodu||(t.chatbiComment&&(t.chatbiComment.includes("[gun]")&&(t.chatbiComment=t.chatbiComment.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiComment.includes("[yas]")&&(t.chatbiComment=t.chatbiComment.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiComment.includes("[plaka]")&&(t.chatbiComment=t.chatbiComment.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentTablet&&(t.chatbiCommentTablet.includes("[gun]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentTablet.includes("[yas]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentTablet.includes("[plaka]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentMobile&&(t.chatbiCommentMobile.includes("[gun]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),
t.chatbiCommentMobile.includes("[yas]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentMobile.includes("[plaka]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[plaka]",e.form.Plaka.toString()))),"between"==t.compareParameter&&D(e.serviceResult.egm.dayDifference,t.firstDay,t.lastDay)&&(e.comment.casco=t),"lessThan"==t.compareParameter&&e.serviceResult.egm.dayDifference<t.remainDay&&(e.comment.casco=t),"greaterThan"==t.compareParameter&&e.serviceResult.egm.dayDifference>t.remainDay&&(e.comment.casco=t)),"cascoNotExist"==t.productParameter&&"modelYearExist"==t.modelYearParameter&&"egmExist"==t.egmParameter&&0==e.serviceResult.egm.HataKodu&&(t.chatbiComment&&(t.chatbiComment.includes("[gun]")&&(t.chatbiComment=t.chatbiComment.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiComment.includes("[yas]")&&(t.chatbiComment=t.chatbiComment.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiComment.includes("[plaka]")&&(t.chatbiComment=t.chatbiComment.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentTablet&&(t.chatbiCommentTablet.includes("[gun]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentTablet.includes("[yas]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentTablet.includes("[plaka]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentMobile&&(t.chatbiCommentMobile.includes("[gun]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[gun]",e.serviceResult.egm.dayDifference.toString())),t.chatbiCommentMobile.includes("[yas]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[yas]",e.serviceResult.egm.modelYear.toString())),t.chatbiCommentMobile.includes("[plaka]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[plaka]",e.form.Plaka.toString()))),"between"==t.compareParameter&&"between"==t.modelYearCompareParameter&&D(e.serviceResult.egm.dayDifference,t.firstDay,t.lastDay)&&D(e.serviceResult.egm.modelYear,t.firstYear,t.lastYear)&&(e.comment.casco=t),"lessThan"==t.compareParameter&&"lessThan"==t.modelYearCompareParameter&&e.serviceResult.egm.dayDifference<t.remainDay&&e.serviceResult.egm.modelYear<t.remainYear&&(e.comment.casco=t),"greaterThan"==t.compareParameter&&"greaterThan"==t.modelYearCompareParameter&&e.serviceResult.egm.dayDifference>t.remainDay&&e.serviceResult.egm.modelYear>t.remainYear&&(e.comment.casco=t),"lessThan"==t.modelYearCompareParameter&&"between"==t.compareParameter&&e.serviceResult.egm.modelYear<t.remainYear&&D(e.serviceResult.egm.dayDifference,t.firstDay,t.lastDay)&&(e.comment.casco=t),"lessThan"==t.modelYearCompareParameter&&"greaterThan"==t.compareParameter&&e.serviceResult.egm.modelYear<t.remainYear&&e.serviceResult.egm.dayDifference>t.remainDay&&(e.comment.casco=t),"greaterThan"==t.modelYearCompareParameter&&"between"==t.compareParameter&&e.serviceResult.egm.modelYear>t.remainYear&&D(e.serviceResult.egm.dayDifference,t.firstDay,t.lastDay)&&(e.comment.casco=t),"greaterThan"==t.modelYearCompareParameter&&"lessThan"==t.compareParameter&&e.serviceResult.egm.modelYear>t.remainYear&&e.serviceResult.egm.dayDifference<t.remainDay&&(e.comment.casco=t),"between"==t.modelYearCompareParameter&&"lessThan"==t.compareParameter&&D(e.serviceResult.egm.modelYear,t.firstYear,t.lastYear)&&e.serviceResult.egm.dayDifference<t.remainDay&&(e.comment.casco=t),"between"==t.modelYearCompareParameter&&"greaterThan"==t.compareParameter&&D(e.serviceResult.egm.modelYear,t.firstYear,t.lastYear)&&e.serviceResult.egm.dayDifference>t.remainDay&&(e.comment.casco=t))):"cascoExist"==t.productParameter&&0==e.serviceResult.kskTramer.HataKodu&&(t.chatbiComment&&(t.chatbiComment.includes("[gun]")&&(t.chatbiComment=t.chatbiComment.replace("[gun]",e.serviceResult.kskTramer.dayDifference.toString())),t.chatbiComment.includes("[yas]")&&(t.chatbiComment=t.chatbiComment.replace("[yas]",e.serviceResult.egm.modelYear.toString()?e.serviceResult.egm.modelYear.toString():"")),t.chatbiComment.includes("[plaka]")&&(t.chatbiComment=t.chatbiComment.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentTablet&&(t.chatbiCommentTablet.includes("[gun]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[gun]",e.serviceResult.kskTramer.dayDifference.toString())),t.chatbiCommentTablet.includes("[yas]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[yas]",e.serviceResult.egm.modelYear.toString()?e.serviceResult.egm.modelYear.toString():"")),t.chatbiCommentTablet.includes("[plaka]")&&(t.chatbiCommentTablet=t.chatbiCommentTablet.replace("[plaka]",e.form.Plaka.toString()))),t.chatbiCommentMobile&&(t.chatbiCommentMobile.includes("[gun]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[gun]",e.serviceResult.kskTramer.dayDifference.toString())),t.chatbiCommentMobile.includes("[yas]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[yas]",e.serviceResult.egm.modelYear.toString()?e.serviceResult.egm.modelYear.toString():"")),t.chatbiCommentMobile.includes("[plaka]")&&(t.chatbiCommentMobile=t.chatbiCommentMobile.replace("[plaka]",e.form.Plaka.toString()))),"between"==t.compareParameter&&D(e.serviceResult.kskTramer.dayDifference,t.firstDay,t.lastDay)&&(e.comment.casco=t),"lessThan"==t.compareParameter&&e.serviceResult.kskTramer.dayDifference<t.remainDay&&(e.comment.casco=t),"greaterThan"==t.compareParameter&&e.serviceResult.kskTramer.dayDifference>t.remainDay&&(e.comment.casco=t))}),4==e.form.AnaBrans&&(e.menuData.chatbiTrafficProduct||(e.comment.traffic=null)),5==e.form.AnaBrans&&(e.menuData.chatbiCascoProduct||(e.comment.casco=null)),"function"==typeof t&&t()})},e.getChatBiIdentityDetails=function(){if(null!==e.form.IlKodu&&null!==e.form.IlceKodu)e.isLoggedIn?e.doChatBidSubmit():e.activateWizard(5);else{var t={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi)};e.isInsuredInfoRunning=!0,t.sID=e.sID,i.post("identity/chatbi/details",t,function(t){if("personal"==e.form.Tip){if(!0!==t.isIdentityValid)return e.isBirthdayValid=!1,c.error(r.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==t.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(n){n.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(n){e.form.GSMNo=n.newGSMNo,e.updateInsured(function(){e.isCityAndDistrictRequired=t.isCityAndDistrictRequired,!0!==t.isCityAndDistrictRequired&&(e.isLoggedIn?e.doChatBidSubmit():e.activateWizard(5))})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):(e.isCityAndDistrictRequired=t.isCityAndDistrictRequired,!0!==t.isCityAndDistrictRequired&&(e.isLoggedIn?e.doChatBidSubmit():e.activateWizard(5)))},function(){e.isInsuredInfoRunning=!1},null,null,!1)}};var D=function(e,t,n){return(e-t)*(e-n)<=0};e.checkIfMasterTiaExists=function(){var t=!1;return void 0!==e._tia&&null!==e._tia&&angular.forEach(e._tia.data,function(e){A(e.elements)&&(t=!0)}),t};var A=function(e){var t=!1;return angular.forEach(e,function(e){2!=e.Izleme&&0===e.AnaDetay&&(t=!0)}),t};e.checkQuotationRecordStatus=function(){var t=!1;return null!==e.comment.casco||null!==e.comment.traffic?(t=null!==e.comment.casco&&(1==e.comment.casco.potentialRecordType||2==e.comment.casco.potentialRecordType||3==e.comment.casco.potentialRecordType)||null!==e.comment.traffic&&(1==e.comment.traffic.potentialRecordType||2==e.comment.traffic.potentialRecordType||3==e.comment.traffic.potentialRecordType),(null===e.comment.casco||1!=e.comment.casco.potentialRecordType&&2!=e.comment.casco.potentialRecordType)&&(null===e.comment.traffic||1!=e.comment.traffic.potentialRecordType&&2!=e.comment.traffic.potentialRecordType)||(e.isViewGetQuotation=!0,e.isViewArchive=!1),(null!==e.comment.casco&&3==e.comment.casco.potentialRecordType||null!==e.comment.traffic&&3==e.comment.traffic.potentialRecordType)&&(e.isViewGetQuotation=!1,e.isViewArchive=!0)):t=!1,null==e.comment.casco&&null==e.comment.traffic&&(t=!1),t},e.setNextStep=function(){e.form.Marka&&e.form.Model&&e.form.KullanimTarzi?e.setWarrantsChatBid(function(){1==e.checkIfMasterTiaExists()?(e.isViewTiaForm=!0,e.activateWizard(3)):e.menuData.portalDetailsMenu.isViewTiaContentAllResolutions&&null!==e.menuData.portalDetailsMenu.tiaContent||!e.menuData.portalDetailsMenu.isViewTiaContentAllResolutions&&(null!==e.menuData.portalDetailsMenu.tiaContentTablet||null!==e.menuData.portalDetailsMenu.tiaContentMobile)?(e.isViewTiaForm=!0,e.activateWizard(3)):(e.activateWizard(4),e.isViewTiaForm=!1)}):(e.isVehicleInfoRequired=!0,e.activeWizard=2)},e.onValidateGSMChatbi=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=y.remove(t.return.JSONData),e.referenceCode=y.remove(t.return.OtherData),e.isChatBiNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCodeChatbi=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?e.doChatBidSubmit():6==t.ResultCode?c.error(r.translate("ALERT_VERIFY_ERROR")):c.error(r.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doChatBidSubmit=function(){e.bidCollection=[],e.bidCollectionList=[],4==e.form.AnaBrans&&(null!==e.comment.casco&&""!==e.comment.casco&&void 0!==e.comment.casco&&(1!=e.comment.casco.potentialRecordType&&2!=e.comment.casco.potentialRecordType&&3!=e.comment.casco.potentialRecordType||(e.bidCollection.push("kasko"),e.bidCollectionList.push("kasko"))),null!==e.comment.traffic&&""!==e.comment.traffic&&void 0!==e.comment.traffic&&(1!=e.comment.traffic.potentialRecordType&&2!=e.comment.traffic.potentialRecordType&&3!=e.comment.traffic.potentialRecordType||null!==e.menuData.chatbiTrafficProduct&&""!==e.menuData.chatbiTrafficProduct&&void 0!==e.menuData.chatbiTrafficProduct&&(e.bidCollection.push("trafik"),e.bidCollectionList.push("trafik")))),5==e.form.AnaBrans&&(null!==e.comment.traffic&&""!==e.comment.traffic&&void 0!==e.comment.traffic&&(1!=e.comment.traffic.potentialRecordType&&2!=e.comment.traffic.potentialRecordType&&3!=e.comment.traffic.potentialRecordType||(e.bidCollection.push("trafik"),e.bidCollectionList.push("trafik"))),null!==e.comment.casco&&""!==e.comment.casco&&void 0!==e.comment.casco&&(1!=e.comment.casco.potentialRecordType&&2!=e.comment.casco.potentialRecordType&&3!=e.comment.casco.potentialRecordType||null!==e.menuData.chatbiCascoProduct&&""!==e.menuData.chatbiCascoProduct&&void 0!==e.menuData.chatbiCascoProduct&&(e.bidCollection.push("kasko"),e.bidCollectionList.push("kasko")))),e.runSavingProcess()},e.runSavingProcess=function(){e.isFirstValue=!1,angular.forEach(e.bidCollection,function(t,a){1==e.isLoggedIn&&(e.isSmsSend=!0),t==e.bidCollectionList[0]&&(e.isFirstValue=!0);var o=l.build(e);o.pKN=e.form.HesapKodu,o.pPlaka=e.form.Plaka,o.pRuhsatNo=e.form.RuhsatNo,o.GSMNo=e.form.GSMNo,o.pIlKodu=e.form.IlKodu,o.pIlceKodu=e.form.IlceKodu,o.pUnvan=e.form.Unvan,o.pUnvan2=e.form.Unvan2,o.pModelYili=e.form.ModelYili,o.pTramerTarifeKodu=e.form.KullanimTarzi,o.pAracKullanimDetayKodu=e.form.KullanimDetayi,o.pMotorNo=e.form.MotorNo,o.pSasiNo=e.form.SasiNo,o.pAracKodu=e.form.Marka+e.form.Model,o.pDogumTarihi=C.dateInputToService(e.form.DogumTarihi),"trafik"===t&&(e.bidCollection.splice(a,1),o.AnaBrans=5,o.AraBrans=e.form.AraBrans,o.pGenel.AnaBrans=5,o.pGenel.AraBrans=e.form.AraBrans,5!==e.form.AnaBrans&&(o.AraBrans=e.menuData.chatbiTrafficProduct,o.pGenel.AraBrans=e.menuData.chatbiTrafficProduct),1!=e.comment.traffic.potentialRecordType&&3!=e.comment.traffic.potentialRecordType||(o.AracDurumu=0),2==e.comment.traffic.potentialRecordType&&(o.AracDurumu=1)),"kasko"===t&&(e.bidCollection.splice(a,1),o.AnaBrans=4,o.AraBrans=e.form.AraBrans,o.pGenel.AnaBrans=4,o.pGenel.AraBrans=e.form.AraBrans,4!==e.form.AnaBrans&&(o.AraBrans=e.menuData.chatbiCascoProduct,o.pGenel.AraBrans=e.menuData.chatbiCascoProduct),1!=e.comment.casco.potentialRecordType&&3!=e.comment.traffic.potentialRecordType||(o.AracDurumu=0),2==e.comment.casco.potentialRecordType&&(o.AracDurumu=1)),angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),o.IlAdi=e.form.IlAdi,o.IlceAdi=e.form.IlceAdi,o.isSmsVerified=!0,o.pTeklifPDF=0,o.pBilgiFormuPDF=0,o.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(o.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(o.pBilgiFormuPDF=1),o.pSMSToken=e.form.pSessionID,o.isArchive=e.isViewArchive,e.isQuotationPreparing=!0;var s=p.get("Ref");null!==s&&""!==s&&void 0!==s&&void 0!==s.kod&&null!==s.kod&&""!==s.kod&&(o.pReferansPersonelKodu=s.kod),"trafik"===t&&(o.pAciklamalar=[],o.pIndirimler=[],o.pTeminatlar=[]);var u={AnaBrans:o.AnaBrans,AraBrans:o.AraBrans,isFirstValue:e.isFirstValue};e.getSessionID(u,function(a){o.sID=a,i.post("chatbi/quotation/kaydet",o,function(a){if(e.isFirstValue&&(e.poliIDToRedirect=a.href),"trafik"===t&&(null!==e.comment.traffic.transactionList||""!==e.comment.traffic.transactionList||void 0!==e.comment.traffic.transactionList)){var l=[],s=[];l.push(1),s.push(a.href);var u={pAciklama:null,pIslemTipi:parseInt(e.comment.traffic.transactionList),pNotlar:null,pTipDizi:l,pPoliceDizi:s,_totalRecordCount:1,isSingleRequest:!0};null!==a.href&&""!==a.href&&void 0!==a.href&&null!==e.comment.traffic.transactionList&&null!==e.comment.traffic.transactionList&&e.sendTransactionList(u)}if("kasko"===t&&(null!==e.comment.casco.transactionList||""!==e.comment.casco.transactionList||void 0!==e.comment.casco.transactionList)){var l=[],s=[];l.push(1),s.push(a.href);var u={pAciklama:null,pIslemTipi:parseInt(e.comment.casco.transactionList),pNotlar:null,pTipDizi:l,pPoliceDizi:s,_totalRecordCount:1,isSingleRequest:!0};null!==a.href&&""!==a.href&&void 0!==a.href&&null!==e.comment.casco.transactionList&&null!==e.comment.casco.transactionList&&e.sendTransactionList(u)}if(e.bidCollection.length>0)o.AnaBrans=null,o.AraBrans=null,o.kvkkStatus=!0,o.privacyStatus=!0,e.runSavingProcess();else{p.set("Quotation",null);var d={pPoliID:e.poliIDToRedirect?e.poliIDToRedirect:a.href,pTip:1};0==a.ResultCode?i.post("l/a/wlg",{},function(){p.set("OtherBid",{pid:a.href,ab:o.AnaBrans,arabrans:o.AraBrans}),e.isViewGetQuotation&&(p.set("Quotation",d),window.location.href="/Panel/dashboard?Success"),e.isViewArchive&&(e.isArchiveSaved=!0,e.isQuotationPreparing=!1,e.activateWizard(0))},null,null,null,!0):(e.isQuotationPreparing=!1,null!==a.ResultMessage&&""!==a.ResultMessage?(c.info(a.ResultMessage),e.clearChatBidForm(),n.reload()):(c.info(r.translate("Ruhsat Numarası Hatalı..!")),n.reload(),e.clearChatBidForm())),e.isSaving=!1}},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)})})},e.sendTransactionList=function(e){i.post("quotation/transactionList",e,function(e){})},e.getSessionID=function(t,n){if(t.isFirstValue)return void("function"==typeof n&&n(e.sID));var a=e.sID;i.post("quotation/pre",t,function(e){a=e.SID,"function"==typeof n&&n(a)},function(){"function"==typeof n&&n(a)})},e.getInsuredVehicleList=function(){var t={pHesapKodu:e.form.HesapKodu};e.data.vehicleList=[],i.post("insured/vehicles",t,function(t){t.length>0&&angular.forEach(t,function(t){t.asbisno=y.remove(t.asbisno),t.id=y.remove(t.id),t.plaka=y.remove(t.plaka),t.ruhsat=y.remove(t.ruhsat),t.ruhsatno=y.remove(t.ruhsatno),t.plaka.length>=6&&e.data.vehicleList.push(t)})},null,null,null,!0)},e.setVehicleSelection=function(t){if(null!==t.plaka&&void 0!==t.plaka&&""!==t.plaka&&(e.form.Plaka=t.plaka),null!==t.ruhsatno&&void 0!==t.ruhsatno&&""!==t.ruhsatno&&(e.form.RuhsatNo=t.ruhsatno),void 0!==t.id&&null!==t.id){var n={pAracID:t.id,pHesKod:e.form.HesapKodu};i.get("insured/vehicles",n,function(t){null!==t&&""!==t&&(t.arackodu=y.remove(t.arackodu),t.asbisno=y.remove(t.asbisno),t.id=y.remove(t.id),t.plaka=y.remove(t.plaka),t.ruhsat=y.remove(t.ruhsat),t.ruhsatno=y.remove(t.ruhsatno),t.motorno=y.remove(t.motorno),t.sasino=y.remove(t.sasino)),e.form.Plaka=t.plaka,e.form.ModelYili=parseInt(t.yil),e.form.AracKodu=t.arackodu,e.form.KullanimTarzi=parseInt(t.tarifekodu),e.form.MotorNo=t.motorno,e.form.SasiNo=t.sasino,e.form.YolcuSayisi=parseInt(t.yeradet),e.form.RuhsatNo=t.ruhsatno,e.form.KullanimDetayi=t.aracdetaykodu,0===e.form.KullanimTarzi&&(e.form.KullanimTarzi=null),e.searchByVehicleCode(),e.onChangeTramerTarifeKodu(function(){e.form.AracDetayTipi=t.aracdetaykodu,""===e.form.AracDetayTipi&&(e.form.AracDetayTipi=null)}),null!==e.form.Marka&&null!==e.form.AracKodu&&null!==e.form.KullanimTarzi&&null!==e.form.KullanimDetayi&&(e.isVehicleSelected=!0)},null,null,null,!0)}},e.getIdentityDetailsStyleThree=function(t){if(auto=!!t,e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi),password:null};e.isInsuredInfoRunning=!0,n.sID=e.sID,null!==e.form.FlexPassword&&void 0!==e.form.FlexPassword&&""!==e.form.FlexPassword&&e.form.FlexPassword.length>3&&(n.password=e.form.FlexPassword),i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,c.error(r.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.currentWizard=2,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}if(n.isFlexActive)try{if(null==n.flex)return c.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir."),e.form.FlexPassword=null,void(e.isInsuredInfoRunning=!1);e.flex=n.flex}catch(t){if(null==n.flex)return c.flexError("Kampanyadan faydalanabilmeniz için öncelikle https://maviprogram.opet.com.tr sitesine kayıt yaptırarak alacağınız şifre ile teklif.sigortaflex.com.tr sitesinde trafik ve kasko sigortası işleminizi yapmanız gerekmektedir."),e.form.FlexPassword=null,void(e.isInsuredInfoRunning=!1);e.flex=n.flex}if(0==n.isGSMValid&&"personal"==e.form.Tip)a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){if(e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),e.onChangeProvince(),e.onVehicleCreate()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=2,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=3,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView()),e.isLoggedIn)e.doCollectVehicleInfo();else{var a="";"0"===e.form.AracDurumu&&(a="RENEWAL_CAR"),"1"===e.form.AracDurumu&&(a="USED_CAR"),"2"===e.form.AracDurumu&&(a="NEW_CAR"),i.post("f/nx/wlg",{wizardTitle:a,sID:e.sID},function(){e.onVehicleCreate(),"function"==typeof t&&t()},null,null,null,!0)}})},onCancel:function(){e.isInsuredInfoRunning=!1}}});else if(e.isInsuredInfoRunning=!1,"company"==e.form.Tip?(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=2,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad)e.currentWizard=3,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView();else{var o="";"0"===e.form.AracDurumu&&(o="RENEWAL_CAR"),"1"===e.form.AracDurumu&&(o="USED_CAR"),"2"===e.form.AracDurumu&&(o="NEW_CAR"),i.post("f/nx/wlg",{wizardTitle:o,sID:e.sID},function(){e.onVehicleCreate(),"function"==typeof t&&t()},null,null,null,!0)}},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=y.remove(t.return.JSONData),e.referenceCode=y.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCode=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?(e.pSMSToken=e.form.pSessionID,e.doPrepareSubmit()):6==t.ResultCode?c.error(r.translate("ALERT_VERIFY_ERROR")):c.error(r.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doPrepareSubmit=function(){var t=l.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.pDogumTarihi=C.dateInputToService(e.form.DogumTarihi),t.sID=e.sID,2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!0,t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var a=p.get("Ref");null!==a&&""!==a&&void 0!==a&&void 0!==a.kod&&null!==a.kod&&""!==a.kod&&(t.pReferansPersonelKodu=a.kod),1==e.isLoggedIn?c.confirmHtmlContent(e.quotationConfirmContent,function(){e.doSubmit(t)}):(document.getElementById("form-start").scrollIntoView(),e.doSubmit(t))},e.onNextWizard=function(){e.current=null,e.currentWizard++,2==e.currentWizard&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),4==e.currentWizard&&e.setWarrants(),document.getElementById("form-start").scrollIntoView()},e.onBackWizard=function(){3!=e.currentWizard&&4!=e.currentWizard||(e.isCustomerExists=null),4==e.currentWizard&&"0"===e.form.AracDurumu&&e.currentWizard--,5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard--,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onEditWizard=function(t){1!=t&&2!=t||(e.isCustomerExists=null),5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard=t,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onCreate()}]),app.controller("Dask.QuotationController",["$scope","$rootScope","$state","$modal","$rest","$lists","$culture","$form","$tia","$sce","$alert","$rootSettings","$insured","$currency","$storage","$welcomeInit","$timeout","$crypto","$boxesInit","$filter","$location","vcRecaptchaService","$dateFormatter","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S,C,T){e.params={ab:null,arabrans:null,menu:null,menuurl:null},e.current=0,e.currentWizard=1,e.isCustomerExists=null,e.isLoggedIn=!1,e.menuData={},e.welcomeInit=g,e.isQuotationPreparing=!1,e.isDefaultBannerActive=!0,e.portalMenusKeywords=null,e.isEmailRegex=!0,e.isBack=!1,e.isAddressSearching=!1,e.isInsuredInfoRunning=!1,e.sID=null,e.isSmsSend=!1,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isNextButtonDisabled=!1,e.isSendGDPRLog=!1,e.isSendMarketingLog=!1,e.binaToplamKatList=[{title:r.translate("01-03 ARASI KAT"),value:5},{title:r.translate("04-07 ARASI KAT"),value:6},{title:r.translate("08-18 ARASI KAT"),value:7},{title:r.translate("19 VE ÜZERİ KATLAR"),value:8}],e._tia={data:null,onPrev:null,onNext:null,current:null},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null,smsActivationLocation:"getQuotation",smsActivateDescription:null,isVerifyRCPT:!1,isViewDateOfBirth:!1},e.form={Tip:"personal",pPSBSType:0,MKSKontrol:0,MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,IlKodu:null,IlceKodu:null,Mahalle:null,Sokak:null,Semt:null,BinaNo:null,id:null,DaireNo:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,propertySelection:null,YngBinaKat:5,YngKullanimSekli:null,YngYapiTarzi:null,YngBrut:null,YngYil:null,DogumTarihi:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,DaskDurumu:"1",DaskPoliceFound:!1,DaskPoliceDescription:null,IkametSekli:null,YngAda:null,YngPafta:null,YngParsel:null,YngSayfa:null,Permissions:!0},e.contact={name:null,surname:null,phone:null,message:null},e.data={sehirList:[],ilceList:[],mulkiyetList:[]},e.kullanimSekliList=[{value:null,title:r.translate("SEÇİNİZ")}],e.yapiTarziList=[{value:null,title:r.translate("SEÇİNİZ")}],e.PSBSStatus={AP:0,KP:0,DP:0,UP:0,TP:0,KsP:0,EP:0},e.onCreate=function(){e.kullanimSekliList=o.getKullanimSekliList(),e.kullanimSekliList.unshift({value:null,title:r.translate("SEÇİNİZ")}),e.yapiTarziList=o.getYapiTarziList(),e.insaaYiliList=o.getInsaaYiliList(),e.ikametSekliList=o.getIkametSekliList(),e.welcomeInit.isSuccessData?e.initData():t.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){""!==n.params.menuurl&&null!==n.params.menuurl||n.go("PageNotFound",{},{reload:!0});var a=I.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};p.set("Ref",t)}});var o=g;if(e.menus=o.getMenus(),angular.forEach(o.getMenus(),function(a){n.params.menuurl==a.menuURL&&(e.params.ab=parseInt(a.main_product),e.params.arabrans=a.product,e.params.menuurl=a.menuURL,e.params.menu=a.id,e.form.AnaBrans=e.params.ab,e.form.AraBrans=e.params.arabrans,e.menuData=a,e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:e.menuData.id,viewLocation:"QUOTATION"},function(){var n=e.welcomeInit;if(e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.setSeoSettings(n.getSeoSettings()),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.PK=n.getReCaptchaKeys(),null!==e.PK&&void 0!==e.PK&&""!==e.PK&&e.formParameters.isVerifyRCPT&&!0!==e.isLoggedIn?(e.isViewReCaptcha=!0,e.isNextButtonDisabled=!0):(e.isNextButtonDisabled=!1,e.isViewReCaptcha=!1),e.setAnnouncements(),e.setQuickLinks(),e.boxesInit=h.onCreate(e.menuData.id),t.$on("$boxesInit.onSuccess",function(){e.boxesData=h.getBoxes(e.menuData.id),e.getCategories(e.boxesData),e.openAnnounceModal()}),i.get("status",{},function(t){e.PSBSStatus=t,i.get("welcome/menus/menuskeywords/"+e.menuData.id,{},function(t){e.portalMenusKeywords=t})})})}))}),d.set(o.getRootSettings()),!0!==e.isLoggedIn&&null!==o.getDynamicContent()&&(e.dynamicContent=o.getDynamicContent(),e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.PCR&&(e.form.PrivacyPolicy=!1),(e.dynamicContent.GCR||e.dynamicContent.PCR)&&(e.form.Permissions=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)),null!==o.getDynamicContent()){var l=o.getDynamicContent();l.quotationConfirmContent?e.quotationConfirmContent=l.quotationConfirmContent:e.quotationConfirmContent='<font size="3"><b>'+r.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>"}else e.quotationConfirmContent='<font size="3"><b>'+r.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>";if(null!==e.menuData.tawkCode&&void 0!==e.menuData.tawkCode&&""!==e.menuData.tawkCode){var s=e.menuData.tawkCode;e.setCustomTawk(s)}e.getCityList(function(){var t=angular.copy(e.menus);e.menus=[],angular.forEach(t,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onChangeProvince(function(){e.form.IlceKodu=o.IlceKodu})});var u=I.search();u&&(void 0!==u.id&&""!==u.id&&void 0==u.cid&&(e.form.Tip="personal",e.form.MusteriTipi=1,e.form.HesapKodu=u.id),void 0!==u.cid&&""!==u.cid&&void 0==u.id&&(e.form.Tip="company",e.form.MusteriTipi=2,e.form.HesapKodu=u.cid),void 0!==u.eml&&""!==u.eml&&(e.form.EMail=u.eml),void 0!==u.gs&&""!==u.gs&&(e.form.GSMNo=u.gs),void 0!==u.uv&&""!==u.uv&&(e.form.Unvan=u.uv),void 0!==u.tt&&""!==u.tt&&(e.form.DaskDurumu=u.tt))},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.params.menu,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],s=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalMenuId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),
"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(s,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalMenuId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=g.getPanelSettings()?g.getPanelSettings().siteName:"Polisoft Ltd");for(var u=0;u<r.length;u++)"robots"!==r[u].getAttribute("name")||i||(r[u].content="index, follow"),"description"!==r[u].getAttribute("name")||o||(r[u].content=g.getPanelSettings()?g.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=g;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalMenuId===e.menuData.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.isNavigationActive=function(e){return e?"current":"pending"},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===g.OpenedAnnounceModals.indexOf(e.menuData.menuURL)&&!0===e.menuData.isViewAnnounce){var t=!1;angular.forEach(e.boxesData.defaultItems,function(n){n.portalMenuId==e.menuData.id&&!0===n.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(t){t.data={menuId:e.menuData.id},g.OpenedAnnounceModals.push(e.menuData.menuURL)},"lg")}},e.setNavigation=function(t){e.form.DaskDurumu=t},e.onNextStep=function(){e.current++,e.currentWizard=null,1==e.current&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),3==e.current&&"1"==e.form.DaskDurumu&&e.current++,1!==e.current&&document.getElementById("form-start").scrollIntoView()},e.onBackStep=function(){2==e.current&&(e.isCustomerExists=null),4==e.current&&"1"==e.form.DaskDurumu&&e.current--,1==e.current&&e.clearForm(),e.current--,e.currentWizard=null,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.clearForm=function(){e.form.AdresNo=null,e.form.DaskPoliceNo=null,e.form.Adres=null,e.form.Mahalle=null,e.form.Sokak=null,e.form.Semt=null,e.form.BinaNo=null,e.form.DaireNo=null,e.form.id=null,e.form.propertySelection=null,e.form.YngBinaKat=5,e.form.YngKullanimSekli=null,e.form.YngYapiTarzi=null,e.form.YngBrut=null,e.form.YngYil=null,e.form.DisPoliceTipi=0,e.form.DaskPoliceFound=!1,e.form.DaskPoliceDescription=null,e.form.IkametSekli=null,e.form.YngAda=null,e.form.YngPafta=null,e.form.YngParsel=null,e.form.YngSayfa=null},e.clearFormPanel=function(){e.form.Plaka=null,e.form.RuhsatNo=null,e.form.ModelYili=null,e.form.Model=null,e.form.KullanimTarzi=null,e.form.KullanimDetayi=null,e.form.Marka=null,e.form.MotorNo=null,e.form.SasiNo=null,e.form.YolcuSayisi=null,e.form.PlakaYK=null},e.reload=function(){n.reload()},e.getCityList=function(t){null!==m.getActiveInsured()&&(e.isLoggedIn=!0,e.form.HesapKodu=m.getActiveInsured().HesKod,e.form.Unvan=m.getActiveInsured().Unvan,e.form.IlKodu=m.getActiveInsured().IlKodu,e.form.IlceKodu=m.getActiveInsured().IlceKodu,e.form.EMail=m.getActiveInsured().EMail,e.form.DogumTarihi=C.identityServiceToInput(m.getActiveInsured().DogumTarihi),!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=m.getActiveInsured().GSMNo,0===m.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==m.getActiveInsured().VergiNo&&""!==m.getActiveInsured().VergiNo&&void 0!==m.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2),"Bilgilendirme Yapıldı"===m.getActiveInsured().KVKKDurum&&(e.form.KVKK=!0),!0===e.isLoggedIn&&(e.form.KVKK=!0,e.form.Agreement=!0,e.form.PrivacyPolicy=!0),"Bilgilendirme Yapıldı"!==m.getActiveInsured().KVKKDurum&&!0!==e.isLoggedIn&&null!==e.dynamicContent&&(e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)));var n={AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans};i.post("quotation/pre",n,function(n){e.serviceConnectionStatus=n.WSCS,e.sID=n.SID,!1===n.isLogged&&(m.set(null),m.setAccountId(null),m.setList(null),e.isLoggedIn=!1),i.get("portal/lists/cities",null,function(n){e.data.sehirList=n,e.data.sehirList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.sehirList.unshift({kod:null,ad:r.translate("SEÇİNİZ")}),e.setWarrants(),"function"==typeof t&&t()})}),e.insuredInfo=m.getActiveInsured()},e.onChangeProvince=function(){i.get("portal/lists/districts",{cityCode:e.form.IlKodu},function(t){e.data.ilceList=t,e.data.ilceList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.ilceList.unshift({kod:null,ad:r.translate("SEÇİNİZ")})},null,null,null,!0)},e.getIdentityDetails=function(t){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.KVKK&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.KVKK,privacyStatus:e.form.Agreement,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi)};e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(t){if("personal"==e.form.Tip){if(!0!==t.isIdentityValid)return e.isBirthdayValid=!1,c.error(r.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.current=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}if(e.form.pPSBSType=t.pPSBSType,e.form.MKSKontrol=t.MKSKontrol,0==t.isGSMValid&&"personal"==e.form.Tip)a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(n){n.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(n){e.form.GSMNo=n.newGSMNo,e.updateInsured(function(){if(!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation)e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1});else if("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,e.onChangeProvince(),document.getElementById("form-start").scrollIntoView()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,e.isLoggedIn){var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:r.translate("SEÇİNİZ")})},null,null,null,!0)}})},onCancel:function(){e.isInsuredInfoRunning=!1}}});else if(!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation)e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1});else if("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,e.onChangeProvince(),document.getElementById("form-start").scrollIntoView()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,e.isLoggedIn){var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:r.translate("SEÇİNİZ")})},null,null,null,!0)}},function(){e.isInsuredInfoRunning=!1},null,null,t)}},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSMNo,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi),sID:e.sID};i.post("insured/update",n,function(e){"function"==typeof t&&t()},function(){e.isInsuredInfoRunning=!1})},e.doSendSMS=function(t){a.open("/content/views/sms-insured-modal.html","SMSVerifyInsuredModalController",function(n){n.data={data:e.form,sID:e.sID,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n,a){e.pSMSToken=n,e.isSmsSend=a,"function"==typeof t&&t()},onModalCancel:function(){e.isInsuredInfoRunning=!1}}})},e.selectProperty=function(){if(e.form.YngIlAdi=null,e.form.Adres=null,void 0!==e.form.propertySelection&&null!==e.form.propertySelection){var t={pHesapKodu:e.form.HesapKodu,id:e.form.propertySelection};i.post("insured/getpropertybyid",t,function(t){e.form.id=t.ID,e.form.Adres=t.Adres,e.form.IlKodu=t.IlKodu,e.form.IlceKodu=t.IlceKodu,e.form.Semt=t.Belde,e.form.Mahalle=t.Mahalle,e.form.Sokak=t.Cadde,e.form.BinaNo=t.BinaNo,e.form.DaireNo=t.DaireNo,e.form.AdresNo=t.AdresNo,e.form.YngBinaKat=t.BinaKat,e.form.YngYapiTarzi=t.YapiTarziWebline,e.form.YngBrut=t.BrutMK,e.form.YngKullanimSekli=t.KullanimSekli,e.form.YngYil=parseInt(t.InsaaYili),e.form.YngAda=t.Ada,e.form.YngPafta=t.Pafta,e.form.YngParsel=t.Parsel,e.form.YngSayfa=t.Sayfa,e.form.IkametSekli=t.IkametSekli,""!=t.IkametSekli&&void 0!=t.IkametSekli||(e.form.IkametSekli=null);var n=e.binaToplamKatList.find(function(e){return e.value===t.BinaKat});void 0!==n?e.form.YngBinaKat=n.value:(e.form.YngBinaKat=null,e.binaToplamKatList.unshift({value:null,title:r.translate("SEÇİNİZ")}));var a=e.insaaYiliList.find(function(e){return e.value===parseInt(t.InsaaYili)});e.form.YngYil=void 0!==a?a.value:null;var i=e.kullanimSekliList.find(function(e){return e.title===t.KullanimSekli});e.form.YngKullanimSekli=void 0!==i?i.value:null;var o=e.yapiTarziList.find(function(e){return e.value===t.YapiTarziWebline});e.form.YngYapiTarzi=void 0!==o?o.value:null},null,null,null,!0)}},e.checkCustomerAddressData=function(){if(!(e.form.IlKodu&&e.form.IlceKodu&&e.form.Unvan))return void(e.isNewInsuredInfosRequired=!0);e.isNewInsuredInfosRequired=!1,e.current=2,e.currentWizard=2,document.getElementById("form-start").scrollIntoView()},e.isFieldsValid=function(){var t=angular.copy(e.form);if(1===e.current||1==e.currentWizard)return 1==t.KVKK&&(!(null===t.Unvan&&e.formParameters.sigortaliAdSoyad||null===t.HesapKodu||null===t.GSMNo||null==t.DogumTarihi&&e.formParameters.isViewDateOfBirth&&"personal"==e.form.Tip)||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1))},e.trustAsHtml=function(e){return u.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return u.trustAsHtml(e)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),l.fetchTIA(e,{pAnaBrans:e.params.ab,pAraBrans:e.params.arabrans,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),l.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=f.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),s.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.doSubmitViaSMS=function(){1==e.isLoggedIn&&(e.isSmsSend=!0);var t=l.build(e);t.HesapKodu=e.form.HesapKodu,t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.DaskDurumu=parseInt(e.form.DaskDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.AdresNo=e.form.AdresNo,t.DaskPoliceNo=e.form.DaskPoliceNo,t.YngAdres=e.form.YngAdres,t.YngBelde=e.form.YngBelde,t.YngBeldeAdi=e.form.YngBeldeAdi,t.YngBinaKat=e.form.YngBinaKat,t.YngBinaNo=e.form.YngBinaNo,t.YngBrut=e.form.YngBrut,t.YngCadde=e.form.YngCadde,t.YngDaireNo=e.form.YngDaireNo,t.YngIlAdi=e.form.YngIlAdi,t.YngIlceAdi=e.form.YngIlceAdi,t.YngIlceKodu=e.form.YngIlceKodu,t.YngIlKodu=e.form.YngIlKodu,t.YngKullanimSekli=e.form.YngKullanimSekli,t.YngMahalle=e.form.YngMahalle,t.YngYapiTarzi=e.form.YngYapiTarzi,t.YngYil=e.form.YngYil,t.YngAda=e.form.YngAda,t.YngPafta=e.form.YngPafta,t.YngParsel=e.form.YngParsel,t.YngSayfa=e.form.YngSayfa,t.pPlaka="",t.pRuhsatNo="",t.AracDurumu="-1",t.pSessionID="",t.pAracKodu="",t.pTramerTarifeKodu="",t.pAracKullanimDetayKodu="",t.IkametSekli=e.form.IkametSekli,t.pDogumTarihi=C.dateInputToService(e.form.DogumTarihi),1==e.form.DaskDurumu&&(e.form.DaskOrUAVT=e.form.DaskPoliceNo,t.DaskOrUAVT=e.form.DaskPoliceNo,t.YngBrut=0,t.YngRizikoKat=0,t.YngYapiTarzi=0,t.YngYil=0),2==e.form.DaskDurumu&&(e.form.DaskOrUAVT=e.form.AdresNo,t.DaskOrUAVT=e.form.AdresNo),angular.forEach(e.data.sehirList,function(n){n.kod==e.form.YngIlKodu&&(t.YngIlKodu=n.kod)}),angular.forEach(e.data.ilceList,function(n){n.kod==e.form.YngIlKodu&&(t.YngIlceKodu=n.kod)}),t.sID=e.sID,t.isSmsVerified=!1,"insuredInformationForm"==e.formParameters.smsActivationLocation&&(t.isSmsVerified=!0),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var n=p.get("Ref");null!==n&&""!==n&&void 0!==n&&void 0!==n.kod&&null!==n.kod&&""!==n.kod&&(t.pReferansPersonelKodu=n.kod),c.confirmHtmlContent(e.quotationConfirmContent,function(){e.isSmsSend?e.doSubmit(t):a.open("/content/views/sms-modal.html","SMSVerifyModalController",function(n){n.data={data:t,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n){t.pSMSToken=n,e.doSubmit(t)}}})})},e.doSubmit=function(t){e.isQuotationPreparing=!0;try{null==t.YngBinaKat&&(t.YngBinaKat=0)}catch(e){}i.post("quotation/kaydet",t,function(t){p.set("Quotation",null);var n={pPoliID:t.href,pTip:1};0==t.ResultCode?0!==t.href&&"0"!==t.href&&null!==t.href&&""!==t.href?i.post("l/a/wlg",{},function(){p.set("Quotation",n),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):c.error(r.translate("Teklif Kaydedilemedi!")):(c.info(t.ResultMessage),e.isQuotationPreparing=!1),e.isSaving=!1},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)},e.openConfirmationModal=function(t){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"KVKK"==t&&e.onChangeGdpr()}}},"lg")},e.setCustomTawk=function(e){t.$broadcast("@SetupTawkForCustomEndpoint",e)},e.onChangeGdpr=function(t){v(function(){if(e.form.KVKK){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){e.isSendGDPRLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangeMarketing=function(t){v(function(){if(e.form.Agreement){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){e.isSendMarketingLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeMusteriTipi=function(t){e.form.MusteriTipi="personal"==t?1:2},e.inquireAddress=function(){if(null===e.form.AdresNo||""===e.form.AdresNo||void 0===e.form.AdresNo)a.open("/content/views/dask-address-modal.html","WSAddress.ModalController",function(t){t.data={onAddressSuccess:e.onAddressModalClose}});else{var t={pKod:e.form.AdresNo};e.isAddressSearching=!0,i.post("webservice/adres/direct",t,function(t){var n=t.result.return.UAVTAdres;angular.forEach(e.data.sehirList,function(t){t.ad==n.IlAd&&(e.form.IlKodu=t.kod)}),e.form.Semt=n.BeldeAd,e.form.Mahalle=n.Mahalle,e.form.Sokak=n.CSBMAd,e.form.BinaNo=n.BinaNo,e.form.DaireNo=n.DaireNo,e.form.YngBelde=n.BeldeKod,e.form.YngBeldeAdi=n.BeldeAd,e.form.YngMahalle=n.Mahalle,e.form.Sokak=n.CSBMAd,e.form.YngBinaNo=n.BinaNo,e.form.YngDaireNo=n.DaireNo,e.form.YngCadde=n.CSBMAd,e.form.YngIlAdi=n.IlAd,e.form.YngIlceAdi=n.IlceAd,e.form.YngIlceKodu=n.IlceKod,e.form.YngIlKodu=n.IlKod,e.form.YngIlKodu="0"+n.IlKod;var a=n.Mahalle+" "+n.CSBMAd+" No: "+n.BinaNo+" "+n.DaireNo+" "+n.BeldeAd+", "+n.IlceAd+", "+n.IlAd;a=a.replace("Bilinmiyor",""),a=a.replace("BİLİNMİYOR",""),e.form.Adres=a,e.form.YngAdres=e.form.Adres,""===n.BeldeAd&&""===n.Mahalle&&(e.form.Adres="ADRES BİLGİSİ ALINIRKEN BİR HATA OLUŞTU. LÜTFEN TEKRAR DENEYİN.",e.form.AdresNo=null),e.isAddressSearching=!1,v(function(){e.getDaskByAddressNo(function(){e.onChangeProvince(function(){angular.forEach(e.data.ilceList,function(t){t.ad==n.IlceAd&&(e.form.IlceKodu=t.kod)})})})},50)},function(){e.isAddressSearching=!1,e.form.AdresNo=null},null,null,!0)}},e.onAddressModalClose=function(t){angular.forEach(e.data.sehirList,function(n){n.ad==t.IlAd&&(e.form.IlKodu=n.kod)}),e.form.Semt=t.BeldeAd,e.form.Mahalle=t.Mahalle,e.form.Sokak=t.CSBMAd,e.form.BeldeAd=t.BeldeAd,e.form.BinaNo=t.BinaNo,e.form.DaireNo=t.DaireNo;var n=t.Mahalle+" "+t.CSBMAd+" No: "+t.BinaNo+" "+t.DaireNo+" "+t.BeldeAd+", "+t.IlceAd+", "+t.IlAd;n=n.replace("Bilinmiyor",""),n=n.replace("BİLİNMİYOR",""),e.form.Adres=n,e.form.YngAdres=e.form.Adres,e.form.AdresNo=t.AdresNo,e.form.YngBelde=t.BeldeKod,e.form.YngBeldeAdi=t.BeldeAd,e.form.YngMahalle=t.Mahalle,e.form.Sokak=t.CSBMAd,e.form.YngBinaNo=t.BinaNo,e.form.YngDaireNo=t.DaireNo,e.form.YngCadde=t.CSBMAd,e.form.YngIlAdi=t.IlAd,e.form.YngIlceAdi=t.IlceAd,e.form.YngIlceKodu=t.IlceKod,e.form.YngIlKodu=t.IlKod,v(function(){e.getDaskByAddressNo(function(){e.onChangeProvince(function(){angular.forEach(e.data.ilceList,function(n){n.ad==t.IlceAd&&(e.form.IlceKodu=n.kod)})})})},50)},e.getDaskByAddressNo=function(t){if("1"==e.form.DaskDurumu&&1==e.PSBSStatus.DP){var n={pTCKimlikNo:e.form.HesapKodu,pUAVTAdresNo:e.form.AdresNo,pPSBSType:e.form.pPSBSType};i.post("webservice/daskpoliceno/getbyaddresscode",n,function(n){e.form.DaskPoliceNo=parseInt(k.decrypt(n)),null!==e.form.DaskPoliceNo&&void 0!==e.form.DaskPoliceNo&&""!==e.form.DaskPoliceNo&&(e.form.hdDaskPoliceNo=n.substring(0,1)+"******"+n.substring(7,8)),""==n||null==n||void 0==n?(e.form.DaskPoliceFound=!1,e.form.DaskPoliceDescription=r.translate("Eski Dask Numarası bulunamadı. Bilgilerinizi kontrol edin.")):(e.form.DaskPoliceFound=!0,e.form.DaskPoliceDescription=null),"function"==typeof t&&t()},null,null,null,!0)}"function"==typeof t&&t()},e.getDASKSummaryBinaKat=function(){var t=null;return angular.forEach(e.binaToplamKatList,function(n){n.value===e.form.YngBinaKat&&(t={title:n.title,tooltip:r.translate("Kat Sayısı")})}),t},e.getDASKSummaryInsaatYili=function(){var t=null;return angular.forEach(e.insaaYiliList,function(n){n.value===e.form.YngYil&&(t={title:n.title,tooltip:r.translate("İnşaat Yılı")})}),t},e.getDASKSummaryKullanimSekli=function(){var t=null;return angular.forEach(e.kullanimSekliList,function(n){n.value===e.form.YngKullanimSekli&&(t={title:n.title,tooltip:r.translate("Kullanım Şekli")})}),t},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=y("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.cbExpiration=function(){S.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(S.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isNextButtonDisabled=!1:(e.isNextButtonDisabled=!0,c.error(r.translate("reCAPTCHA doğrulanamadı..!")),S.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&c.info(e)},e.getIdentityDetailsStyleThree=function(t){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:C.dateInputToService(e.form.DogumTarihi)};e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(t){if("personal"==e.form.Tip){if(!0!==t.isIdentityValid)return e.isBirthdayValid=!1,c.error(r.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.currentWizard=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}if(e.form.pPSBSType=t.pPSBSType,e.form.MKSKontrol=t.MKSKontrol,0==t.isGSMValid&&"personal"==e.form.Tip)a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(n){n.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(n){e.form.GSMNo=n.newGSMNo,e.updateInsured(function(){if("company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,e.onChangeProvince(),document.getElementById("form-start").scrollIntoView()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,e.isLoggedIn){var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:r.translate("SEÇİNİZ")})},null,null,null,!0)}})},onCancel:function(){e.isInsuredInfoRunning=!1}}});else if("company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,e.onChangeProvince(),document.getElementById("form-start").scrollIntoView()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,e.isLoggedIn){var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:r.translate("SEÇİNİZ")})},null,null,null,!0)}},function(){e.isInsuredInfoRunning=!1},null,null,t)}},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=T.remove(t.return.JSONData),e.referenceCode=T.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCode=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?(e.pSMSToken=e.form.pSessionID,e.doPrepareSubmit()):6==t.ResultCode?c.error(r.translate("ALERT_VERIFY_ERROR")):c.error(r.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doPrepareSubmit=function(){var t=l.build(e);t.HesapKodu=e.form.HesapKodu,t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.DaskDurumu=parseInt(e.form.DaskDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.AdresNo=e.form.AdresNo,t.DaskPoliceNo=e.form.DaskPoliceNo,t.YngAdres=e.form.YngAdres,t.YngBelde=e.form.YngBelde,t.YngBeldeAdi=e.form.YngBeldeAdi,t.YngBinaKat=e.form.YngBinaKat,t.YngBinaNo=e.form.YngBinaNo,t.YngBrut=e.form.YngBrut,t.YngCadde=e.form.YngCadde,t.YngDaireNo=e.form.YngDaireNo,t.YngIlAdi=e.form.YngIlAdi,t.YngIlceAdi=e.form.YngIlceAdi,t.YngIlceKodu=e.form.YngIlceKodu,t.YngIlKodu=e.form.YngIlKodu,t.YngKullanimSekli=e.form.YngKullanimSekli,t.YngMahalle=e.form.YngMahalle,t.YngYapiTarzi=e.form.YngYapiTarzi,t.YngYil=e.form.YngYil,t.YngAda=e.form.YngAda,t.YngPafta=e.form.YngPafta,t.YngParsel=e.form.YngParsel,t.YngSayfa=e.form.YngSayfa,t.pPlaka="",t.pRuhsatNo="",t.AracDurumu="-1",t.pSessionID="",t.pAracKodu="",t.pTramerTarifeKodu="",t.pAracKullanimDetayKodu="",t.IkametSekli=e.form.IkametSekli,t.pDogumTarihi=C.dateInputToService(e.form.DogumTarihi),1==e.form.DaskDurumu&&(e.form.DaskOrUAVT=e.form.DaskPoliceNo,t.DaskOrUAVT=e.form.DaskPoliceNo,t.YngBrut=0,t.YngRizikoKat=0,t.YngYapiTarzi=0,t.YngYil=0),2==e.form.DaskDurumu&&(e.form.DaskOrUAVT=e.form.AdresNo,t.DaskOrUAVT=e.form.AdresNo),angular.forEach(e.data.sehirList,function(n){n.kod==e.form.YngIlKodu&&(t.YngIlKodu=n.kod)}),angular.forEach(e.data.ilceList,function(n){n.kod==e.form.YngIlKodu&&(t.YngIlceKodu=n.kod)}),t.sID=e.sID,t.isSmsVerified=!0,t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var n=p.get("Ref");null!==n&&""!==n&&void 0!==n&&void 0!==n.kod&&null!==n.kod&&""!==n.kod&&(t.pReferansPersonelKodu=n.kod),1==e.isLoggedIn?c.confirmHtmlContent(e.quotationConfirmContent,function(){e.doSubmit(t)}):(document.getElementById("form-start").scrollIntoView(),e.doSubmit(t))},e.onChangeGdprAndMarketing=function(t){e.form.KVKK=t,e.form.PrivacyPolicy=t,e.onChangeGdpr(function(){})},e.checkCustomerType=function(t){null!==t&&""!==t&&void 0!==t&&(9!=t.length&&10!=t.length||(e.form.Tip="company",e.form.MusteriTipi=2),11==t.length&&(e.form.Tip="personal",e.form.MusteriTipi=1))},e.onNextWizard=function(){e.current=null,e.currentWizard++,1==e.currentWizard&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),3==e.currentWizard&&"1"==e.form.DaskDurumu&&e.currentWizard++,document.getElementById("form-start").scrollIntoView()},e.onBackWizard=function(){2==e.currentWizard&&(e.isCustomerExists=null),4==e.currentWizard&&"1"==e.form.DaskDurumu&&e.currentWizard--,5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard--,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onEditWizard=function(t){1==t&&(e.isCustomerExists=null),5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard=t,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onCreate()}]),app.controller("Engineering.QuotationController",["$scope","$rootScope","$state","$modal","$rest","$culture","$form","$tia","$sce","$alert","$rootSettings","$insured","$currency","$storage","$welcomeInit","$timeout","$boxesInit","$filter","$location","vcRecaptchaService","$dateFormatter","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S){e.params={ab:null,arabrans:null,menu:null,menuurl:null},e.current=1,e.currentWizard=1,e.isCustomerExists=null,e.isLoggedIn=!1,e.menuData={},e.welcomeInit=p,e.isQuotationPreparing=!1,e.isDefaultBannerActive=!0,e.portalMenusKeywords=null,e.isEmailRegex=!0,e.isBack=!1,e.isInsuredInfoRunning=!1,e.sID=null,e.isSmsSend=!1,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isNextButtonDisabled=!1,e.isSendGDPRLog=!1,e.isSendMarketingLog=!1,e._tia={data:null,onPrev:null,onNext:null,current:null},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null,smsActivationLocation:"getQuotation",smsActivateDescription:null,isVerifyRCPT:!1,isViewDateOfBirth:!1},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.form={Tip:"personal",MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,IlKodu:null,IlceKodu:null,KVKK:!0,
Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,DogumTarihi:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,Permissions:!0},e.contact={name:null,surname:null,phone:null,message:null},e.data={sehirList:[],ilceList:[]},e.onCreate=function(){e.welcomeInit.isSuccessData?e.initData():t.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){""!==n.params.menuurl&&null!==n.params.menuurl||n.go("PageNotFound",{},{reload:!0});var a=h.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};f.set("Ref",t)}});var r=p;if(e.menus=r.getMenus(),angular.forEach(r.getMenus(),function(a){n.params.menuurl==a.menuURL&&(e.params.ab=parseInt(a.main_product),e.params.arabrans=a.product,e.params.menuurl=a.menuURL,e.params.menu=a.id,e.form.AnaBrans=e.params.ab,e.form.AraBrans=e.params.arabrans,e.menuData=a,e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:e.menuData.id,viewLocation:"QUOTATION"},function(){var n=e.welcomeInit;if(e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.PK=n.getReCaptchaKeys(),null!==e.PK&&void 0!==e.PK&&""!==e.PK&&e.formParameters.isVerifyRCPT&&!0!==e.isLoggedIn?(e.isViewReCaptcha=!0,e.isNextButtonDisabled=!0):(e.isNextButtonDisabled=!1,e.isViewReCaptcha=!1),e.setAnnouncements(),e.setQuickLinks(),e.boxesInit=v.onCreate(e.menuData.id),t.$on("$boxesInit.onSuccess",function(){e.boxesData=v.getBoxes(e.menuData.id),e.getCategories(e.boxesData),e.openAnnounceModal()}),i.get("welcome/menus/menuskeywords/"+e.menuData.id,{},function(t){e.portalMenusKeywords=t})})}))}),c.set(r.getRootSettings()),!0!==e.isLoggedIn&&null!==r.getDynamicContent()&&(e.dynamicContent=r.getDynamicContent(),e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.PCR&&(e.form.PrivacyPolicy=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1),(e.dynamicContent.GCR||e.dynamicContent.PCR)&&(e.form.Permissions=!1)),null!==r.getDynamicContent()){var l=r.getDynamicContent();l.quotationConfirmContent?e.quotationConfirmContent=l.quotationConfirmContent:e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>"}else e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>";if(null!==e.menuData.tawkCode&&void 0!==e.menuData.tawkCode&&""!==e.menuData.tawkCode){var s=e.menuData.tawkCode;e.setCustomTawk(s)}e.getCityList(function(){var t=angular.copy(e.menus);e.menus=[],angular.forEach(t,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onChangeProvince(function(){e.form.IlceKodu=r.IlceKodu})});var u=h.search();u&&(void 0!==u.id&&""!==u.id&&void 0==u.cid&&(e.form.Tip="personal",e.form.MusteriTipi=1,e.form.HesapKodu=u.id),void 0!==u.cid&&""!==u.cid&&void 0==u.id&&(e.form.Tip="company",e.form.MusteriTipi=2,e.form.HesapKodu=u.cid),void 0!==u.eml&&""!==u.eml&&(e.form.EMail=u.eml),void 0!==u.gs&&""!==u.gs&&(e.form.GSMNo=u.gs),void 0!==u.uv&&""!==u.uv&&(e.form.Unvan=u.uv))},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.params.menu,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],s=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalMenuId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(s,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalMenuId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=p.getPanelSettings()?p.getPanelSettings().siteName:"Polisoft Ltd");for(var u=0;u<r.length;u++)"robots"!==r[u].getAttribute("name")||i||(r[u].content="index, follow"),"description"!==r[u].getAttribute("name")||o||(r[u].content=p.getPanelSettings()?p.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=p;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalMenuId===e.menuData.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.isNavigationActive=function(e){return e?"current":"pending"},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===p.OpenedAnnounceModals.indexOf(e.menuData.menuURL)&&!0===e.menuData.isViewAnnounce){var t=!1;angular.forEach(e.boxesData.defaultItems,function(n){n.portalMenuId==e.menuData.id&&!0===n.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(t){t.data={menuId:e.menuData.id},p.OpenedAnnounceModals.push(e.menuData.menuURL)},"lg")}},e.onNextStep=function(){e.current++,e.currentWizard=null,1==e.current&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackStep=function(){2==e.current&&(e.isCustomerExists=null),e.current--,e.currentWizard=null,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.reload=function(){n.reload()},e.getCityList=function(t){null!==d.getActiveInsured()&&(e.isLoggedIn=!0,e.form.HesapKodu=d.getActiveInsured().HesKod,e.form.Unvan=d.getActiveInsured().Unvan,e.form.IlKodu=d.getActiveInsured().IlKodu,e.form.IlceKodu=d.getActiveInsured().IlceKodu,e.form.EMail=d.getActiveInsured().EMail,e.form.DogumTarihi=I.identityServiceToInput(d.getActiveInsured().DogumTarihi),!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=d.getActiveInsured().GSMNo,null!==e.form.IlKodu&&void 0!==e.form.IlKodu&&""!==e.form.IlKodu||(e.form.IlKodu="001"),null!==e.form.IlceKodu&&void 0!==e.form.IlceKodu&&""!==e.form.IlceKodu||(e.form.IlceKodu="001"),0===d.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==d.getActiveInsured().VergiNo&&""!==d.getActiveInsured().VergiNo&&void 0!==d.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2),"Bilgilendirme Yapıldı"===d.getActiveInsured().KVKKDurum&&(e.form.KVKK=!0),!0===e.isLoggedIn&&(e.form.KVKK=!0,e.form.Agreement=!0,e.form.PrivacyPolicy=!0),"Bilgilendirme Yapıldı"!==d.getActiveInsured().KVKKDurum&&!0!==e.isLoggedIn&&null!==e.dynamicContent&&(e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)));var n={AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans};i.post("quotation/pre",n,function(n){e.serviceConnectionStatus=n.WSCS,e.sID=n.SID,!1===n.isLogged&&(d.set(null),d.setAccountId(null),d.setList(null),e.isLoggedIn=!1),i.get("portal/lists/cities",null,function(n){e.data.sehirList=n,e.data.sehirList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.sehirList.unshift({kod:null,ad:o.translate("SEÇİNİZ")}),"function"==typeof t&&t()})}),e.insuredInfo=d.getActiveInsured()},e.onChangeProvince=function(){i.get("portal/lists/districts",{cityCode:e.form.IlKodu},function(t){e.data.ilceList=t,e.data.ilceList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.ilceList.unshift({kod:null,ad:o.translate("SEÇİNİZ")})},null,null,null,!0)},e.getIdentityDetails=function(t){if(auto=!!t,e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.KVKK&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.KVKK,privacyStatus:e.form.Agreement,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.current=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==n.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,e.onChangeProvince(),document.getElementById("form-start").scrollIntoView(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,e.onChangeProvince(),document.getElementById("form-start").scrollIntoView(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSMNo,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi),sID:e.sID};i.post("insured/update",n,function(e){"function"==typeof t&&t()},function(){e.isInsuredInfoRunning=!1})},e.doSendSMS=function(t){a.open("/content/views/sms-insured-modal.html","SMSVerifyInsuredModalController",function(n){n.data={data:e.form,sID:e.sID,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n,a){e.pSMSToken=n,e.isSmsSend=a,"function"==typeof t&&t()},onModalCancel:function(){e.isInsuredInfoRunning=!1}}})},e.checkCustomerAddressData=function(){if(!(e.form.IlKodu&&e.form.IlceKodu&&e.form.Unvan))return void(e.isNewInsuredInfosRequired=!0);e.isNewInsuredInfosRequired=!1,e.setWarrants(),e.current=2,e.currentWizard=2,e.onVehicleCreate(),document.getElementById("form-start").scrollIntoView()},e.isFieldsValid=function(){var t=angular.copy(e.form);if(1===e.current||1===e.currentWizard)return 1==t.KVKK&&(!(null===t.Unvan&&e.formParameters.sigortaliAdSoyad||null===t.HesapKodu||null===t.GSMNo||null==t.DogumTarihi&&e.formParameters.isViewDateOfBirth&&"personal"==e.form.Tip)||(u.error(o.translate("Lütfen gerekli alanları doldurun.")),!1))},e.trustAsHtml=function(e){return s.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return s.trustAsHtml(e)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),r.fetchTIA(e,{pAnaBrans:e.params.ab,pAraBrans:e.params.arabrans,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),r.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=m.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),l.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.doSubmitViaSMS=function(){1==e.isLoggedIn&&(e.isSmsSend=!0);var t=r.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.sID=e.sID,t.isSmsVerified=!1,"insuredInformationForm"==e.formParameters.smsActivationLocation&&(t.isSmsVerified=!0),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var i=f.get("Ref");null!==i&&""!==i&&void 0!==i&&void 0!==i.kod&&null!==i.kod&&""!==i.kod&&(t.pReferansPersonelKodu=i.kod),u.confirmHtmlContent(e.quotationConfirmContent,function(){e.isSmsSend?e.doSubmit(t):a.open("/content/views/sms-modal.html","SMSVerifyModalController",function(n){n.data={data:t,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n){t.pSMSToken=n,e.doSubmit(t)}}})})},e.doSubmit=function(t){e.isQuotationPreparing=!0,i.post("quotation/kaydet",t,function(t){f.set("Quotation",null);var n={pPoliID:t.href,pTip:1};0==t.ResultCode?0!==t.href&&"0"!==t.href&&null!==t.href&&""!==t.href?i.post("l/a/wlg",{},function(){f.set("Quotation",n),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):u.error(o.translate("Teklif Kaydedilemedi!")):(u.info(t.ResultMessage),e.isQuotationPreparing=!1),e.isSaving=!1},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)},e.openConfirmationModal=function(t){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"KVKK"==t&&e.onChangeGdpr()}}},"lg")},e.setCustomTawk=function(e){t.$broadcast("@SetupTawkForCustomEndpoint",e)},e.onChangeGdpr=function(t){g(function(){if(e.form.KVKK){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){e.isSendGDPRLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangeMarketing=function(t){g(function(){if(e.form.Agreement){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){e.isSendMarketingLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeMusteriTipi=function(t){e.form.MusteriTipi="personal"==t?1:2},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=k("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.cbExpiration=function(){y.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(y.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isNextButtonDisabled=!1:(e.isNextButtonDisabled=!0,u.error(o.translate("reCAPTCHA doğrulanamadı..!")),y.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&u.info(e)},e.getIdentityDetailsStyleThree=function(t){if(auto=!!t,e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.currentWizard=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==n.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=S.remove(t.return.JSONData),e.referenceCode=S.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCode=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?(e.pSMSToken=e.form.pSessionID,e.doPrepareSubmit()):6==t.ResultCode?u.error(o.translate("ALERT_VERIFY_ERROR")):u.error(o.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doPrepareSubmit=function(){var t=r.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.sID=e.sID,t.isSmsVerified=!0,t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var a=f.get("Ref");null!==a&&""!==a&&void 0!==a&&void 0!==a.kod&&null!==a.kod&&""!==a.kod&&(t.pReferansPersonelKodu=a.kod),1==e.isLoggedIn?u.confirmHtmlContent(e.quotationConfirmContent,function(){e.doSubmit(t)}):(document.getElementById("form-start").scrollIntoView(),e.doSubmit(t))},e.onChangeGdprAndMarketing=function(t){e.form.KVKK=t,e.form.PrivacyPolicy=t,e.onChangeGdpr(function(){})},e.checkCustomerType=function(t){null!==t&&""!==t&&void 0!==t&&(9!=t.length&&10!=t.length||(e.form.Tip="company",e.form.MusteriTipi=2),11==t.length&&(e.form.Tip="personal",e.form.MusteriTipi=1))},e.onNextWizard=function(){e.current=null,e.currentWizard++,1==e.currentWizard&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackWizard=function(){2==e.currentWizard&&(e.isCustomerExists=null),3==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard--,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onEditWizard=function(t){1==t&&(e.isCustomerExists=null),3==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard=t,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onCreate()}]),app.controller("Health.QuotationController",["$scope","$rootScope","$state","$modal","$rest","$culture","$form","$tia","$sce","$alert","$rootSettings","$insured","$currency","$storage","$welcomeInit","$timeout","$boxesInit","$filter","$location","vcRecaptchaService","$dateFormatter","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S){e.params={ab:null,arabrans:null,menu:null,menuurl:null},e.current=1,e.currentWizard=1,e.isCustomerExists=null,e.menuData={},e.isLoggedIn=!1,e.welcomeInit=p,e.isQuotationPreparing=!1,e.isDefaultBannerActive=!0,e.portalMenusKeywords=null,e.isEmailRegex=!0,e.isBack=!1,e.isInsuredInfoRunning=!1,e.sID=null,e.isSmsSend=!1,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isNextButtonDisabled=!1,e.isSendGDPRLog=!1,e.isSendMarketingLog=!1,e._tia={data:null,onPrev:null,onNext:null,current:null},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null,smsActivationLocation:"getQuotation",smsActivateDescription:null,isVerifyRCPT:!1,isViewDateOfBirth:!1},e.form={Tip:"personal",MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,IlKodu:null,IlceKodu:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,DogumTarihi:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,Permissions:!0},e.contact={name:null,surname:null,phone:null,message:null},e.data={sehirList:[],ilceList:[]},e.onCreate=function(){e.welcomeInit.isSuccessData?e.initData():t.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.insuredList=[],e.sigortaliForm={TCKN:null,Ad:null,Yakinlik:null,DogumTarihi:null},e.yakinlikList=[{kod:null,ad:o.translate("SEÇİNİZ")},{kod:"Eşi",ad:o.translate("Eşi")},{kod:"Çocuğu",ad:o.translate("Çocuğu")}],e.addInsured=function(t){t.TCKN&&t.Ad&&t.Yakinlik&&t.DogumTarihi?(e.insuredList.push({TCKN:t.TCKN,Ad:t.Ad,Yakinlik:t.Yakinlik,DogumTarihi:I.dateInputToService(t.DogumTarihi)}),e.sigortaliForm={TCKN:null,Ad:null,Yakinlik:null,DogumTarihi:null}):u.error(o.translate("Tüm alanlar doldurulmalıdır!"))},e.deleteInsured=function(t){u.deleteConfirmation(function(){var n=e.insuredList.indexOf(t);e.insuredList.splice(n,1),e.$apply()})},e.initData=function(){""!==n.params.menuurl&&null!==n.params.menuurl||n.go("PageNotFound",{},{reload:!0});var a=h.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};f.set("Ref",t)}});var r=p;if(e.menus=r.getMenus(),angular.forEach(r.getMenus(),function(a){n.params.menuurl==a.menuURL&&(e.params.ab=parseInt(a.main_product),e.params.arabrans=a.product,e.params.menuurl=a.menuURL,e.params.menu=a.id,e.form.AnaBrans=e.params.ab,e.form.AraBrans=e.params.arabrans,e.menuData=a,e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:e.menuData.id,viewLocation:"QUOTATION"},function(){var n=e.welcomeInit;if(e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.PK=n.getReCaptchaKeys(),null!==e.PK&&void 0!==e.PK&&""!==e.PK&&e.formParameters.isVerifyRCPT&&!0!==e.isLoggedIn?(e.isViewReCaptcha=!0,e.isNextButtonDisabled=!0):(e.isNextButtonDisabled=!1,e.isViewReCaptcha=!1),e.setAnnouncements(),e.setQuickLinks(),e.boxesInit=v.onCreate(e.menuData.id),t.$on("$boxesInit.onSuccess",function(){e.boxesData=v.getBoxes(e.menuData.id),e.getCategories(e.boxesData),e.openAnnounceModal()}),i.get("welcome/menus/menuskeywords/"+e.menuData.id,{},function(t){e.portalMenusKeywords=t})})}))}),c.set(r.getRootSettings()),!0!==e.isLoggedIn&&null!==r.getDynamicContent()&&(e.dynamicContent=r.getDynamicContent(),e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.PCR&&(e.form.PrivacyPolicy=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1),(e.dynamicContent.GCR||e.dynamicContent.PCR)&&(e.form.Permissions=!1)),null!==r.getDynamicContent()){var l=r.getDynamicContent();l.quotationConfirmContent?e.quotationConfirmContent=l.quotationConfirmContent:e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>"}else e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>";if(null!==e.menuData.tawkCode&&void 0!==e.menuData.tawkCode&&""!==e.menuData.tawkCode){var s=e.menuData.tawkCode;e.setCustomTawk(s)}e.getCityList(function(){var t=angular.copy(e.menus);e.menus=[],angular.forEach(t,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onChangeProvince(function(){e.form.IlceKodu=r.IlceKodu})});var u=h.search();u&&(void 0!==u.id&&""!==u.id&&void 0==u.cid&&(e.form.Tip="personal",e.form.MusteriTipi=1,e.form.HesapKodu=u.id),void 0!==u.cid&&""!==u.cid&&void 0==u.id&&(e.form.Tip="company",e.form.MusteriTipi=2,e.form.HesapKodu=u.cid),void 0!==u.eml&&""!==u.eml&&(e.form.EMail=u.eml),void 0!==u.gs&&""!==u.gs&&(e.form.GSMNo=u.gs),void 0!==u.uv&&""!==u.uv&&(e.form.Unvan=u.uv))},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.params.menu,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",
property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],s=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalMenuId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(s,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalMenuId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=p.getPanelSettings()?p.getPanelSettings().siteName:"Polisoft Ltd");for(var u=0;u<r.length;u++)"robots"!==r[u].getAttribute("name")||i||(r[u].content="index, follow"),"description"!==r[u].getAttribute("name")||o||(r[u].content=p.getPanelSettings()?p.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=p;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalMenuId===e.menuData.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.isNavigationActive=function(e){return e?"current":"pending"},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===p.OpenedAnnounceModals.indexOf(e.menuData.menuURL)&&!0===e.menuData.isViewAnnounce){var t=!1;angular.forEach(e.boxesData.defaultItems,function(n){n.portalMenuId==e.menuData.id&&!0===n.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(t){t.data={menuId:e.menuData.id},p.OpenedAnnounceModals.push(e.menuData.menuURL)},"lg")}},e.onNextStep=function(){e.current++,e.currentWizard=null,1==e.current&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackStep=function(){2==e.current&&(e.isCustomerExists=null),e.current--,e.currentWizard=null,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.reload=function(){n.reload()},e.getCityList=function(t){null!==d.getActiveInsured()&&(e.isLoggedIn=!0,e.form.HesapKodu=d.getActiveInsured().HesKod,e.form.Unvan=d.getActiveInsured().Unvan,e.form.IlKodu=d.getActiveInsured().IlKodu,e.form.IlAdi=d.getActiveInsured().Sehir,e.form.IlceKodu=d.getActiveInsured().IlceKodu,e.form.IlceAdi=d.getActiveInsured().Ilce,e.form.EMail=d.getActiveInsured().EMail,e.form.DogumTarihi=I.identityServiceToInput(d.getActiveInsured().DogumTarihi),!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=d.getActiveInsured().GSMNo,null!==e.form.IlKodu&&void 0!==e.form.IlKodu&&""!==e.form.IlKodu||(e.form.IlKodu="001"),null!==e.form.IlceKodu&&void 0!==e.form.IlceKodu&&""!==e.form.IlceKodu||(e.form.IlceKodu="001"),0===d.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==d.getActiveInsured().VergiNo&&""!==d.getActiveInsured().VergiNo&&void 0!==d.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2),"Bilgilendirme Yapıldı"===d.getActiveInsured().KVKKDurum&&(e.form.KVKK=!0),!0===e.isLoggedIn&&(e.form.KVKK=!0,e.form.Agreement=!0,e.form.PrivacyPolicy=!0),"Bilgilendirme Yapıldı"!==d.getActiveInsured().KVKKDurum&&!0!==e.isLoggedIn&&null!==e.dynamicContent&&(e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)));var n={AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans};i.post("quotation/pre",n,function(n){e.serviceConnectionStatus=n.WSCS,e.sID=n.SID,!1===n.isLogged&&(d.set(null),d.setAccountId(null),d.setList(null),e.isLoggedIn=!1),i.get("portal/lists/cities",null,function(n){e.data.sehirList=n,e.data.sehirList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.sehirList.unshift({kod:null,ad:o.translate("SEÇİNİZ")}),"function"==typeof t&&t()})}),e.insuredInfo=d.getActiveInsured()},e.onChangeProvince=function(){i.get("portal/lists/districts",{cityCode:e.form.IlKodu},function(t){e.data.ilceList=t,e.data.ilceList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.ilceList.unshift({kod:null,ad:o.translate("SEÇİNİZ")})},null,null,null,!0)},e.getIdentityDetails=function(t){t?(auto=!0,loadingTimeout=0):(auto=!1,loadingTimeout=150),g(function(){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.KVKK&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.KVKK,privacyStatus:e.form.Agreement,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};"company"!=e.form.Tip&&2!=e.form.MusteriTipi||(void 0!=n.IlAdi&&null!=n.IlAdi&&""!=n.IlAdi||(n.IlAdi=e.insuredInfo.Sehir),void 0!=n.IlceAdi&&null!=n.IlceAdi&&""!=n.IlceAdi||(n.IlceAdi=e.insuredInfo.Ilce)),e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.current=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==n.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},loadingTimeout)},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSMNo,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi),sID:e.sID};i.post("insured/update",n,function(e){"function"==typeof t&&t()},function(){e.isInsuredInfoRunning=!1})},e.doSendSMS=function(t){a.open("/content/views/sms-insured-modal.html","SMSVerifyInsuredModalController",function(n){n.data={data:e.form,sID:e.sID,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n,a){e.pSMSToken=n,e.isSmsSend=a,"function"==typeof t&&t()},onModalCancel:function(){e.isInsuredInfoRunning=!1}}})},e.checkCustomerAddressData=function(){if(!(e.form.IlKodu&&e.form.IlceKodu&&e.form.Unvan))return void(e.isNewInsuredInfosRequired=!0);e.isNewInsuredInfosRequired=!1,e.setWarrants(),e.current=2,e.currentWizard=2,document.getElementById("form-start").scrollIntoView()},e.isFieldsValid=function(){var t=angular.copy(e.form);if(1===e.current||1==e.currentWizard)return 1==t.KVKK&&(!(null===t.Unvan&&e.formParameters.sigortaliAdSoyad||null===t.HesapKodu||null===t.GSMNo||null==t.DogumTarihi&&e.formParameters.isViewDateOfBirth&&"personal"==e.form.Tip)||(u.error(o.translate("Lütfen gerekli alanları doldurun.")),!1))},e.trustAsHtml=function(e){return s.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return s.trustAsHtml(e)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),r.fetchTIA(e,{pAnaBrans:e.params.ab,pAraBrans:e.params.arabrans,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),r.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=m.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),l.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.doSubmitViaSMS=function(){1==e.isLoggedIn&&(e.isSmsSend=!0);var t=r.build(e);t.pKN=e.form.HesapKodu,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),t.sID=e.sID,angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!1,"insuredInformationForm"==e.formParameters.smsActivationLocation&&(t.isSmsVerified=!0),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var n=f.get("Ref");null!==n&&""!==n&&void 0!==n&&void 0!==n.kod&&null!==n.kod&&""!==n.kod&&(t.pReferansPersonelKodu=n.kod),u.confirmHtmlContent(e.quotationConfirmContent,function(){e.isSmsSend?e.doSubmit(t):a.open("/content/views/sms-modal.html","SMSVerifyModalController",function(n){n.data={data:t,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n){t.pSMSToken=n,e.doSubmit(t)}}})})},e.doSubmit=function(t){e.isQuotationPreparing=!0,t.pSigortalilar=e.insuredList,i.post("quotation/kaydet",t,function(t){f.set("Quotation",null);var n={pPoliID:t.href,pTip:1};0==t.ResultCode?0!==t.href&&"0"!==t.href&&null!==t.href&&""!==t.href?i.post("l/a/wlg",{},function(){f.set("Quotation",n),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):u.error(o.translate("Teklif Kaydedilemedi!")):(u.info(t.ResultMessage),e.isQuotationPreparing=!1),e.isSaving=!1},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)},e.openConfirmationModal=function(t){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"KVKK"==t&&e.onChangeGdpr()}}},"lg")},e.setCustomTawk=function(e){t.$broadcast("@SetupTawkForCustomEndpoint",e)},e.onChangeGdpr=function(t){g(function(){if(e.form.KVKK){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){e.isSendGDPRLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangeMarketing=function(t){g(function(){if(e.form.Agreement){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){e.isSendMarketingLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeMusteriTipi=function(t){e.form.MusteriTipi="personal"==t?1:2},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=k("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.cbExpiration=function(){y.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(y.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isNextButtonDisabled=!1:(e.isNextButtonDisabled=!0,u.error(o.translate("reCAPTCHA doğrulanamadı..!")),y.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&u.info(e)},e.getIdentityDetailsStyleThree=function(t){t?(auto=!0,loadingTimeout=0):(auto=!1,loadingTimeout=150),g(function(){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};"company"!=e.form.Tip&&2!=e.form.MusteriTipi||(void 0!=n.IlAdi&&null!=n.IlAdi&&""!=n.IlAdi||(n.IlAdi=e.insuredInfo.Sehir),void 0!=n.IlceAdi&&null!=n.IlceAdi&&""!=n.IlceAdi||(n.IlceAdi=e.insuredInfo.Ilce)),e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.currentWizard=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==n.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},loadingTimeout)},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=S.remove(t.return.JSONData),e.referenceCode=S.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCode=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?(e.pSMSToken=e.form.pSessionID,e.doPrepareSubmit()):6==t.ResultCode?u.error(o.translate("ALERT_VERIFY_ERROR")):u.error(o.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doPrepareSubmit=function(){var t=r.build(e);t.pKN=e.form.HesapKodu,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),t.sID=e.sID,angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!0,t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var n=f.get("Ref");null!==n&&""!==n&&void 0!==n&&void 0!==n.kod&&null!==n.kod&&""!==n.kod&&(t.pReferansPersonelKodu=n.kod),1==e.isLoggedIn?u.confirmHtmlContent(e.quotationConfirmContent,function(){e.doSubmit(t)}):(document.getElementById("form-start").scrollIntoView(),e.doSubmit(t))},e.onChangeGdprAndMarketing=function(t){e.form.KVKK=t,e.form.PrivacyPolicy=t,e.onChangeGdpr(function(){})},e.checkCustomerType=function(t){null!==t&&""!==t&&void 0!==t&&(9!=t.length&&10!=t.length||(e.form.Tip="company",e.form.MusteriTipi=2),11==t.length&&(e.form.Tip="personal",e.form.MusteriTipi=1))},e.onNextWizard=function(){e.current=null,e.currentWizard++,1==e.currentWizard&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackWizard=function(){2==e.currentWizard&&(e.isCustomerExists=null),3==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard--,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onEditWizard=function(t){1==t&&(e.isCustomerExists=null),3==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard=t,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onCreate()}]),app.controller("OtherCar.QuotationController",["$scope","$rootScope","$state","$modal","$rest","$lists","$culture","$form","$tia","$sce","$alert","$rootSettings","$insured","$currency","$welcomeInit","$storage","$timeout","$boxesInit","$filter","$location","vcRecaptchaService","$dateFormatter","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S,C){e.params={ab:null,arabrans:null,menu:null,menuurl:null},e.current=0,e.currentWizard=1,e.isCustomerExists=null,e.menuData={},e.isLoggedIn=!1,e.welcomeInit=p,e.isQuotationPreparing=!1,e.isDefaultBannerActive=!0,e.portalMenusKeywords=null,e.isEmailRegex=!0,e.isBack=!1,e.isInsuredInfoRunning=!1,e.sID=null,e.isSmsSend=!1,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isNextButtonDisabled=!1,e.isSendGDPRLog=!1,e.isSendMarketingLog=!1,e._tia={data:null,onPrev:null,onNext:null,current:null},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null,smsActivationLocation:"getQuotation",smsActivateDescription:null,isVerifyRCPT:!1,isViewDateOfBirth:!1},e.form={Tip:"personal",MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,AracDurumu:"0",IlKodu:null,IlceKodu:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,Plaka:null,RuhsatNo:null,ModelYili:null,Marka:null,Model:null,KullanimTarzi:null,KullanimDetayi:null,MotorNo:null,SasiNo:null,YolcuSayisi:null,PlakaYK:null,DogumTarihi:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,Permissions:!0},e.contact={name:null,surname:null,phone:null,message:null},e.data={sehirList:[],ilceList:[],modelYillariList:[],aracMarkaList:[],tarifeList:[],aracModelList:[{tip:r.translate("SEÇİNİZ"),tipkodu:null}],altTarifeList:[{ad:r.translate("SEÇİNİZ"),kod:null}]},e.onCreate=function(){e.welcomeInit.isSuccessData?e.initData():t.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){""!==n.params.menuurl&&null!==n.params.menuurl||n.go("PageNotFound",{},{reload:!0});var a=y.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};g.set("Ref",t)}});var o=p;if(e.menus=o.getMenus(),angular.forEach(o.getMenus(),function(a){n.params.menuurl==a.menuURL&&(e.params.ab=parseInt(a.main_product),e.params.arabrans=a.product,e.params.menuurl=a.menuURL,e.params.menu=a.id,e.form.AnaBrans=e.params.ab,e.form.AraBrans=e.params.arabrans,e.menuData=a,e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:e.menuData.id,viewLocation:"QUOTATION"},function(){var n=e.welcomeInit;if(e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.PK=n.getReCaptchaKeys(),null!==e.PK&&void 0!==e.PK&&""!==e.PK&&e.formParameters.isVerifyRCPT&&!0!==e.isLoggedIn?(e.isViewReCaptcha=!0,e.isNextButtonDisabled=!0):(e.isNextButtonDisabled=!1,e.isViewReCaptcha=!1),e.setAnnouncements(),e.setQuickLinks(),e.boxesInit=k.onCreate(e.menuData.id),t.$on("$boxesInit.onSuccess",function(){e.boxesData=k.getBoxes(e.menuData.id),e.getCategories(e.boxesData),e.openAnnounceModal()}),(null!=e.menuData.quotationFormStyle&&""!=e.menuData.quotationFormStyle&&void 0!=e.menuData.quotationFormStyle||"STYLE-3"!=e.quotationFormStyles.formStyle)&&"STYLE-3"!=e.menuData.quotationFormStyle||(e.onVehicleCreate(),e.isLoggedIn&&e.doCollectVehicleInfo()),i.get("welcome/menus/menuskeywords/"+e.menuData.id,{},function(t){e.portalMenusKeywords=t})})}))}),d.set(o.getRootSettings()),!0!==e.isLoggedIn&&null!==o.getDynamicContent()&&(e.dynamicContent=o.getDynamicContent(),e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.PCR&&(e.form.PrivacyPolicy=!1),(e.dynamicContent.GCR||e.dynamicContent.PCR)&&(e.form.Permissions=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)),null!==o.getDynamicContent()){var l=o.getDynamicContent();l.quotationConfirmContent?e.quotationConfirmContent=l.quotationConfirmContent:e.quotationConfirmContent='<font size="3"><b>'+r.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>"}else e.quotationConfirmContent='<font size="3"><b>'+r.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>";if(null!==e.menuData.tawkCode&&void 0!==e.menuData.tawkCode&&""!==e.menuData.tawkCode){var s=e.menuData.tawkCode;e.setCustomTawk(s)}e.getCityList(function(){var t=angular.copy(e.menus);e.menus=[],angular.forEach(t,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onChangeProvince(function(){e.form.IlceKodu=o.IlceKodu})});var u=y.search();u&&(void 0!==u.id&&""!==u.id&&void 0==u.cid&&(e.form.Tip="personal",e.form.MusteriTipi=1,e.form.HesapKodu=u.id),void 0!==u.cid&&""!==u.cid&&void 0==u.id&&(e.form.Tip="company",e.form.MusteriTipi=2,e.form.HesapKodu=u.cid),void 0!==u.eml&&""!==u.eml&&(e.form.EMail=u.eml),void 0!==u.gs&&""!==u.gs&&(e.form.GSMNo=u.gs),void 0!==u.uv&&""!==u.uv&&(e.form.Unvan=u.uv),void 0!==u.tt&&""!==u.tt&&(e.form.AracDurumu=u.tt))},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.params.menu,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],s=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalMenuId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(s,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalMenuId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=p.getPanelSettings()?p.getPanelSettings().siteName:"Polisoft Ltd");for(var u=0;u<r.length;u++)"robots"!==r[u].getAttribute("name")||i||(r[u].content="index, follow"),"description"!==r[u].getAttribute("name")||o||(r[u].content=p.getPanelSettings()?p.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=p;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalMenuId===e.menuData.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.isNavigationActive=function(e){return e?"current":"pending"},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===p.OpenedAnnounceModals.indexOf(e.menuData.menuURL)&&!0===e.menuData.isViewAnnounce){var t=!1;angular.forEach(e.boxesData.defaultItems,function(n){n.portalMenuId==e.menuData.id&&!0===n.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(t){t.data={menuId:e.menuData.id},p.OpenedAnnounceModals.push(e.menuData.menuURL)},"lg")}},e.setNavigation=function(t){e.form.AracDurumu=t},e.setVehicleStatus=function(t){e.form.AracDurumu=t,e.isLoggedIn&&e.doCollectVehicleInfo()},e.onNextStep=function(){e.current++,e.currentWizard=null,1==e.current&&i.post("f/nx/wlg",{
wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackStep=function(){2==e.current&&(e.isCustomerExists=null),1==e.current&&e.clearForm(),e.current--,e.currentWizard=null,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.clearForm=function(){e.form.Plaka=null,e.form.RuhsatNo=null,e.form.ModelYili=null,e.form.Marka=null,e.form.Model=null,e.form.KullanimTarzi=null,e.form.KullanimDetayi=null,e.form.MotorNo=null,e.form.SasiNo=null,e.form.YolcuSayisi=null,e.form.PlakaYK=null},e.reload=function(){n.reload()},e.getCityList=function(t){null!==m.getActiveInsured()&&(e.isLoggedIn=!0,e.form.HesapKodu=m.getActiveInsured().HesKod,e.form.Unvan=m.getActiveInsured().Unvan,e.form.IlKodu=m.getActiveInsured().IlKodu,e.form.IlceKodu=m.getActiveInsured().IlceKodu,e.form.EMail=m.getActiveInsured().EMail,e.form.DogumTarihi=S.identityServiceToInput(m.getActiveInsured().DogumTarihi),!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=m.getActiveInsured().GSMNo,null!==e.form.IlKodu&&void 0!==e.form.IlKodu&&""!==e.form.IlKodu||(e.form.IlKodu="001"),null!==e.form.IlceKodu&&void 0!==e.form.IlceKodu&&""!==e.form.IlceKodu||(e.form.IlceKodu="001"),0===m.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==m.getActiveInsured().VergiNo&&""!==m.getActiveInsured().VergiNo&&void 0!==m.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2),"Bilgilendirme Yapıldı"===m.getActiveInsured().KVKKDurum&&(e.form.KVKK=!0),!0===e.isLoggedIn&&(e.form.KVKK=!0,e.form.Agreement=!0,e.form.PrivacyPolicy=!0),"Bilgilendirme Yapıldı"!==m.getActiveInsured().KVKKDurum&&!0!==e.isLoggedIn&&null!==e.dynamicContent&&(e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)));var n={AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans};i.post("quotation/pre",n,function(n){e.serviceConnectionStatus=n.WSCS,e.sID=n.SID,!1===n.isLogged&&(m.set(null),m.setAccountId(null),m.setList(null),e.isLoggedIn=!1),i.get("portal/lists/cities",null,function(n){e.data.sehirList=n,e.data.sehirList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.sehirList.unshift({kod:null,ad:r.translate("SEÇİNİZ")}),"function"==typeof t&&t()})}),e.insuredInfo=m.getActiveInsured()},e.onChangeProvince=function(){i.get("portal/lists/districts",{cityCode:e.form.IlKodu},function(t){e.data.ilceList=t,e.data.ilceList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.ilceList.unshift({kod:null,ad:r.translate("SEÇİNİZ")})},null,null,null,!0)},e.getIdentityDetails=function(t){if(auto=!!t,e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.KVKK&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.KVKK,privacyStatus:e.form.Agreement,pDogumTarihi:S.dateInputToService(e.form.DogumTarihi)};e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,c.error(r.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.current=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==n.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSMNo,pDogumTarihi:S.dateInputToService(e.form.DogumTarihi),sID:e.sID};i.post("insured/update",n,function(e){"function"==typeof t&&t()},function(){e.isInsuredInfoRunning=!1})},e.doSendSMS=function(t){a.open("/content/views/sms-insured-modal.html","SMSVerifyInsuredModalController",function(n){n.data={data:e.form,sID:e.sID,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n,a){e.pSMSToken=n,e.isSmsSend=a,"function"==typeof t&&t()},onModalCancel:function(){e.isInsuredInfoRunning=!1}}})},e.checkCustomerAddressData=function(){if(!(e.form.IlKodu&&e.form.IlceKodu&&e.form.Unvan))return void(e.isNewInsuredInfosRequired=!0);e.isNewInsuredInfosRequired=!1,e.setWarrants(),e.current=2,e.currentWizard=3,document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate()},e.getCarDetails=function(){e.isFieldsValid()&&(e.current=3,document.getElementById("form-start").scrollIntoView())},e.getCarDetailsStyleThree=function(){e.isFieldsValid()&&("0"===e.form.AracDurumu?(e.setWarrants(),e.currentWizard=4):e.currentWizard=3,document.getElementById("form-start").scrollIntoView())},e.isFieldsValid=function(){var t=angular.copy(e.form);if(1===e.current||2==e.currentWizard)return 1==t.KVKK&&(!(null===t.Unvan&&e.formParameters.sigortaliAdSoyad||null===t.HesapKodu||null===t.GSMNo||null==t.DogumTarihi&&e.formParameters.isViewDateOfBirth&&"personal"==e.form.Tip)||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1));if(2===e.current||3==e.currentWizard){if("1"===e.form.AracDurumu)return null!==t.Plaka||null!==t.RuhsatNo||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1);if("2"===e.form.AracDurumu)return null!==t.Plaka||null!==t.RuhsatNo||null!==t.ModelYili||null!==t.Marka||null!==t.Model||null!==t.KullanimTarzi||null!==t.KullanimDetayi||null!==t.MotorNo||null!==t.SasiNo||null!==t.YolcuSayisi||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1);if("3"===e.form.AracDurumu)return null!==t.PlakaYK||null!==t.ModelYili||null!==t.Marka||null!==t.Model||null!==t.KullanimTarzi||null!==t.KullanimDetayi||null!==t.MotorNo||null!==t.SasiNo||null!==t.YolcuSayisi||(c.error(r.translate("Lütfen gerekli alanları doldurun.")),!1)}},e.onVehicleCreate=function(){i.get("vehicle/brands",{},function(t){e.data.aracMarkaList=t,e.data.modelYillariList=[{kod:null,ad:r.translate("SEÇİNİZ")}],e.data.aracMarkaList.unshift({markakodu:null,marka:r.translate("SEÇİNİZ")}),e.data.tarifeList=o.getTarifeler().addSelection();for(var n=parseInt(moment().format("YYYY"));n>1970;n--)e.data.modelYillariList.push({kod:n,ad:n});e.setWarrants()},null,null,null,!0)},e.onChangeMarka=function(t){var n={pMarkaKodu:e.form.Marka,pModelYili:e.form.ModelYili};i.get("vehicle/models",n,function(n){e.data.aracModelList=n,e.data.aracModelList.unshift({arackodu:null,tip:r.translate("SEÇİNİZ"),tipkodu:null}),"function"==typeof t&&t()},null,null,null,!0)},e.onChangeModelYili=function(){if(null!==e.form.Marka){var t={pMarkaKodu:e.form.Marka,pModelYili:e.form.ModelYili};e.form.Model=null,i.get("vehicle/models",t,function(t){e.data.aracModelList=t,e.data.aracModelList.unshift({arackodu:null,tip:r.translate("SEÇİNİZ"),tipkodu:null})},null,null,null,!0)}},e.onChangeModel=function(){angular.forEach(e.data.aracModelList,function(t){t.tipkodu===e.form.Model&&(e.form.AracKodu=t.arackodu)}),e.form.AracKodu},e.getModel=function(t){var n=null;return angular.forEach(e.data.aracModelList,function(e){parseInt(t)===parseInt(e.tipkodu)&&(n=e.tip)}),n},e.onChangeTramerTarifeKodu=function(){e.form.AracDetayTipi=null,o.getSilent("ALT_TARIFE",e.form.KullanimTarzi,null,function(t){e.data.altTarifeList=t.addSelection()},!0)},e.trustAsHtml=function(e){return u.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return u.trustAsHtml(e)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),l.fetchTIA(e,{pAnaBrans:e.params.ab,pAraBrans:e.params.arabrans,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),l.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=f.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),s.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.doSubmitViaSMS=function(){1==e.isLoggedIn&&(e.isSmsSend=!0);var t=l.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.GSMNo=e.form.GSMNo,t.pRuhsatNo=e.form.RuhsatNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.pDogumTarihi=S.dateInputToService(e.form.DogumTarihi),2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}t.sID=e.sID,angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!1,"insuredInformationForm"==e.formParameters.smsActivationLocation&&(t.isSmsVerified=!0),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var i=g.get("Ref");null!==i&&""!==i&&void 0!==i&&void 0!==i.kod&&null!==i.kod&&""!==i.kod&&(t.pReferansPersonelKodu=i.kod),c.confirmHtmlContent(e.quotationConfirmContent,function(){e.isSmsSend?e.doSubmit(t):a.open("/content/views/sms-modal.html","SMSVerifyModalController",function(n){n.data={data:t,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n){t.pSMSToken=n,e.doSubmit(t)}}})})},e.doSubmit=function(t){e.isQuotationPreparing=!0,i.post("quotation/kaydet",t,function(t){g.set("Quotation",null);var n={pPoliID:t.href,pTip:1};0==t.ResultCode?0!==t.href&&"0"!==t.href&&null!==t.href&&""!==t.href?i.post("l/a/wlg",{},function(){g.set("Quotation",n),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):c.error(r.translate("Teklif Kaydedilemedi!")):(c.info(t.ResultMessage),e.isQuotationPreparing=!1),e.isSaving=!1},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)},e.openConfirmationModal=function(t){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"KVKK"==t&&e.onChangeGdpr()}}},"lg")},e.setCustomTawk=function(e){t.$broadcast("@SetupTawkForCustomEndpoint",e)},e.onChangeGdpr=function(t){v(function(){if(e.form.KVKK){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){e.isSendGDPRLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangeMarketing=function(t){v(function(){if(e.form.Agreement){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){e.isSendMarketingLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeMusteriTipi=function(t){e.form.MusteriTipi="personal"==t?1:2},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=h("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.cbExpiration=function(){I.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(I.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isNextButtonDisabled=!1:(e.isNextButtonDisabled=!0,c.error(r.translate("reCAPTCHA doğrulanamadı..!")),I.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&c.info(e)},e.getIdentityDetailsStyleThree=function(t){if(auto=!!t,e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:S.dateInputToService(e.form.DogumTarihi)};e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,c.error(r.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.currentWizard=2,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}if(0==n.isGSMValid&&"personal"==e.form.Tip)a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){if("company"==e.form.Tip?(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=2,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=3,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView()),e.isLoggedIn)e.doCollectVehicleInfo();else{var a="";"0"===e.form.AracDurumu&&(a="RENEWAL_CAR"),"1"===e.form.AracDurumu&&(a="USED_CAR"),"2"===e.form.AracDurumu&&(a="NEW_CAR"),i.post("f/nx/wlg",{wizardTitle:a,sID:e.sID},function(){e.onVehicleCreate(),"function"==typeof t&&t()},null,null,null,!0)}})},onCancel:function(){e.isInsuredInfoRunning=!1}}});else if("company"==e.form.Tip?(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.onVehicleCreate()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView(),e.onVehicleCreate(),e.onChangeProvince()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=2,document.getElementById("form-start").scrollIntoView())),e.isInsuredInfoRunning=!1,e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad)e.currentWizard=3,e.getCarDetailsStyleThree(),document.getElementById("form-start").scrollIntoView();else{var o="";"0"===e.form.AracDurumu&&(o="RENEWAL_CAR"),"1"===e.form.AracDurumu&&(o="USED_CAR"),"2"===e.form.AracDurumu&&(o="NEW_CAR"),i.post("f/nx/wlg",{wizardTitle:o,sID:e.sID},function(){e.onVehicleCreate(),"function"==typeof t&&t()},null,null,null,!0)}},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=C.remove(t.return.JSONData),e.referenceCode=C.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCode=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?(e.pSMSToken=e.form.pSessionID,e.doPrepareSubmit()):6==t.ResultCode?c.error(r.translate("ALERT_VERIFY_ERROR")):c.error(r.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doPrepareSubmit=function(){var t=l.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.GSMNo=e.form.GSMNo,t.pRuhsatNo=e.form.RuhsatNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.pDogumTarihi=S.dateInputToService(e.form.DogumTarihi),2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}t.sID=e.sID,angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!0,t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var a=g.get("Ref");null!==a&&""!==a&&void 0!==a&&void 0!==a.kod&&null!==a.kod&&""!==a.kod&&(t.pReferansPersonelKodu=a.kod),1==e.isLoggedIn?c.confirmHtmlContent(e.quotationConfirmContent,function(){e.doSubmit(t)}):(document.getElementById("form-start").scrollIntoView(),e.doSubmit(t))},e.onChangeGdprAndMarketing=function(t){e.form.KVKK=t,e.form.PrivacyPolicy=t,e.onChangeGdpr(function(){})},e.checkCustomerType=function(t){null!==t&&""!==t&&void 0!==t&&(9!=t.length&&10!=t.length||(e.form.Tip="company",e.form.MusteriTipi=2),11==t.length&&(e.form.Tip="personal",e.form.MusteriTipi=1))},e.onNextWizard=function(){e.current=null,e.currentWizard++,2==e.currentWizard&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),4==e.currentWizard&&e.setWarrants(),document.getElementById("form-start").scrollIntoView()},e.onBackWizard=function(){3!=e.currentWizard&&4!=e.currentWizard||(e.isCustomerExists=null),4==e.currentWizard&&"0"===e.form.AracDurumu&&e.currentWizard--,5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard--,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onEditWizard=function(t){1!=t&&2!=t||(e.isCustomerExists=null),5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard=t,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onCreate()}]),app.controller("Other.QuotationController",["$scope","$rootScope","$state","$modal","$rest","$culture","$form","$tia","$sce","$alert","$rootSettings","$insured","$currency","$storage","$welcomeInit","$timeout","$boxesInit","$filter","$location","vcRecaptchaService","$dateFormatter","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S){e.params={ab:null,arabrans:null,menu:null,menuurl:null},e.current=1,e.currentWizard=1,e.isCustomerExists=null,e.menuData={},e.isLoggedIn=!1,e.welcomeInit=p,e.isQuotationPreparing=!1,e.isDefaultBannerActive=!0,e.portalMenusKeywords=null,e.isEmailRegex=!0,e.isBack=!1,e.isInsuredInfoRunning=!1,e.sID=null,e.isSmsSend=!1,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isNextButtonDisabled=!1,e.isSendGDPRLog=!1,e.isSendMarketingLog=!1,e._tia={data:null,onPrev:null,onNext:null,current:null},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null,smsActivationLocation:"getQuotation",smsActivateDescription:null,isVerifyRCPT:!1,isViewDateOfBirth:!1},e.form={Tip:"personal",MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,IlKodu:null,IlceKodu:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,DogumTarihi:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,Permissions:!0},e.contact={name:null,surname:null,phone:null,message:null},e.data={sehirList:[],ilceList:[]},e.onCreate=function(){e.welcomeInit.isSuccessData?e.initData():t.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){""!==n.params.menuurl&&null!==n.params.menuurl||n.go("PageNotFound",{},{reload:!0});var a=h.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};f.set("Ref",t)}});var r=p;if(e.menus=r.getMenus(),angular.forEach(r.getMenus(),function(a){n.params.menuurl==a.menuURL&&(e.params.ab=parseInt(a.main_product),e.params.arabrans=a.product,e.params.menuurl=a.menuURL,e.params.menu=a.id,e.form.AnaBrans=e.params.ab,e.form.AraBrans=e.params.arabrans,e.menuData=a,e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:e.menuData.id,viewLocation:"QUOTATION"},function(){var n=e.welcomeInit;if(e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.PK=n.getReCaptchaKeys(),null!==e.PK&&void 0!==e.PK&&""!==e.PK&&e.formParameters.isVerifyRCPT&&!0!==e.isLoggedIn?(e.isViewReCaptcha=!0,e.isNextButtonDisabled=!0):(e.isNextButtonDisabled=!1,e.isViewReCaptcha=!1),e.setAnnouncements(),e.setQuickLinks(),e.boxesInit=v.onCreate(e.menuData.id),t.$on("$boxesInit.onSuccess",function(){e.boxesData=v.getBoxes(e.menuData.id),e.getCategories(e.boxesData),e.openAnnounceModal()}),i.get("welcome/menus/menuskeywords/"+e.menuData.id,{},function(t){e.portalMenusKeywords=t})})}))}),c.set(r.getRootSettings()),!0!==e.isLoggedIn&&null!==r.getDynamicContent()&&(e.dynamicContent=r.getDynamicContent(),e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.PCR&&(e.form.PrivacyPolicy=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1),(e.dynamicContent.GCR||e.dynamicContent.PCR)&&(e.form.Permissions=!1)),null!==r.getDynamicContent()){var l=r.getDynamicContent();l.quotationConfirmContent?e.quotationConfirmContent=l.quotationConfirmContent:e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>"}else e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>";if(null!==e.menuData.tawkCode&&void 0!==e.menuData.tawkCode&&""!==e.menuData.tawkCode){var s=e.menuData.tawkCode;e.setCustomTawk(s)}e.getCityList(function(){var t=angular.copy(e.menus);e.menus=[],angular.forEach(t,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onChangeProvince(function(){e.form.IlceKodu=r.IlceKodu})});var u=h.search();u&&(void 0!==u.id&&""!==u.id&&void 0==u.cid&&(e.form.Tip="personal",e.form.MusteriTipi=1,e.form.HesapKodu=u.id),void 0!==u.cid&&""!==u.cid&&void 0==u.id&&(e.form.Tip="company",e.form.MusteriTipi=2,e.form.HesapKodu=u.cid),void 0!==u.eml&&""!==u.eml&&(e.form.EMail=u.eml),void 0!==u.gs&&""!==u.gs&&(e.form.GSMNo=u.gs),void 0!==u.uv&&""!==u.uv&&(e.form.Unvan=u.uv))},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.params.menu,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],s=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalMenuId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(s,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalMenuId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=p.getPanelSettings()?p.getPanelSettings().siteName:"Polisoft Ltd");for(var u=0;u<r.length;u++)"robots"!==r[u].getAttribute("name")||i||(r[u].content="index, follow"),"description"!==r[u].getAttribute("name")||o||(r[u].content=p.getPanelSettings()?p.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=p;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalMenuId===e.menuData.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.isNavigationActive=function(e){return e?"current":"pending"},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===p.OpenedAnnounceModals.indexOf(e.menuData.menuURL)&&!0===e.menuData.isViewAnnounce){var t=!1;angular.forEach(e.boxesData.defaultItems,function(n){n.portalMenuId==e.menuData.id&&!0===n.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(t){t.data={menuId:e.menuData.id},p.OpenedAnnounceModals.push(e.menuData.menuURL)},"lg")}},e.onNextStep=function(){e.current++,e.currentWizard=null,1==e.current&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackStep=function(){2==e.current&&(e.isCustomerExists=null),e.current--,e.currentWizard=null,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.reload=function(){n.reload()},e.getCityList=function(t){null!==d.getActiveInsured()&&(e.isLoggedIn=!0,e.form.HesapKodu=d.getActiveInsured().HesKod,e.form.Unvan=d.getActiveInsured().Unvan,e.form.IlKodu=d.getActiveInsured().IlKodu,e.form.IlAdi=d.getActiveInsured().Sehir,e.form.IlceKodu=d.getActiveInsured().IlceKodu,e.form.IlceAdi=d.getActiveInsured().Ilce,e.form.EMail=d.getActiveInsured().EMail,e.form.DogumTarihi=I.identityServiceToInput(d.getActiveInsured().DogumTarihi),!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=d.getActiveInsured().GSMNo,
null!==e.form.IlKodu&&void 0!==e.form.IlKodu&&""!==e.form.IlKodu||(e.form.IlKodu="001"),null!==e.form.IlceKodu&&void 0!==e.form.IlceKodu&&""!==e.form.IlceKodu||(e.form.IlceKodu="001"),0===d.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==d.getActiveInsured().VergiNo&&""!==d.getActiveInsured().VergiNo&&void 0!==d.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2),"Bilgilendirme Yapıldı"===d.getActiveInsured().KVKKDurum&&(e.form.KVKK=!0),!0===e.isLoggedIn&&(e.form.KVKK=!0,e.form.Agreement=!0,e.form.PrivacyPolicy=!0),"Bilgilendirme Yapıldı"!==d.getActiveInsured().KVKKDurum&&!0!==e.isLoggedIn&&null!==e.dynamicContent&&(e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1)));var n={AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans};i.post("quotation/pre",n,function(n){e.serviceConnectionStatus=n.WSCS,e.sID=n.SID,!1===n.isLogged&&(d.set(null),d.setAccountId(null),d.setList(null),e.isLoggedIn=!1),i.get("portal/lists/cities",null,function(n){e.data.sehirList=n,e.data.sehirList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.sehirList.unshift({kod:null,ad:o.translate("SEÇİNİZ")}),"function"==typeof t&&t()})}),e.insuredInfo=d.getActiveInsured()},e.onChangeProvince=function(){i.get("portal/lists/districts",{cityCode:e.form.IlKodu},function(t){e.data.ilceList=t,e.data.ilceList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.ilceList.unshift({kod:null,ad:o.translate("SEÇİNİZ")})},null,null,null,!0)},e.getIdentityDetails=function(t){t?(auto=!0,loadingTimeout=0):(auto=!1,loadingTimeout=150),g(function(){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.KVKK&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.KVKK,privacyStatus:e.form.Agreement,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};"company"!=e.form.Tip&&2!=e.form.MusteriTipi||(void 0!=n.IlAdi&&null!=n.IlAdi&&""!=n.IlAdi||(n.IlAdi=e.insuredInfo.Sehir),void 0!=n.IlceAdi&&null!=n.IlceAdi&&""!=n.IlceAdi||(n.IlceAdi=e.insuredInfo.Ilce)),e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.current=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==n.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation?e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},loadingTimeout)},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSMNo,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi),sID:e.sID};i.post("insured/update",n,function(e){"function"==typeof t&&t()},function(){e.isInsuredInfoRunning=!1})},e.doSendSMS=function(t){a.open("/content/views/sms-insured-modal.html","SMSVerifyInsuredModalController",function(n){n.data={data:e.form,sID:e.sID,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n,a){e.pSMSToken=n,e.isSmsSend=a,"function"==typeof t&&t()},onModalCancel:function(){e.isInsuredInfoRunning=!1}}})},e.checkCustomerAddressData=function(){if(!(e.form.IlKodu&&e.form.IlceKodu&&e.form.Unvan))return void(e.isNewInsuredInfosRequired=!0);e.isNewInsuredInfosRequired=!1,e.current=2,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.setWarrants()},e.isFieldsValid=function(){var t=angular.copy(e.form);if(1===e.current||1==e.currentWizard)return 1==t.KVKK&&(!(null===t.Unvan&&e.formParameters.sigortaliAdSoyad||null===t.HesapKodu||null===t.GSMNo||null==t.DogumTarihi&&e.formParameters.isViewDateOfBirth&&"personal"==e.form.Tip)||(u.error(o.translate("Lütfen gerekli alanları doldurun.")),!1))},e.trustAsHtml=function(e){return s.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return s.trustAsHtml(e)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),r.fetchTIA(e,{pAnaBrans:e.params.ab,pAraBrans:e.params.arabrans,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),r.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=m.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),l.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.doSubmitViaSMS=function(){1==e.isLoggedIn&&(e.isSmsSend=!0);var t=r.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.EMail=e.form.EMail,t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}t.sID=e.sID,angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!1,"insuredInformationForm"==e.formParameters.smsActivationLocation&&(t.isSmsVerified=!0);var i=[],o={tc:null,ad:null};angular.forEach(e._tia.data,function(e){angular.forEach(e.elements,function(e){angular.forEach(t.pTeminatlar,function(t){t.TeminatID==e.Id&&("Sigortalı Adı"==e.Adi&&(o.ad=t.Aciklama),"Sigortalı TCKN"==e.Adi&&(o.tc=t.Aciklama),"Sigortalı GSM"==e.Adi&&(o.gsm=t.Aciklama))})})}),null!==o.tc&&null!==o.ad&&(i.push({TCKN:o.tc,Ad:o.ad,GSM:o.gsm}),t.pSigortalilar=i),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var l=f.get("Ref");null!==l&&""!==l&&void 0!==l&&void 0!==l.kod&&null!==l.kod&&""!==l.kod&&(t.pReferansPersonelKodu=l.kod),u.confirmHtmlContent(e.quotationConfirmContent,function(){e.isSmsSend?e.doSubmit(t):a.open("/content/views/sms-modal.html","SMSVerifyModalController",function(n){n.data={data:t,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n){t.pSMSToken=n,e.doSubmit(t)}}})})},e.doSubmit=function(t){e.isQuotationPreparing=!0,i.post("quotation/kaydet",t,function(t){f.set("Quotation",null);var n={pPoliID:t.href,pTip:1};0==t.ResultCode?0!==t.href&&"0"!==t.href&&null!==t.href&&""!==t.href?i.post("l/a/wlg",{},function(){f.set("Quotation",n),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):u.error(o.translate("Teklif Kaydedilemedi!")):(u.info(t.ResultMessage),e.isQuotationPreparing=!1),e.isSaving=!1},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)},e.openConfirmationModal=function(t){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"KVKK"==t&&e.onChangeGdpr()}}},"lg")},e.setCustomTawk=function(e){t.$broadcast("@SetupTawkForCustomEndpoint",e)},e.onChangeGdpr=function(t){g(function(){if(e.form.KVKK){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){e.isSendGDPRLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangeMarketing=function(t){g(function(){if(e.form.Agreement){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){e.isSendMarketingLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeMusteriTipi=function(t){e.form.MusteriTipi="personal"==t?1:2},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=k("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.cbExpiration=function(){y.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(y.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isNextButtonDisabled=!1:(e.isNextButtonDisabled=!0,u.error(o.translate("reCAPTCHA doğrulanamadı..!")),y.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&u.info(e)},e.getIdentityDetailsStyleThree=function(t){t?(auto=!0,loadingTimeout=0):(auto=!1,loadingTimeout=150),g(function(){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var n={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};"company"!=e.form.Tip&&2!=e.form.MusteriTipi||(void 0!=n.IlAdi&&null!=n.IlAdi&&""!=n.IlAdi||(n.IlAdi=e.insuredInfo.Sehir),void 0!=n.IlceAdi&&null!=n.IlceAdi&&""!=n.IlceAdi||(n.IlceAdi=e.insuredInfo.Ilce)),e.isInsuredInfoRunning=!0,n.sID=e.sID,i.post("identity/membercheck",n,function(n){if("personal"==e.form.Tip){if(!0!==n.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.currentWizard=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}0==n.isGSMValid&&"personal"==e.form.Tip?a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(a){a.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(a){e.form.GSMNo=a.newGSMNo,e.updateInsured(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t()})},onCancel:function(){e.isInsuredInfoRunning=!1}}}):("company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()):(!1===n.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince(),e.setWarrants()),!0===n.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.setWarrants(),e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1,"function"==typeof t&&t())},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},loadingTimeout)},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=S.remove(t.return.JSONData),e.referenceCode=S.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCode=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?(e.pSMSToken=e.form.pSessionID,e.doPrepareSubmit()):6==t.ResultCode?u.error(o.translate("ALERT_VERIFY_ERROR")):u.error(o.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doPrepareSubmit=function(){var t=r.build(e);if(t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AracDurumu=parseInt(e.form.AracDurumu),t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.pModelYili=e.form.ModelYili,t.pTramerTarifeKodu=e.form.KullanimTarzi,t.pAracKullanimDetayKodu=e.form.KullanimDetayi,t.pMotorNo=e.form.MotorNo,t.pSasiNo=e.form.SasiNo,t.pAracKodu=e.form.Marka+e.form.Model,t.EMail=e.form.EMail,t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),2==t.AracDurumu){var n=e.form.PlakaYK.substr(1);t.pPlaka=n+"YK"}t.sID=e.sID,angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),t.IlAdi=e.form.IlAdi,t.IlceAdi=e.form.IlceAdi,t.isSmsVerified=!0;var a=[],i={tc:null,ad:null};angular.forEach(e._tia.data,function(e){angular.forEach(e.elements,function(e){angular.forEach(t.pTeminatlar,function(t){t.TeminatID==e.Id&&("Sigortalı Adı"==e.Adi&&(i.ad=t.Aciklama),"Sigortalı TCKN"==e.Adi&&(i.tc=t.Aciklama),"Sigortalı GSM"==e.Adi&&(i.gsm=t.Aciklama))})})}),null!==i.tc&&null!==i.ad&&(a.push({TCKN:i.tc,Ad:i.ad,GSM:i.gsm}),t.pSigortalilar=a),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var o=f.get("Ref");null!==o&&""!==o&&void 0!==o&&void 0!==o.kod&&null!==o.kod&&""!==o.kod&&(t.pReferansPersonelKodu=o.kod),1==e.isLoggedIn?u.confirmHtmlContent(e.quotationConfirmContent,function(){e.doSubmit(t)}):(document.getElementById("form-start").scrollIntoView(),e.doSubmit(t))},e.onChangeGdprAndMarketing=function(t){e.form.KVKK=t,e.form.PrivacyPolicy=t,e.onChangeGdpr(function(){})},e.checkCustomerType=function(t){null!==t&&""!==t&&void 0!==t&&(9!=t.length&&10!=t.length||(e.form.Tip="company",e.form.MusteriTipi=2),11==t.length&&(e.form.Tip="personal",e.form.MusteriTipi=1))},e.onNextWizard=function(){e.current=null,e.currentWizard++,1==e.currentWizard&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackWizard=function(){2==e.currentWizard&&(e.isCustomerExists=null),3==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard--,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onEditWizard=function(t){1==t&&(e.isCustomerExists=null),3==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard=t,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onCreate()}]),app.controller("Property.QuotationController",["$scope","$rootScope","$state","$modal","$rest","$culture","$form","$tia","$sce","$alert","$rootSettings","$insured","$currency","$storage","$welcomeInit","$timeout","$boxesInit","$filter","$location","vcRecaptchaService","$dateFormatter","$lists","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S,C){e.params={ab:null,arabrans:null,menu:null,menuurl:null},e.current=1,e.currentWizard=1,e.isCustomerExists=null,e.isLoggedIn=!1,e.menuData={},e.welcomeInit=p,e.isQuotationPreparing=!1,e.isDefaultBannerActive=!0,e.portalMenusKeywords=null,e.isEmailRegex=!0,e.isBack=!1,e.isAddressSearching=!1,e.isInsuredInfoRunning=!1,e.sID=null,e.isSmsSend=!1,e.widgetId=null,e.reCaptchaResponse="",e.isViewReCaptcha=!1,e.isNextButtonDisabled=!1,e.isSendGDPRLog=!1,e.isSendMarketingLog=!1,e.binaToplamKatList=[{title:o.translate("01-03 ARASI KAT"),value:5},{title:o.translate("04-07 ARASI KAT"),value:6},{title:o.translate("08-18 ARASI KAT"),value:7},{title:o.translate("19 VE ÜZERİ KATLAR"),value:8}],e._tia={data:null,onPrev:null,onNext:null,current:null},e.phoneMaskOptions={maskDefinitions:{0:/[0]/}},e.formParameters={bilgiKS:null,bilgiTRS:null,bilgiES:null,bilgiAS:null,mulkiyetAdresUAVT:null,mulkiyetAdresWS:null,sigortaliIkamet:null,sigortaliMail:null,sigortaliAdSoyad:null,aracKullanimDetay:null,smsActivationLocation:"getQuotation",smsActivateDescription:null,isVerifyRCPT:!1,isViewDateOfBirth:!1},e.form={Tip:"personal",pPSBSType:0,MKSKontrol:0,MusteriTipi:1,pTC:null,HesapKodu:null,Unvan:null,AnaBrans:e.params.ab,AraBrans:e.params.arabrans,menuURL:n.params.menuURL,IlKodu:null,IlceKodu:null,Mahalle:null,Sokak:null,Semt:null,BinaNo:null,id:null,DaireNo:null,KVKK:!0,Agreement:!0,PrivacyPolicy:!0,EMail:null,GSMNo:null,propertySelection:null,YngBinaKat:5,YngRizikoKat:null,YngKullanimSekli:null,YngYapiTarzi:null,YngBrut:null,YngYil:null,DogumTarihi:null,_tia:{teminat:{},indirim:{},aciklama:{}},DisPoliceTipi:0,DaskDurumu:"1",DaskPoliceFound:!1,YngIkametSekli:null,YngAda:null,YngPafta:null,YngParsel:null,YngSayfa:null,Permissions:!0},e.contact={name:null,surname:null,phone:null,message:null},e.data={sehirList:[],ilceList:[],mulkiyetList:[]},e.kullanimSekliList=[{value:null,title:o.translate("SEÇİNİZ")},{value:"Mesken",title:o.translate("Mesken")},{value:"İşyeri",title:o.translate("İşyeri")},{value:"Depo",title:o.translate("Depo")}],e.yapiTarziList=[{value:null,title:o.translate("SEÇİNİZ")},{value:"Kagir",title:o.translate("Kagir")},{value:"Yığma Kagir",title:o.translate("Yığma Kagir")},{value:"Betonerme",title:o.translate("Betonerme")},{value:"Ahşap",title:o.translate("Ahşap")},{value:"Çelik",title:o.translate("Çelik")}],e.insaaYiliList=[{value:null,title:o.translate("SEÇİNİZ")},{value:6,title:o.translate("1975 VE ÖNCESİ")},{value:7,title:o.translate("1976-1999")},{value:8,title:o.translate("2000-2006")},{value:9,title:o.translate("2007-2018")},{value:10,title:o.translate("2019 ve sonrası")}],e.PSBSStatus={AP:0,KP:0,DP:0,UP:0,TP:0,KsP:0,EP:0},e.onCreate=function(){e.ikametSekliList=S.getIkametSekliList(),e.welcomeInit.isSuccessData?e.initData():t.$on("$welcomeInit.onSuccess",function(){e.initData()})},e.initData=function(){""!==n.params.menuurl&&null!==n.params.menuurl||n.go("PageNotFound",{},{reload:!0});var a=h.search();null!==a&&""!==a&&void 0!==a&&null!==a.ref_fw&&""!==a.ref_fw&&void 0!==a.ref_fw&&i.get("reference/definition/"+a.ref_fw,{},function(e){if(null!==e.userCode&&""!==e.userCode&&void 0!==e.userCode){var t={kod:e.userCode,ad:e.userName};f.set("Ref",t)}});var r=p;if(e.menus=r.getMenus(),angular.forEach(r.getMenus(),function(a){n.params.menuurl==a.menuURL&&(e.params.ab=parseInt(a.main_product),e.params.arabrans=a.product,e.params.menuurl=a.menuURL,e.params.menu=a.id,e.form.AnaBrans=e.params.ab,e.form.AraBrans=e.params.arabrans,e.menuData=a,e.welcomeInit.getQuotationSettings(function(){e.welcomeInit.onCreateFilter({portalMenuId:e.menuData.id,viewLocation:"QUOTATION"},function(){var n=e.welcomeInit;if(e.banners=n.getBanners(),e.bannerSettings=n.getBannersSettings(),e.quickLinks=n.getQuickLinks(),e.setSeoSettings(n.getSeoSettings()),n.getFormParameters()&&(e.formParameters=n.getFormParameters()),e.quotationCriterias=n.getQuotationCriterias(),e.quotationFormStyles=n.getFormStyles(),null!==e.quotationFormStyles&&""!==e.quotationFormStyles&&void 0!==e.quotationFormStyles&&"STYLE-1"==e.quotationFormStyles.formStyle){var a=0;e.quotationFormStyles.borderRadius&&e.quotationFormStyles.borderRadius>3&&(a=e.quotationFormStyles.borderRadius-3),e.quotationFormStyles.wizardBorderRadius=a}e.PK=n.getReCaptchaKeys(),null!==e.PK&&void 0!==e.PK&&""!==e.PK&&e.formParameters.isVerifyRCPT&&!0!==e.isLoggedIn?(e.isViewReCaptcha=!0,e.isNextButtonDisabled=!0):(e.isNextButtonDisabled=!1,e.isViewReCaptcha=!1),e.setAnnouncements(),e.setQuickLinks(),e.boxesInit=v.onCreate(e.menuData.id),t.$on("$boxesInit.onSuccess",function(){e.boxesData=v.getBoxes(e.menuData.id),e.getCategories(e.boxesData),e.openAnnounceModal()}),i.get("status",{},function(t){e.PSBSStatus=t,i.get("welcome/menus/menuskeywords/"+e.menuData.id,{},function(t){e.portalMenusKeywords=t})})})}))}),c.set(r.getRootSettings()),!0!==e.isLoggedIn&&null!==r.getDynamicContent()&&(e.dynamicContent=r.getDynamicContent(),e.dynamicContent.GCR&&(e.form.KVKK=!1),e.dynamicContent.PCR&&(e.form.PrivacyPolicy=!1),e.dynamicContent.CCR&&(e.form.Agreement=!1),(e.dynamicContent.GCR||e.dynamicContent.PCR)&&(e.form.Permissions=!1)),null!==r.getDynamicContent()){var l=r.getDynamicContent();l.quotationConfirmContent?e.quotationConfirmContent=l.quotationConfirmContent:e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>"}else e.quotationConfirmContent='<font size="3"><b>'+o.translate("Onayınızla sizin için en uygun fiyatları araştıracağız.")+"</b></font>";if(null!==e.menuData.tawkCode&&void 0!==e.menuData.tawkCode&&""!==e.menuData.tawkCode){var s=e.menuData.tawkCode;e.setCustomTawk(s)}e.getCityList(function(){var t=angular.copy(e.menus);e.menus=[],angular.forEach(t,function(t){1==e.isLoggedIn&&-1!==t.viewLocation&&e.menus.push(t),0==e.isLoggedIn&&-2!==t.viewLocation&&e.menus.push(t)}),e.onChangeProvince(function(){e.form.IlceKodu=r.IlceKodu})});var u=h.search();u&&(void 0!==u.id&&""!==u.id&&void 0==u.cid&&(e.form.Tip="personal",e.form.MusteriTipi=1,e.form.HesapKodu=u.id),void 0!==u.cid&&""!==u.cid&&void 0==u.id&&(e.form.Tip="company",e.form.MusteriTipi=2,e.form.HesapKodu=u.cid),void 0!==u.eml&&""!==u.eml&&(e.form.EMail=u.eml),void 0!==u.gs&&""!==u.gs&&(e.form.GSMNo=u.gs),void 0!==u.uv&&""!==u.uv&&(e.form.Unvan=u.uv))},e.redirectToUrl=function(e){if(null!==e.url&&void 0!==e.url&&""!==e.url)return void("_self"===e.urlStyle?window.open(e.url,"_self"):window.open(e.url,"_blank"))},e.setSeoSettings=function(t){var n=e.params.menu,a=!1,i=!1,o=!1,r=document.getElementsByTagName("meta"),l=[{variable:"ogType",property:"og:type"},{variable:"ogTitle",property:"og:title"},{variable:"ogDescription",property:"og:description"},{variable:"ogImage",property:"og:image"},{variable:"ogUrl",property:"og:url"},{variable:"ogSiteName",property:"og:site_name"}],s=[{variable:"twitterCard",property:"twitter:card"},{variable:"twitterTitle",property:"twitter:title"},{variable:"twitterDescription",property:"twitter:description"},{variable:"twitterImage",property:"twitter:image"},{variable:"twitterUrl",property:"twitter:url"},{variable:"twitterSiteName",property:"twitter:site"}];angular.forEach(t,function(e){if(e.portalMenuId==n){for(var t=0;t<r.length;t++)"robots"===r[t].getAttribute("name")&&0==e.isRobot&&(r[t].content="noindex, nofollow",i=!0),"description"===r[t].getAttribute("name")&&e.description&&""!==e.description&&(r[t].content=e.description,o=!0),"keywords"===r[t].getAttribute("name")&&e.keywords&&""!==e.keywords&&(r[t].content=e.keywords);angular.forEach(l,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}}),angular.forEach(s,function(t){if(document.querySelector("[property='"+t.property+"']")&&document.querySelector("[property='"+t.property+"']").remove(),e[t.variable]&&""!=e[t.variable]){var n=document.createElement("meta");n.setAttribute("property",t.property),n.setAttribute("content",e[t.variable]),document.head.appendChild(n)}})}e.portalMenuId==n&&null!==e.title&&""!==e.title&&void 0!==e.title&&(document.title=e.title,a=!0)}),a||(document.title=p.getPanelSettings()?p.getPanelSettings().siteName:"Polisoft Ltd");for(var u=0;u<r.length;u++)"robots"!==r[u].getAttribute("name")||i||(r[u].content="index, follow"),"description"!==r[u].getAttribute("name")||o||(r[u].content=p.getPanelSettings()?p.getPanelSettings().siteDescription:"Polisoft Ltd")},e.setAnnouncements=function(){var n=p;e.announcements=[],angular.forEach(n.getAnnouncements(),function(t){t.portalMenuId===e.menuData.id&&e.announcements.push(t)}),t.$broadcast("@SetAnnouncementList",e.announcements),e.onReadyMarquee()},e.setQuickLinks=function(){var n=e.welcomeInit;e.quickLinks=[],angular.forEach(n.getQuickLinks(),function(t){e.quickLinks.push(t)}),t.$broadcast("@SetQuickLinkList",e.quickLinks)},e.isNavigationActive=function(e){return e?"current":"pending"},e.openContactModal=function(){a.open("/content/views/contact-modal.html","ContactModalController",function(e){e.contact={}})},e.openAnnounceModal=function(){if(-1===p.OpenedAnnounceModals.indexOf(e.menuData.menuURL)&&!0===e.menuData.isViewAnnounce){var t=!1;angular.forEach(e.boxesData.defaultItems,function(n){n.portalMenuId==e.menuData.id&&!0===n.isViewAnnounceModal&&(t=!0)}),t&&a.open("/content/views/announce-modal.html","AnnounceModalController",function(t){t.data={menuId:e.menuData.id},p.OpenedAnnounceModals.push(e.menuData.menuURL)},"lg")}},e.setNavigation=function(t){e.form.DaskDurumu=t},e.onNextStep=function(){e.current++,e.currentWizard=null,1==e.current&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackStep=function(){2==e.current&&(e.isCustomerExists=null),e.current--,e.currentWizard=null,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.reload=function(){n.reload()},e.getCityList=function(t){null!==d.getActiveInsured()&&(e.isLoggedIn=!0,e.form.HesapKodu=d.getActiveInsured().HesKod,e.form.Unvan=d.getActiveInsured().Unvan,e.form.IlKodu=d.getActiveInsured().IlKodu,e.form.IlAdi=d.getActiveInsured().Sehir,e.form.IlceKodu=d.getActiveInsured().IlceKodu,e.form.IlceAdi=d.getActiveInsured().Ilce,e.form.EMail=d.getActiveInsured().EMail,e.form.DogumTarihi=I.identityServiceToInput(d.getActiveInsured().DogumTarihi),!1===/^([\w\-\.]+)@((\[([0-9]{1,3}\.){3}[0-9]{1,3}\])|(([\w\-]+\.)+)([a-zA-Z]{2,4}))$/.test(e.form.EMail)&&(e.isEmailRegex=!1),e.form.GSMNo=d.getActiveInsured().GSMNo,null!==e.form.IlKodu&&void 0!==e.form.IlKodu&&""!==e.form.IlKodu||(e.form.IlKodu="001"),null!==e.form.IlceKodu&&void 0!==e.form.IlceKodu&&""!==e.form.IlceKodu||(e.form.IlceKodu="001"),0===d.getActiveInsured().HesapTipi?(e.form.Tip="personal",e.form.MusteriTipi=1):(e.form.Tip="company",e.form.MusteriTipi=2),null!==d.getActiveInsured().VergiNo&&""!==d.getActiveInsured().VergiNo&&void 0!==d.getActiveInsured().VergiNo&&(e.form.Tip="company",e.form.MusteriTipi=2),"Bilgilendirme Yapıldı"===d.getActiveInsured().KVKKDurum&&(e.form.KVKK=!0),!0===e.isLoggedIn&&(e.form.KVKK=!0,e.form.Agreement=!0,e.form.PrivacyPolicy=!0),"Bilgilendirme Yapıldı"!==d.getActiveInsured().KVKKDurum&&!0!==e.isLoggedIn&&null!==e.dynamicContent&&(e.dynamicContent.GCR&&(e.form.KVKK=!1),
e.dynamicContent.CCR&&(e.form.Agreement=!1)));var n={AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans};i.post("quotation/pre",n,function(n){e.serviceConnectionStatus=n.WSCS,e.sID=n.SID,!1===n.isLogged&&(d.set(null),d.setAccountId(null),d.setList(null),e.isLoggedIn=!1),i.get("portal/lists/cities",null,function(n){e.data.sehirList=n,e.data.sehirList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.sehirList.unshift({kod:null,ad:o.translate("SEÇİNİZ")}),e.setWarrants(),"function"==typeof t&&t()})}),e.insuredInfo=d.getActiveInsured()},e.onChangeProvince=function(){i.get("portal/lists/districts",{cityCode:e.form.IlKodu},function(t){e.data.ilceList=t,e.data.ilceList.sort(function(e,t){return e.ad.localeCompare(t.ad)}),e.data.ilceList.unshift({kod:null,ad:o.translate("SEÇİNİZ")})},null,null,null,!0)},e.getIdentityDetails=function(t){t?(auto=!0,loadingTimeout=0):(auto=!1,loadingTimeout=150),g(function(){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.KVKK&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var t={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.KVKK,privacyStatus:e.form.Agreement,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};"company"!=e.form.Tip&&2!=e.form.MusteriTipi||(void 0!=t.IlAdi&&null!=t.IlAdi&&""!=t.IlAdi||(t.IlAdi=e.insuredInfo.Sehir),void 0!=t.IlceAdi&&null!=t.IlceAdi&&""!=t.IlceAdi||(t.IlceAdi=e.insuredInfo.Ilce)),e.isInsuredInfoRunning=!0,t.sID=e.sID,i.post("identity/membercheck",t,function(t){if("personal"==e.form.Tip){if(!0!==t.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.current=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}if(e.form.pPSBSType=t.pPSBSType,e.form.MKSKontrol=t.MKSKontrol,0==t.isGSMValid&&"personal"==e.form.Tip)a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(n){n.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(n){e.form.GSMNo=n.newGSMNo,e.updateInsured(function(){if(!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation)e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1});else if(e.isLoggedIn){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1;var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:o.translate("SEÇİNİZ")})},null,null,null,!0)}else"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1})},onCancel:function(){e.isInsuredInfoRunning=!1}}});else if(!0!==e.isLoggedIn&&"insuredInformationForm"==e.formParameters.smsActivationLocation)e.doSendSMS(function(){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1});else if(e.isLoggedIn){"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1;var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:o.translate("SEÇİNİZ")})},null,null,null,!0)}else"company"==e.form.Tip?(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.current=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.current=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.current=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},loadingTimeout)},e.updateInsured=function(t){var n={pTC:e.form.HesapKodu,GSMNo:e.form.GSMNo,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi),sID:e.sID};i.post("insured/update",n,function(e){"function"==typeof t&&t()},function(){e.isInsuredInfoRunning=!1})},e.doSendSMS=function(t){a.open("/content/views/sms-insured-modal.html","SMSVerifyInsuredModalController",function(n){n.data={data:e.form,sID:e.sID,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n,a){e.pSMSToken=n,e.isSmsSend=a,"function"==typeof t&&t()},onModalCancel:function(){e.isInsuredInfoRunning=!1}}})},e.selectProperty=function(){if(e.form.YngIlAdi=null,e.form.Adres=null,void 0!==e.form.propertySelection&&null!==e.form.propertySelection){var t={pHesapKodu:e.form.HesapKodu,id:e.form.propertySelection};i.post("insured/getpropertybyid",t,function(t){e.form.id=t.ID,e.form.Adres=t.Adres,e.form.IlKodu=t.IlKodu,e.form.IlceKodu=t.IlceKodu,e.form.Semt=t.Belde,e.form.Mahalle=t.Mahalle,e.form.Sokak=t.Cadde,e.form.BinaNo=t.BinaNo,e.form.DaireNo=t.DaireNo,e.form.AdresNo=t.AdresNo,e.form.YngRizikoKat=t.RizikoKat,e.form.YngBrut=t.BrutMK,e.form.YngKullanimSekli=t.KullanimSekli,e.form.YngYil=parseInt(t.InsaaYili),e.form.YngBinaKat=t.BinaKat,e.form.YngYapiTarzi=t.YapiTarzi,e.form.YngIkametSekli=t.IkametSekli,e.form.YngAda=t.Ada,e.form.YngPafta=t.Pafta,e.form.YngParsel=t.Parsel,e.form.YngSayfa=t.Sayfa,""!=t.IkametSekli&&void 0!=t.IkametSekli||(e.form.YngIkametSekli=null);var n=e.binaToplamKatList.find(function(e){return e.value===t.BinaKat});void 0!==n?e.form.YngBinaKat=n.value:(e.form.YngBinaKat=null,e.binaToplamKatList.unshift({value:null,title:o.translate("SEÇİNİZ")}));var a=e.insaaYiliList.find(function(e){return e.value===parseInt(t.InsaaYili)});e.form.YngYil=void 0!==a?a.value:null;var i=e.kullanimSekliList.find(function(e){return e.value===t.KullanimSekli});e.form.YngKullanimSekli=void 0!==i?i.value:null;var r=e.yapiTarziList.find(function(e){return e.value===t.YapiTarzi});e.form.YngYapiTarzi=void 0!==r?r.value:null,"Betonarme"==t.YapiTarzi&&(e.form.YngYapiTarzi="Betonerme")},null,null,null,!0)}},e.checkCustomerAddressData=function(){if(!(e.form.IlKodu&&e.form.IlceKodu&&e.form.Unvan))return void(e.isNewInsuredInfosRequired=!0);e.isNewInsuredInfosRequired=!1,e.current=2,document.getElementById("form-start").scrollIntoView()},e.isFieldsValid=function(){var t=angular.copy(e.form);if(1===e.current||1===e.currentWizard)return 1==t.KVKK&&(!(null===t.Unvan&&e.formParameters.sigortaliAdSoyad||null===t.HesapKodu||null===t.GSMNo||null==t.DogumTarihi&&e.formParameters.isViewDateOfBirth&&"personal"==e.form.Tip)||(u.error(o.translate("Lütfen gerekli alanları doldurun.")),!1))},e.trustAsHtml=function(e){return s.trustAsHtml(e)},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return s.trustAsHtml(e)},e.setWarrants=function(t){null==e.form.KullanimTarzi&&(e.form.KullanimTarzi="0"),r.fetchTIA(e,{pAnaBrans:e.params.ab,pAraBrans:e.params.arabrans,pTarifeKodu:e.form.KullanimTarzi},function(){"function"==typeof t&&t()}),r.isTIAActive(e._tia)},e._isTiaVisible=function(e,t,n){if(2===e.Izleme)return!1;if(0===e.GorunumSartiTipi)return!0;var a=n.type,i=null;"teminat"===a&&angular.forEach(t.teminat,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"indirim"===a&&angular.forEach(t.indirim,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)}),"aciklama"===a&&angular.forEach(t.aciklama,function(t){t.TeminatID===e.GorunumSartiIliskiliAlanId&&(i=t)});var o=null;return 1===e.GorunumSartiTipi&&(o=i.ListItem),2===e.GorunumSartiTipi&&null!==i&&void 0!==i&&(20===i.Tip||21===i.Tip?(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=m.toService(i.Deger)):(null!=i.Deger&&""!=i.Deger||(i.Deger=0),o=i.Deger)),l.executeCondition(e.GorunumSartiIfade,parseFloat(o))},e.isTiaGroupVisible=function(t){var n=0;angular.forEach(t,function(){n++});var a=0;return angular.forEach(t,function(t){(2===t.Izleme||t.MusteriTipi!==e.form.MusteriTipi&&0!==t.MusteriTipi)&&a++}),n!==a},e.doSubmitViaSMS=function(){1==e.isLoggedIn&&(e.isSmsSend=!0);var t=r.build(e);t.HesapKodu=e.form.HesapKodu,t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.AdresNo=e.form.AdresNo,t.YngUAVTNo=e.form.AdresNo,t.YngAdres=e.form.YngAdres,t.YngBelde=e.form.YngBelde,t.YngBeldeAdi=e.form.YngBeldeAdi,t.YngBinaKat=e.form.YngBinaKat,t.YngBinaNo=e.form.YngBinaNo,t.YngBrut=parseInt(e.form.YngBrut),t.YngCadde=e.form.YngCadde,t.YngDaireNo=e.form.YngDaireNo,t.YngIlAdi=e.form.YngIlAdi,t.YngIlceAdi=e.form.YngIlceAdi,t.YngIlKodu=e.form.YngIlKodu,t.YngIlceKodu=e.form.YngIlceKodu,t.YngKullanimSekli=e.form.YngKullanimSekli,t.YngMahalle=e.form.YngMahalle,t.YngRizikoKat=e.form.YngRizikoKat,t.YngYapiTarzi=e.form.YngYapiTarzi,t.YngIkametSekli=e.form.YngIkametSekli,t.YngYil=e.form.YngYil,t.YngAda=e.form.YngAda,t.YngPafta=e.form.YngPafta,t.YngParsel=e.form.YngParsel,t.YngSayfa=e.form.YngSayfa,t.pPlaka="",t.pRuhsatNo="",t.AracDurumu="-1",t.pSessionID="",t.pAracKodu="",t.pTramerTarifeKodu="",t.pAracKullanimDetayKodu="",t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),angular.forEach(e.data.sehirList,function(n){n.kod==e.form.YngIlKodu&&(t.YngIlKodu=n.kod)}),angular.forEach(e.data.ilceList,function(e){e.ad==t.YngIlceAdi&&(t.YngIlceKodu=e.kod)}),t.sID=e.sID,t.isSmsVerified=!1,"insuredInformationForm"==e.formParameters.smsActivationLocation&&(t.isSmsVerified=!0),t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var n=f.get("Ref");null!==n&&""!==n&&void 0!==n&&void 0!==n.kod&&null!==n.kod&&""!==n.kod&&(t.pReferansPersonelKodu=n.kod),u.confirmHtmlContent(e.quotationConfirmContent,function(){e.isSmsSend?e.doSubmit(t):a.open("/content/views/sms-modal.html","SMSVerifyModalController",function(n){n.data={data:t,smsActivateDescription:e.formParameters.smsActivateDescription,smsActivationLocation:e.formParameters.smsActivationLocation,onSuccess:function(n){t.pSMSToken=n,e.doSubmit(t)}}})})},e.doSubmit=function(t){e.isQuotationPreparing=!0;try{null==t.YngBinaKat&&(t.YngBinaKat=0)}catch(e){}i.post("quotation/kaydet",t,function(t){f.set("Quotation",null);var n={pPoliID:t.href,pTip:1};0==t.ResultCode?0!==t.href&&"0"!==t.href&&null!==t.href&&""!==t.href?i.post("l/a/wlg",{},function(){f.set("Quotation",n),window.location.href="/Panel/dashboard?Success"},null,null,null,!0):u.error(o.translate("Teklif Kaydedilemedi!")):(u.info(t.ResultMessage),e.isQuotationPreparing=!1),e.isSaving=!1},function(){e.isSaving=!1,e.isQuotationPreparing=!1},null,null,!0)},e.openConfirmationModal=function(t){a.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"KVKK"==t&&e.onChangeGdpr()}}},"lg")},e.setCustomTawk=function(e){t.$broadcast("@SetupTawkForCustomEndpoint",e)},e.onChangeGdpr=function(t){g(function(){if(e.form.KVKK){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/gd/wlg",n,function(){e.isSendGDPRLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},50)},e.onChangeMarketing=function(t){g(function(){if(e.form.Agreement){var n={Unvan:e.form.Unvan,HesapKodu:e.form.HesapKodu,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlKodu:e.form.IlKodu,IlceKodu:e.form.IlceKodu,sID:e.sID};i.post("f/pri/wlg",n,function(){e.isSendMarketingLog=!0,"function"==typeof t&&t()},null,null,null,!0)}},250)},e.onChangeMusteriTipi=function(t){e.form.MusteriTipi="personal"==t?1:2},e.inquireAddress=function(){if(null===e.form.AdresNo||""===e.form.AdresNo||void 0===e.form.AdresNo)a.open("/content/views/dask-address-modal.html","WSAddress.ModalController",function(t){t.data={onAddressSuccess:e.onAddressModalClose}});else{var t={pKod:e.form.AdresNo};e.isAddressSearching=!0,i.post("webservice/adres/direct",t,function(t){var n=t.result.return.UAVTAdres;angular.forEach(e.data.sehirList,function(t){t.ad==n.IlAd&&(e.form.IlKodu=t.kod)}),e.form.Semt=n.BeldeAd,e.form.Mahalle=n.Mahalle,e.form.Sokak=n.CSBMAd,e.form.BinaNo=n.BinaNo,e.form.DaireNo=n.DaireNo,e.form.YngBelde=n.BeldeKod,e.form.YngBeldeAdi=n.BeldeAd,e.form.YngMahalle=n.Mahalle,e.form.Sokak=n.CSBMAd,e.form.YngBinaNo=n.BinaNo,e.form.YngDaireNo=n.DaireNo,e.form.YngCadde=n.CSBMAd,e.form.YngIlAdi=n.IlAd,e.form.YngIlceAdi=n.IlceAd,e.form.YngIlceKodu=n.IlceKod,e.form.YngIlKodu="0"+n.IlKod;var a=n.Mahalle+" "+n.CSBMAd+" No: "+n.BinaNo+" "+n.DaireNo+" "+n.BeldeAd+", "+n.IlceAd+", "+n.IlAd;a=a.replace("Bilinmiyor",""),a=a.replace("BİLİNMİYOR",""),e.form.Adres=a,e.form.YngAdres=e.form.Adres,""===n.BeldeAd&&""===n.Mahalle&&(e.form.Adres="ADRES BİLGİSİ ALINIRKEN BİR HATA OLUŞTU. LÜTFEN TEKRAR DENEYİN.",e.form.AdresNo=null),e.isAddressSearching=!1,g(function(){e.onChangeProvince(function(){angular.forEach(e.data.ilceList,function(t){t.ad==n.IlceAd&&(e.form.IlceKodu=t.kod)})})},50)},function(){e.isAddressSearching=!1,e.form.AdresNo=null},null,null,!0)}},e.onAddressModalClose=function(t){angular.forEach(e.data.sehirList,function(n){n.ad==t.IlAd&&(e.form.IlKodu=n.kod)}),e.form.Semt=t.BeldeAd,e.form.Mahalle=t.Mahalle,e.form.Sokak=t.CSBMAd,e.form.BeldeAd=t.BeldeAd,e.form.BinaNo=t.BinaNo,e.form.DaireNo=t.DaireNo;var n=t.Mahalle+" "+t.CSBMAd+" No: "+t.BinaNo+" "+t.DaireNo+" "+t.BeldeAd+", "+t.IlceAd+", "+t.IlAd;n=n.replace("Bilinmiyor",""),n=n.replace("BİLİNMİYOR",""),e.form.Adres=n,e.form.YngAdres=e.form.Adres,e.form.AdresNo=t.AdresNo,e.form.YngBelde=t.BeldeKod,e.form.YngBeldeAdi=t.BeldeAd,e.form.YngMahalle=t.Mahalle,e.form.Sokak=t.CSBMAd,e.form.YngBinaNo=t.BinaNo,e.form.YngDaireNo=t.DaireNo,e.form.YngCadde=t.CSBMAd,e.form.YngIlAdi=t.IlAd,e.form.YngIlceAdi=t.IlceAd,e.form.YngIlceKodu=t.IlceKod,e.form.YngIlKodu="0"+t.IlKod,g(function(){e.onChangeProvince(function(){angular.forEach(e.data.ilceList,function(n){n.ad==t.IlceAd&&(e.form.IlceKodu=n.kod)})})},50)},e.getDASKSummaryBinaKat=function(){var t=null;return angular.forEach(e.binaToplamKatList,function(n){n.value===e.form.YngBinaKat&&(t={title:n.title,tooltip:o.translate("Kat Sayısı")})}),t},e.getDASKSummaryInsaatYili=function(){var t=null;return angular.forEach(e.insaaYiliList,function(n){n.value===e.form.YngYil&&(t={title:n.title,tooltip:o.translate("İnşaat Yılı")})}),t},e.getDASKSummaryKullanimSekli=function(){var t=null;return angular.forEach(e.kullanimSekliList,function(n){n.value===e.form.YngKullanimSekli&&(t={title:n.title,tooltip:o.translate("Kullanım Şekli")})}),t},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=k("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onDisableDefaultBanner=function(){e.isDefaultBannerActive=!1},e.cbExpiration=function(){y.reload(e.widgetId),e.reCaptchaResponse=null},e.setResponse=function(t){e.reCaptchaResponse=t,e.reCaptchaResponse?e.checkCaptcha():(y.reload(e.widgetId),e.reCaptchaResponse=null)},e.setWidgetId=function(t){e.widgetId=t},e.checkCaptcha=function(){var t={reCaptchaResponse:e.reCaptchaResponse};i.post("widget/recaptcha/check",t,function(t){t?e.isNextButtonDisabled=!1:(e.isNextButtonDisabled=!0,u.error(o.translate("reCAPTCHA doğrulanamadı..!")),y.reload(e.widgetId),e.reCaptchaResponse=null)},null,null,null,!0)},e.openInfo=function(e){""!==e&&null!==e&&void 0!==e&&u.info(e)},e.getIdentityDetailsStyleThree=function(t){t?(auto=!0,loadingTimeout=0):(auto=!1,loadingTimeout=150),g(function(){if(e.isFieldsValid()){angular.forEach(e.data.sehirList,function(t){e.form.IlKodu==t.kod&&(e.form.IlAdi=t.ad)}),angular.forEach(e.data.ilceList,function(t){e.form.IlceKodu==t.kod&&(e.form.IlceAdi=t.ad)}),e.form.Permissions&&0==e.isSendGDPRLog&&e.onChangeGdpr(),e.form.Agreement&&0==e.isSendMarketingLog&&e.onChangeMarketing();var t={pTC:e.form.HesapKodu,AnaBrans:e.form.AnaBrans,AraBrans:e.form.AraBrans,GSMNo:e.form.GSMNo,EMail:e.form.EMail,IlAdi:e.form.IlAdi,IlceAdi:e.form.IlceAdi,Unvan:e.form.Unvan,kvkkStatus:e.form.Permissions,privacyStatus:e.form.Permissions,pDogumTarihi:I.dateInputToService(e.form.DogumTarihi)};"company"!=e.form.Tip&&2!=e.form.MusteriTipi||(void 0!=t.IlAdi&&null!=t.IlAdi&&""!=t.IlAdi||(t.IlAdi=e.insuredInfo.Sehir),void 0!=t.IlceAdi&&null!=t.IlceAdi&&""!=t.IlceAdi||(t.IlceAdi=e.insuredInfo.Ilce)),e.isInsuredInfoRunning=!0,t.sID=e.sID,i.post("identity/membercheck",t,function(t){if("personal"==e.form.Tip){if(!0!==t.isIdentityValid)return e.isBirthdayValid=!1,u.error(o.translate("Doğum Tarihini doğru girdiğinizden emin olun..!")),e.currentWizard=1,void(e.isInsuredInfoRunning=!1);e.isBirthdayValid=!0}if(e.form.pPSBSType=t.pPSBSType,e.form.MKSKontrol=t.MKSKontrol,0==t.isGSMValid&&"personal"==e.form.Tip)a.open("/content/views/modals/edit-phone-number-modal.html","Modals.EditPhoneNumberController",function(n){n.data={GSMNo:e.form.GSMNo,DogumTarihi:e.form.DogumTarihi,Tip:e.form.Tip,onSuccess:function(n){e.form.GSMNo=n.newGSMNo,e.updateInsured(function(){if(e.isLoggedIn){"company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1;var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:o.translate("SEÇİNİZ")})},null,null,null,!0)}else"company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1})},onCancel:function(){e.isInsuredInfoRunning=!1}}});else if(e.isLoggedIn){"company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1;var n={pHesapKodu:e.form.HesapKodu};i.post("insured/allproperties",n,function(t){e.data.mulkiyetList=t,angular.forEach(e.data.mulkiyetList,function(e){e.longTitle=e.il+"/"+e.ilce+" - "+e.kullanimsekli+" - "+e.binano+"-"+e.daireno}),e.data.mulkiyetList.unshift({id:null,longTitle:o.translate("SEÇİNİZ")})},null,null,null,!0)}else"company"==e.form.Tip?(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView()):(!1===t.isCityAndDistrictRequired&&(e.isCustomerExists=!0,e.currentWizard=2,document.getElementById("form-start").scrollIntoView(),e.onChangeProvince()),!0===t.isCityAndDistrictRequired&&(e.isCustomerExists=!1,e.currentWizard=1,document.getElementById("form-start").scrollIntoView())),e.formParameters.sigortaliIkamet&&e.formParameters.sigortaliAdSoyad&&(e.currentWizard=2,document.getElementById("form-start").scrollIntoView()),e.isInsuredInfoRunning=!1},function(){e.isInsuredInfoRunning=!1},null,null,auto)}},loadingTimeout)},e.onValidateGSM=function(){e.isValidating=!0;var t={pTCKN:null,HesapKodu:e.form.HesapKodu,pGSM:e.form.GSMNo,pVKN:null,pUnvan:e.form.Unvan,pKVKKVarsaUstuneYaz:0,sID:e.sID};"company"==e.form.Tip?t.pVKN=e.form.HesapKodu:t.pTCKN=e.form.HesapKodu,i.post("prepare/activation",t,function(t){e.form.pSessionID=C.remove(t.return.JSONData),e.referenceCode=C.remove(t.return.OtherData),e.isNumberValidated=!0,e.isValidating=!1,i.post("open/sms",{},function(){})},function(){e.isValidating=!1},null,null,!0)},e.verifySMSCode=function(){e.verifying=!0;var t={HesapKodu:e.form.HesapKodu,GSM:e.form.GSMNo,securecode:e.form.securecode,pSessionID:e.form.pSessionID};i.post("insured/check/sms",t,function(t){e.verifying=!1,!0===t.isSmsValid?(e.pSMSToken=e.form.pSessionID,e.doPrepareSubmit()):6==t.ResultCode?u.error(o.translate("ALERT_VERIFY_ERROR")):u.error(o.translate(t.Message))},function(){e.verifying=!1},null,null,!0)},e.doPrepareSubmit=function(){var t=r.build(e);t.HesapKodu=e.form.HesapKodu,t.pKN=e.form.HesapKodu,t.pPlaka=e.form.Plaka,t.pRuhsatNo=e.form.RuhsatNo,t.GSMNo=e.form.GSMNo,t.pIlKodu=e.form.IlKodu,t.pIlceKodu=e.form.IlceKodu,t.pUnvan=e.form.Unvan,t.AnaBrans=e.form.AnaBrans,t.AraBrans=e.form.AraBrans,t.AdresNo=e.form.AdresNo,t.YngUAVTNo=e.form.AdresNo,t.YngAdres=e.form.YngAdres,t.YngBelde=e.form.YngBelde,t.YngBeldeAdi=e.form.YngBeldeAdi,t.YngBinaKat=e.form.YngBinaKat,t.YngBinaNo=e.form.YngBinaNo,t.YngBrut=parseInt(e.form.YngBrut),t.YngCadde=e.form.YngCadde,t.YngDaireNo=e.form.YngDaireNo,t.YngIlAdi=e.form.YngIlAdi,t.YngIlceAdi=e.form.YngIlceAdi,t.YngIlKodu=e.form.YngIlKodu,t.YngIlceKodu=e.form.YngIlceKodu,t.YngKullanimSekli=e.form.YngKullanimSekli,t.YngMahalle=e.form.YngMahalle,t.YngRizikoKat=e.form.YngRizikoKat,t.YngYapiTarzi=e.form.YngYapiTarzi,t.YngIkametSekli=e.form.YngIkametSekli,t.YngYil=e.form.YngYil,t.YngAda=e.form.YngAda,t.YngPafta=e.form.YngPafta,t.YngParsel=e.form.YngParsel,t.YngSayfa=e.form.YngSayfa,t.pPlaka="",t.pRuhsatNo="",t.AracDurumu="-1",t.pSessionID="",t.pAracKodu="",t.pTramerTarifeKodu="",t.pAracKullanimDetayKodu="",t.pDogumTarihi=I.dateInputToService(e.form.DogumTarihi),angular.forEach(e.data.sehirList,function(n){n.kod==e.form.YngIlKodu&&(t.YngIlKodu=n.kod)}),angular.forEach(e.data.ilceList,function(e){e.ad==t.YngIlceAdi&&(t.YngIlceKodu=e.kod)}),t.sID=e.sID,t.isSmsVerified=!0,t.pTeklifPDF=0,t.pBilgiFormuPDF=0,t.pSMSToken=e.pSMSToken,e.menuData.isCreatePdf&&(t.pTeklifPDF=1),e.menuData.isCreateInformingForm&&(t.pBilgiFormuPDF=1);var n=f.get("Ref");null!==n&&""!==n&&void 0!==n&&void 0!==n.kod&&null!==n.kod&&""!==n.kod&&(t.pReferansPersonelKodu=n.kod),1==e.isLoggedIn?u.confirmHtmlContent(e.quotationConfirmContent,function(){e.doSubmit(t)}):(document.getElementById("form-start").scrollIntoView(),e.doSubmit(t))},e.onChangeGdprAndMarketing=function(t){e.form.KVKK=t,e.form.PrivacyPolicy=t,e.onChangeGdpr(function(){})},e.checkCustomerType=function(t){null!==t&&""!==t&&void 0!==t&&(9!=t.length&&10!=t.length||(e.form.Tip="company",e.form.MusteriTipi=2),11==t.length&&(e.form.Tip="personal",e.form.MusteriTipi=1))},e.onNextWizard=function(){e.current=null,e.currentWizard++,1==e.currentWizard&&i.post("f/nx/wlg",{wizardTitle:null,sID:e.sID},function(){},null,null,null,!0),document.getElementById("form-start").scrollIntoView()},e.onBackWizard=function(){2==e.currentWizard&&(e.isCustomerExists=null),5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard--,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onEditWizard=function(t){1==t&&(e.isCustomerExists=null),5==e.currentWizard&&(e.isNumberValidated=!1,i.post("o/sc/wlg",{},function(){},null,null,null,!0)),e.current=null,e.currentWizard=t,e.isBack=!0,document.getElementById("form-start").scrollIntoView()},e.onCreate()}]),app.directive("daskFormStyleDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/dask/form-style-default.html"}}),app.directive("daskFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/dask/form-style-1.html"}}),app.directive("daskFormStyleThree",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/dask/form-style-3.html"}}),app.directive("daskFormStyleTwo",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/dask/form-style-2.html"}}),app.directive("engineeringFormStyleDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/engineering/form-style-default.html"}}),app.directive("engineeringFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/engineering/form-style-1.html"}}),app.directive("engineeringFormStyleThree",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/engineering/form-style-3.html"}}),app.directive("engineeringFormStyleTwo",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/engineering/form-style-2.html"}}),app.directive("healthFormStyleDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/health/form-style-default.html"}}),app.directive("healthFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/health/form-style-1.html"}}),app.directive("healthFormStyleThree",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/health/form-style-3.html"}}),app.directive("healthFormStyleTwo",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/health/form-style-2.html"}}),app.directive("otherCarFormStyleDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other-car/form-style-default.html"}}),app.directive("otherCarFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other-car/form-style-1.html"}}),app.directive("otherCarFormStyleThree",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other-car/form-style-3.html"}}),app.directive("otherCarFormStyleTwo",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other-car/form-style-2.html"}}),app.directive("otherFormStyleDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other/form-style-default.html"}}),app.directive("otherFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other/form-style-1.html"}}),app.directive("otherFormStyleThree",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other/form-style-3.html"}}),app.directive("otherFormStyleTwo",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/other/form-style-2.html"}}),app.directive("propertyFormStyleDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/property/form-style-default.html"}}),app.directive("propertyFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/property/form-style-1.html"}}),app.directive("propertyFormStyleThree",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/property/form-style-3.html"}}),app.directive("propertyFormStyleTwo",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/property/form-style-2.html"}}),app.directive("trafficFormStyleDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/traffic/form-style-default.html"}}),app.directive("trafficFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/traffic/form-style-1.html"}}),app.directive("trafficFormStyleThree",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/traffic/form-style-3.html"}}),app.directive("trafficFormStyleTwo",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/traffic/form-style-2.html"}}),app.directive("formCurrency",["$rootSettings","$inputter",function(e,t){return{restrict:"A",
require:"ngModel",scope:{},link:function(n,a,i,o){e.whenReady(function(){t.setCurrencyMask(a,i.digits),t.removeMark(a,"form-currency")}),a.on("keydown",function(e){","==e.key&&angular.element(e.currentTarget).prop("selectionStart",e.target.inputmask.maskset.buffer.indexOf(".")+1)}),a.on("keyup",function(){n.$apply(function(){o.$setViewValue(a.val())})})}}}]),app.directive("formDate",["$culture","$validations","$viewFactory","$compile","$inputter",function($culture,$validations,$viewFactory,$compile,$inputter){return{restrict:"A",scope:{},link:function(scope,element,attributes){if(void 0===element.attr("is-form-date-element")){$inputter.setFundamentals(attributes.formDate,scope,element,attributes),$inputter.removeMark(element,"form-date"),element.parent().parent().addClass("date-input"),element.attr("is-form-date-element",!0),scope.isDisabled=function(){var e=element.attr("disabled");return void 0!==e&&!1!==e},$viewFactory.get("directives/forms/date.html",function(e){element.before($compile('<span class="input-group-btn date-button-selector input-group-prepend">    <button ng-click="open();" ng-disabled="isDisabled();" class="btn btn-secondary date-button" type="button" style="margin-bottom: 0px; ">        <i class="fa fa-calendar-alt p-1" style="color: #48465b;"></i>    </button></span>')(scope)),element.after($compile(e)(scope))}),scope.data={parts:{year:null,month:null,day:null,hour:null,minute:null,second:null},selector:{currentYear:null,currentMonth:null}},scope.parameters={},scope.options={dateFormat:"DD-MM-YYYY",firstDayOfWeek:1,mask:"99-99-9999"},scope.dropup=!1,$validations.get(attributes.formDate,function(e){void 0!==e&&null!==e&&(null!==e.dateDisplay&&void 0!==e.dateDisplay&&e.dateDisplay.toString().length>0&&(scope.options.dateFormat=e.dateDisplay),null!==e.dateFirstDayOfWeek&&void 0!==e.dateFirstDayOfWeek&&e.dateFirstDayOfWeek.toString().length>0&&(scope.options.firstDayOfWeek=parseInt(e.dateFirstDayOfWeek)),null!==e.inputMask&&void 0!==e.inputMask&&e.inputMask.length>0&&(scope.options.mask=e.inputMask)),new Inputmask(scope.options.mask).mask(element)});var setSelectorCurrentMonth=function(){scope.data.selector.currentYear=moment().year(),scope.data.selector.currentMonth=moment().month()};element.on("focus",function(e){angular.element(e.currentTarget).prop("selectionStart",0),angular.element(e.currentTarget).prop("selectionEnd",0)}),element.on("keydown",function(e){if(!(["Backspace","ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Delete"].indexOf(e.key)>-1||isNaN(parseInt(e.key)))){var t=scope.getModelValue();if(null!==t&&t.replace(/_/g,"").length===scope.options.mask.length){var n=angular.element(e.currentTarget).prop("selectionStart");t=t.substr(0,n)+e.key+t.substr(n+1),scope.$apply(function(){scope.setModelValue(t)});var a=1;"-"===scope.options.mask.substr(n+1,1)&&a++,angular.element(e.currentTarget).prop("selectionStart",n+a),angular.element(e.currentTarget).prop("selectionEnd",n+a)}}}),element.on("blur",function(){var e=moment(scope.getModelValue(),scope.options.dateFormat);if(null===e||void 0===e||!0!==e._isValid)return void scope.$apply(function(){scope.setModelValue(null)});scope.$apply(function(){setMomentDate(e)})});var setMomentDate=function(e){scope.data.parts.year=e.get("year"),scope.data.parts.month=e.get("month"),scope.data.parts.day=e.get("date"),scope.data.parts.hour=e.get("hour"),scope.data.parts.minute=e.get("minute"),scope.data.parts.second=e.get("second"),scope.applyMask()},setNullValue=function(){scope.data.parts.year=null,scope.data.parts.month=null,scope.data.parts.day=null,scope.data.parts.hour=null,scope.data.parts.minute=null,scope.data.parts.second=null,scope.applyMask()},getTodayAsObject=function(){var e=moment();return{day:e._d.getDate(),month:e._d.getMonth(),year:e._d.getFullYear()}},setCurrentCaledarPosition=function(){if(null===scope.data.parts.year&&null===scope.data.parts.month){var e=moment();return scope.data.selector.currentYear=e.get("year"),void(scope.data.selector.currentMonth=e.get("month"))}scope.data.selector.currentYear=scope.data.parts.year,scope.data.selector.currentMonth=scope.data.parts.month};scope.putValue=function(e){if(null===e)return setNullValue();if("string"==typeof e){if(!1===moment(e).isValid())return setNullValue();e=moment(e)}setMomentDate(e),scope.close()},scope.open=function(){setCurrentCaledarPosition(),scope.setCalendar(),scope.boxVisible=!0,void 0!==attributes.dropup&&(scope.dropup=!0)},scope.close=function(){scope.boxVisible=!1},scope.applyMask=function(){if(null===scope.data.parts.year)return void(scope.$parent[attributes.ngModel]=null);scope.setModelValue(moment(scope.data.parts).format(scope.options.dateFormat))},scope.changeDay=function(e,t,n){scope.data.parts.year=e,scope.data.parts.month=t,scope.data.parts.day=n,null===scope.data.parts.hour&&(scope.data.parts.hour=0,scope.data.parts.minute=0,scope.data.parts.second=0),scope.applyMask(),scope.setCalendar()},scope.changeMonth=function(e){scope.data.selector.currentMonth+=e,scope.data.selector.currentMonth>11?(scope.data.selector.currentMonth=0,scope.data.selector.currentYear++):scope.data.selector.currentMonth<0&&(scope.data.selector.currentMonth=11,scope.data.selector.currentYear--),scope.setCalendar()},scope.setClear=function(){scope.putValue(null),scope.setModelValue(null),scope.close()},scope.setToday=function(){setMomentDate(new moment),setCurrentCaledarPosition(),scope.setCalendar(),scope.close()},scope.addToMatrix=function(e,t,n){scope.matrix[e][t]=n.value},scope.getDayOfWeekByLocale=function(e){var t=e.getDay(),n=t-parseInt(scope.options.firstDayOfWeek);return n<0&&(n+=7),n},scope.setCalendar=function(){var e=scope.data.selector.currentYear,t=scope.data.selector.currentMonth,n=scope.lapse[t];scope.title.year=e;var a=["January","February","March","April","May","June","July","August","September","October","November","December"];scope.title.month=scope.parameters.MONTH[a[t]],1===t&&e%4==0&&n++,scope.matrix=[[],[],[],[],[],[]];var i=new Date(e,t,1),o=scope.getDayOfWeekByLocale(i),r=31;t>0&&(r=scope.lapse[t-1],2===t&&e%4==0&&r++);var l,s,u,c,d;if(0===o){for(s=6,u=0;u<7;u++)l=t-1,d=scope.title.year,0===t&&(d--,l=11),scope.matrix[0][u]={value:r-s,type:"beforeMonth",year:d,month:l,isWeekend:-1!==scope.weekendIndexes.indexOf(u)},s--;1}else{for(s=o,u=0;u<o;u++)l=t-1,d=scope.title.year,0===t&&(d--,l=11),scope.matrix[0][u]={value:r-s+1,type:"beforeMonth",year:d,month:l,isWeekend:-1!==scope.weekendIndexes.indexOf(u)},s--;for(s=1,u=o;u<7;u++)scope.matrix[0][u]={value:s++,type:"currentMonth",year:scope.title.year,month:t,isWeekend:-1!==scope.weekendIndexes.indexOf(u)}}var m=n-s+1,f=Math.ceil(m/7),p=0;s<1&&(s=1);for(var g=1;g<=f;g++)for(u=0;u<7;u++)s<=n?scope.matrix[g][u]={value:s++,type:"currentMonth",year:scope.title.year,month:t,isWeekend:-1!==scope.weekendIndexes.indexOf(u)}:p++;if(0===p)for(u=0;u<7;u++)c=t+1,d=scope.title.year,11===t&&(d++,c=0),scope.matrix[f+1][u]={value:u+1,type:"nextMonth",year:d,month:c,isWeekend:-1!==scope.weekendIndexes.indexOf(u)};else for(u=0;u<p;u++)c=t+1,d=scope.title.year,11===t&&(d++,c=0),scope.matrix[f][6-u]={value:p-u,type:"nextMonth",year:d,month:c,isWeekend:-1!==scope.weekendIndexes.indexOf(u)};var v=getTodayAsObject();angular.forEach(scope.matrix,function(e){angular.forEach(e,function(e){e.value===v.day&&e.month===v.month&&e.year===v.year&&(e.isToday=!0),null!==scope.data.parts.year&&e.value===scope.data.parts.day&&e.month===scope.data.parts.month&&e.year===scope.data.parts.year&&(e.isSelected=!0)})})},scope.onBlur=function(){var e=moment(scope.value,scope.options.dateFormat);e.isValid()?scope.putValue(e):scope.putValue(null)},scope.initLocale=function(){scope.days=[],scope.weekendIndexes=[];for(var e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=0;t<7;t++){var n=t+parseInt(scope.options.firstDayOfWeek);n>6&&(n-=7);var a={title:scope.parameters.SHORTDAY[e[n]],isWeekend:0===n||6===n};scope.days.push(a),a.isWeekend&&scope.weekendIndexes.push(t)}setSelectorCurrentMonth(),scope.setCalendar(),scope.onBlur()},scope.getValue=function(){return null===scope.data.parts.year?"":moment(scope.data.parts).format("YYYY-MM-DD HH:mm:ss")},scope.getModelValue=function(){var expression=attributes.ngModel;return expression="scope.$parent."+expression.replace(/[\[']+/g,"[scope.$parent."),eval(expression)},scope.setModelValue=function(newValue){var expression=attributes.ngModel;expression="scope.$parent."+expression.replace(/[\[']+/g,"[scope.$parent."),expression=expression+" = '"+newValue+"';",expression=expression.replace("'null'","null"),eval(expression)},scope.onShow=function(){scope.parameters={DAY:{Sunday:$culture.translate("Pazar"),Monday:$culture.translate("Pazartesi"),Tuesday:$culture.translate("Salı"),Wednesday:$culture.translate("Çarşamba"),Thursday:$culture.translate("Perşembe"),Friday:$culture.translate("Cuma"),Saturday:$culture.translate("Cumartesi")},MAIN:{FIRSTDAYOFWEEK:$culture.translate("Haftanın İlk Günü")},MONTH:{January:$culture.translate("Ocak"),February:$culture.translate("Şubat"),March:$culture.translate("Mart"),April:$culture.translate("Nisan"),May:$culture.translate("Mayıs"),June:$culture.translate("Haziran"),July:$culture.translate("Temmuz"),August:$culture.translate("Ağustos"),September:$culture.translate("Eylül"),October:$culture.translate("Ekim"),November:$culture.translate("Kasım"),December:$culture.translate("Aralık")},SHORTDAY:{Sun:$culture.translate("Paz"),Mon:$culture.translate("Pzt"),Tue:$culture.translate("Sal"),Wed:$culture.translate("Çrş"),Thu:$culture.translate("Prş"),Fri:$culture.translate("Cum"),Sat:$culture.translate("Cmt")},SHORTMONTH:{Jan:$culture.translate("Oca"),Feb:$culture.translate("Şub"),Mar:$culture.translate("Mar"),Apr:$culture.translate("Nis"),May:$culture.translate("May"),Jun:$culture.translate("Haz"),Jul:$culture.translate("Tem"),Aug:$culture.translate("Ağu"),Sep:$culture.translate("Eyl"),Oct:$culture.translate("Ekm"),Nov:$culture.translate("Kas"),Dec:$culture.translate("Ara")}},scope.matrix=!1,scope.boxVisible=!1,scope.title={year:!1,month:!1},scope.lapse=[31,28,31,30,31,30,31,31,30,31,30,31],void 0===scope.options.firstDayOfWeek&&(scope.options.firstDayOfWeek=1),scope.initLocale();var e=scope.getModelValue();if(void 0!==e&&null!==e){var t=moment(e,scope.options.dateFormat);null!==t&&void 0!==t&&!0===t._isValid?setMomentDate(t):scope.setModelValue(null)}},$culture.whenReady(scope.onShow),$compile(element.parent().parent())(scope.$parent)}}}}]),app.directive("formDatePicker",["$culture",function(e){return{restrict:"A",require:"?ngModel",link:function(t,n,a,i){var o,r;if(n.datepicker.dates.en={days:["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi","Pazar"],daysShort:["Pzr","Pts","Sal","Çar","Per","Cum","Cts","Pzr"],daysMin:["Pz","Pt","Sa","Ça","Pe","Cu","Ct","Pz"],months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],monthsShort:["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],today:e.translate("Bugün"),clear:e.translate("Temizle")},o=n.datepicker({autoclose:!0,keyboardNavigation:!1,todayHighlight:!0,format:"dd.mm.yyyy",language:"en",weekStart:1,constrainInput:"true",todayBtn:"linked",clearBtn:!0}),r=o.data("datepicker").picker,o.on("show",function(e){r.css("left",parseInt(r.css("left"))+ +a.offsetX),r.css("top",parseInt(r.css("top"))+ +a.offsetY)}),o.keyup(function(e){8!=e.keyCode&&46!=e.keyCode||n.datepicker("update","")}),i){var l;i.$formatters.push(function(e){var t,a=moment(e);return e&&a.isValid()?(l=a.clone(),t=a.format("DD.MM.YYYY")):(l=void 0,t=void 0),t&&n.datepicker("update",t),t}),i.$parsers.push(function(e){var t,n=moment(e,"DD.MM.YYYY",!0);return e&&n.isValid()?(l&&(n.hour(l.hour()),n.minute(l.minute()),n.second(l.second()),n.millisecond(l.millisecond())),t=n.toDate()):t=void 0,t=moment(t).format("DDMMYYYY")}),o.on("changeDate",function(e){"INPUT"!==e.target.tagName&&(i.$setViewValue(moment(e.date).format("DD.MM.YYYY")),i.$render())})}}}}]),app.directive("formElement",["$compile","$inputElement",function(e,t){return{restrict:"A",link:function(n,a,i){t.setFundamentals(i.formElement,n,a,i),t.setDirty(i.formElement,n,a,i),t.setPlateRegex(i.formElement,n,a,i),t.removeMark(a,"form-element"),e(a)(n)}}}]),app.directive("quotationFormDate",["$culture","$validations","$viewFactory","$compile","$inputter","$welcomeInit",function($culture,$validations,$viewFactory,$compile,$inputter,$welcomeInit){return{restrict:"A",scope:{},link:function(scope,element,attributes){if(scope.className=$welcomeInit.getFormStyles().inputType,scope.showPickerButton=attributes.showPickerButton,void 0===element.attr("is-form-date-element")){$inputter.removeMark(element,"form-date"),element.parent().parent().addClass("date-input"),element.attr("is-form-date-element",!0),scope.isDisabled=function(){var e=element.attr("disabled");return void 0!==e&&!1!==e},"false"!==scope.showPickerButton&&$viewFactory.get("directives/forms/date.html",function(e){element.before($compile('<span class="input-group-btn date-button-selector input-group-prepend">    <button ng-click="open();" ng-disabled="isDisabled();" class="btn btn-secondary date-button" ng-class="{\'btn-sm\': className == \'form-control-sm\', \'btn-lg\': className == \'form-control-lg\' }" type="button" style="margin-bottom: 0px; ">        <i class="fa fa-calendar-alt p-1" style="color: #48465b;"></i>    </button></span>')(scope)),element.after($compile(e)(scope))}),scope.data={parts:{year:null,month:null,day:null,hour:null,minute:null,second:null},selector:{currentYear:null,currentMonth:null}},scope.parameters={},scope.options={dateFormat:"DD-MM-YYYY",firstDayOfWeek:1,mask:"99-99-9999"},scope.dropup=!1,$validations.get(attributes.formDate,function(e){void 0!==e&&null!==e&&(null!==e.dateDisplay&&void 0!==e.dateDisplay&&e.dateDisplay.toString().length>0&&(scope.options.dateFormat=e.dateDisplay),null!==e.dateFirstDayOfWeek&&void 0!==e.dateFirstDayOfWeek&&e.dateFirstDayOfWeek.toString().length>0&&(scope.options.firstDayOfWeek=parseInt(e.dateFirstDayOfWeek)),null!==e.inputMask&&void 0!==e.inputMask&&e.inputMask.length>0&&(scope.options.mask=e.inputMask)),new Inputmask(scope.options.mask).mask(element)});var setSelectorCurrentMonth=function(){scope.data.selector.currentYear=moment().year(),scope.data.selector.currentMonth=moment().month()};element.on("focus",function(e){angular.element(e.currentTarget).prop("selectionStart",0),angular.element(e.currentTarget).prop("selectionEnd",0)}),element.on("keydown",function(e){if(!(["Backspace","ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Delete"].indexOf(e.key)>-1||isNaN(parseInt(e.key)))){var t=scope.getModelValue();if(null!==t&&t.replace(/_/g,"").length===scope.options.mask.length){var n=angular.element(e.currentTarget).prop("selectionStart");t=t.substr(0,n)+e.key+t.substr(n+1),scope.$apply(function(){scope.setModelValue(t)});var a=1;"-"===scope.options.mask.substr(n+1,1)&&a++,angular.element(e.currentTarget).prop("selectionStart",n+a),angular.element(e.currentTarget).prop("selectionEnd",n+a)}}}),element.on("blur",function(){var e=moment(scope.getModelValue(),scope.options.dateFormat);if(null===e||void 0===e||!0!==e._isValid)return void scope.$apply(function(){scope.setModelValue(null)});scope.$apply(function(){setMomentDate(e)})});var setMomentDate=function(e){scope.data.parts.year=e.get("year"),scope.data.parts.month=e.get("month"),scope.data.parts.day=e.get("date"),scope.data.parts.hour=e.get("hour"),scope.data.parts.minute=e.get("minute"),scope.data.parts.second=e.get("second"),scope.applyMask()},setNullValue=function(){scope.data.parts.year=null,scope.data.parts.month=null,scope.data.parts.day=null,scope.data.parts.hour=null,scope.data.parts.minute=null,scope.data.parts.second=null,scope.applyMask()},getTodayAsObject=function(){var e=moment();return{day:e._d.getDate(),month:e._d.getMonth(),year:e._d.getFullYear()}},setCurrentCaledarPosition=function(){if(null===scope.data.parts.year&&null===scope.data.parts.month){var e=moment();return scope.data.selector.currentYear=e.get("year"),void(scope.data.selector.currentMonth=e.get("month"))}scope.data.selector.currentYear=scope.data.parts.year,scope.data.selector.currentMonth=scope.data.parts.month};scope.putValue=function(e){if(null===e)return setNullValue();if("string"==typeof e){if(!1===moment(e).isValid())return setNullValue();e=moment(e)}setMomentDate(e),scope.close()},scope.open=function(){setCurrentCaledarPosition(),scope.setCalendar(),scope.boxVisible=!0,void 0!==attributes.dropup&&(scope.dropup=!0)},scope.close=function(){scope.boxVisible=!1},scope.applyMask=function(){if(null===scope.data.parts.year)return void(scope.$parent[attributes.ngModel]=null);scope.setModelValue(moment(scope.data.parts).format(scope.options.dateFormat))},scope.changeDay=function(e,t,n){scope.data.parts.year=e,scope.data.parts.month=t,scope.data.parts.day=n,null===scope.data.parts.hour&&(scope.data.parts.hour=0,scope.data.parts.minute=0,scope.data.parts.second=0),scope.applyMask(),scope.setCalendar(),scope.onBlur()},scope.changeMonth=function(e){scope.data.selector.currentMonth+=e,scope.data.selector.currentMonth>11?(scope.data.selector.currentMonth=0,scope.data.selector.currentYear++):scope.data.selector.currentMonth<0&&(scope.data.selector.currentMonth=11,scope.data.selector.currentYear--),scope.setCalendar()},scope.setClear=function(){scope.putValue(null),scope.setModelValue(null),scope.close()},scope.setToday=function(){setMomentDate(new moment),setCurrentCaledarPosition(),scope.setCalendar(),scope.close()},scope.addToMatrix=function(e,t,n){scope.matrix[e][t]=n.value},scope.getDayOfWeekByLocale=function(e){var t=e.getDay(),n=t-parseInt(scope.options.firstDayOfWeek);return n<0&&(n+=7),n},scope.setCalendar=function(){var e=scope.data.selector.currentYear,t=scope.data.selector.currentMonth,n=scope.lapse[t];scope.title.year=e;var a=["January","February","March","April","May","June","July","August","September","October","November","December"];scope.title.month=scope.parameters.MONTH[a[t]],1===t&&e%4==0&&n++,scope.matrix=[[],[],[],[],[],[]];var i=new Date(e,t,1),o=scope.getDayOfWeekByLocale(i),r=31;t>0&&(r=scope.lapse[t-1],2===t&&e%4==0&&r++);var l,s,u,c,d;if(0===o){for(s=6,u=0;u<7;u++)l=t-1,d=scope.title.year,0===t&&(d--,l=11),scope.matrix[0][u]={value:r-s,type:"beforeMonth",year:d,month:l,isWeekend:-1!==scope.weekendIndexes.indexOf(u)},s--;1}else{for(s=o,u=0;u<o;u++)l=t-1,d=scope.title.year,0===t&&(d--,l=11),scope.matrix[0][u]={value:r-s+1,type:"beforeMonth",year:d,month:l,isWeekend:-1!==scope.weekendIndexes.indexOf(u)},s--;for(s=1,u=o;u<7;u++)scope.matrix[0][u]={value:s++,type:"currentMonth",year:scope.title.year,month:t,isWeekend:-1!==scope.weekendIndexes.indexOf(u)}}var m=n-s+1,f=Math.ceil(m/7),p=0;s<1&&(s=1);for(var g=1;g<=f;g++)for(u=0;u<7;u++)s<=n?scope.matrix[g][u]={value:s++,type:"currentMonth",year:scope.title.year,month:t,isWeekend:-1!==scope.weekendIndexes.indexOf(u)}:p++;if(0===p)for(u=0;u<7;u++)c=t+1,d=scope.title.year,11===t&&(d++,c=0),scope.matrix[f+1][u]={value:u+1,type:"nextMonth",year:d,month:c,isWeekend:-1!==scope.weekendIndexes.indexOf(u)};else for(u=0;u<p;u++)c=t+1,d=scope.title.year,11===t&&(d++,c=0),scope.matrix[f][6-u]={value:p-u,type:"nextMonth",year:d,month:c,isWeekend:-1!==scope.weekendIndexes.indexOf(u)};var v=getTodayAsObject();angular.forEach(scope.matrix,function(e){angular.forEach(e,function(e){e.value===v.day&&e.month===v.month&&e.year===v.year&&(e.isToday=!0),null!==scope.data.parts.year&&e.value===scope.data.parts.day&&e.month===scope.data.parts.month&&e.year===scope.data.parts.year&&(e.isSelected=!0)})})},scope.onBlur=function(){var e=moment(scope.value,scope.options.dateFormat);e.isValid()?scope.putValue(e):scope.putValue(null)},scope.initLocale=function(){scope.days=[],scope.weekendIndexes=[];for(var e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=0;t<7;t++){var n=t+parseInt(scope.options.firstDayOfWeek);n>6&&(n-=7);var a={title:scope.parameters.SHORTDAY[e[n]],isWeekend:0===n||6===n};scope.days.push(a),a.isWeekend&&scope.weekendIndexes.push(t)}setSelectorCurrentMonth(),scope.setCalendar(),scope.onBlur()},scope.getValue=function(){return null===scope.data.parts.year?"":moment(scope.data.parts).format("YYYY-MM-DD HH:mm:ss")},scope.getModelValue=function(){var expression=attributes.ngModel;return expression="scope.$parent."+expression.replace(/[\[']+/g,"[scope.$parent."),eval(expression)},scope.setModelValue=function(newValue){var expression=attributes.ngModel;expression="scope.$parent."+expression.replace(/[\[']+/g,"[scope.$parent."),expression=expression+" = '"+newValue+"';",expression=expression.replace("'null'","null"),eval(expression)},scope.onShow=function(){scope.parameters={DAY:{Sunday:$culture.translate("Pazar"),Monday:$culture.translate("Pazartesi"),Tuesday:$culture.translate("Salı"),Wednesday:$culture.translate("Çarşamba"),Thursday:$culture.translate("Perşembe"),Friday:$culture.translate("Cuma"),Saturday:$culture.translate("Cumartesi")},MAIN:{FIRSTDAYOFWEEK:$culture.translate("Haftanın İlk Günü")},MONTH:{January:$culture.translate("Ocak"),February:$culture.translate("Şubat"),March:$culture.translate("Mart"),April:$culture.translate("Nisan"),May:$culture.translate("Mayıs"),June:$culture.translate("Haziran"),July:$culture.translate("Temmuz"),August:$culture.translate("Ağustos"),September:$culture.translate("Eylül"),October:$culture.translate("Ekim"),November:$culture.translate("Kasım"),December:$culture.translate("Aralık")},SHORTDAY:{Sun:$culture.translate("Paz"),Mon:$culture.translate("Pzt"),Tue:$culture.translate("Sal"),Wed:$culture.translate("Çrş"),Thu:$culture.translate("Prş"),Fri:$culture.translate("Cum"),Sat:$culture.translate("Cmt")},SHORTMONTH:{Jan:$culture.translate("Oca"),Feb:$culture.translate("Şub"),Mar:$culture.translate("Mar"),Apr:$culture.translate("Nis"),May:$culture.translate("May"),Jun:$culture.translate("Haz"),Jul:$culture.translate("Tem"),Aug:$culture.translate("Ağu"),Sep:$culture.translate("Eyl"),Oct:$culture.translate("Ekm"),Nov:$culture.translate("Kas"),Dec:$culture.translate("Ara")}},scope.matrix=!1,scope.boxVisible=!1,scope.title={year:!1,month:!1},scope.lapse=[31,28,31,30,31,30,31,31,30,31,30,31],void 0===scope.options.firstDayOfWeek&&(scope.options.firstDayOfWeek=1),scope.initLocale();var e=scope.getModelValue();if(void 0!==e&&null!==e){var t=moment(e,scope.options.dateFormat);null!==t&&void 0!==t&&!0===t._isValid?setMomentDate(t):scope.setModelValue(null)}},$culture.whenReady(scope.onShow),$compile(element.parent().parent())(scope.$parent)}}}}]),app.directive("headerS01Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/header-styles/S01-default.html"}}),app.directive("headerS03",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/header-styles/S03-default.html"}}),app.directive("menuS01",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S01.html"}}),app.directive("menuS02Bottom",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S02-bottom.html"}}),app.directive("menuS02SubheaderDefault",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S02-subheader-default.html"}}),app.directive("menuS02Topbar",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S02-topbar.html"}}),app.directive("menuS03BootstrapColor",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S03-bootstrap-color.html"}}),app.directive("menuS03BootstrapDark",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S03-bootstrap-dark.html"}}),app.directive("menuS03Bootstrap",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S03-bootstrap.html"}}),app.directive("menuS04Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S04-default.html"}}),app.directive("menuS05Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S05-default.html"}}),app.directive("menuS06Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S06-default.html"}}),app.directive("menuS07Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S07-default.html"}}),app.directive("menuS08Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S08-default.html"}}),app.directive("menuS09Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/S09-default.html"}}),app.directive("menuS01Header",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S01.html"}}),app.directive("menuS02BottomHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S02-bottom.html"}}),app.directive("menuS02MobileHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S02-mobile.html"}}),app.directive("menuS02TopbarHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S02-topbar.html"}}),app.directive("menuS03BootstrapColorHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S03-bootstrap-color.html"}}),app.directive("menuS03BootstrapDarkHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S03-bootstrap-dark.html"}}),app.directive("menuS03BootstrapHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S03-bootstrap.html"}}),app.directive("menuS04DefaultHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S04-default.html"}}),app.directive("menuS05DefaultHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S05-default.html"}}),app.directive("menuS06DefaultHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S06-default.html"}}),app.directive("menuS07DefaultHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S07-default.html"}}),app.directive("menuS08DefaultHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S08-default.html"}}),app.directive("menuS09DefaultHeader",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/S09-default.html"}}),app.directive("mobileBurgerMenu",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles-header/mobile-burger-menu.html"}}),app.directive("topbarS01Default",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/top-bar-styles/S01-default.html"}}),app.factory("$boxesInit",["$rootScope","$rest","$filter","$window",function(e,t,n,a){var i={isSuccessData:!1},o={welcome:[],dashboard:[],others:[]};return i.onCreate=function(n){var a={portalMenuId:n,resolution:i.getResolution()};return-1===n&&o.welcome.length>0?o.welcome:-2===n&&o.dashboard.length>0?o.dashboard:void t.get("welcome/box/init",a,function(t){-1===n&&(o.welcome=angular.copy(t.portalBoxes)),-2===n&&(o.dashboard=angular.copy(t.portalBoxes)),-1!==n&&-2!==n&&(o.others=angular.copy(t.portalBoxes)),e.$broadcast("$boxesInit.onSuccess"),i.isSuccessData=!0})},i.getBoxes=function(e){var t={defaultItems:[],footerItems:[],aboveBannerItems:[],widgetBoxItems:[]},a=null;return-1===e&&(a=o.welcome),-2===e&&(a=o.dashboard),-1!==e&&-2!==e&&(a=o.others),angular.forEach(a,function(e){"default"==e.type&&t.defaultItems.push(e),"footer"==e.type&&t.footerItems.push(e),"above-banner"==e.type&&t.aboveBannerItems.push(e),"widget"==e.type&&t.widgetBoxItems.push(e)}),t.defaultItems=n("orderBy")(t.defaultItems,"order"),t.footerItems=n("orderBy")(t.footerItems,"order"),t.aboveBannerItems=n("orderBy")(t.aboveBannerItems,"order"),t.widgetBoxItems=n("orderBy")(t.widgetBoxItems,"order"),t},i.getResolution=function(){var e="desktop";return a.innerWidth<768&&(e="mobile"),a.innerWidth>767&&a.innerWidth<1024&&(e="tablet"),e},i}]),app.factory("$welcomeInit",["$rootScope","$rest","$handcuff","$storage","$window",function(e,t,n,a,i){var o={isSuccessData:!1,OpenedAnnounceModals:[],filterQuery:null,refLoginInfo:"",isFlexActive:!1},r=["WELCOME","DASHBOARD","BOXES","PAGES","QUATATION","WIDGET"],l=null,s=[],u=[],c=null;o.onCreate=function(i){if(null!=l)i();else{var r={resolution:o.getResolution()};!0===a.get("isChangeLanguage")?$.ajax({url:"/api/welcome/init",method:"GET",data:r,cache:!1,success:function(t){t.portalMenus.length>0&&angular.forEach(t.portalMenus,function(e){e.code=n.remove(e.code),e.tawkCode=n.remove(e.tawkCode),e.product=n.remove(e.product)}),null!==t.tawkSettings&&""!==t.tawkSettings&&(t.tawkSettings.tawkWidgetCode=n.remove(t.tawkSettings.tawkWidgetCode),t.tawkSettings.tawkWidgetOption=n.remove(t.tawkSettings.tawkWidgetOption)),null!==t.portalPanelSettings&&""!==t.portalPanelSettings&&(t.portalPanelSettings.staffCode=n.remove(t.portalPanelSettings.staffCode),t.portalPanelSettings.staffName=n.remove(t.portalPanelSettings.staffName),t.portalPanelSettings.transportCounterAgencyCode=n.remove(t.portalPanelSettings.transportCounterAgencyCode),t.portalPanelSettings.transportCounterApiUrl=n.remove(t.portalPanelSettings.transportCounterApiUrl),t.portalPanelSettings.transportCounterBalanceUrl=n.remove(t.portalPanelSettings.transportCounterBalanceUrl),t.portalPanelSettings.transportCounterCompanyCode=n.remove(t.portalPanelSettings.transportCounterCompanyCode),t.portalPanelSettings.transportCounterPassword=n.remove(t.portalPanelSettings.transportCounterPassword),t.portalPanelSettings.transportCounterProjectUrl=n.remove(t.portalPanelSettings.transportCounterProjectUrl),t.portalPanelSettings.transportCounterTokenUrl=n.remove(t.portalPanelSettings.transportCounterTokenUrl),t.portalPanelSettings.transportCounterUsername=n.remove(t.portalPanelSettings.transportCounterUsername),t.portalPanelSettings.PK=n.remove(t.portalPanelSettings.PK)),l=angular.copy(t),e.$broadcast("$welcomeInit.onSuccess"),o.isSuccessData=!0,null!==l.refLoginInfo&&void 0!==l.refLoginInfo&&""!==l.refLoginInfo&&(o.refLoginInfo=l.refLoginInfo),o.isFlexActive=l.isFlexActive}}):t.get("welcome/init",r,function(t){t.portalMenus.length>0&&angular.forEach(t.portalMenus,function(e){e.code=n.remove(e.code),e.tawkCode=n.remove(e.tawkCode),e.product=n.remove(e.product)}),null!==t.tawkSettings&&""!==t.tawkSettings&&(t.tawkSettings.tawkWidgetCode=n.remove(t.tawkSettings.tawkWidgetCode),t.tawkSettings.tawkWidgetOption=n.remove(t.tawkSettings.tawkWidgetOption)),null!==t.portalPanelSettings&&""!==t.portalPanelSettings&&(t.portalPanelSettings.staffCode=n.remove(t.portalPanelSettings.staffCode),t.portalPanelSettings.staffName=n.remove(t.portalPanelSettings.staffName),t.portalPanelSettings.transportCounterAgencyCode=n.remove(t.portalPanelSettings.transportCounterAgencyCode),t.portalPanelSettings.transportCounterApiUrl=n.remove(t.portalPanelSettings.transportCounterApiUrl),t.portalPanelSettings.transportCounterBalanceUrl=n.remove(t.portalPanelSettings.transportCounterBalanceUrl),t.portalPanelSettings.transportCounterCompanyCode=n.remove(t.portalPanelSettings.transportCounterCompanyCode),t.portalPanelSettings.transportCounterPassword=n.remove(t.portalPanelSettings.transportCounterPassword),t.portalPanelSettings.transportCounterProjectUrl=n.remove(t.portalPanelSettings.transportCounterProjectUrl),
t.portalPanelSettings.transportCounterTokenUrl=n.remove(t.portalPanelSettings.transportCounterTokenUrl),t.portalPanelSettings.transportCounterUsername=n.remove(t.portalPanelSettings.transportCounterUsername),t.portalPanelSettings.PK=n.remove(t.portalPanelSettings.PK)),l=angular.copy(t),e.$broadcast("$welcomeInit.onSuccess"),o.isSuccessData=!0,null!==l.refLoginInfo&&void 0!==l.refLoginInfo&&""!==l.refLoginInfo&&(o.refLoginInfo=l.refLoginInfo),o.isFlexActive=l.isFlexActive})}},o.onCreateFilter=function(n,a){n.portalMenuId=n.portalMenuId?n.portalMenuId:null,n.portalPageId=n.portalPageId?n.portalPageId:null,n.portalWidgetId=n.portalWidgetId?n.portalWidgetId:null,n.resolution=o.getResolution(),o.filterQuery=n;var i=d();null==i?t.get("welcome/filter/init",n,function(t){var i=angular.copy(t);u.push({filterQuery:n,responseObject:i}),s=i,e.$broadcast("$welcomeFilterInit.onSuccess"),"function"==typeof a&&a()}):(s=i,e.$broadcast("$welcomeFilterInit.onSuccess"),"function"==typeof a&&a())},o.getQuotationSettings=function(e){t.get("quotation/settings",{},function(t){c=angular.copy(t),"function"==typeof e&&e()})},o.getMenus=function(){var e=l.portalMenus;return angular.forEach(e,function(t){angular.forEach(e,function(e){t.id==e.parent&&(t.isSubExists=!0)})}),e},o.getMenuProducts=function(){var e=l.portalMenus;return angular.forEach(e,function(t){angular.forEach(e,function(e){t.id==e.parent&&(t.isSubExists=!0)})}),e},o.getMenuStyles=function(){return l.portalMenuStyles},o.getCompanies=function(){return l.portalCompanies},o.getDynamicContent=function(){return l.dynamicContent},o.getLanguages=function(){return l.languages},o.getLanguageList=function(){return l.languages.languageList},o.getLangCode=function(){return l.languages.langCode},o.getCompanyDetail=function(){return l.companyDetail},o.getPanelSettings=function(){return l?l.portalPanelSettings:null},o.getQuotationCriterias=function(){return c.quotationCriterias},o.getWebsiteSettings=function(){return l.contactWebsite},o.getRootSettings=function(){return l.rootSettings},o.getFormParameters=function(){return c.formParameters},o.getTawkSettings=function(){return l.tawkSettings},o.getBannersSettings=function(){var e={};return angular.forEach(r,function(t){var n=s.bannersSettings.find(function(e){return e.kategori===t});n?(n.duration=0===n.duration?4e3:n.duration,n.transitionDuration=0===n.transitionDuration?1500:n.transitionDuration,n.defaultBackground=null!==n.siteUrl?n.siteUrl+n.defaultLocation:"/content/assets/media/bg/bg-default.jpg",n.isViewBannerMobil=null!==n.isViewBannerMobil&&n.isViewBannerMobil,n.isViewBannerTablet=null!==n.isViewBannerTablet&&n.isViewBannerTablet,n.isViewBannerDesktop=null!==n.isViewBannerDesktop&&n.isViewBannerDesktop,n.isViewOnInsuredPanel=null===n.isViewOnInsuredPanel||n.isViewOnInsuredPanel,n.isViewNavigation=null!==n.isViewNavigation&&n.isViewNavigation,n.isStopLoop=null!==n.isStopLoop&&n.isStopLoop,n.height=0==n.height?500:n.height,n.heightMobile=0==n.heightMobile?400:n.heightMobile,n.heightTablet=0==n.heightTablet?400:n.heightTablet,e[t]=n):e[t]={transition:"fade",transitionDuration:1500,duration:4e3,defaultBackground:"/content/assets/media/bg/bg-default.jpg",isViewBannerMobil:!0,isViewBannerTablet:!0,isViewBannerDesktop:!0,isViewOnInsuredPanel:!0,isStopLoop:!1,height:500,heightMobile:400,heightTablet:400,isViewNavigation:!1}}),e},o.getBoxesBannersSettings=function(){var e={},t=s.bannersSettings.find(function(e){return"BOXES"===e.kategori});return t?(t.duration=0===t.duration?4e3:t.duration,t.transitionDuration=0===t.transitionDuration?1500:t.transitionDuration,t.defaultBackground=null!==t.siteUrl?t.siteUrl+t.defaultLocation:"/content/assets/media/bg/bg-default.jpg",t.isViewBannerMobil=null!==t.isViewBannerMobil&&t.isViewBannerMobil,t.isViewBannerTablet=null!==t.isViewBannerTablet&&t.isViewBannerTablet,t.isViewBannerDesktop=null!==t.isViewBannerDesktop&&t.isViewBannerDesktop,t.isViewOnInsuredPanel=null===t.isViewOnInsuredPanel||t.isViewOnInsuredPanel,t.isViewNavigation=null!==t.isViewNavigation&&t.isViewNavigation,t.isStopLoop=null!==t.isStopLoop&&t.isStopLoop,t.height=0==t.height?500:t.height,t.heightMobile=0==t.heightMobile?400:t.heightMobile,t.heightTablet=0==t.heightTablet?400:t.heightTablet,e.BOXES=t):e.BOXES={transition:"fade",transitionDuration:1500,duration:4e3,defaultBackground:"/content/assets/media/bg/bg-default.jpg",isViewBannerMobil:!0,isViewBannerTablet:!0,isViewBannerDesktop:!0,isViewOnInsuredPanel:!0,isStopLoop:!1,height:500,heightMobile:400,heightTablet:400,isViewNavigation:!1},e},o.getStyleSettings=function(){return l.portalStyleSettings&&(l.portalStyleSettings.headerColor=l.portalStyleSettings.headerColor?l.portalStyleSettings.headerColor:"#fff"),l.portalStyleSettings},o.getHeaderStyle=function(){var e=l.headerStyle;return 0==e.isViewTopHeader&&(e.topHeaderHeightDesktop=0,e.topHeaderHeightMobile=0,e.topHeaderHeightTablet=0),l.headerStyle},o.getHeaderSettings=function(){return l.headerSettings.length>0?l.headerSettings:m()},o.getHeaderControl=function(){var e={desktop:{hasRight:!1,hasLeft:!1,hasCenter:!1},tablet:{hasRight:!1,hasLeft:!1,hasCenter:!1},mobile:{hasRight:!1,hasLeft:!1,hasCenter:!1}};if(l.headerSettings.length>0){for(var t in e)if("desktop"===t){var n=l.headerSettings.find(function(e){return"RIGHT"===e.placement&&"DESKTOP"===e.resolution});e[t].hasRight=!!n;var a=l.headerSettings.find(function(e){return"LEFT"===e.placement&&"DESKTOP"===e.resolution});e[t].hasLeft=!!a;var i=l.headerSettings.find(function(e){return"CENTER"===e.placement&&"DESKTOP"===e.resolution});e[t].hasCenter=!!i}else if("tablet"===t){var n=l.headerSettings.find(function(e){return"RIGHT"===e.placement&&"TABLET"===e.resolution});e[t].hasRight=!!n;var a=l.headerSettings.find(function(e){return"LEFT"===e.placement&&"TABLET"===e.resolution});e[t].hasLeft=!!a;var i=l.headerSettings.find(function(e){return"CENTER"===e.placement&&"TABLET"===e.resolution});e[t].hasCenter=!!i}else{var n=l.headerSettings.find(function(e){return"RIGHT"===e.placement&&"MOBİLE"===e.resolution});e[t].hasRight=!!n;var a=l.headerSettings.find(function(e){return"LEFT"===e.placement&&"MOBİLE"===e.resolution});e[t].hasLeft=!!a;var i=l.headerSettings.find(function(e){return"CENTER"===e.placement&&"MOBİLE"===e.resolution});e[t].hasCenter=!!i}return e}return{desktop:{hasRight:!0,hasLeft:!0,hasCenter:!0},tablet:{hasRight:!0,hasLeft:!0,hasCenter:!0},mobile:{hasRight:!0,hasLeft:!0,hasCenter:!0}}},o.getTopHeaderSettings=function(){return l.topHeaderSettings.length>0?l.topHeaderSettings:f()},o.getTopHeaderControl=function(){var e={desktop:{hasRight:!1,hasLeft:!1,hasCenter:!1},tablet:{hasRight:!1,hasLeft:!1,hasCenter:!1},mobile:{hasRight:!1,hasLeft:!1,hasCenter:!1}};if(l.topHeaderSettings.length>0){for(var t in e)if("desktop"===t){var n=l.topHeaderSettings.find(function(e){return"RIGHT"===e.placement&&"DESKTOP"===e.resolution});e[t].hasRight=!!n;var a=l.topHeaderSettings.find(function(e){return"LEFT"===e.placement&&"DESKTOP"===e.resolution});e[t].hasLeft=!!a;var i=l.topHeaderSettings.find(function(e){return"CENTER"===e.placement&&"DESKTOP"===e.resolution});e[t].hasCenter=!!i}else if("tablet"===t){var n=l.topHeaderSettings.find(function(e){return"RIGHT"===e.placement&&"TABLET"===e.resolution});e[t].hasRight=!!n;var a=l.topHeaderSettings.find(function(e){return"LEFT"===e.placement&&"TABLET"===e.resolution});e[t].hasLeft=!!a;var i=l.topHeaderSettings.find(function(e){return"CENTER"===e.placement&&"TABLET"===e.resolution});e[t].hasCenter=!!i}else{var n=l.topHeaderSettings.find(function(e){return"RIGHT"===e.placement&&"MOBİLE"===e.resolution});e[t].hasRight=!!n;var a=l.topHeaderSettings.find(function(e){return"LEFT"===e.placement&&"MOBİLE"===e.resolution});e[t].hasLeft=!!a;var i=l.topHeaderSettings.find(function(e){return"CENTER"===e.placement&&"MOBİLE"===e.resolution});e[t].hasCenter=!!i}return e}return{desktop:{hasRight:!0,hasLeft:!0,hasCenter:!0},tablet:{hasRight:!0,hasLeft:!0,hasCenter:!0},mobile:{hasRight:!0,hasLeft:!0,hasCenter:!0}}},o.getQuickLinks=function(){return s.quickLinks},o.getBanners=function(){return s.portalBanners},o.getSeoSettings=function(){return angular.forEach(s.seoSettings,function(e){e.siteUrl&&(e.ogImage=e.siteUrl+e.ogImage,e.twitterImage=e.siteUrl+e.twitterImage)}),s.seoSettings},o.getReCaptchaKeys=function(){return l.portalPanelSettings.PK},o.getAnnouncements=function(){return s.announcements};var d=function(){var e=null,t=o.filterQuery;return null!=t&&angular.forEach(u,function(n){t.portalMenuId==n.filterQuery.portalMenuId&&t.portalPageId==n.filterQuery.portalPageId&&t.portalWidgetId==n.filterQuery.portalWidgetId&&t.viewLocation==n.filterQuery.viewLocation&&(e=n.responseObject)}),e},m=function(){var e=[{type:"LOGO",placement:"LEFT",order:1,resolution:"DESKTOP"},{type:"LOGO",placement:"LEFT",order:1,resolution:"TABLET"},,{type:"LOGO",placement:"LEFT",order:1,resolution:"MOBİLE"},{type:"MENU",placement:"RIGHT",order:1,resolution:"DESKTOP"}],t=[];return angular.forEach(e,function(e){t.push({headerType:"HEADER",order:e.order,placement:e.placement,resolution:e.resolution,style:"STYLE-1",type:e.type})}),t},f=function(){var e=[{type:"GSM",placement:"LEFT",order:1,resolution:"DESKTOP"},{type:"WHATSAPP_NO",order:2,placement:"LEFT",resolution:"DESKTOP"},{type:"ANNOUNCEMENTS",order:3,placement:"CENTER",resolution:"DESKTOP"},{type:"LANGUAGE_SELECT",order:4,placement:"RIGHT",resolution:"DESKTOP"},{type:"USER_OPERATIONS",order:5,placement:"RIGHT",resolution:"DESKTOP"},{type:"GSM",placement:"LEFT",order:1,resolution:"TABLET"},{type:"WHATSAPP_NO",order:2,placement:"LEFT",resolution:"TABLET"},{type:"ANNOUNCEMENTS",order:3,placement:"CENTER",resolution:"TABLET"},{type:"USER_OPERATIONS",order:5,placement:"RIGHT",resolution:"TABLET"},{type:"GSM",placement:"LEFT",order:1,resolution:"MOBİLE"},{type:"USER_OPERATIONS",order:5,placement:"RIGHT",resolution:"MOBİLE"}],t=[];return angular.forEach(e,function(e){t.push({headerType:"TOP_HEADER",order:e.order,placement:e.placement,resolution:e.resolution,style:"STYLE-1",type:e.type})}),t};return o.getFormStyles=function(){return c.portalFormStyles},o.getResolution=function(){var e="desktop";return i.innerWidth<768&&(e="mobile"),i.innerWidth>767&&i.innerWidth<1024&&(e="tablet"),e},o.init=function(){o.onCreate()},o.init(),o}]),app.factory("$tia",["$culture","$helpers","$currency",function(e,t,n){var a={};a.groupBy=function(t,a){var i,o={},r=[],l={};return angular.forEach(t,function(t){if(30===t.Tip||31===t.Tip||60===t.Tip||70===t.Tip){var l=t.ListItems.find(function(e){return 1===e.IsNull});void 0===l?t.ListItems.unshift({ID:null,Ad:e.translate("SEÇİNİZ")}):l.ID=null}20!==t.Tip&&21!==t.Tip||(t.Deger=n.toInput(t.Deger)),i=t.Grup,""===i&&(i="Genel "+a),void 0===o[i]&&(o[i]=[],r[t.GSira]=i),o[i].push(t)}),angular.forEach(r,function(e){l[e]=o[e]}),o};var i=function(e,n,a){angular.forEach(a,function(a,i){e.push({title:i,slug:t.slugify(i),type:n,elements:a})})};return a.build=function(e,t){var n=[];return i(n,"teminat",a.groupBy(t.Teminat,"Teminatlar")),i(n,"indirim",a.groupBy(t.Indirim,"Indirimler")),i(n,"aciklama",a.groupBy(t.Aciklama,"Açıklamalar")),angular.forEach(n,function(t){angular.forEach(t.elements,function(n){var a={Tip:n.Tip,TeminatID:n.Id,Deger:n.Deger,Aciklama:n.Aciklama,Varmi:n.Varmi,WQV:n.WQV,ListItem:n.NesneDeger};if(a.ListItem>0){void 0===n.ListItems.find(function(e){return e.ID===a.ListItem})&&(a.ListItem=null)}0===a.ListItem&&(a.ListItem=null),0===a.Deger&&(a.Deger=null),null!==e&&(e._tia[t.type][n.Id]=a)})}),n},a.buildPolicyList=function(e,t){var n=[];return i(n,"teminat",a.groupBy(t,"Teminatlar")),angular.forEach(n,function(t){angular.forEach(t.elements,function(n){var a={Tip:n.Tip,TeminatID:n.Id,Deger:n.Deger,Aciklama:n.Aciklama,Varmi:n.Varmi,WQV:n.WQV,ListItem:n.NesneDeger};if(a.ListItem>0){void 0===n.ListItems.find(function(e){return e.ID===a.ListItem})&&(a.ListItem=null)}0===a.ListItem&&(a.ListItem=null),0===a.Deger&&(a.Deger=null),null!==e&&(e._tia[t.type][n.Id]=a)})}),n},a.executeCondition=function(e,t){var n=[">","<","<>","=",">=","<="],a=null;if(angular.forEach(n,function(t){e.indexOf(t)>-1&&(a=t)}),0==t)return!0;var i=parseFloat(e.toString().replace(a,""));switch(a){case">":return t>i;case"<":return t<i;case"<>":return t!==i;case"=":return t===i;case">=":return t>=i;case"<=":return t<=i;default:return!0}},a}]),app.controller("WSAddress.ModalController",["$scope","$rest","$uibModalInstance","$culture","$timeout","$filter","$alert",function(e,t,n,a,i,o,r){e.data=n.data,e.isLoading=!1,e.isLoadingCities=!1,e.Ilceler=[],e.Beldeler=[],e.Mahalleler=[],e.Sokaklar=[],e.Binalar=[],e.Daireler=[],e.form={Sehir:null,Ilce:null,Belde:null,Mahalle:null,Sokak:null,Bina:null,Daire:null},e.cancel=function(){n.dismiss("cancel"),"function"==typeof n.onCancel&&n.onCancel(),void 0!==window.Tawk_API&&"function"==typeof window.Tawk_API.showWidget&&window.Tawk_API.showWidget()},e.getIlceler=function(){e.isLoading=!0,i(function(){var n={pKod:e.form.Sehir.Kod};t.post("webservice/adres/ilce",n,function(t){e.Ilceler=t.result.return.Liste,e.Ilceler=o("orderBy")(e.Ilceler,"Aciklama"),e.Ilceler.unshift({Kod:null,Aciklama:a.translate("SEÇİNİZ")}),e.form.Ilce=e.Ilceler[0],e.isLoading=!1},function(){e.isLoading=!1},null,null,!0)},50)},e.getBeldeler=function(){e.isLoading=!0,i(function(){var n={pKod:e.form.Ilce.Kod};t.post("webservice/adres/belde",n,function(t){e.Beldeler=t.result.return.Liste,e.Beldeler=o("orderBy")(e.Beldeler,"Aciklama"),e.form.Belde=e.Beldeler[0],e.isLoading=!1,1===t.result.return.Liste.length?e.getMahalleler():(e.Beldeler.unshift({Kod:null,Aciklama:a.translate("SEÇİNİZ")}),e.form.Belde=e.Beldeler[0])},function(){e.isLoading=!1},null,null,!0)},50)},e.getMahalleler=function(){e.isLoading=!0,i(function(){var n={pKod:e.form.Belde.Kod};t.post("webservice/adres/mahalle",n,function(t){e.Mahalleler=t.result.return.Liste,e.Mahalleler=o("orderBy")(e.Mahalleler,"Aciklama"),e.form.Mahalle=e.Mahalleler[0],e.isLoading=!1,1===t.result.return.Liste.length?e.getSokaklar():(e.Mahalleler.unshift({Kod:null,Aciklama:a.translate("SEÇİNİZ")}),e.form.Mahalle=e.Mahalleler[0])},function(){e.isLoading=!1},null,null,!0)},50)},e.getSokaklar=function(){e.isLoading=!0,i(function(){var n={pKod:e.form.Mahalle.Kod};t.post("webservice/adres/sokak",n,function(t){e.Sokaklar=t.result.return.Liste,e.Sokaklar=o("orderBy")(e.Sokaklar,"Aciklama"),e.form.Sokak=e.Sokaklar[0],e.isLoading=!1,1===t.result.return.Liste.length?e.getBinalar():(e.Sokaklar.unshift({Kod:null,Aciklama:a.translate("SEÇİNİZ")}),e.form.Sokak=e.Sokaklar[0])},function(){e.isLoading=!1},null,null,!0)},50)},e.getBinalar=function(){e.isLoading=!0,i(function(){var n={pKod:e.form.Sokak.Kod};t.post("webservice/adres/bina",n,function(t){e.Binalar=t.result.return.Liste,e.Binalar=o("orderBy")(e.Binalar,"BinaNo"),e.form.Bina=e.Binalar[0],e.isLoading=!1,1===t.result.return.Liste.length?e.getDaireler():(e.Binalar.unshift({Kod:null,Aciklama:a.translate("SEÇİNİZ"),BinaNo:a.translate("SEÇİNİZ")}),e.form.Bina=e.Binalar[0])},function(){e.isLoading=!1},null,null,!0)},50)},e.getDaireler=function(){e.isLoading=!0,i(function(){var n={pKod:e.form.Bina.Kod};t.post("webservice/adres/daire",n,function(t){if(1==t.result.return.HataKodu)return r.info(a.translate("Seçilen Bina içinde kayıtlı adres bulunamadı. Lütfen Seçimlerinizi kontrol edin.")),void(e.isLoading=!1);e.Daireler=t.result.return.Liste,e.isLoading=!1,1===t.result.return.Liste.length?e.form.Daire=e.Daireler[0]:(e.Daireler.unshift({Kod:null,DaireNo:a.translate("SEÇİNİZ")}),e.form.Daire=e.Daireler[0])},function(){e.isLoading=!1},null,null,!0)},50)},e.onCreate=function(){e.isLoadingCities=!0,t.post("webservice/adres/il",{},function(t){e.Sehirler=t.result.return.Liste,e.Sehirler.unshift({Kod:null,Aciklama:a.translate("SEÇİNİZ")}),e.form.Sehir=e.Sehirler[0],e.isLoadingCities=!1},function(){e.isLoadingCities=!1},null,null,!0),void 0!==window.Tawk_API&&"function"==typeof window.Tawk_API.hideWidget&&window.Tawk_API.hideWidget()},e.saveDask=function(){var t={IlKod:e.form.Sehir.Kod,IlceKod:e.form.Ilce.Kod,BeldeAd:e.form.Belde.Aciklama,Mahalle:e.form.Mahalle.Aciklama,CSBMAd:e.form.Sokak.Aciklama,BinaNo:e.form.Bina.BinaNo,DaireNo:e.form.Daire.DaireNo,IlceAd:e.form.Ilce.Aciklama,IlAd:e.form.Sehir.Aciklama,AdresNo:e.form.Daire.UAVT};e.data.onAddressSuccess(t),e.cancel()},e.onCreate()}]),app.controller("Mail.QuotationModalController",["$scope","$uibModalInstance","$rest","$filter","$welcomeInit","$sce","$rootScope","$alert","$culture",function(e,t,n,a,i,o,r,l,s){e.data=t.data,e.welcomeInit=i,e.isCompared=!1,e.form={EMail:null},e.success=function(){e.data.onSuccess(e.form.EMail),t.dismiss("cancel")},e.cancel=function(){t.dismiss("cancel")},e.checkIfMailValid=function(){angular.element("#InputEMail").hasClass("form-error")||null===e.form.EMail?l.error(s.translate("Girilen mail adresi geçersiz..!")):e.success()}}]),app.controller("Preferences.QuotationModalController",["$scope","$uibModalInstance","$rest","$filter","$insured","$location","$sce","$http","$handcuff","$alert","$culture","$modal","$boxesInit","$welcomeInit",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f){e.data=t.data,e.sirket=t.data.sirket,e.activeMenu=t.data.activeMenu,e.insuredData=i.getActiveInsured(),e.isInformationTextDocumentExist=!1,e.isDefaultInformationTextDocumentExist=!1,e.welcomeInit=f,e.onCreate=function(){var t=e.data.data;e.completedAll=!0,e.min1Teklif=!1;var i={pAnaBrans:t.detail.satir.anabrans,pAraBrans:t.detail.satir.arabrans,pPoliID:t.pPoliID,pTip:t.pTip,pTeklifID:t.detail.teklif.selected.id,pSirketler:[e.sirket.skod]};try{parseInt(e.sirket.teklif_id)>0&&(i.pTeklifID=e.sirket.teklif_id)}catch(e){}n.post("sales/operations/comparison",i,function(n){null!==n.sirketler&&""!==n.sirketler&&angular.forEach(n.sirketler,function(e){e.skod=s.remove(e.skod),e.abs_aciklama=s.remove(e.abs_aciklama),e.aciklama=s.remove(e.aciklama),e.id=s.remove(e.id),e.panatalikom=s.remove(e.panatalikom),e.pkom=s.remove(e.pkom),e.policeno=s.remove(e.policeno),e.sirketadi=s.remove(e.sirketadi),e.tanatalikom=s.remove(e.tanatalikom),e.ptalikom=s.remove(e.ptalikom),e.teklifno=s.remove(e.teklifno),e.teklifno_psn=s.remove(e.teklifno_psn),e.ttutar=s.remove(e.ttutar),e.ttalikom=s.remove(e.ttalikom),e.kullanici=s.remove(e.kullanici),e.ptutar=s.remove(e.ptutar),e.tkom=s.remove(e.tkom),e.tsk=s.remove(e.tsk),e.tvneden=s.remove(e.tvneden)}),null!==n.tablo.TeminatTablo&&""!==n.tablo.TeminatTablo&&angular.forEach(n.tablo.TeminatTablo,function(e){e.Aciklama=s.remove(e.Aciklama),e.Deger=s.remove(e.Deger),e.Grup_Adi=s.remove(e.Grup_Adi),e.SirketAdi=s.remove(e.SirketAdi),e.SirketKodu=s.remove(e.SirketKodu),e.TIA_Aciklama=s.remove(e.TIA_Aciklama),e.TIA_Adi=s.remove(e.TIA_Adi)}),null!==n.tablo.IndirimTablo&&""!==n.tablo.IndirimTablo&&angular.forEach(n.tablo.IndirimTablo,function(e){e.Aciklama=s.remove(e.Aciklama),e.Deger=s.remove(e.Deger),e.Grup_Adi=s.remove(e.Grup_Adi),e.SirketAdi=s.remove(e.SirketAdi),e.SirketKodu=s.remove(e.SirketKodu),e.TIA_Aciklama=s.remove(e.TIA_Aciklama),e.TIA_Adi=s.remove(e.TIA_Adi)}),null!==n.tablo.AciklamaTablo&&""!==n.tablo.AciklamaTablo&&angular.forEach(n.tablo.AciklamaTablo,function(e){e.Aciklama=s.remove(e.Aciklama),e.Deger=s.remove(e.Deger),e.Grup_Adi=s.remove(e.Grup_Adi),e.SirketAdi=s.remove(e.SirketAdi),e.SirketKodu=s.remove(e.SirketKodu),e.TIA_Aciklama=s.remove(e.TIA_Aciklama),e.TIA_Adi=s.remove(e.TIA_Adi)}),t.table={length:{column:0},columns:{},groups:{TeminatTablo:[],IndirimTablo:[],AciklamaTablo:[]}};var i=n;e.min1Teklif=!1,angular.forEach(i.sirketler,function(e){e.floatPtutar=parseFloat(e.ptutar)}),i.sirketler=a("orderBy")(i.sirketler,t.selectedOption),angular.forEach(i.sirketler,function(n){(parseFloat(n.ptutar)>0||parseFloat(n.ttutar)>0)&&(t.table.length.column++,n.ptutar=n.ptutar,n.ttutar=n.ttutar,t.table.columns[n.skod]=n),n.completed=!1,(n.aciklama.toString().length>0||parseFloat(n.tvnedenid)>0||parseFloat(n.ptutar)>0||parseFloat(n.ttutar)>0)&&(n.completed=!0),(parseFloat(n.ptutar)>0||parseFloat(n.ttutar)>0)&&(e.min1Teklif=!0),!1===n.completed&&(e.completedAll=!1)}),e.setGroups(i.tablo.TeminatTablo,"TeminatTablo",t),e.setGroups(i.tablo.IndirimTablo,"IndirimTablo",t),e.setGroups(i.tablo.AciklamaTablo,"AciklamaTablo",t),e.loaded=!0,e.boxesData=m.getBoxes(e.activeMenu.id),e.portalPanelSettings=e.welcomeInit.getPanelSettings(),angular.forEach(e.welcomeInit.getMenus(),function(n){if(t.detail.satir.arabrans===n.product&&1===n.presentation&&n.portalDetailsMenu&&(e.menuPresentationDesc=n.portalDetailsMenu.presentationDesc,e.isMenuPresentationDesc=!(!e.menuPresentationDesc&&""===e.menuPresentationDesc)),"0"==t.detail.satir.tip&&t.detail.satir.arabrans!==n.product&&1===n.presentation){parseInt(n.main_product)-1==t.detail.satir.anabrans&&n.portalDetailsMenu&&(e.menuPresentationDesc=n.portalDetailsMenu.presentationDesc,e.isMenuPresentationDesc=!(!e.menuPresentationDesc&&""===e.menuPresentationDesc))}}),e.item=t,e.setFiles(),e.setInformationForms()})},e.setGroups=function(t,n,a){angular.forEach(t,function(t){if(void 0!==a.table.columns[t.SirketKodu]){var i=e.getOrCreateSection(n,t,a);e.getOrCreateElement(i,t,a).values[t.SirketKodu]={SirketAdi:t.SirketAdi,TIA_Tip:t.TIA_Tip,Deger:t.Deger,Aciklama:t.Aciklama,Tip:t.Tip,TIA_Aciklama:t.TIA_Aciklama,WQV:t.WQV}}})},e.getOrCreateSection=function(e,t,n){var a=!1;return angular.forEach(n.table.groups[e],function(e){e.Grup_Id===t.Grup_Id&&(a=e)}),!1===a&&(a={Grup_Id:t.Grup_Id,Grup_Adi:t.Grup_Adi,WQV:t.WQV,elements:[]},0===a.Grup_Adi.length&&(a.Grup_Adi="GENEL"),n.table.groups[e].push(a)),a},e.getOrCreateElement=function(e,t){var n=!1;return angular.forEach(e.elements,function(e){e.TIA_Id===t.TIA_Id&&(n=e)}),!1===n&&(n={TIA_Id:t.TIA_Id,TIA_Adi:t.TIA_Adi,WQV:t.WQV,values:{}},e.elements.push(n)),n},e.setFiles=function(){e.insuranceFile=[],angular.forEach(e.data.data.detail.dosyalar,function(t){t.skod===e.sirket.skod&&"4"==t.doctip&&e.insuranceFile.push(t)})},e.setInformationForms=function(){e.informationFormFile=[],null!==e.data.data.detail.dosyalar&&angular.forEach(e.data.data.detail.dosyalar,function(t){t.skod===e.sirket.skod&&"3"==t.doctip&&101==t.yer&&e.sirket.teklif_id==t.yerid&&(e.informationFormFile.push(t),e.isInformationTextDocumentExist=!0,e.isDefaultInformationTextDocumentExist=!1)}),!0!==e.isInformationTextDocumentExist&&null!==e.data.data.detail.forms&&angular.forEach(e.data.data.detail.forms,function(t){null!==t.siteUrl&&""!==t.siteUrl&&null!==t.pdfLocation&&""!==t.pdfLocation&&e.sirket.arabrans==t.product&&e.sirket.skod==t.skod&&(e.informationFormFile.push(t),e.isDefaultInformationTextDocumentExist=!0)})},e.generateFileURL=function(){var t=null,t=location.host,n=o.protocol()+"://"+t,a=n+"/content/uploads/temp-"+i.getActiveInsured().HesKod;return e.getFileURL(a)},e.getFileURL=function(e){return e+"-Pdf.pdf?time="+Number(new Date)},e.cancel=function(){t.dismiss("cancel")},e.downloadFile=function(t){l({url:"/api/sales/operations/file?pDosyaID="+t.id,method:"GET",responseType:"arraybuffer"}).then(function(a){var i=document.createElement("a");i.target="_blank",i.setAttribute("href",window.URL.createObjectURL(new Blob([a.data],{type:"application/octet-stream"}))),i.setAttribute("download",t.orjinalad);var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});try{navigator.userAgent.match("CriOS")?u.error(c.translate("Mobil tarayıcı (iOS/Chrome) PDF dosyalarını doğrudan indiremiyor. Lütfen farklı bir tarayıcı ile tekrar deneyin!")):i.dispatchEvent(o)}catch(e){i.dispatchEvent(o)}var r={pPoliID:e.data.data.pPoliID,skod:e.sirket.skod};n.post("q/d/d/wlg",r,function(){},null,null,null,!0)})},e.downloadFileFromURL=function(e){var t=document.createElement("a");t.target="_blank",t.setAttribute("href",e.siteUrl+e.pdfLocation),t.setAttribute("download",e.fileName);var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});try{navigator.userAgent.match("CriOS")?u.error(c.translate("Mobil tarayıcı (iOS/Chrome) PDF dosyalarını doğrudan indiremiyor. Lütfen farklı bir tarayıcı ile tekrar deneyin!")):t.dispatchEvent(n)}catch(e){t.dispatchEvent(n)}},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return r.trustAsHtml(e)},e.openPaymentModal=function(t){return"1"==t.kk_3d?void d.open("/content/views/secure-payment-modal.html","SecurePayment.ModalController",function(n){n.data={sirket:t,quotationContent:e.data.data,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,insuredData:e.insuredData,activeMenu:e.activeMenu,documents:e.data.data.detail.dosyalar,forms:e.data.data.detail.forms}},"xl"):"1"==t.kk_online?void d.open("/content/views/payment-modal.html","Payment.ModalController",function(n){n.data={sirket:t,quotationContent:e.data.data,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,insuredData:e.insuredData,activeMenu:e.activeMenu,documents:e.data.data.detail.dosyalar,forms:e.data.data.detail.forms}},"cml"):"1"==t.acik||"0"==t.kk_online&&"0"==t.kk_3d&&"0"==t.acik?void d.open("/content/views/payment-request-modal.html","PaymentRequest.ModalController",function(n){n.data={sirket:t,quotationContent:e.data.data,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,documents:e.data.data.detail.dosyalar,forms:e.data.data.detail.forms}},"cml"):void 0},e.openPaymentByParameter=function(n){t.dismiss("cancel"),e.data.onRedirectPaymentPage(n)},e.onCreate()}]),app.controller("Compare.QuotationModalController",["$scope","$uibModalInstance","$rest","$filter","$welcomeInit","$sce","$rootScope","$http","$alert","$culture","$modal","$timeout","$handcuff",function(e,t,n,a,i,o,r,l,s,u,c,d,m){e.data=t.data,e.boxesData=t.data.boxesData,e.activeMenu=t.data.menu,e.menuProductDetails=t.data.menuProductDetails,e.companiesInfo=t.data.companiesInfo,e.welcomeInit=i,e.isCompared=!1,e.selectedOption="floatPtutar",e.onCreate=function(){var t=e.data.data;e.completedAll=!0,e.min1Teklif=!1;var i=null;t.teklifSecimi=null,t.araBransAciklama=null,i=null!==e.data.selectedAraBrans&&void 0!==e.data.selectedAraBrans&&""!==e.data.selectedAraBrans?e.data.selectedAraBrans:t.detail.satir.arabrans,angular.forEach(e.data.data.detail.teklif.teklifler,function(e){e.arabrans==i&&(t.teklifSecimi=e.id,t.araBransAciklama=e.arabrans_adi)}),null==t.teklifSecimi&&(t.teklifSecimi=t.detail.teklif.selected.id),null==t.araBransAciklama&&(t.araBransAciklama=t.detail.satir.arabransaciklama);var o={pAnaBrans:t.detail.satir.anabrans,pAraBrans:i,pPoliID:t.pPoliID,pTip:t.pTip,pTeklifID:t.teklifSecimi};n.post("sales/operations/comparison",o,function(n){null!==n.sirketler&&""!==n.sirketler&&angular.forEach(n.sirketler,function(e){e.skod=m.remove(e.skod),e.abs_aciklama=m.remove(e.abs_aciklama),e.aciklama=m.remove(e.aciklama),e.id=m.remove(e.id),e.panatalikom=m.remove(e.panatalikom),e.pkom=m.remove(e.pkom),e.policeno=m.remove(e.policeno),e.sirketadi=m.remove(e.sirketadi),e.tanatalikom=m.remove(e.tanatalikom),e.ptalikom=m.remove(e.ptalikom),e.teklifno=m.remove(e.teklifno),e.teklifno_psn=m.remove(e.teklifno_psn),e.ttutar=m.remove(e.ttutar),e.ttalikom=m.remove(e.ttalikom),e.kullanici=m.remove(e.kullanici),e.ptutar=m.remove(e.ptutar),e.tkom=m.remove(e.tkom),e.tsk=m.remove(e.tsk),e.tvneden=m.remove(e.tvneden)}),null!==n.tablo.TeminatTablo&&""!==n.tablo.TeminatTablo&&angular.forEach(n.tablo.TeminatTablo,function(e){e.Aciklama=m.remove(e.Aciklama),e.Deger=m.remove(e.Deger),e.Grup_Adi=m.remove(e.Grup_Adi),e.SirketAdi=m.remove(e.SirketAdi),e.SirketKodu=m.remove(e.SirketKodu),e.TIA_Aciklama=m.remove(e.TIA_Aciklama),e.TIA_Adi=m.remove(e.TIA_Adi)}),null!==n.tablo.IndirimTablo&&""!==n.tablo.IndirimTablo&&angular.forEach(n.tablo.IndirimTablo,function(e){e.Aciklama=m.remove(e.Aciklama),e.Deger=m.remove(e.Deger),e.Grup_Adi=m.remove(e.Grup_Adi),e.SirketAdi=m.remove(e.SirketAdi),e.SirketKodu=m.remove(e.SirketKodu),e.TIA_Aciklama=m.remove(e.TIA_Aciklama),e.TIA_Adi=m.remove(e.TIA_Adi)}),null!==n.tablo.AciklamaTablo&&""!==n.tablo.AciklamaTablo&&angular.forEach(n.tablo.AciklamaTablo,function(e){e.Aciklama=m.remove(e.Aciklama),e.Deger=m.remove(e.Deger),e.Grup_Adi=m.remove(e.Grup_Adi),e.SirketAdi=m.remove(e.SirketAdi),e.SirketKodu=m.remove(e.SirketKodu),e.TIA_Aciklama=m.remove(e.TIA_Aciklama),e.TIA_Adi=m.remove(e.TIA_Adi)}),t.table={length:{column:0},columns:{},groups:{TeminatTablo:[],IndirimTablo:[],AciklamaTablo:[]}};var i=n;e.min1Teklif=!1,i.sirketler=i.sirketler.filter(function(e){return parseFloat(e.ptutar)>0||parseFloat(e.ttutar)>0}),angular.forEach(i.sirketler,function(e){e.floatPtutar=parseFloat(e.ptutar),e.floatTtutar=parseFloat(e.ttutar)}),"INSTALLMENT"===e.activeMenu.priceSort&&null!==e.activeMenu.priceSort&&void 0!==e.activeMenu.priceSort&&""!==e.activeMenu.priceSort&&(e.selectedOption="floatTtutar"),"CASH"===e.activeMenu.priceSort&&null!==e.activeMenu.priceSort&&void 0!==e.activeMenu.priceSort&&""!==e.activeMenu.priceSort&&(e.selectedOption="floatPtutar"),i.sirketler=a("orderBy")(i.sirketler,"sirketadi"),i.sirketler=a("orderBy")(i.sirketler,e.selectedOption),angular.forEach(e.menuProductDetails,function(t){angular.forEach(i.sirketler,function(n){angular.forEach(e.companiesInfo,function(e){n.tsk==e.tramerCode&&t.companyId===e.id&&n.arabrans==t.product&&(n.orderOfCompanyToShow=t.orderOfCompanyToShow)})})}),i.sirketler=i.sirketler.filter(function(e,t){return 0!==e.orderOfCompanyToShow&&void 0!==e.orderOfCompanyToShow?t<e.orderOfCompanyToShow:e}),0!==e.activeMenu.numberOfCompaniesToShow&&null!==e.activeMenu.numberOfCompaniesToShow&&void 0!==e.activeMenu.numberOfCompaniesToShow&&""!==e.activeMenu.numberOfCompaniesToShow&&(i.sirketler=a("limitTo")(i.sirketler,parseInt(e.activeMenu.numberOfCompaniesToShow))),angular.forEach(i.sirketler,function(n){(parseFloat(n.ptutar)>0||parseFloat(n.ttutar)>0)&&(t.table.length.column++,n.ptutar=n.ptutar,n.ttutar=n.ttutar,t.table.columns[n.skod]=n),n.completed=!1,(n.aciklama.toString().length>0||parseFloat(n.tvnedenid)>0||parseFloat(n.ptutar)>0||parseFloat(n.ttutar)>0)&&(n.completed=!0),(parseFloat(n.ptutar)>0||parseFloat(n.ttutar)>0)&&(e.min1Teklif=!0),!1===n.completed&&(e.completedAll=!1)}),e.setGroups(i.tablo.TeminatTablo,"TeminatTablo",t),e.setGroups(i.tablo.IndirimTablo,"IndirimTablo",t),e.setGroups(i.tablo.AciklamaTablo,"AciklamaTablo",t),e.loaded=!0,angular.forEach(t.table.columns,function(t){angular.forEach(e.data.data.detail.teklif.sirketler,function(e){e.floatPtutar=parseFloat(e.ptutar),t.skod==e.skod&&(t.companyLogo=e.companyLogo,t.isHideCompanyInformation=e.isHideCompanyInformation)})}),angular.forEach(t.table.columns,function(t){angular.forEach(e.data.data.detail.teklif.sirketler,function(n){t.skod==n.skod&&(t.taksitText=e.getInstallmentCount(n.tablo.OdemeTipleri.odeme_tipleri,n.skod,n.ttutar).taksitText,t.taksitTutar=e.getInstallmentCount(n.tablo.OdemeTipleri.odeme_tipleri,n.skod,n.ttutar).taksitTutar,t.taksitAdet=e.getInstallmentCount(n.tablo.OdemeTipleri.odeme_tipleri,n.skod,n.ttutar).taksitAdet)})}),e.item=t,e.setLimits(),angular.forEach(e.item.table.columns,function(t){e.onSelectCompany(t)}),e.welcomeInit.isSuccessData?e.initData():r.$on("$welcomeInit.onSuccess",function(){e.initData()})})},e.setGroups=function(t,n,a){angular.forEach(t,function(t){if(void 0!==a.table.columns[t.SirketKodu]){var i=e.getOrCreateSection(n,t,a);e.getOrCreateElement(i,t,a).values[t.SirketKodu]={SirketAdi:t.SirketAdi,TIA_Tip:t.TIA_Tip,Deger:t.Deger,Aciklama:t.Aciklama,Tip:t.Tip,TIA_Aciklama:t.TIA_Aciklama}}})},e.getOrCreateSection=function(e,t,n){var a=!1;return angular.forEach(n.table.groups[e],function(e){e.Grup_Id===t.Grup_Id&&(a=e)}),!1===a&&(a={Grup_Id:t.Grup_Id,Grup_Adi:t.Grup_Adi,elements:[]},0===a.Grup_Adi.length&&(a.Grup_Adi="GENEL"),n.table.groups[e].push(a)),a},e.getOrCreateElement=function(e,t){var n=!1;return angular.forEach(e.elements,function(e){e.TIA_Id===t.TIA_Id&&(n=e)}),!1===n&&(n={TIA_Id:t.TIA_Id,TIA_Adi:t.TIA_Adi,WQV:t.WQV,values:{}},e.elements.push(n)),n},e.initData=function(t){var n=i;e.websiteSettings=n.getWebsiteSettings(),angular.forEach(n.getMenus(),function(t){
if(e.data.data.detail.satir.arabrans===t.product&&(e.data.data.detail.satir.arabransaciklama=t.portalDetailsMenu.title),"0"==e.data.data.detail.satir.tip&&e.data.data.detail.satir.arabrans!==t.product){var n=parseInt(t.main_product)-1;e.data.data.detail.satir.anabrans==n&&(e.data.data.detail.satir.arabransaciklama=t.portalDetailsMenu.title)}}),e.getCategories(e.boxesData),"function"==typeof t&&t()},e.cancel=function(){t.dismiss("cancel")},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return o.trustAsHtml(e)},e.getInstallmentCount=function(e,t,n){var i={taksitAdet:0,taksitText:"",taksitTutar:0},o=0,r=parseFloat(n),l=0;return void 0!==n&&null!==n&&""!==n&&(angular.forEach(e,function(e){e.skod==t&&parseInt(e.taksit_adedi)>1&&(o=e.taksit_adedi)}),l=r/o),l=a("serviceCurrency")(l),i.taksitAdet=parseInt(o),i.taksitTutar=parseInt(l),i.taksitText=l+" x "+o,i},e.onSelectCompany=function(t){null===t.isSelected||void 0===t.isSelected?t.isSelected=!0:t.isSelected=!t.isSelected,e.getSelectedCompanyCount()>e.limits.comparisonMax&&(t.isSelected=!1)},e.getSelectedCompanyCount=function(){var t=0;return null!==e.item&&void 0!==e.item&&angular.forEach(e.item.table.columns,function(e){e.isSelected&&t++}),t},e.setLimits=function(){var t="desktop";window.screen.width<768&&(t="mobile"),window.screen.width>767&&window.screen.width<1024&&(t="tablet"),e.limits={comparisonMin:1,comparisonMax:3},e.data.menu&&("desktop"===t&&(e.limits={comparisonMin:e.data.menu.comparisonDesktopMin,comparisonMax:e.data.menu.comparisonDesktopMax}),"tablet"===t&&(e.limits={comparisonMin:e.data.menu.comparisonTabletMin,comparisonMax:e.data.menu.comparisonTabletMax}),"mobile"===t&&(e.limits={comparisonMin:e.data.menu.comparisonMobileMin,comparisonMax:e.data.menu.comparisonMobileMax}))},e.downloadPdf=function(){var t=document.getElementById("html-object"),a=t.innerHTML.replace(/\n|\t/g," "),i={htmlContent:a,type:"download"};e.isDownloadPdf=!0,n.post("pdf/savehtml",i,function(t){"url"===i.type?window.open(t,"_blank"):l({url:"/api/pdf/compare?code="+t,method:"GET",responseType:"arraybuffer"}).then(function(t){e.isDownloadPdf=!1;var a=document.createElement("a");a.setAttribute("href",window.URL.createObjectURL(new Blob([t.data],{type:"application/pdf"}))),a.setAttribute("download",e.item.teklifSecimi);var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});try{navigator.userAgent.match("CriOS")?s.error(u.translate("Mobil tarayıcı (iOS/Chrome) PDF dosyalarını doğrudan indiremiyor. Lütfen farklı bir tarayıcı ile tekrar deneyin!")):a.dispatchEvent(i)}catch(e){a.dispatchEvent(i)}d(function(){n.post("pd/wlg",{},function(){},null,null,null,!0)})},function(){e.isDownloadPdf=!1,s.error(u.translate("PDF indirilirken bir hata oluştu. Lütfen daha sonra tekrar deneyin!"))})},function(){e.isDownloadPdf=!1})},e.changeComparison=function(){e.isCompared=!e.isCompared},e.getEncryptedAccountCode=function(e){return 11==e.length&&(e=e.substring(0,1)+"*********"+e.substring(10,11)),10==e.length&&(e=e.substring(0,1)+"********"+e.substring(9,10)),e},e.sendViaMail=function(){""!==e.data.insured.EMail&&null!==e.data.insured.EMail&&void 0!==e.data.insured.EMail?s.areYouSureWithMessage(u.translate("Karşılaştırma tablosu")+" <strong> "+e.data.insured.EMail+" </strong> "+u.translate("mail adresinize gönderilecek.")+" "+u.translate("İşlemi onaylıyor musunuz?"),function(){var t={email:e.data.insured.EMail,unvan:e.data.insured.Unvan,teklifNo:e.item.teklifSecimi};e.sendEmail(t)}):c.open("/content/views/quotation/email-modal.html","Mail.QuotationModalController",function(t){t.data={onSuccess:function(t){s.areYouSureWithMessage(u.translate("Karşılaştırma tablosu")+" <strong> "+t+" </strong> "+u.translate("mail adresinize gönderilecek.")+" "+u.translate("İşlemi onaylıyor musunuz?"),function(){var n={email:t,unvan:e.data.insured.Unvan,teklifNo:e.item.teklifSecimi};e.sendEmail(n)})}}})},e.sendEmail=function(e){var t=document.getElementById("html-object"),a=t.innerHTML.replace(/\n|\t/g," "),i={htmlContent:a,type:"download"};n.post("pdf/savehtml",i,function(t){e.code=t,n.post("pdf/compare/sendemail",e,function(){s.success(u.translate("Mail gönderildi. Gelen kutunuzu kontrol ediniz.")),d(function(){n.post("m/wlg",{},function(){},null,null,null,!0)})},function(){s.error(u.translate("PDF indirilirken bir hata oluştu. Lütfen daha sonra tekrar deneyin!"))})})},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=a("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.getOverflowTopWidth=function(){d(function(){var t;t=$(".scroll-bottom").width(),e.scrollTopWidth=t},500)},$(function(){$(".overflow-top").scroll(function(){$(".overflow-bottom").scrollLeft($(".overflow-top").scrollLeft())}),$(".overflow-bottom").scroll(function(){$(".overflow-top").scrollLeft($(".overflow-bottom").scrollLeft())})}),$(window).resize(function(){var t=$(".scroll-bottom").width();e.scrollTopWidth=t}),e.onCreate()}]),app.controller("Detail.QuotationController",["$scope","$location","$rootSettings","$rest","$state","$insured","$storage","$modal","$tia","$interval","$rootScope","$auth","$sce","$welcomeInit","$timeout","$filter","$culture","$alert","$boxesInit","$handcuff","$dateFormatter","$formValidations","$interval",function(e,t,n,a,i,o,r,l,s,u,c,d,m,f,p,g,v,k,h,y,I,S,u){e.data={},e.isLoggedIn=!1,e.isPaymentRequested=!1,e.isAutoRefresh=i.params.auto,e.isAutoRefreshed=!1,e.welcomeInit=f,e.isCompaniesLoading=!1,e.selects={},e.isWebLogSendOnPageOpen=!1,e.activeMenu=null,e._validator=S,e.prodStatusMessage=null,e.form={pPoliID:null,pTip:null,TaksitSayisi:1,PoliceTipi:1,Aciklama:null,Banka:null,Cvc:null,KartNo:null,KartSahibi:null,KartTipi:null,SonKulTar:null,GSM:null,ReferansKodu:null,KartSahibiTC:null,sonKulYil:null,sonKulAy:null,OdemeTipi:"1",SalesAgreement:"0",CreditCardAgreement:"0",PaymentSelection:null,InformationText:!1,Agreement:!1,InsuranceAgreement:!1,AraBransFilter:"ALL",OnlineOdemeSecenekKodu:"0",KartSahibiTC:null},e.isPrepared=!1,e.isMenuPresentationDesc=!1,e.isPageRendering=!0,e.isViewCounter=!0,e.styleSelection={quotation:null},e.isViewCashFirst=!0,e.isViewInstallmentFirst=!1,e.quotationDetailCardHeight=null,e.pdfDocuments={isInformationTextDocumentExist:!1,isDefaultInformationTextDocumentExist:!1,informationDocument:null,defaultInformationDocument:null},e.setActiveInsured=function(n){null!==o.getActiveInsured()?(e.isLoggedIn=!0,"function"==typeof n&&n()):a.get("application/init",{},function(t){null!==t.authenticated&&""!==t.authenticated&&(t.authenticated.HesapKodu=y.remove(t.authenticated.HesapKodu),t.authenticated.AdresNo=y.remove(t.authenticated.AdresNo),t.authenticated.Adres=y.remove(t.authenticated.Adres),t.authenticated.Email=y.remove(t.authenticated.Email),t.authenticated.GSM=y.remove(t.authenticated.GSM),t.authenticated.Unvan=y.remove(t.authenticated.Unvan),t.authenticated.UserName=y.remove(t.authenticated.UserName),t.authenticated.CustomerHesKod=y.remove(t.authenticated.CustomerHesKod),t.authenticated.DaireNo=y.remove(t.authenticated.DaireNo),t.authenticated.Mahalle=y.remove(t.authenticated.Mahalle),t.authenticated.TPSicilNo=y.remove(t.authenticated.TPSicilNo),t.authenticated.PersonelKodu=y.remove(t.authenticated.PersonelKodu),t.authenticated.PersonelAdi=y.remove(t.authenticated.PersonelAdi)),t.companiesInfo.length>0&&angular.forEach(t.companiesInfo,function(e){e.description=y.remove(e.description),e.fileName=y.remove(e.fileName),e.logo=y.remove(e.logo),e.skpsCode=y.remove(e.skpsCode),e.tramerCode=y.remove(e.tramerCode),e.title=y.remove(e.title)}),e.companiesInfo=t.companiesInfo,e.isLoggedIn=!0,d.set(t);var i={accountId:t.authenticated.HesapKodu};a.post("insured/query",i,function(a){null!==a&&""!==a&&(a.Adres=y.remove(a.Adres),a.AdresNo=y.remove(a.AdresNo),a.BinaNo=y.remove(a.BinaNo),a.DaireNo=y.remove(a.DaireNo),a.EMail=y.remove(a.EMail),a.GSMNo=y.remove(a.GSMNo),a.HesKod=y.remove(a.HesKod),a.Mahalle=y.remove(a.Mahalle),a.PasaportNo=y.remove(a.PasaportNo),a.ReferansAdi=y.remove(a.ReferansAdi),a.Sokak=y.remove(a.Sokak),a.TCNo=y.remove(a.TCNo),a.Tali=y.remove(a.Tali),a.TaliAdi=y.remove(a.TaliAdi),a.TelNo1=y.remove(a.TelNo1),a.TelNo2=y.remove(a.TelNo2),a.Temsilci=y.remove(a.Temsilci),a.TemsilciAdi=y.remove(a.TemsilciAdi),a.Unvan=y.remove(a.Unvan),a.VergiNo=y.remove(a.VergiNo),a.Ilce=y.remove(a.Ilce),a.IlKodu=y.remove(a.IlKodu),a.IkametTel1=y.remove(a.IkametTel1),a.IzinliPazarlamaDurum=y.remove(a.IzinliPazarlamaDurum),a.KVKKDurum=y.remove(a.KVKKDurum),a.Sehir=y.remove(a.Sehir),a.Semt=y.remove(a.Semt),a.PKodu=y.remove(a.PKodu),a.Cadde=y.remove(a.Cadde),a.IlceKodu=y.remove(a.IlceKodu),a.DogumTarihi=y.remove(a.DogumTarihi)),o.setAccountId(t.authenticated.HesapKodu),o.set(a),e.insuredData=a,"function"==typeof n&&n()})},function(e){"HttpStatusCode_Unauthorized"===e.code&&t.path("/")})},e.onCreate=function(){e.setActiveInsured(function(){var t=null;if(null!==i.params.id&&null!==i.params.tip?(e.data={pPoliID:i.params.id,pTip:i.params.tip},e.form=angular.copy(e.data),t=angular.copy(e.data)):null!==r.get("Quotation")&&void 0!==r.get("Quotation")&&(e.data=angular.copy(r.get("Quotation")),e.form=angular.copy(e.data),t=angular.copy(r.get("Quotation"))),null===t)return void i.go("dashboard");e.isCompaniesLoading=!0;var n={pPoliID:e.pPoliIDForDetail,pTip:e.pTipForDetail};e.isPrepared=!1,a.get("sales/operations/detail",n,function(n){n.teklif.sirketler.length>0&&angular.forEach(n.teklif.sirketler,function(e){e.skod=y.remove(e.skod),e.policeno=y.remove(e.policeno),e.abs_aciklama=y.remove(e.abs_aciklama),e.sirketadi=y.remove(e.sirketadi),e.aciklama=y.remove(e.aciklama),e.panatalikom=y.remove(e.panatalikom),e.pkom=y.remove(e.pkom),e.policelestir=y.remove(e.policelestir),e.prod=y.remove(e.prod),e.ptalikom=y.remove(e.ptalikom),e.ptutar=y.remove(e.ptutar),e.tanatalikom=y.remove(e.tanatalikom),e.teklifno=y.remove(e.teklifno),e.teklifno_psn=y.remove(e.teklifno_psn),e.tkom=y.remove(e.tkom),e.tsk=y.remove(e.tsk),e.ttalikom=y.remove(e.ttalikom),e.ttutar=y.remove(e.ttutar),e.tvneden=y.remove(e.tvneden),e.tvnedenid=y.remove(e.tvnedenid)}),n.teklif.teklifler.length>0&&angular.forEach(n.teklif.teklifler,function(e){e.policetalebi=y.remove(e.policetalebi),e.saat=y.remove(e.saat),e.tarih=y.remove(e.tarih),e.teklifislemtipi=y.remove(e.teklifislemtipi)}),n.dosyalar.length>0&&angular.forEach(n.dosyalar,function(e){e.skod=y.remove(e.skod),e.aciklama=y.remove(e.aciklama),e.orjinalad=y.remove(e.orjinalad),e.sistemad=y.remove(e.sistemad)}),n.forms.length>0&&angular.forEach(n.forms,function(e){e.createEmployeeCode=y.remove(e.createEmployeeCode),e.updateEmployeeCode=y.remove(e.updateEmployeeCode),e.databaseCode=y.remove(e.databaseCode),e.skod=y.remove(e.skod),e.product=y.remove(e.product)}),null!==n.satir&&""!==n.satir&&(n.satir.gtemsilciad=y.remove(n.satir.gtemsilciad),n.satir.gtemsilcikodu=y.remove(n.satir.gtemsilcikodu),n.satir.heskod=y.remove(n.satir.heskod),n.satir.motorno=y.remove(n.satir.motorno),n.satir.policeno=y.remove(n.satir.policeno),n.satir.skod=y.remove(n.satir.skod),n.satir.pt_skod=y.remove(n.satir.pt_skod),n.satir.sasino=y.remove(n.satir.sasino),n.satir.unvan1=y.remove(n.satir.unvan1),n.satir.ttbn=y.remove(n.satir.ttbn),n.satir.yenilemeno=y.remove(n.satir.yenilemeno),n.satir.zeylno=y.remove(n.satir.zeylno),n.satir.anabrans=y.remove(n.satir.anabrans),n.satir.anabransadi=y.remove(n.satir.anabransadi),n.satir.arabransaciklama=y.remove(n.satir.arabransaciklama),n.satir.bitisgun=y.remove(n.satir.bitisgun),n.satir.ebaslama=y.remove(n.satir.ebaslama),n.satir.ebitis=y.remove(n.satir.ebitis),n.satir.kayittarihi=y.remove(n.satir.kayittarihi),n.satir.ksirket2=y.remove(n.satir.ksirket2),n.satir.nsirket=y.remove(n.satir.nsirket),n.satir.pt_sirketad=y.remove(n.satir.pt_sirketad),n.satir.refgrup=y.remove(n.satir.refgrup),n.satir.sirketadi=y.remove(n.satir.sirketadi),n.satir.sisaat=y.remove(n.satir.sisaat),n.satir.sitarih=y.remove(n.satir.sitarih),n.satir.subeadi=y.remove(n.satir.subeadi),n.satir.tali=y.remove(n.satir.tali),n.satir.tesciltarihi=y.remove(n.satir.tesciltarihi),n.satir.tsirket2=y.remove(n.satir.tsirket2),n.satir.ttkaciklama=y.remove(n.satir.ttkaciklama),n.satir.vsirket2=y.remove(n.satir.vsirket2)),n||(window.location.href="/"),e.isPageRendering=!1,t.detail=n,angular.forEach(n.teklif.sirketler,function(e){e.image=e.skod.replace(/ /g,"_"),e.floatPtutar=parseFloat(e.ptutar),e.floatTtutar=parseFloat(e.ttutar)}),null!==t.detail.teklif.selectedCompany&&(e.policyRequestIsShow=!0,e.detailButtonIsShow=!0),t.detail.documentPath=null,null===t.detail.teklif.selectedCompany&&t.detail.teklif.sirketler.length>0&&(t.detail.teklif.selectedCompany=t.detail.teklif.sirketler[0].skod),angular.forEach(t.detail.teklif.sirketler,function(e){e.isReady=!1,parseFloat(e.ptutar,10)>0||parseFloat(e.ttutar,10)>0?(e.isReady=!0,e.status="QUOT_GIVEN"):e.status="QUOT_PREPARING",e.floatPtutar=parseFloat(e.ptutar),e.floatTtutar=parseFloat(e.ttutar)}),angular.forEach(t.detail.teklif.sirketler,function(e){"0"!==e.tvnedenid&&(e.status="QUOT_NOT_GIVEN"),"0"!==e.tvnedenid&&-1===e.aciklama.indexOf("(Bilgi)")&&(e.status="QUOT_ERROR")}),null===t.detail.teklif.subTab&&(t.detail.teklif.subTab="cover"),t.detail.teklif.selected=null,t.detail.teklif.isListOpen=!1,t.detail.teklif.teklifler.length>0&&(t.detail.teklif.teklifler.sort(function(e,t){return parseInt(t.id)-parseInt(e.id)}),t.detail.teklif.teklifler[0].isActive=!0,t.detail.teklif.teklifler[0].isSelfActive=!0,t.detail.teklif.selected=t.detail.teklif.teklifler[0]),t.detail.tia=s.build(null,t.detail.sigortaIcerikleri),angular.forEach(f.getMenus(),function(n){if(t.detail.satir.arabrans===n.product&&(e.isViewQuotationErrors=n.isViewQuotationErrors),"0"==t.detail.satir.tip&&t.detail.satir.arabrans!==n.product){var a=parseInt(n.main_product)-1;t.detail.satir.anabrans==a&&(e.isViewQuotationErrors=n.isViewQuotationErrors)}});var i=[];angular.forEach(t.detail.teklif.sirketler,function(t){(parseFloat(t.ptutar)>0||parseFloat(t.ttutar)>0)&&i.push(t),e.filteredSirketListLenght=i.length}),e.isViewQuotationErrors&&angular.forEach(t.detail.teklif.sirketler,function(e){0!=parseFloat(e.ptutar)&&0!=parseFloat(e.ttutar)||""===e.aciklama||i.push(e)}),t.detail.teklif.sirketler=i;var l=parseInt(t.detail.satir.tsirket2),d=parseInt(t.detail.satir.vsirket2),m=parseInt(t.detail.satir.nsirket);l>0&&d<l&&(t.detail.satir.teklifDurum="TEKLIF_CALISIYOR"),l>0&&d==l&&(t.detail.satir.teklifDurum="TEKLIF_TAMAMLANDI"),l>0&&m==l&&(t.detail.satir.teklifDurum="TEKLIF_CALISILAMADI"),e.quotationContent=t,e.quotationContent.pPoliID=e.pPoliIDForDetail,e.quotationContent.pTip=e.pTipForDetail,e.quotationContent.detail.teklif.teklifler=g("orderBy")(e.quotationContent.detail.teklif.teklifler,"-teklif_tipi"),e.isCompaniesLoading=!1,e.getAlternativeQuotations(function(){e.checkQuotationPresentation(function(){e.activeMenu.isViewAllBranchesFilter&&e.onChangeAraBransFilter("ALL");var n=e.activeMenu.priceSort;"INSTALLMENT"===n&&null!==n&&void 0!==n&&""!==n&&(e.quotationContent.detail.teklif.sirketler=g("orderBy")(e.quotationContent.detail.teklif.sirketler,"floatTtutar"),e.quotationContent.selectedOption="floatTtutar",e.isViewInstallmentFirst=!0,e.isViewCashFirst=!1),"CASH"===n&&null!==n&&void 0!==n&&""!==n&&(e.quotationContent.detail.teklif.sirketler=g("orderBy")(e.quotationContent.detail.teklif.sirketler,"floatPtutar"),e.quotationContent.selectedOption="floatPtutar",e.isViewInstallmentFirst=!1,e.isViewCashFirst=!0),a.get("portalmenus/menustatus/"+e.activeMenu.id,{},function(n){e.portalMenuStatus=n,angular.forEach(n,function(t){e.quotationContent.detail.satir.teklifDurum===t.status&&e.quotationContent.detail.satir.arabrans==t.product&&(e.quotationContent.quotationStatusMessage=t.message,e.quotationContent.quotationStatusMessageMobile=t.messageMobile,e.quotationContent.quotationStatusMessageTablet=t.messageTablet,e.quotationContent.quotationStatusIsViewAllResolutions=t.isViewAllResolutions,e.quotationContent.isViewTimeoutMessage=t.isViewTimeoutMessage,e.quotationContent.isHideTimeoutMessage=t.isHideTimeoutMessage)});var i={menuId:e.activeMenu.id,quotationStylesDetail:e.styleSelection.quotation};a.get("portalmenus/menuProductDetails",i,function(n){if(e.portalMenuProductDetails=n,angular.forEach(n,function(t){angular.forEach(e.quotationContent.detail.teklif.sirketler,function(n){angular.forEach(e.companiesInfo,function(e){n.tsk==e.tramerCode&&t.companyId===e.id&&n.arabrans==t.product&&(n.listProductDesc=t.listProductDesc,n.listProductDescMobile=t.listProductDescMobile,n.listProductDescTablet=t.listProductDescTablet,n.cardProductDesc=t.cardProductDesc,n.cardProductDescMobile=t.cardProductDescMobile,n.cardProductDescTablet=t.cardProductDescTablet,n.isViewAllResolutionsList=t.isViewAllResolutionsList,n.isViewAllResolutionsCard=t.isViewAllResolutionsCard,n.ribbonDesc=t.ribbonDesc,n.isHideCompanyInformation=t.isHideCompanyInformation,n.isHideInstallmentOn3D=t.isHideInstallmentOn3D,n.quotationTitleColor=t.quotationTitleColor,n.quotationBackgroundColor=t.quotationBackgroundColor,n.isViewQuotationBorder=t.isViewQuotationBorder,n.isViewAllResolutionsDetail=t.isViewAllResolutionsDetail,n.detailModalDescription=t.detailModalDescription,n.detailModalDescriptionTablet=t.detailModalDescriptionTablet,n.detailModalDescriptionMobile=t.detailModalDescriptionMobile,n.orderOfCompanyToShow=t.orderOfCompanyToShow,n.isViewCardOwner=t.isViewCardOwner)})})}),angular.forEach(e.quotationContent.detail.teklif.sirketler,function(t){angular.forEach(e.companiesInfo,function(e){t.tsk==e.tramerCode&&!0!==t.isHideCompanyInformation&&(t.companyLogo=e.logo),t.isHideCompanyInformation&&(t.companyLogo="none")})}),"INSTALLMENT"==e.activeMenu.priceView&&(e.quotationContent.detail.teklif.sirketler=e.quotationContent.detail.teklif.sirketler.filter(function(e){return!0!==e.isHideInstallmentOn3D})),""!==e.quotationContent.detail.teklif.TeklifZaman&&null!==e.quotationContent.detail.teklif.TeklifZaman&&void 0!==e.quotationContent.detail.teklif.TeklifZaman){if(0!=e.activeMenu.timeOut&&null!=e.activeMenu.timeOut&&void 0!=e.activeMenu.timeOut||0!=parseInt(e.activeMenu.refreshTime)&&null!=parseInt(e.activeMenu.refreshTime)&&void 0!=parseInt(e.activeMenu.refreshTime)||(e.isTimedOut=!0),(0==e.activeMenu.timeOut||null==e.activeMenu.timeOut||void 0==e.activeMenu.timeOut)&&parseInt(e.activeMenu.refreshTime)>0&&(e.counter=parseInt(e.activeMenu.refreshTime),!1===e.isAutoRefreshed)){e.onTimeout=function(){e.counter>0&&e.counter--,i=p(e.onTimeout,1e3)};var i=p(e.onTimeout,1e3);e.autoRefreshQuotation()}if(e.activeMenu.timeOut>0&&parseInt(e.activeMenu.refreshTime)>0){var l=moment(e.quotationContent.detail.teklif.TeklifZaman,"YYYY-MM-DD HH:mm:ss"),s=l.add(e.activeMenu.timeOut,"seconds"),d=moment(e.quotationContent.detail.teklif.ServerTime,"YYYY-MM-DD HH:mm:ss");if(""!==l&&null!==l&&void 0!==l&&""!==s&&null!==s&&void 0!==s)if(s.valueOf()>=d.valueOf())e.counter=parseInt(e.activeMenu.refreshTime),!1===e.isAutoRefreshed&&(e.onTimeout=function(){e.counter>0&&e.counter--,i=p(e.onTimeout,1e3)},i=p(e.onTimeout,1e3),e.autoRefreshQuotation());else{if(e.isTimedOut=!0,e.activeMenu.isCloseOfferWhenTimeout&&"TEKLIF_TAMAMLANDI"!==t.detail.satir.teklifDurum){var m={pPoliceID:parseInt(e.quotationContent.pPoliID),pTip:parseInt(e.quotationContent.pTip)};a.post("sales/timeout",m,function(){e.refreshQuotationAfterTimeout()},null,null,null,!0)}e.otherBidData=angular.copy(r.get("OtherBid"));var f=!1;if(null!==e.otherBidData&&""!==e.otherBidData&&void 0!==e.otherBidData&&null!==e.otherBidData.pid&&""!==e.otherBidData.pid&&void 0!==e.otherBidData.pid&&(angular.forEach(e.menus,function(t){t.main_product==e.otherBidData.ab&&t.product==e.otherBidData.arabrans&&(f=t.isCloseOfferWhenTimeout)}),f&&"TEKLIF_TAMAMLANDI"!==t.detail.satir.teklifDurum)){var m={pPoliceID:parseInt(e.otherBidData.pid),pTip:1};a.post("sales/timeout",m,function(){},null,null,null,!0)}}}}else e.isTimedOut=!0;e.isTimedOut&&(u.cancel(c.quotationRefresh),c.$broadcast("@OnUpdateCount",o.getActiveInsured().HesKod)),e.isPrepared=!0,"CARD"!==e.styleSelection.quotation&&"LIST"!==e.styleSelection.quotation||e.getPoliceCaprazTablo(t.detail.teklif.sirketler)},null,null,null,!0)},null,null,null,!0)})})},null,null,null,!0)})},e.refreshQuotation=function(t){e.autoRefreshInprogress=!!t,e.setActiveInsured(function(){var t=null;if(null!==i.params.id&&null!==i.params.tip?(e.data={pPoliID:i.params.id,pTip:i.params.tip},e.form=angular.copy(e.data),t=angular.copy(e.data)):null!==r.get("Quotation")&&void 0!==r.get("Quotation")&&(e.data=angular.copy(r.get("Quotation")),e.form=angular.copy(e.data),t=angular.copy(r.get("Quotation"))),null===t)return void i.go("dashboard");e.isCompaniesLoading=!0;var n={pPoliID:e.pPoliIDForDetail,pTip:e.pTipForDetail};e.isPrepared=!1,a.get("sales/operations/detail",n,function(n){n.teklif.sirketler.length>0&&angular.forEach(n.teklif.sirketler,function(e){e.skod=y.remove(e.skod),e.policeno=y.remove(e.policeno),e.abs_aciklama=y.remove(e.abs_aciklama),e.sirketadi=y.remove(e.sirketadi),e.aciklama=y.remove(e.aciklama),e.panatalikom=y.remove(e.panatalikom),e.pkom=y.remove(e.pkom),e.policelestir=y.remove(e.policelestir),e.prod=y.remove(e.prod),e.ptalikom=y.remove(e.ptalikom),e.ptutar=y.remove(e.ptutar),e.tanatalikom=y.remove(e.tanatalikom),e.teklifno=y.remove(e.teklifno),e.teklifno_psn=y.remove(e.teklifno_psn),e.tkom=y.remove(e.tkom),e.tsk=y.remove(e.tsk),e.ttalikom=y.remove(e.ttalikom),e.ttutar=y.remove(e.ttutar),e.tvneden=y.remove(e.tvneden),e.tvnedenid=y.remove(e.tvnedenid)}),n.teklif.teklifler.length>0&&angular.forEach(n.teklif.teklifler,function(e){e.policetalebi=y.remove(e.policetalebi),e.saat=y.remove(e.saat),e.tarih=y.remove(e.tarih),e.teklifislemtipi=y.remove(e.teklifislemtipi)}),n.dosyalar.length>0&&angular.forEach(n.dosyalar,function(e){e.skod=y.remove(e.skod),e.aciklama=y.remove(e.aciklama),e.orjinalad=y.remove(e.orjinalad),e.sistemad=y.remove(e.sistemad)}),n.forms.length>0&&angular.forEach(n.forms,function(e){e.createEmployeeCode=y.remove(e.createEmployeeCode),e.updateEmployeeCode=y.remove(e.updateEmployeeCode),e.databaseCode=y.remove(e.databaseCode),e.skod=y.remove(e.skod),e.product=y.remove(e.product)}),null!==n.satir&&""!==n.satir&&(n.satir.gtemsilciad=y.remove(n.satir.gtemsilciad),n.satir.gtemsilcikodu=y.remove(n.satir.gtemsilcikodu),n.satir.heskod=y.remove(n.satir.heskod),n.satir.motorno=y.remove(n.satir.motorno),n.satir.policeno=y.remove(n.satir.policeno),n.satir.skod=y.remove(n.satir.skod),n.satir.pt_skod=y.remove(n.satir.pt_skod),n.satir.sasino=y.remove(n.satir.sasino),n.satir.unvan1=y.remove(n.satir.unvan1),n.satir.ttbn=y.remove(n.satir.ttbn),n.satir.yenilemeno=y.remove(n.satir.yenilemeno),n.satir.zeylno=y.remove(n.satir.zeylno),n.satir.anabrans=y.remove(n.satir.anabrans),n.satir.anabransadi=y.remove(n.satir.anabransadi),n.satir.arabransaciklama=y.remove(n.satir.arabransaciklama),n.satir.bitisgun=y.remove(n.satir.bitisgun),n.satir.ebaslama=y.remove(n.satir.ebaslama),n.satir.ebitis=y.remove(n.satir.ebitis),n.satir.kayittarihi=y.remove(n.satir.kayittarihi),n.satir.ksirket2=y.remove(n.satir.ksirket2),n.satir.nsirket=y.remove(n.satir.nsirket),n.satir.pt_sirketad=y.remove(n.satir.pt_sirketad),n.satir.refgrup=y.remove(n.satir.refgrup),n.satir.sirketadi=y.remove(n.satir.sirketadi),n.satir.sisaat=y.remove(n.satir.sisaat),n.satir.sitarih=y.remove(n.satir.sitarih),n.satir.subeadi=y.remove(n.satir.subeadi),n.satir.tali=y.remove(n.satir.tali),n.satir.tesciltarihi=y.remove(n.satir.tesciltarihi),n.satir.tsirket2=y.remove(n.satir.tsirket2),n.satir.ttkaciklama=y.remove(n.satir.ttkaciklama),n.satir.vsirket2=y.remove(n.satir.vsirket2)),n||(window.location.href="/"),e.isPageRendering=!1,t.detail=n,angular.forEach(n.teklif.sirketler,function(e){e.image=e.skod.replace(/ /g,"_"),e.floatPtutar=parseFloat(e.ptutar),e.floatTtutar=parseFloat(e.ttutar)}),null!==t.detail.teklif.selectedCompany&&(e.policyRequestIsShow=!0,e.detailButtonIsShow=!0),t.detail.documentPath=null,null===t.detail.teklif.selectedCompany&&t.detail.teklif.sirketler.length>0&&(t.detail.teklif.selectedCompany=t.detail.teklif.sirketler[0].skod),angular.forEach(t.detail.teklif.sirketler,function(e){e.isReady=!1,parseFloat(e.ptutar,10)>0||parseFloat(e.ttutar,10)>0?(e.isReady=!0,e.status="QUOT_GIVEN"):e.status="QUOT_PREPARING",e.floatPtutar=parseFloat(e.ptutar),e.floatTtutar=parseFloat(e.ttutar)}),angular.forEach(t.detail.teklif.sirketler,function(e){"0"!==e.tvnedenid&&(e.status="QUOT_NOT_GIVEN"),"0"!==e.tvnedenid&&-1===e.aciklama.indexOf("(Bilgi)")&&(e.status="QUOT_ERROR")});var i=e.activeMenu.priceSort;"INSTALLMENT"===i&&null!==i&&void 0!==i&&""!==i&&(t.detail.teklif.sirketler=g("orderBy")(t.detail.teklif.sirketler,"floatTtutar"),e.isViewInstallmentFirst=!0,e.isViewCashFirst=!1,t.selectedOption="floatTtutar"),"CASH"===i&&null!==i&&void 0!==i&&""!==i&&(t.detail.teklif.sirketler=g("orderBy")(t.detail.teklif.sirketler,"floatPtutar"),e.isViewInstallmentFirst=!1,e.isViewCashFirst=!0,t.selectedOption="floatPtutar"),null===t.detail.teklif.subTab&&(t.detail.teklif.subTab="cover"),t.detail.teklif.selected=null,t.detail.teklif.isListOpen=!1,t.detail.teklif.teklifler.length>0&&(t.detail.teklif.teklifler.sort(function(e,t){return parseInt(t.id)-parseInt(e.id)}),t.detail.teklif.teklifler[0].isActive=!0,t.detail.teklif.teklifler[0].isSelfActive=!0,t.detail.teklif.selected=t.detail.teklif.teklifler[0]),t.detail.tia=s.build(null,t.detail.sigortaIcerikleri),angular.forEach(f.getMenus(),function(n){if(t.detail.satir.arabrans===n.product&&(e.isViewQuotationErrors=n.isViewQuotationErrors),"0"==t.detail.satir.tip&&t.detail.satir.arabrans!==n.product){var a=parseInt(n.main_product)-1;t.detail.satir.anabrans==a&&(e.isViewQuotationErrors=n.isViewQuotationErrors)}});var l=[];angular.forEach(t.detail.teklif.sirketler,function(t){(parseFloat(t.ptutar)>0||parseFloat(t.ttutar)>0)&&l.push(t),e.filteredSirketListLenght=l.length}),e.isViewQuotationErrors&&angular.forEach(t.detail.teklif.sirketler,function(e){0!=parseFloat(e.ptutar)&&0!=parseFloat(e.ttutar)||""===e.aciklama||l.push(e)}),t.detail.teklif.sirketler=l;var d=parseInt(t.detail.satir.tsirket2),m=parseInt(t.detail.satir.vsirket2),v=parseInt(t.detail.satir.nsirket);d>0&&m<d&&(t.detail.satir.teklifDurum="TEKLIF_CALISIYOR"),d>0&&m==d&&(t.detail.satir.teklifDurum="TEKLIF_TAMAMLANDI"),d>0&&v==d&&(t.detail.satir.teklifDurum="TEKLIF_CALISILAMADI"),e.quotationContent=t,e.quotationContent.pPoliID=e.pPoliIDForDetail,e.quotationContent.pTip=e.pTipForDetail,angular.forEach(e.portalMenuProductDetails,function(t){angular.forEach(e.quotationContent.detail.teklif.sirketler,function(n){angular.forEach(e.companiesInfo,function(e){n.tsk==e.tramerCode&&t.companyId===e.id&&n.arabrans==t.product&&(n.listProductDesc=t.listProductDesc,n.listProductDescMobile=t.listProductDescMobile,n.listProductDescTablet=t.listProductDescTablet,n.cardProductDesc=t.cardProductDesc,n.cardProductDescMobile=t.cardProductDescMobile,n.cardProductDescTablet=t.cardProductDescTablet,n.isViewAllResolutionsList=t.isViewAllResolutionsList,n.isViewAllResolutionsCard=t.isViewAllResolutionsCard,n.ribbonDesc=t.ribbonDesc,n.isHideCompanyInformation=t.isHideCompanyInformation,n.isHideInstallmentOn3D=t.isHideInstallmentOn3D,n.quotationTitleColor=t.quotationTitleColor,n.quotationBackgroundColor=t.quotationBackgroundColor,n.isViewQuotationBorder=t.isViewQuotationBorder,n.isViewAllResolutionsDetail=t.isViewAllResolutionsDetail,n.detailModalDescription=t.detailModalDescription,n.detailModalDescriptionTablet=t.detailModalDescriptionTablet,n.detailModalDescriptionMobile=t.detailModalDescriptionMobile,n.orderOfCompanyToShow=t.orderOfCompanyToShow,n.isViewCardOwner=t.isViewCardOwner)})})}),angular.forEach(e.quotationContent.detail.teklif.sirketler,function(t){angular.forEach(e.companiesInfo,function(e){t.tsk==e.tramerCode&&!0!==t.isHideCompanyInformation&&(t.companyLogo=e.logo),t.isHideCompanyInformation&&(t.companyLogo="none")})}),"INSTALLMENT"==e.activeMenu.priceView&&(e.quotationContent.detail.teklif.sirketler=e.quotationContent.detail.teklif.sirketler.filter(function(e){return!0!==e.isHideInstallmentOn3D})),angular.forEach(e.portalMenuStatus,function(t){e.quotationContent.detail.satir.teklifDurum===t.status&&e.quotationContent.detail.satir.arabrans==t.product&&(e.quotationContent.quotationStatusMessage=t.message,e.quotationContent.quotationStatusMessageMobile=t.messageMobile,e.quotationContent.quotationStatusMessageTablet=t.messageTablet,e.quotationContent.quotationStatusIsViewAllResolutions=t.isViewAllResolutions,e.quotationContent.isViewTimeoutMessage=t.isViewTimeoutMessage,e.quotationContent.isHideTimeoutMessage=t.isHideTimeoutMessage)}),e.isCompaniesLoading=!1,e.checkQuotationPresentationRefresh(function(){if(e.quotationContent.detail.teklif.teklifler=g("orderBy")(e.quotationContent.detail.teklif.teklifler,"-teklif_tipi"),e.activeMenu.isViewAllBranchesFilter&&e.onChangeAraBransFilter("ALL"),""!==e.quotationContent.detail.teklif.TeklifZaman&&null!==e.quotationContent.detail.teklif.TeklifZaman&&void 0!==e.quotationContent.detail.teklif.TeklifZaman){if(0!=e.activeMenu.timeOut&&null!=e.activeMenu.timeOut&&void 0!=e.activeMenu.timeOut||0!=parseInt(e.activeMenu.refreshTime)&&null!=parseInt(e.activeMenu.refreshTime)&&void 0!=parseInt(e.activeMenu.refreshTime)||(e.isTimedOut=!0),(0==e.activeMenu.timeOut||null==e.activeMenu.timeOut||void 0==e.activeMenu.timeOut)&&parseInt(e.activeMenu.refreshTime)>0&&(e.counter=parseInt(e.activeMenu.refreshTime),!1===e.isAutoRefreshed)){e.onTimeout=function(){e.counter>0&&e.counter--,n=p(e.onTimeout,1e3)};var n=p(e.onTimeout,1e3);e.autoRefreshQuotation()}if(e.activeMenu.timeOut>0&&parseInt(e.activeMenu.refreshTime)>0){var i=moment(e.quotationContent.detail.teklif.TeklifZaman,"YYYY-MM-DD HH:mm:ss"),l=i.add(e.activeMenu.timeOut,"seconds"),s=moment(e.quotationContent.detail.teklif.ServerTime,"YYYY-MM-DD HH:mm:ss");if(""!==i&&null!==i&&void 0!==i&&""!==l&&null!==l&&void 0!==l)if(l.valueOf()>=s.valueOf())e.counter=parseInt(e.activeMenu.refreshTime),!1===e.isAutoRefreshed&&(e.onTimeout=function(){e.counter>0&&e.counter--,n=p(e.onTimeout,1e3)},n=p(e.onTimeout,1e3),e.autoRefreshQuotation());else{if(e.isTimedOut=!0,e.activeMenu.isCloseOfferWhenTimeout&&"TEKLIF_TAMAMLANDI"!==t.detail.satir.teklifDurum){var d={pPoliceID:parseInt(e.quotationContent.pPoliID),pTip:parseInt(e.quotationContent.pTip)};a.post("sales/timeout",d,function(){e.refreshQuotationAfterTimeout()},null,null,null,!0)}e.otherBidData=angular.copy(r.get("OtherBid"));var m=!1;if(null!==e.otherBidData&&""!==e.otherBidData&&void 0!==e.otherBidData&&null!==e.otherBidData.pid&&""!==e.otherBidData.pid&&void 0!==e.otherBidData.pid&&(angular.forEach(e.menus,function(t){t.main_product==e.otherBidData.ab&&t.product==e.otherBidData.arabrans&&(m=t.isCloseOfferWhenTimeout)}),m&&"TEKLIF_TAMAMLANDI"!==t.detail.satir.teklifDurum)){var d={pPoliceID:parseInt(e.otherBidData.pid),pTip:1};a.post("sales/timeout",d,function(){},null,null,null,!0)}}}}else e.isTimedOut=!0;try{"TEKLIF_TAMAMLANDI"===e.quotationContent.detail.satir.teklifDurum&&(e.isTimedOut=!0)}catch(e){}e.isTimedOut&&(u.cancel(c.quotationRefresh),c.$broadcast("@OnUpdateCount",o.getActiveInsured().HesKod)),e.isPrepared=!0,angular.forEach(e.menus,function(t){if(e.quotationContent.detail.satir.arabrans===t.product&&(t.isCreateWebLog||!1===e.isWebLogSendOnPageOpen)&&e.sendWebLog(),
"0"==e.quotationContent.detail.satir.tip&&e.quotationContent.detail.satir.arabrans!==t.product){var n=parseInt(t.main_product)-1;e.quotationContent.detail.satir.anabrans==n&&(t.isCreateWebLog||!1===e.isWebLogSendOnPageOpen)&&e.sendWebLog()}}),"CARD"!==e.styleSelection.quotation&&"LIST"!==e.styleSelection.quotation||e.getPoliceCaprazTablo(t.detail.teklif.sirketler)})},null,null,null,!0)})},e.refreshQuotationAfterTimeout=function(){e.setActiveInsured(function(){var t=null;if(null!==i.params.id&&null!==i.params.tip?(e.data={pPoliID:i.params.id,pTip:i.params.tip},e.form=angular.copy(e.data),t=angular.copy(e.data)):null!==r.get("Quotation")&&void 0!==r.get("Quotation")&&(e.data=angular.copy(r.get("Quotation")),e.form=angular.copy(e.data),t=angular.copy(r.get("Quotation"))),null===t)return void i.go("dashboard");e.isCompaniesLoading=!0;var n={pPoliID:e.pPoliIDForDetail,pTip:e.pTipForDetail};e.isPrepared=!1,a.get("sales/operations/detail",n,function(n){n.teklif.sirketler.length>0&&angular.forEach(n.teklif.sirketler,function(e){e.skod=y.remove(e.skod),e.policeno=y.remove(e.policeno),e.abs_aciklama=y.remove(e.abs_aciklama),e.sirketadi=y.remove(e.sirketadi),e.aciklama=y.remove(e.aciklama),e.panatalikom=y.remove(e.panatalikom),e.pkom=y.remove(e.pkom),e.policelestir=y.remove(e.policelestir),e.prod=y.remove(e.prod),e.ptalikom=y.remove(e.ptalikom),e.ptutar=y.remove(e.ptutar),e.tanatalikom=y.remove(e.tanatalikom),e.teklifno=y.remove(e.teklifno),e.teklifno_psn=y.remove(e.teklifno_psn),e.tkom=y.remove(e.tkom),e.tsk=y.remove(e.tsk),e.ttalikom=y.remove(e.ttalikom),e.ttutar=y.remove(e.ttutar),e.tvneden=y.remove(e.tvneden),e.tvnedenid=y.remove(e.tvnedenid)}),n.teklif.teklifler.length>0&&angular.forEach(n.teklif.teklifler,function(e){e.policetalebi=y.remove(e.policetalebi),e.saat=y.remove(e.saat),e.tarih=y.remove(e.tarih),e.teklifislemtipi=y.remove(e.teklifislemtipi)}),n.dosyalar.length>0&&angular.forEach(n.dosyalar,function(e){e.skod=y.remove(e.skod),e.aciklama=y.remove(e.aciklama),e.orjinalad=y.remove(e.orjinalad),e.sistemad=y.remove(e.sistemad)}),n.forms.length>0&&angular.forEach(n.forms,function(e){e.createEmployeeCode=y.remove(e.createEmployeeCode),e.updateEmployeeCode=y.remove(e.updateEmployeeCode),e.databaseCode=y.remove(e.databaseCode),e.skod=y.remove(e.skod),e.product=y.remove(e.product)}),null!==n.satir&&""!==n.satir&&(n.satir.gtemsilciad=y.remove(n.satir.gtemsilciad),n.satir.gtemsilcikodu=y.remove(n.satir.gtemsilcikodu),n.satir.heskod=y.remove(n.satir.heskod),n.satir.motorno=y.remove(n.satir.motorno),n.satir.policeno=y.remove(n.satir.policeno),n.satir.skod=y.remove(n.satir.skod),n.satir.pt_skod=y.remove(n.satir.pt_skod),n.satir.sasino=y.remove(n.satir.sasino),n.satir.unvan1=y.remove(n.satir.unvan1),n.satir.ttbn=y.remove(n.satir.ttbn),n.satir.yenilemeno=y.remove(n.satir.yenilemeno),n.satir.zeylno=y.remove(n.satir.zeylno),n.satir.anabrans=y.remove(n.satir.anabrans),n.satir.anabransadi=y.remove(n.satir.anabransadi),n.satir.arabransaciklama=y.remove(n.satir.arabransaciklama),n.satir.bitisgun=y.remove(n.satir.bitisgun),n.satir.ebaslama=y.remove(n.satir.ebaslama),n.satir.ebitis=y.remove(n.satir.ebitis),n.satir.kayittarihi=y.remove(n.satir.kayittarihi),n.satir.ksirket2=y.remove(n.satir.ksirket2),n.satir.nsirket=y.remove(n.satir.nsirket),n.satir.pt_sirketad=y.remove(n.satir.pt_sirketad),n.satir.refgrup=y.remove(n.satir.refgrup),n.satir.sirketadi=y.remove(n.satir.sirketadi),n.satir.sisaat=y.remove(n.satir.sisaat),n.satir.sitarih=y.remove(n.satir.sitarih),n.satir.subeadi=y.remove(n.satir.subeadi),n.satir.tali=y.remove(n.satir.tali),n.satir.tesciltarihi=y.remove(n.satir.tesciltarihi),n.satir.tsirket2=y.remove(n.satir.tsirket2),n.satir.ttkaciklama=y.remove(n.satir.ttkaciklama),n.satir.vsirket2=y.remove(n.satir.vsirket2)),n||(window.location.href="/"),e.isPageRendering=!1,t.detail=n,angular.forEach(n.teklif.sirketler,function(e){e.image=e.skod.replace(/ /g,"_"),e.floatPtutar=parseFloat(e.ptutar),e.floatTtutar=parseFloat(e.ttutar)}),null!==t.detail.teklif.selectedCompany&&(e.policyRequestIsShow=!0,e.detailButtonIsShow=!0),t.detail.documentPath=null,null===t.detail.teklif.selectedCompany&&t.detail.teklif.sirketler.length>0&&(t.detail.teklif.selectedCompany=t.detail.teklif.sirketler[0].skod),angular.forEach(t.detail.teklif.sirketler,function(e){e.isReady=!1,parseFloat(e.ptutar,10)>0||parseFloat(e.ttutar,10)>0?(e.isReady=!0,e.status="QUOT_GIVEN"):e.status="QUOT_PREPARING",e.floatPtutar=parseFloat(e.ptutar),e.floatTtutar=parseFloat(e.ttutar)}),angular.forEach(t.detail.teklif.sirketler,function(e){"0"!==e.tvnedenid&&(e.status="QUOT_NOT_GIVEN"),"0"!==e.tvnedenid&&-1===e.aciklama.indexOf("(Bilgi)")&&(e.status="QUOT_ERROR")});var a=e.activeMenu.priceSort;"INSTALLMENT"===a&&null!==a&&void 0!==a&&""!==a&&(t.detail.teklif.sirketler=g("orderBy")(t.detail.teklif.sirketler,"floatTtutar"),t.selectedOption="floatTtutar",e.isViewInstallmentFirst=!0,e.isViewCashFirst=!1),"CASH"===a&&null!==a&&void 0!==a&&""!==a&&(t.detail.teklif.sirketler=g("orderBy")(t.detail.teklif.sirketler,"floatPtutar"),t.selectedOption="floatPtutar",e.isViewInstallmentFirst=!1,e.isViewCashFirst=!0),null===t.detail.teklif.subTab&&(t.detail.teklif.subTab="cover"),t.detail.teklif.selected=null,t.detail.teklif.isListOpen=!1,t.detail.teklif.teklifler.length>0&&(t.detail.teklif.teklifler.sort(function(e,t){return parseInt(t.id)-parseInt(e.id)}),t.detail.teklif.teklifler[0].isActive=!0,t.detail.teklif.teklifler[0].isSelfActive=!0,t.detail.teklif.selected=t.detail.teklif.teklifler[0]),t.detail.tia=s.build(null,t.detail.sigortaIcerikleri),angular.forEach(f.getMenus(),function(n){if(t.detail.satir.arabrans===n.product&&(e.isViewQuotationErrors=n.isViewQuotationErrors),"0"==t.detail.satir.tip&&t.detail.satir.arabrans!==n.product){var a=parseInt(n.main_product)-1;t.detail.satir.anabrans==a&&(e.isViewQuotationErrors=n.isViewQuotationErrors)}});var i=[];angular.forEach(t.detail.teklif.sirketler,function(t){(parseFloat(t.ptutar)>0||parseFloat(t.ttutar)>0)&&i.push(t),e.filteredSirketListLenght=i.length}),e.isViewQuotationErrors&&angular.forEach(t.detail.teklif.sirketler,function(e){0!=parseFloat(e.ptutar)&&0!=parseFloat(e.ttutar)||""===e.aciklama||i.push(e)}),t.detail.teklif.sirketler=i;var r=parseInt(t.detail.satir.tsirket2),l=parseInt(t.detail.satir.vsirket2),d=parseInt(t.detail.satir.nsirket);r>0&&l<r&&(t.detail.satir.teklifDurum="TEKLIF_CALISIYOR"),r>0&&l==r&&(t.detail.satir.teklifDurum="TEKLIF_TAMAMLANDI"),r>0&&d==r&&(t.detail.satir.teklifDurum="TEKLIF_CALISILAMADI"),e.quotationContent=t,e.quotationContent.pPoliID=e.pPoliIDForDetail,e.quotationContent.pTip=e.pTipForDetail,angular.forEach(e.portalMenuProductDetails,function(t){angular.forEach(e.quotationContent.detail.teklif.sirketler,function(n){angular.forEach(e.companiesInfo,function(e){n.tsk==e.tramerCode&&t.companyId===e.id&&n.arabrans==t.product&&(n.listProductDesc=t.listProductDesc,n.listProductDescMobile=t.listProductDescMobile,n.listProductDescTablet=t.listProductDescTablet,n.cardProductDesc=t.cardProductDesc,n.cardProductDescMobile=t.cardProductDescMobile,n.cardProductDescTablet=t.cardProductDescTablet,n.isViewAllResolutionsList=t.isViewAllResolutionsList,n.isViewAllResolutionsCard=t.isViewAllResolutionsCard,n.ribbonDesc=t.ribbonDesc,n.isHideCompanyInformation=t.isHideCompanyInformation,n.isHideInstallmentOn3D=t.isHideInstallmentOn3D,n.quotationTitleColor=t.quotationTitleColor,n.quotationBackgroundColor=t.quotationBackgroundColor,n.isViewQuotationBorder=t.isViewQuotationBorder,n.isViewAllResolutionsDetail=t.isViewAllResolutionsDetail,n.detailModalDescription=t.detailModalDescription,n.detailModalDescriptionTablet=t.detailModalDescriptionTablet,n.detailModalDescriptionMobile=t.detailModalDescriptionMobile,n.orderOfCompanyToShow=t.orderOfCompanyToShow,n.isViewCardOwner=t.isViewCardOwner)})})}),angular.forEach(e.quotationContent.detail.teklif.sirketler,function(t){angular.forEach(e.companiesInfo,function(e){t.tsk==e.tramerCode&&!0!==t.isHideCompanyInformation&&(t.companyLogo=e.logo),t.isHideCompanyInformation&&(t.companyLogo="none")})}),"INSTALLMENT"==e.activeMenu.priceView&&(e.quotationContent.detail.teklif.sirketler=e.quotationContent.detail.teklif.sirketler.filter(function(e){return!0!==e.isHideInstallmentOn3D})),angular.forEach(e.portalMenuStatus,function(t){e.quotationContent.detail.satir.teklifDurum===t.status&&e.quotationContent.detail.satir.arabrans==t.product&&(e.quotationContent.quotationStatusMessage=t.message,e.quotationContent.quotationStatusMessageMobile=t.messageMobile,e.quotationContent.quotationStatusMessageTablet=t.messageTablet,e.quotationContent.quotationStatusIsViewAllResolutions=t.isViewAllResolutions,e.quotationContent.isViewTimeoutMessage=t.isViewTimeoutMessage,e.quotationContent.isHideTimeoutMessage=t.isHideTimeoutMessage)}),e.isCompaniesLoading=!1,e.checkQuotationPresentationRefresh(function(){if(e.quotationContent.detail.teklif.teklifler=g("orderBy")(e.quotationContent.detail.teklif.teklifler,"-teklif_tipi"),e.activeMenu.isViewAllBranchesFilter&&e.onChangeAraBransFilter("ALL"),""!==e.quotationContent.detail.satir.tarih&&null!==e.quotationContent.detail.satir.tarih&&void 0!==e.quotationContent.detail.satir.tarih){if(0!=e.activeMenu.timeOut&&null!=e.activeMenu.timeOut&&void 0!=e.activeMenu.timeOut||0!=parseInt(e.activeMenu.refreshTime)&&null!=parseInt(e.activeMenu.refreshTime)&&void 0!=parseInt(e.activeMenu.refreshTime)||(e.isTimedOut=!0),(0==e.activeMenu.timeOut||null==e.activeMenu.timeOut||void 0==e.activeMenu.timeOut)&&parseInt(e.activeMenu.refreshTime)>0&&(e.counter=parseInt(e.activeMenu.refreshTime),!1===e.isAutoRefreshed)){e.onTimeout=function(){e.counter>0&&e.counter--,n=p(e.onTimeout,1e3)};var n=p(e.onTimeout,1e3);e.autoRefreshQuotation()}if(e.activeMenu.timeOut>0&&parseInt(e.activeMenu.refreshTime)>0){var a=moment(e.quotationContent.detail.teklif.TeklifZaman,"YYYY-MM-DD HH:mm:ss"),i=a.add(e.activeMenu.timeOut,"seconds"),r=moment(e.quotationContent.detail.teklif.ServerTime,"YYYY-MM-DD HH:mm:ss");""!==a&&null!==a&&void 0!==a&&""!==i&&null!==i&&void 0!==i&&i.valueOf()>=r.valueOf()?(e.counter=parseInt(e.activeMenu.refreshTime),!1===e.isAutoRefreshed&&(e.onTimeout=function(){e.counter>0&&e.counter--,n=p(e.onTimeout,1e3)},n=p(e.onTimeout,1e3),e.autoRefreshQuotation())):e.isTimedOut=!0}}else e.isTimedOut=!0;try{"TEKLIF_TAMAMLANDI"===e.quotationContent.detail.satir.teklifDurum&&(e.isTimedOut=!0)}catch(e){}e.isTimedOut&&(u.cancel(c.quotationRefresh),c.$broadcast("@OnUpdateCount",o.getActiveInsured().HesKod)),e.isPrepared=!0,angular.forEach(e.menus,function(t){if(e.quotationContent.detail.satir.arabrans===t.product&&(t.isCreateWebLog||!1===e.isWebLogSendOnPageOpen)&&e.sendWebLog(),"0"==e.quotationContent.detail.satir.tip&&e.quotationContent.detail.satir.arabrans!==t.product){var n=parseInt(t.main_product)-1;e.quotationContent.detail.satir.anabrans==n&&(t.isCreateWebLog||!1===e.isWebLogSendOnPageOpen)&&e.sendWebLog()}}),"CARD"!==e.styleSelection.quotation&&"LIST"!==e.styleSelection.quotation||e.getPoliceCaprazTablo(t.detail.teklif.sirketler)})},null,null,null,!0)})},e.onCompare=function(){l.open("/content/views/quotation/compare-modal.html","Compare.QuotationModalController",function(t){t.data={data:e.quotationContent,menu:e.activeMenu,menuProductDetails:e.portalMenuProductDetails,companiesInfo:e.companiesInfo,insured:e.insuredData,boxesData:e.boxesData,selectedAraBrans:e.form.AraBransFilter}},"xxl")},e.autoRefreshQuotation=function(){var t=1e3*parseInt(e.activeMenu.refreshTime);c.quotationRefresh=u(function(){e.isAutoRefreshed=!0,e.refreshQuotation(!0)},t)},e.checkQuotationPresentation=function(t){e.welcomeInit.isSuccessData?e.welcomeInit.onCreateFilter({portalMenuId:-2,viewLocation:"DASHBOARD"},function(){e.initData(t)}):c.$on("$welcomeInit.onSuccess",function(){e.welcomeInit.onCreateFilter({portalMenuId:-2,viewLocation:"DASHBOARD"},function(){e.initData(t)})})},e.checkQuotationPresentationRefresh=function(t){e.welcomeInit.isSuccessData?e.initDataRefresh(t):c.$on("$welcomeInit.onSuccess",function(){e.initDataRefresh(t)})},e.initData=function(t){var a=f;e.menus=a.getMenus(),e.dynamicContent=a.getDynamicContent(),e.websiteSettings=a.getWebsiteSettings(),n.set(a.getRootSettings()),angular.forEach(a.getMenus(),function(t){if(e.quotationContent.detail.satir.arabrans===t.product&&(1===t.presentation&&t.portalDetailsMenu&&(e.menuPresentationDesc=t.portalDetailsMenu.presentationDesc,e.menuPresentationDescMobile=t.portalDetailsMenu.presentationDescMobile,e.menuPresentationDescTablet=t.portalDetailsMenu.presentationDescTablet,e.menuisViewAllResolutionsPresentation=t.portalDetailsMenu.isViewAllResolutionsPresentation,e.isMenuPresentationDesc=!(!e.menuPresentationDesc&&""===e.menuPresentationDesc)),e.activeMenu=t,null!==e.activeMenu.quotationStylesDetail&&""!==e.activeMenu.quotationStylesDetail&&e.activeMenu.quotationStylesDetail.length>0?e.styleSelection.quotation=e.activeMenu.quotationStylesDetail:e.styleSelection.quotation=e.welcomeInit.getPanelSettings().quotationStylesDetail,null!==t.portalDetailsMenu&&(e.quotationContent.araBransTitle=t.portalDetailsMenu.title),null!==e.activeMenu.quotationDetailCardHeight&&""!==e.activeMenu.quotationDetailCardHeight&&void 0!==e.activeMenu.quotationDetailCardHeight?e.quotationDetailCardHeight=e.activeMenu.quotationDetailCardHeight:e.quotationDetailCardHeight=f.getPanelSettings().quotationDetailListHeight),"0"==e.quotationContent.detail.satir.tip&&e.quotationContent.detail.satir.arabrans!==t.product){var n=parseInt(t.main_product)-1;parseInt(e.quotationContent.detail.satir.anabrans)===n&&(1===t.presentation&&t.portalDetailsMenu&&(e.menuPresentationDesc=t.portalDetailsMenu.presentationDesc,e.menuPresentationDescMobile=t.portalDetailsMenu.presentationDescMobile,e.menuPresentationDescTablet=t.portalDetailsMenu.presentationDescTablet,e.menuisViewAllResolutionsPresentation=t.portalDetailsMenu.isViewAllResolutionsPresentation,e.isMenuPresentationDesc=!(!e.menuPresentationDesc&&""===e.menuPresentationDesc)),e.activeMenu=t,null!==e.activeMenu.quotationStylesDetail&&""!==e.activeMenu.quotationStylesDetail&&e.activeMenu.quotationStylesDetail.length>0?e.styleSelection.quotation=e.activeMenu.quotationStylesDetail:e.styleSelection.quotation=e.welcomeInit.getPanelSettings().quotationStylesDetail,null!==t.portalDetailsMenu&&(e.quotationContent.araBransTitle=e.quotationContent.detail.satir.arabransaciklama),null!==e.activeMenu.quotationDetailCardHeight&&""!==e.activeMenu.quotationDetailCardHeight&&void 0!==e.activeMenu.quotationDetailCardHeight?e.quotationDetailCardHeight=e.activeMenu.quotationDetailCardHeight:e.quotationDetailCardHeight=f.getPanelSettings().quotationDetailListHeight)}}),e.onInitPortalBox(e.activeMenu.id),"function"==typeof t&&t()},e.initDataRefresh=function(t){var a=f;e.menus=a.getMenus(),e.dynamicContent=a.getDynamicContent(),e.websiteSettings=a.getWebsiteSettings(),n.set(a.getRootSettings()),angular.forEach(a.getMenus(),function(t){if(e.quotationContent.detail.satir.arabrans===t.product&&(1===t.presentation&&t.portalDetailsMenu&&(e.menuPresentationDesc=t.portalDetailsMenu.presentationDesc,e.menuPresentationDescMobile=t.portalDetailsMenu.presentationDescMobile,e.menuPresentationDescTablet=t.portalDetailsMenu.presentationDescTablet,e.menuisViewAllResolutionsPresentation=t.portalDetailsMenu.isViewAllResolutionsPresentation,e.isMenuPresentationDesc=!(!e.menuPresentationDesc&&""===e.menuPresentationDesc)),e.activeMenu=t,null!==t.portalDetailsMenu&&(e.quotationContent.araBransTitle=t.portalDetailsMenu.title)),"0"==e.quotationContent.detail.satir.tip&&e.quotationContent.detail.satir.arabrans!==t.product){var n=parseInt(t.main_product)-1;parseInt(e.quotationContent.detail.satir.anabrans)===n&&(1===t.presentation&&t.portalDetailsMenu&&(e.menuPresentationDesc=t.portalDetailsMenu.presentationDesc,e.menuPresentationDescMobile=t.portalDetailsMenu.presentationDescMobile,e.menuPresentationDescTablet=t.portalDetailsMenu.presentationDescTablet,e.menuisViewAllResolutionsPresentation=t.portalDetailsMenu.isViewAllResolutionsPresentation,e.isMenuPresentationDesc=!(!e.menuPresentationDesc&&""===e.menuPresentationDesc)),e.activeMenu=t,null!==t.portalDetailsMenu&&(e.quotationContent.araBransTitle=e.quotationContent.detail.satir.arabransaciklama))}}),"function"==typeof t&&t()},e.getTrustedHtml=function(e){if(null!==e&&void 0!==e)return m.trustAsHtml(e)},e.openPaymentModal=function(t){e.isPaymentRequested=!0,e.isPaymentContentExist=!1;var n="cml";return angular.forEach(e.boxesData.defaultItems,function(a){a.isViewPaymentModal&&a.isActive&&e.quotationContent.detail.satir.arabrans==a.portalMenus.product&&a.paymentCompany==t.skod&&(e.isPaymentContentExist=!0,n="xl")}),"1"==t.kk_3d?void l.open("/content/views/secure-payment-modal.html","SecurePayment.ModalController",function(n){n.data={sirket:t,quotationContent:e.quotationContent,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,insuredData:e.insuredData,activeMenu:e.activeMenu,documents:e.quotationContent.detail.dosyalar,forms:e.quotationContent.detail.forms,isPaymentContentExist:e.isPaymentContentExist}},n):"1"==t.kk_online?void l.open("/content/views/payment-modal.html","Payment.ModalController",function(n){n.data={sirket:t,quotationContent:e.quotationContent,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,insuredData:e.insuredData,activeMenu:e.activeMenu,documents:e.quotationContent.detail.dosyalar,forms:e.quotationContent.detail.forms}},"cml"):"1"==t.acik||"0"==t.kk_online&&"0"==t.kk_3d&&"0"==t.acik?void l.open("/content/views/payment-request-modal.html","PaymentRequest.ModalController",function(n){n.data={sirket:t,quotationContent:e.quotationContent,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,documents:e.quotationContent.detail.dosyalar,forms:e.quotationContent.detail.forms,activeMenu:e.activeMenu}},"cml"):void 0},e.resetPaymentPage=function(){e.isPaymentRequested=!1,e.requestedPaymentCompany=null,e.prodStatusMessage=null,e.result=null,null!==e.interval&&void 0!==e.interval&&u.cancel(e.interval)},e.onClickPaymentTitle=function(){e.form.Cvc=null,e.form.KartNo=null,e.form.KartSahibi=null,e.form.KartSahibiTC=null,e.form.KartTipi=null,e.form.SonKulTar=null,e.form.sonKulYil=null,e.form.sonKulAy=null,e.form.SalesAgreement="0",e.form.Agreement=!1,e.isPaymentRequested=!0,e.form.InsuranceAgreement=!1,e.isOnlinePaymentAvailable=!1,e.result=null},e.openPaymentByParameter=function(t){if(e.isPaymentContentExist=!1,e.isProdCheckActive=!1,"page"==e.portalPanelSettings.paymentStyle){if(e.isPaymentRequested=!0,e.form.Agreement=!1,e.form.InsuranceAgreement=!1,e.isOnlinePaymentAvailable=!1,e.result=null,delete t.table,e.requestedPaymentCompany=angular.copy(t),e.form.Cvc=null,e.form.KartNo=null,e.form.KartSahibi=null,e.form.KartSahibiTC=null,e.form.KartTipi=null,e.form.SonKulTar=null,e.form.sonKulYil=null,e.form.sonKulAy=null,e.form.SalesAgreement="0",e.form.Agreement=!1,e.isTimedOut=!0,e.getPaymentPageDescriptions(),e.pdfDocuments.informationDocument=null,e.pdfDocuments.isInformationTextDocumentExist=!1,e.pdfDocuments.isDefaultInformationTextDocumentExist=!1,e.pdfDocuments.defaultInformationDocument=null,null!==e.quotationContent.detail.dosyalar&&angular.forEach(e.quotationContent.detail.dosyalar,function(n){t.skod==n.skod&&n.yerid==t.teklif_id&&"3"==n.doctip&&(e.pdfDocuments.informationDocument=n,e.pdfDocuments.isInformationTextDocumentExist=!0,e.pdfDocuments.isDefaultInformationTextDocumentExist=!1)}),!0!==e.pdfDocuments.isInformationTextDocumentExist&&null!==e.quotationContent.detail.forms&&angular.forEach(e.quotationContent.detail.forms,function(n){null!==n.siteUrl&&""!==n.siteUrl&&null!==n.pdfLocation&&""!==n.pdfLocation&&e.quotationContent.detail.satir.arabrans==n.product&&t.skod==n.skod&&(e.pdfDocuments.defaultInformationDocument=n,e.pdfDocuments.isDefaultInformationTextDocumentExist=!0)}),null!==e.pdfDocuments.informationDocument){var n={pDosyaID:e.pdfDocuments.informationDocument.id};a.post("sales/operations/file/base",n,function(){var t=e.generateFileURL();e.pdfDocuments.informationDocument=m.trustAsResourceUrl(t)})}e.requestedPaymentCompany.isHideInstallmentOn3D||"CASH"===e.activeMenu.priceView?e.setOdemeTipi("0"):e.setOdemeTipi("1");try{p(function(){window.scrollTo({top:0})},50)}catch(e){}}else{var i="cml";if(angular.forEach(e.boxesData.defaultItems,function(n){n.isViewPaymentModal&&n.isActive&&e.quotationContent.detail.satir.arabrans==n.portalMenus.product&&n.paymentCompany==t.skod&&(e.isPaymentContentExist=!0,i="xl")}),"1"==t.kk_3d)return void l.open("/content/views/secure-payment-modal.html","SecurePayment.ModalController",function(n){n.data={sirket:t,quotationContent:e.quotationContent,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,insuredData:e.insuredData,activeMenu:e.activeMenu,documents:e.quotationContent.detail.dosyalar,forms:e.quotationContent.detail.forms,isPaymentContentExist:e.isPaymentContentExist}},i);if("1"==t.kk_online)return void l.open("/content/views/payment-modal.html","Payment.ModalController",function(n){n.data={sirket:t,quotationContent:e.quotationContent,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,insuredData:e.insuredData,activeMenu:e.activeMenu,documents:e.quotationContent.detail.dosyalar,forms:e.quotationContent.detail.forms}},"cml");if("1"==t.acik||"0"==t.kk_online&&"0"==t.kk_3d&&"0"==t.acik)return void l.open("/content/views/payment-request-modal.html","PaymentRequest.ModalController",function(n){n.data={sirket:t,quotationContent:e.quotationContent,isMenuPresentationDesc:e.isMenuPresentationDesc,boxesData:e.boxesData,documents:e.quotationContent.detail.dosyalar,forms:e.quotationContent.detail.forms,activeMenu:e.activeMenu}},"cml")}},e.getPaymentPageDescriptions=function(){a.get("payment/descriptions",{},function(t){e.paymentPageDescription=t.paymentPageDescription,e.paymentPageDescriptionTablet=t.paymentPageDescriptionTablet,e.paymentPageDescriptionMobile=t.paymentPageDescriptionMobile,e.isViewPaymentDescriptionAllResolutions=t.isViewPaymentDescriptionAllResolutions})},e.onClickContact=function(t,n){k.areYouSureWithMessage(v.translate("INFO_6"),function(){if(!0!==t.isContactRequested){var i={pCompany:t.sirketadi,pIdentity:e.insuredData.HesKod,pMail:e.insuredData.EMail,pProduct:n.araBransTitle,pType:v.translate("TEKLİF DETAYI"),pGSM:e.insuredData.GSMNo,pName:e.insuredData.Unvan,pPoliID:n.pPoliID};a.post("quotation/detail/contact/request",i,function(e){e&&(t.isContactRequested=!0,k.success(v.translate("İletişim talebinizi aldık. En kısa sürede size ulaşacağız.")))},null,null,null,!0)}})},e.policyRequestWithPhone=function(t){null!=e.requestedPaymentCompany&&""!=e.requestedPaymentCompany&&void 0!=e.requestedPaymentCompany||(e.requestedPaymentCompany=angular.copy(t)),k.areYouSureWithMessage(v.translate("Poliçenizi telefonda satın alma seçimi için onay veriyor musunuz?"),function(){var t={pAnaBrans:e.quotationContent.detail.satir.anabrans,pAraBrans:e.requestedPaymentCompany.arabrans,pTeklifID:e.requestedPaymentCompany.teklif_id,pPTutar:e.requestedPaymentCompany.ptutar,pPoliID:e.quotationContent.pPoliID,pSKOD:e.requestedPaymentCompany.skod,pTTutar:e.requestedPaymentCompany.ttutar,pTVNedeni:e.requestedPaymentCompany.tvneden,pTeklifNo:e.requestedPaymentCompany.teklifno,pTeklifnoPSN:e.requestedPaymentCompany.teklifno_psn,pTip:e.quotationContent.pTip,pPKomisyon:e.requestedPaymentCompany.pkom,pTKomisyon:e.requestedPaymentCompany.tkom,pAciklama:e.requestedPaymentCompany.aciklama,SatisSekli:"-1",pOdemeTipi:0,pPhone:e.insuredData.TelNo1,pEposta:e.insuredData.EMail,OdemeSekli:-1,KartNo:"00000",Cvc:null,SonKulTar:null,KartTipi:null,Banka:null,KartSahibi:null,KartSahibiTC:null,Telefon:e.insuredData.TelNo1,Aciklama:"",CekimSekli:0,TaksitSayisi:0,OdemeSecenekID:-1,TC:e.insuredData.TCNo,OdemeSecenekKodu:null};a.post("sales/policyrequest/phone",t,function(t){0==t.return.HataKodu?e.sendTransactionList(function(){var t={pCompany:e.requestedPaymentCompany.sirketadi,pIdentity:e.insuredData.HesKod,pMail:e.insuredData.EMail,pProduct:e.requestedPaymentCompany.arabrans_adi,pType:v.translate("TEKLİF DETAYI"),pGSM:e.insuredData.GSMNo,pName:e.insuredData.Unvan,pPoliID:e.quotationContent.pPoliID};a.post("quotation/detail/contact/request",t,function(e){e&&(k.success(v.translate("Talebinizi aldık. En kısa sürede size ulaşacağız.")),c.$broadcast("@activateView","police-talepleri"))},null,null,null,!0)}):k.info(t.return.HataMesaji)})})},e.sendTransactionList=function(t){if("page"==e.portalPanelSettings.paymentStyle&&null!==e.portalPanelSettings.policyPhoneOperationList&&""!==e.portalPanelSettings.policyPhoneOperationList&&void 0!==e.portalPanelSettings.policyPhoneOperationList){var n=[],i=[];n.push(1),i.push(e.quotationContent.pPoliID);var o={pAciklama:null,pIslemTipi:parseInt(e.portalPanelSettings.policyPhoneOperationList),pNotlar:null,pTipDizi:n,pPoliceDizi:i,_totalRecordCount:1,isSingleRequest:!0};a.post("quotation/transactionList",o,function(e){"function"==typeof t&&t()},function(){"function"==typeof t&&t()})}else"function"==typeof t&&t()},e.getPercent=function(){if(void 0!==e.quotationContent){return parseInt(e.quotationContent.detail.satir.vsirket2)/parseInt(e.quotationContent.detail.satir.tsirket2)*100}},e.getPoliceCaprazTablo=function(t){angular.forEach(t,function(t){var n={table:{length:{column:0},columns:{},groups:{TeminatTablo:[],IndirimTablo:[],AciklamaTablo:[]}}};n.table.columns[t.skod]=t,e.setGroups(t.tablo.tablo.TeminatTablo,"TeminatTablo",n,t.skod),e.setGroups(t.tablo.tablo.IndirimTablo,"IndirimTablo",n,t.skod),e.setGroups(t.tablo.tablo.AciklamaTablo,"AciklamaTablo",n,t.skod),t.table=n})},e.setGroups=function(t,n,a,i){angular.forEach(t,function(t){var o=e.getOrCreateSection(n,t,a);e.getOrCreateElement(o,t,a).values[i]={SirketAdi:t.SirketAdi,TIA_Tip:t.TIA_Tip,Deger:t.Deger,Aciklama:t.Aciklama,Tip:t.Tip,TIA_Aciklama:t.TIA_Aciklama,WQV:t.WQV}})},e.getOrCreateSection=function(t,n,a){var i=!1;return angular.forEach(a.table.groups[t],function(t){"LIST"===e.styleSelection.quotation?i=t:t.Grup_Id===n.Grup_Id&&(i=t)}),!1===i&&(i={Grup_Id:n.Grup_Id,Grup_Adi:n.Grup_Adi,WQV:n.WQV,elements:[]},0===i.Grup_Adi.length&&(i.Grup_Adi="GENEL"),a.table.groups[t].push(i)),i},e.getOrCreateElement=function(e,t){var n=!1;return angular.forEach(e.elements,function(e){e.TIA_Id===t.TIA_Id&&(n=e)}),!1===n&&(n={TIA_Id:t.TIA_Id,TIA_Adi:t.TIA_Adi,WQV:t.WQV,values:{}},e.elements.push(n)),n},e.sendWebLog=function(){e.isWebLogSendOnPageOpen=!0;var t={pPoliID:e.pPoliIDForDetail,pCount:e.quotationContent.detail.teklif.sirketler.length};a.post("q/d/wlg",t,function(){},null,null,null,!0)},e.getValidPaymentTypes=function(e,t){var n=0,a=[];return angular.forEach(e,function(e){e.skod==t&&(e.index=n,a.push(e),n++)}),a},e.getInstallmentCount=function(e,t,n){var a={taksitAdet:0,taksitText:"",taksitTutar:0},i=0,o=parseFloat(n),r=0;return void 0!==n&&null!==n&&""!==n&&(angular.forEach(e,function(e){e.skod==t&&parseInt(e.taksit_adedi)>1&&(i=e.taksit_adedi)}),r=o/i),r=g("serviceCurrency")(r),a.taksitAdet=parseInt(i),a.taksitTutar=parseInt(r),a.taksitText=r+" x "+i,a},e.getCategories=function(t){angular.forEach(t.defaultItems,function(t){angular.forEach(t.portalPageCategories,function(n,a){0===a?(n.activeClass="active",e.onChangeActiveKategori(n.id,t)):n.activeClass=""})})},e.onChangeActiveKategori=function(t,n){n.activeKategoriID=t,angular.forEach(e.boxesData.defaultItems,function(e){angular.forEach(e.portalPageCategories,function(e){e.id===t?(e.activeClass="active",e.portalPageFaqContentResponses=g("orderBy")(e.portalPageFaqContentResponses,"order"),angular.forEach(e.portalPageFaqContentResponses,function(e,t){e.showClass=0===t?"show":""})):e.activeClass=""})})},e.onChangeActiveContent=function(e,t){angular.forEach(t.portalPageFaqContentResponses,function(t){t.id===e?"show"===t.showClass?t.showClass="":t.showClass="show":t.showClass=""})},e.onInitPortalBox=function(t){e.boxesInit=h.onCreate(t),c.$on("$boxesInit.onSuccess",function(){e.boxesData=h.getBoxes(t),e.getCategories(e.boxesData)})},e.getRemainingTime=function(){var t=0,n=moment(e.quotationContent.detail.teklif.TeklifZaman,"YYYY-MM-DD HH:mm:ss"),a=n.add(e.activeMenu.timeOut,"seconds"),i=moment(e.quotationContent.detail.teklif.ServerTime,"YYYY-MM-DD HH:mm:ss");return a.diff(i,"milliseconds")>0&&(t=a.diff(i,"milliseconds")),0==t&&(e.isViewCounter=!1),t},e.getAlternativeQuotations=function(t){var n=f.getMenus();if(angular.forEach(n,function(t){e.quotationContent.detail.satir.arabrans===t.product&&(e.activeMenuSelection=t)}),"0"==e.quotationContent.detail.satir.tip&&angular.forEach(n,function(t){var n=parseInt(t.main_product)-1;parseInt(e.quotationContent.detail.satir.anabrans)===n&&(e.activeMenuSelection=t)}),!0!==e.activeMenuSelection.isViewAlternativeQuotations)"function"==typeof t&&t();else{e.quotationCriterias=e.welcomeInit.getQuotationCriterias();var i={HesapKodu:e.insuredData.HesKod,pPoliceTipi:-1,pPozisyon:e.quotationCriterias.position,pSiralama:e.quotationCriterias.order,pGorevlendirmeDurumu:e.quotationCriterias.assignType,pGrupGetir:e.quotationCriterias.groupAccount,endDatePreviousDay:e.quotationCriterias.endDatePreviousDay,endDateNextDay:e.quotationCriterias.endDateNextDay};a.post("teklifler/getlist",i,function(a){""!==a&&null!==a&&void 0!==a&&a.dispolice.length>0&&angular.forEach(a.dispolice,function(e){e.gtemsilciad=y.remove(e.gtemsilciad),e.heskod=y.remove(e.heskod),e.id=y.remove(e.id),e.motorno=y.remove(e.motorno),e.plaka=y.remove(e.plaka),e.policeno=y.remove(e.policeno),e.refgrup=y.remove(e.refgrup),e.sasino=y.remove(e.sasino),e.skod=y.remove(e.skod),e.ttkaciklama=y.remove(e.ttkaciklama),e.unvan1=y.remove(e.unvan1),e.yenilemeno=y.remove(e.yenilemeno),e.zeylno=y.remove(e.zeylno),e.anabrans=y.remove(e.anabrans),e.anabransadi=y.remove(e.anabransadi),e.arabrans=y.remove(e.arabrans),e.arabransaciklama=y.remove(e.arabransaciklama),e.aracdurumu=y.remove(e.aracdurumu),e.bitisgun=y.remove(e.bitisgun),e.distalep2=y.remove(e.distalep2),e.ebaslama=y.remove(e.ebaslama),e.ebitis=y.remove(e.ebitis),e.kayittarihi=y.remove(e.kayittarihi),e.pt_sirketad=y.remove(e.pt_sirketad),e.pt_skod=y.remove(e.pt_skod),e.sirketadi=y.remove(e.sirketadi),e.tarih=y.remove(e.tarih),e.tsirket2=y.remove(e.tsirket2),e.vsirket2=y.remove(e.vsirket2)});var i=a.dispolice;angular.forEach(i,function(e){if(e.tarih=I.wsServiceToInput(e.tarih),e.isQuotationExpired=!1,e.gecerlilikGun=null,""!==e.gun&&"0"!==e.gun&&null!==e.gun){e.gecerlilikGun=moment(e.tekliftarihi,"DD.MM.YYYY").add(parseInt(e.gun),"days").format("DD.MM.YYYY");var t=moment().format("YYYY-MM-DD"),n=moment(e.tekliftarihi,"DD.MM.YYYY").add(parseInt(e.gun),"days").format("YYYY-MM-DD");parseInt(moment.duration(moment(n).diff(moment(t))).asDays())<0&&(e.isQuotationExpired=!0)}}),angular.forEach(i,function(e){var t=parseInt(e.tsirket2),n=parseInt(e.vsirket2),a=parseInt(e.nsirket);t>0&&n+a<t&&(e.teklifDurum="TEKLIF_CALISIYOR"),t>0&&n+a==t&&(e.teklifDurum="TEKLIF_TAMAMLANDI"),t>0&&a==t&&(e.teklifDurum="TEKLIF_CALISILAMADI")}),angular.forEach(i,function(t){angular.forEach(e.menuProducts,function(e){if(e.product===t.arabrans)try{t.araBransTitle=e.portalDetailsMenu.title}catch(e){}if("0"==t.tip&&t.arabrans!==e.product&&t.anabrans==e.main_product)try{t.araBransTitle=t.arabransaciklama}catch(e){}})}),angular.forEach(i,function(e){e.icon="fa fa-clipboard-check",angular.forEach(n,function(t){t.product===e.arabrans&&(e.icon=t.icon,e.color=t.color),"0"==e.tip&&e.arabrans!==t.product&&e.anabrans==t.main_product&&(e.icon=t.icon,e.color=t.color)})}),e.alternativeQuotationList=[],angular.forEach(i,function(t){t.id!=e.quotationContent.pPoliID&&(e.alternativeQuotationList.push(t),e.alternativeQuotationList=g("orderBy")(e.alternativeQuotationList,"id"))}),"function"==typeof t&&t()},null,null,null,!0)}},e.odemeTipiFilter=function(t){return t.ot==e.form.OdemeTipi?t:!1===e.onlineTaksitMevcut&&1==e.form.OdemeTipi?t:void 0},e.setFirstItemOnChangePayment=function(){var t=!1
;angular.forEach(e.selects.onlineOdemeSekilleriList,function(n){n.isSelected=!1,n.ot==e.form.OdemeTipi&&!1===t&&(e.form.OdemeSecenekKodu=n.kod,e.form.OnlineOdemeSecenekKodu=n.kod,e.form.TaksitSayisi=n.adet,n.isSelected=!0,t=!0)})},e.selectData={yearList:[],months:[{kod:null,number:v.translate("Ay"),ad:v.translate("Ay")},{kod:"01",number:"01",ad:v.translate("Ocak")},{kod:"02",number:"02",ad:v.translate("Şubat")},{kod:"03",number:"03",ad:v.translate("Mart")},{kod:"04",number:"04",ad:v.translate("Nisan")},{kod:"05",number:"05",ad:v.translate("Mayıs")},{kod:"06",number:"06",ad:v.translate("Haziran")},{kod:"07",number:"07",ad:v.translate("Temmuz")},{kod:"08",number:"08",ad:v.translate("Ağustos")},{kod:"09",number:"09",ad:v.translate("Eylül")},{kod:"10",number:"10",ad:v.translate("Ekim")},{kod:"11",number:"11",ad:v.translate("Kasım")},{kod:"12",number:"12",ad:v.translate("Aralık")}]},e.getValidYears=function(){for(var e=[],t=moment().year(),n=0;n<11;n++)e.push({kod:t.toString(),ad:t}),t++;return e},e.setOdemeTipi=function(t){e.form.sonKulAy=null,e.form.sonKulYil=null,e.form.SonKulTar=null,e.form.OdemeTipi=t,e.setOnlineOdemeYontemi(function(){e.setFirstItemOnChangePayment(),e.selectData.yearList=e.getValidYears(),e.selectData.yearList.unshift({kod:null,ad:v.translate("Yıl")})})},e.setOnlineOdemeYontemi=function(t){e.form.Agreement=!1,e.form.InsuranceAgreement=!1,e.isOnlinePaymentAvailable=!1;var n={pTeklifHareketID:parseInt(parseInt(e.requestedPaymentCompany.teklif_id)),pSirketKodu:e.requestedPaymentCompany.skod};a.post("sales/onlinepayment/types",n,function(n){e.selects.onlineOdemeSekilleriList=n,n.length>0&&(e.isOnlinePaymentAvailable=!0),e.onlineTaksitMevcut=!1,angular.forEach(e.selects.onlineOdemeSekilleriList,function(t){1==t.ot&&(e.onlineTaksitMevcut=!0)}),"function"==typeof t&&t()},null,null,null,!0)},e.onOnlineTaksitChange=function(t,n){n&&(t.isSelected=!0),e.form.OdemeSecenekKodu=t.kod,e.form.OnlineOdemeSecenekKodu=t.kod,e.form.TaksitSayisi=t.adet,angular.forEach(e.selects.onlineOdemeSekilleriList,function(e){e.kod!=t.kod&&(e.isSelected=!1)})},e.onSelectOnlineTaksitChange=function(t){angular.forEach(e.selects.onlineOdemeSekilleriList,function(n){n.kod==t&&(n.isSelected=!0,e.form.OnlineOdemeSecenekKodu=n.kod,e.form.TaksitSayisi=n.adet),n.kod!=t&&(n.isSelected=!1)})},e.getCurrentActiveTaksit=function(){var t="";return angular.forEach(e.selects.onlineOdemeSekilleriList,function(e){e.isSelected&&(t=e.ad)}),t},e.getTrustedSecureUrl=function(e){return m.trustAsResourceUrl(e)},e.onSuccessPolisoftSecure=function(t){if("Success"==t.result){e.isProdCheckActive=!1,e.prodStatusMessage=null;var n=angular.copy(e.form);n.pPoliID=e.quotationContent.pPoliID,n.pSKOD=e.requestedPaymentCompany.skod,n.pOdemeTipi=parseInt(e.form.OdemeTipi),n.pTeklifID=e.requestedPaymentCompany.teklif_id,n.pTip=e.quotationContent.pTip,n.pSatisSekli="-1",n.pGSM=e.insuredData.TelNo1,n.pEposta=e.insuredData.EMail,n.OdemeSekli=parseInt(e.form.OdemeTipi),n.OnlineOdemeSecenekKodu=e.form.OnlineOdemeSecenekKodu,n.TaksitSayisi=e.form.TaksitSayisi,n.OdemeSecenekID=0,n.KartNo=e.form.KartNo,n.KartSahibi=e.form.KartSahibi,n.KartSahibiTC=e.form.KartSahibiTC,n.Cvc=e.form.Cvc,n.sonKulAy=e.form.sonKulAy,n.sonKulYil=e.form.sonKulYil,n.SonKulTar=n.sonKulAy+"-"+n.sonKulYil,n.KartTipi=-1,n.Banka=-1,n.Telefon=e.insuredData.TelNo1,n.Aciklama="",n.CekimSekli=parseInt(e.form.OdemeTipi),n.pAnaBrans=e.quotationContent.detail.satir.anabrans,n.pAraBrans=e.requestedPaymentCompany.arabrans,n.pPTutar=e.requestedPaymentCompany.ptutar,n.pTTutar=e.requestedPaymentCompany.ttutar,n.pTVNedeni=e.requestedPaymentCompany.tvneden,n.pTeklifNo=e.requestedPaymentCompany.teklifno,n.pTeklifnoPSN=e.requestedPaymentCompany.teklifno_psn,n.pPKomisyon=e.requestedPaymentCompany.pkom,n.pTKomisyon=e.requestedPaymentCompany.tkom,n.pAciklama=e.requestedPaymentCompany.aciklama,n.pPhone=e.insuredData.TelNo1,n.TC=e.insuredData.TCNo,null!==n.TaksitSayisi&&void 0!==n.TaksitSayisi&&""!==n.TaksitSayisi||(n.TaksitSayisi=0),null!==n.OnlineOdemeSecenekKodu&&void 0!==n.OnlineOdemeSecenekKodu&&""!==n.OnlineOdemeSecenekKodu||(n.OnlineOdemeSecenekKodu=0),null!==n.KartNo&&""!==n.KartNo&&void 0!==n.KartNo&&(n.KartNo=e.spliteCardNumber(n.KartNo)),a.post("sales/securepolicyprod",n,function(t){try{p(function(){window.scrollTo({top:0})},50)}catch(e){}e.isFormProcessing=!1,e.isProdCheckActive=!0;var n=u(function(){"Success"!==e.result&&e.checkPolicyProdStatus(n)},1e4);e.interval=n,p(function(){u.cancel(n)},18e4)},function(){e.isFormProcessing=!1},null,null,!0)}else k.error(t.successMessage)},e.onSavePayment3D=function(){null!==e.interval&&void 0!==e.interval&&u.cancel(e.interval),k.areYouSureWithMessageOk(v.translate("Bu adımda kredi kartınızın güvenlik doğrulaması işlemi gerçekleştirilecek, poliçeniz düzenlenene kadar kartınızdan tahsilat yapılmayacaktır. Sonraki adımda bankanız tarafından telefonunuza iletilen doğrulama şifresini girin ve işleminizin güvenliğini sağlayın."),function(){e.isFormProcessing=!0,angular.forEach(e.portalMenuStatus,function(t){"POLICE_TALEBI_3D"===t.status&&e.requestedPaymentCompany.arabrans==t.product&&(e.isViewPolicy3dMessage=!0,e.isViewPolicyOnlineMessage=!1,e.policy3dStatusMessage=t.message,e.policy3dStatusMessageMobile=t.messageMobile,e.policy3dStatusMessageTablet=t.messageTablet,e.policy3dStatusIsViewAllResolutions=t.isViewAllResolutions)});var t={pTeklifID:e.requestedPaymentCompany.teklif_id,pOdemeTipi:parseInt(e.form.OdemeTipi),pSirketKodu:e.requestedPaymentCompany.skod};a.post("sales/3d/online",t,function(t){try{e.isFormProcessing=!1,0==t.return.HataKodu?(e.transactionId=t.return.TransactionID,e.transactionUrl=t.return.Url,l.open("/content/views/payment/secure-window.html","SecurePolisoftModalController",function(n){n.data={data:t,form:e.form,sirket:e.requestedPaymentCompany,quotationContent:e.quotationContent,websiteSettings:e.websiteSettings,activeMenu:e.activeMenu,onSuccess:function(t){e.onSuccessPolisoftSecure(t)},onFailed:function(n){if(null!==n&&void 0!==n&&""!==n){var i={TransactionId:n};a.post("sales/polisoft/3dresult",i,function(n){if("Success"===t.result&&(e.secureResult="Success",u.cancel(interval),e.onSuccessPolisoftSecure(n)),"Fail"===t.result){e.secureResult="Failed";var i={pTeklifID:parseInt(e.requestedPaymentCompany.teklif_id),pSirketKodu:e.requestedPaymentCompany.skod};a.post("sales/order/fail",i,function(){k.error("Ödeme Alınamadı..! 3D işlemi tamamlanmadı."),e.isFormProcessing=!1})}},null,null,null,!0)}else k.error("Ödeme Alınamadı..! 3D işlemi tamamlanmadı."),e.isFormProcessing=!1}}},"xl")):(e.isFormProcessing=!1,k.error(t.return.HataMesaji))}catch(t){e.isFormProcessing=!1,k.error(v.translate("Yerel Hata Oluştu: İşleme devam edilemiyor. 3D Doğrulama hizmeti yanıt vermiyor. Lütfen daha sonra tekrar deneyin."))}},function(){e.isFormProcessing=!1,k.error(v.translate("Yerel Hata Oluştu: İşleme devam edilemiyor. 3D Doğrulama hizmeti yanıt vermiyor. Lütfen daha sonra tekrar deneyin."))})})},e.onSavePayment=function(){null!==e.interval&&void 0!==e.interval&&u.cancel(e.interval),k.areYouSureWithMessage(v.translate("Onayınızla Poliçeniz üretilecektir."),function(){e.isFormProcessing=!0,e.isProdCheckActive=!1,e.prodStatusMessage=null,angular.forEach(e.portalMenuStatus,function(t){"POLICE_TALEBI_ONLINE"===t.status&&e.requestedPaymentCompany.arabrans==t.product&&(e.isViewPolicyOnlineMessage=!0,e.isViewPolicy3dMessage=!1,e.policyOnlineStatusMessage=t.message,e.policyOnlineStatusMessageMobile=t.messageMobile,e.policyOnlineStatusMessageTablet=t.messageTablet,e.policyOnlineStatusIsViewAllResolutions=t.isViewAllResolutions)});var t=angular.copy(e.form);t.pPoliID=e.quotationContent.pPoliID,t.pSKOD=e.requestedPaymentCompany.skod,t.pOdemeTipi=parseInt(e.form.OdemeTipi),t.pTeklifID=e.requestedPaymentCompany.teklif_id,t.pTip=e.quotationContent.pTip,t.pSatisSekli="-1",t.pGSM=e.insuredData.TelNo1,t.pEposta=e.insuredData.EMail,t.OdemeSekli=parseInt(e.form.OdemeTipi),t.OnlineOdemeSecenekKodu=e.form.OnlineOdemeSecenekKodu,t.TaksitSayisi=e.form.TaksitSayisi,t.OdemeSecenekID=0,t.KartNo=e.form.KartNo,t.KartSahibi=e.form.KartSahibi,t.KartSahibiTC=e.form.KartSahibiTC,t.Cvc=e.form.Cvc,t.sonKulAy=e.form.sonKulAy,t.sonKulYil=e.form.sonKulYil,t.SonKulTar=t.sonKulAy+"-"+t.sonKulYil,t.KartTipi=-1,t.Banka=-1,t.Telefon=e.insuredData.TelNo1,t.Aciklama="",t.CekimSekli=parseInt(e.form.OdemeTipi),t.pAnaBrans=e.quotationContent.detail.satir.anabrans,t.pAraBrans=e.requestedPaymentCompany.arabrans,t.pPTutar=e.requestedPaymentCompany.ptutar,t.pTTutar=e.requestedPaymentCompany.ttutar,t.pTVNedeni=e.requestedPaymentCompany.tvneden,t.pTeklifNo=e.requestedPaymentCompany.teklifno,t.pTeklifnoPSN=e.requestedPaymentCompany.teklifno_psn,t.pPKomisyon=e.requestedPaymentCompany.pkom,t.pTKomisyon=e.requestedPaymentCompany.tkom,t.pAciklama=e.requestedPaymentCompany.aciklama,t.pPhone=e.insuredData.TelNo1,t.TC=e.insuredData.TCNo,null!==t.TaksitSayisi&&void 0!==t.TaksitSayisi&&""!==t.TaksitSayisi||(t.TaksitSayisi=0),null!==t.OnlineOdemeSecenekKodu&&void 0!==t.OnlineOdemeSecenekKodu&&""!==t.OnlineOdemeSecenekKodu||(t.OnlineOdemeSecenekKodu=0),null!==t.KartNo&&""!==t.KartNo&&void 0!==t.KartNo&&(t.KartNo=e.spliteCardNumber(t.KartNo)),a.post("sales/policyrequestonline",t,function(t){try{p(function(){window.scrollTo({top:0})},50)}catch(e){}e.isFormProcessing=!1,e.isProdCheckActive=!0;var n=u(function(){"Success"!==e.result&&e.checkPolicyProdStatus(n)},1e4);e.interval=n,p(function(){u.cancel(n)},18e4)},function(){e.isFormProcessing=!1},null,null,!0)})},e.checkPolicyProdStatus=function(t){var n={pTeklifHareketID:parseInt(e.requestedPaymentCompany.teklif_id),pSkod:e.requestedPaymentCompany.skod};a.post("sales/check/policystatus",n,function(n){if(e.prodStatusMessage=null,2==n.HataKodu&&(e.result="Success",u.cancel(t),k.success(v.translate("Satın Alma işlemi başarıyla gerçekleştirildi..!")),c.$broadcast("@activateView","police-talepleri"),e.isProdCheckActive=!1),1==n.HataKodu){e.result=null,u.cancel(t),k.error(n.HataMesaji),e.prodStatusMessage=n.HataMesaji,e.isProdCheckActive=!1;var i={pPoliceID:e.quotationContent.pPoliID,pPoliceTipi:e.quotationContent.pTip,pTeklifID:parseInt(e.requestedPaymentCompany.teklif_id)};a.post("sales/operations/cancel/policy",i,function(){e.isProdCheckActive=!1,e.result=null,e.form.Cvc=null,null!==e.interval&&void 0!==e.interval&&u.cancel(e.interval)},null,null,null,!0)}},null,null,null,!0)},e.validateMultiForms=function(t,n,a,i,o,r,l,s,u,c){e._validator.validateMultiForms(t,n,a,i,o,r,l,s,u,c)},e.spliteCardNumber=function(e){for(var t="",n=e.toString(),a=4,i=0;i<n.length;i++)i===a?(t+="-"+n.charAt(i),a+=4):t+=n.charAt(i);return t},e.checkDocumentAvailability=function(t){var n=!1;return angular.forEach(e.quotationContent.detail.dosyalar,function(a){t==a.doctip&&a.skod==e.requestedPaymentCompany.skod&&a.yerid==e.requestedPaymentCompany.teklif_id&&(n=!0)}),n},e.checkInformationFormExist=function(){var t=!1;return angular.forEach(e.quotationContent.detail.forms,function(n){n.skod==e.requestedPaymentCompany.skod&&n.product==e.requestedPaymentCompany.arabrans&&(t=!0)}),t},e.downloadFileFromURL=function(e){var t=document.createElement("a");t.target="_blank",t.setAttribute("href",e.siteUrl+e.pdfLocation),t.setAttribute("download",e.fileName);var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});try{navigator.userAgent.match("CriOS")?k.error(v.translate("Mobil tarayıcı (iOS/Chrome) PDF dosyalarını doğrudan indiremiyor. Lütfen farklı bir tarayıcı ile tekrar deneyin!")):t.dispatchEvent(n)}catch(e){t.dispatchEvent(n)}},e.openConfirmationModal=function(t){l.open("/content/views/modals/confirmation-text.html","Modals.ConfirmationTextController",function(n){n.data={contentType:t,onSuccess:function(n){e.form[t]=n,1==n&&"SalesAgreement"==t&&e.onChangeSaleAgreement()}}},"lg")},e.onChangeSaleAgreement=function(){p(function(){if(e.form.SalesAgreement){var t={pPoliID:e.quotationContent.pPoliID,skod:e.requestedPaymentCompany.skod};a.post("p/s/wlg",t,function(){},null,null,null,!0)}},50)},e.onChangeAraBransFilter=function(t){e.form.AraBransFilter=t},e.araBransFilter=function(t){if(t.arabrans==e.form.AraBransFilter||"ALL"==e.form.AraBransFilter||null==e.form.AraBransFilter||void 0==e.form.AraBransFilter)return t},e.onClickPreferences=function(t,n,a){l.open("/content/views/quotation/preferences-modal.html","Preferences.QuotationModalController",function(i){i.data={sirket:n,data:t,activeMenu:a,onRedirectPaymentPage:function(t){e.openPaymentByParameter(t)}}},"lg")},e.orderBySelectedOption=function(t,n){t.selectedOption=n,"sirketadi"!=t.selectedOption&&"max_taksit_adet"!=t.selectedOption||(t.detail.teklif.sirketler=g("orderBy")(t.detail.teklif.sirketler,n),t.detail.teklif.sirketler.sort(function(t,n){return"INSTALLMENT"===e.activeMenu.priceSort&&n.sirketadi===t.sirketadi?parseFloat(t.ttutar)-parseFloat(n.ttutar):"CASH"===e.activeMenu.priceSort&&n.sirketadi===t.sirketadi?parseFloat(t.ptutar)-parseFloat(n.ptutar):void 0}))},e.filterCompanies=function(t,n){return 0!==t.orderOfCompanyToShow&&void 0!==t.orderOfCompanyToShow&&""!==t.orderOfCompanyToShow&&null!==t.orderOfCompanyToShow?e.isTimedOut&&n<t.orderOfCompanyToShow:t},e.openInformationTextModal=function(t){l.open("/content/views/modals/information-text-document.html","Modals.InformationTextController",function(n){n.data={document:e.pdfDocuments,onSuccess:function(n){e.form[t]=n,1==n&&e.onChangeInformationText()}}},"lg")},e.onChangeInformationText=function(){p(function(){if(e.form.InsuranceAgreement){var t={pPoliID:e.quotationContent.pPoliID,skod:e.requestedPaymentCompany.skod};a.post("p/cd/wlg",t,function(){},null,null,null,!0)}},50)},e.generateFileURL=function(){var n=null,n=location.host,a=t.protocol()+"://"+n,i=a+"/content/uploads/temp-"+o.getActiveInsured().HesKod;return e.getFileURL(i)},e.getFileURL=function(e){return e+"-Pdf.pdf?time="+Number(new Date)},e.onCreate()}]),app.directive("chatbiTrafficFormStyleOne",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/form-styles/chatbi-bid/form-style-1.html"}}),app.directive("menuS01Mobile",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/mobile/S01-mobile.html"}}),app.directive("menuS02Mobile",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/mobile/S02-mobile.html"}}),app.directive("menuS01Tablet",function(){return{restrict:"E",transclude:!0,templateUrl:"/content/views/directives/menu-styles/tablet/S01-tablet.html"}}),function(){"use strict";function t(e,t){t?(d[0]=d[16]=d[1]=d[2]=d[3]=d[4]=d[5]=d[6]=d[7]=d[8]=d[9]=d[10]=d[11]=d[12]=d[13]=d[14]=d[15]=0,this.blocks=d):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function i(e,n,a){var i,o=typeof e;if("string"===o){var r,l=[],s=e.length,u=0;for(i=0;i<s;++i)(r=e.charCodeAt(i))<128?l[u++]=r:r<2048?(l[u++]=192|r>>6,l[u++]=128|63&r):r<55296||r>=57344?(l[u++]=224|r>>12,l[u++]=128|r>>6&63,l[u++]=128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++i)),l[u++]=240|r>>18,l[u++]=128|r>>12&63,l[u++]=128|r>>6&63,l[u++]=128|63&r);e=l}else{if("object"!==o)throw new Error(h);if(null===e)throw new Error(h);if(f&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||f&&ArrayBuffer.isView(e)))throw new Error(h)}e.length>64&&(e=new t(n,!0).update(e).array());var c=[],d=[];for(i=0;i<64;++i){var m=e[i]||0;c[i]=92^m,d[i]=54^m}t.call(this,n,a),this.update(d),this.oKeyPad=c,this.inner=!0,this.sharedMemory=a}var h="input is invalid type",r="object"==typeof window,s=r?window:{};s.JS_SHA256_NO_WINDOW&&(r=!1);var e=!r&&"object"==typeof self,n=!s.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;n?s=global:e&&(s=self);var o=!s.JS_SHA256_NO_COMMON_JS&&"object"==typeof module&&module.exports,a="function"==typeof define&&define.amd,f=!s.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,u="0123456789abcdef".split(""),c=[-2147483648,8388608,32768,128],y=[24,16,8,0],p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=["hex","array","digest","arrayBuffer"],d=[];!s.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!f||!s.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var A=function(e,n){return function(a){return new t(n,!0).update(a)[e]()}},w=function(e){var a=A("hex",e);n&&(a=b(a,e)),a.create=function(){return new t(e)},a.update=function(e){return a.create().update(e)};for(var i=0;i<l.length;++i){var o=l[i];a[o]=A(o,e)}return a},b=function(t,i){var r=eval("require('crypto')"),s=eval("require('buffer').Buffer"),e=i?"sha224":"sha256",n=function(n){if("string"==typeof n)return r.createHash(e).update(n,"utf8").digest("hex");if(null===n||void 0===n)throw new Error(h);return n.constructor===ArrayBuffer&&(n=new Uint8Array(n)),Array.isArray(n)||ArrayBuffer.isView(n)||n.constructor===s?r.createHash(e).update(new s(n)).digest("hex"):t(n)};return n},v=function(e,t){return function(n,a){return new i(n,t,!0).update(a)[e]()}},_=function(e){var t=v("hex",e);t.create=function(t){return new i(t,e)},t.update=function(e,n){return t.create(e).update(n)};for(var n=0;n<l.length;++n){var a=l[n];t[a]=v(a,e)}return t};t.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(h);if(null===e)throw new Error(h);if(f&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||f&&ArrayBuffer.isView(e)))throw new Error(h);t=!0}for(var a,i,o=0,r=e.length,l=this.blocks;o<r;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),t)for(i=this.start;o<r&&i<64;++o)l[i>>2]|=e[o]<<y[3&i++];else for(i=this.start;o<r&&i<64;++o)(a=e.charCodeAt(o))<128?l[i>>2]|=a<<y[3&i++]:a<2048?(l[i>>2]|=(192|a>>6)<<y[3&i++],l[i>>2]|=(128|63&a)<<y[3&i++]):a<55296||a>=57344?(l[i>>2]|=(224|a>>12)<<y[3&i++],l[i>>2]|=(128|a>>6&63)<<y[3&i++],l[i>>2]|=(128|63&a)<<y[3&i++]):(a=65536+((1023&a)<<10|1023&e.charCodeAt(++o)),l[i>>2]|=(240|a>>18)<<y[3&i++],l[i>>2]|=(128|a>>12&63)<<y[3&i++],l[i>>2]|=(128|a>>6&63)<<y[3&i++],l[i>>2]|=(128|63&a)<<y[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=l[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=c[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},t.prototype.hash=function(){var e,t,n,a,i,o,r,l,s,u=this.h0,c=this.h1,d=this.h2,m=this.h3,f=this.h4,g=this.h5,v=this.h6,k=this.h7,h=this.blocks;for(e=16;e<64;++e)t=((i=h[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,n=((i=h[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,h[e]=h[e-16]+t+h[e-7]+n<<0;for(s=c&d,e=0;e<64;e+=4)this.first?(this.is224?(o=300032,k=(i=h[0]-1413257819)-150054599<<0,m=i+24177077<<0):(o=704751109,k=(i=h[0]-210244248)-1521486534<<0,m=i+143694565<<0),this.first=!1):(t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),a=(o=u&c)^u&d^s,k=m+(i=k+(n=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&g^~f&v)+p[e]+h[e])<<0,m=i+(t+a)<<0),t=(m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10),a=(r=m&u)^m&c^o,v=d+(i=v+(n=(k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7))+(k&f^~k&g)+p[e+1]+h[e+1])<<0,t=((d=i+(t+a)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),a=(l=d&m)^d&u^r,g=c+(i=g+(n=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&k^~v&f)+p[e+2]+h[e+2])<<0,t=((c=i+(t+a)<<0)>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),a=(s=c&d)^c&m^l,f=u+(i=f+(n=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&v^~g&k)+p[e+3]+h[e+3])<<0,u=i+(t+a)<<0;this.h0=this.h0+u<<0,this.h1=this.h1+c<<0,this.h2=this.h2+d<<0,this.h3=this.h3+m<<0,this.h4=this.h4+f<<0,this.h5=this.h5+g<<0,this.h6=this.h6+v<<0,this.h7=this.h7+k<<0},t.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,a=this.h3,i=this.h4,o=this.h5,r=this.h6,l=this.h7,s=u[e>>28&15]+u[e>>24&15]+u[e>>20&15]+u[e>>16&15]+u[e>>12&15]+u[e>>8&15]+u[e>>4&15]+u[15&e]+u[t>>28&15]+u[t>>24&15]+u[t>>20&15]+u[t>>16&15]+u[t>>12&15]+u[t>>8&15]+u[t>>4&15]+u[15&t]+u[n>>28&15]+u[n>>24&15]+u[n>>20&15]+u[n>>16&15]+u[n>>12&15]+u[n>>8&15]+u[n>>4&15]+u[15&n]+u[a>>28&15]+u[a>>24&15]+u[a>>20&15]+u[a>>16&15]+u[a>>12&15]+u[a>>8&15]+u[a>>4&15]+u[15&a]+u[i>>28&15]+u[i>>24&15]+u[i>>20&15]+u[i>>16&15]+u[i>>12&15]+u[i>>8&15]+u[i>>4&15]+u[15&i]+u[o>>28&15]+u[o>>24&15]+u[o>>20&15]+u[o>>16&15]+u[o>>12&15]+u[o>>8&15]+u[o>>4&15]+u[15&o]+u[r>>28&15]+u[r>>24&15]+u[r>>20&15]+u[r>>16&15]+u[r>>12&15]+u[r>>8&15]+u[r>>4&15]+u[15&r];return this.is224||(s+=u[l>>28&15]+u[l>>24&15]+u[l>>20&15]+u[l>>16&15]+u[l>>12&15]+u[l>>8&15]+u[l>>4&15]+u[15&l]),s},t.prototype.toString=t.prototype.hex,t.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,a=this.h3,i=this.h4,o=this.h5,r=this.h6,l=this.h7,s=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,a>>24&255,a>>16&255,a>>8&255,255&a,i>>24&255,i>>16&255,i>>8&255,255&i,o>>24&255,o>>16&255,o>>8&255,255&o,r>>24&255,r>>16&255,r>>8&255,255&r];return this.is224||s.push(l>>24&255,l>>16&255,l>>8&255,255&l),s},t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},i.prototype=new t,i.prototype.finalize=function(){if(t.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();t.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),t.prototype.finalize.call(this)}};var B=w();B.sha256=B,B.sha224=w(!0),B.sha256.hmac=_(),B.sha224.hmac=_(!0),o?module.exports=B:(s.sha256=B.sha256,s.sha224=B.sha224,a&&define(function(){return B}))}();